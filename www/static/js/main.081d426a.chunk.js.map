{"version":3,"sources":["game/jass2js/JassParser.js","maps/ArchiveLoader.wasm","maps/ArchiveLoader.jscc","maps/parser.worker.js","game/jass2js/JassLexer.js","utils/ActiveContainer.js","utils/createChainedFunction.js","utils/ErrorView.js","utils/scrollIntoView.js","utils/SearchBox.js","utils/withAsync.js","utils/cache.js","utils/scrollView.js","utils/OverlayNav.js","utils/ScrollSaver.js","utils/downloadBlob.js","data/hash.js","maps/archive.js","maps/parser.js","notify.js","data/cache.js","data/title.js","data/options.js","objects/types.js","DataMenu.js","objects/ObjectCtx.js","objects/DataDownload.js","objects/ObjectList.js","data/tagString.js","objects/Tooltip.js","mdx/parsers/ini/file.js","mdx/parsers/ini/index.js","mdx/parsers/slk/file.js","mdx/parsers/slk/index.js","mdx/common/typecast.js","mdx/common/binarystream.js","mdx/parsers/w3x/doo/randomitem.js","mdx/parsers/w3x/doo/randomitemset.js","mdx/parsers/w3x/doo/doodad.js","mdx/parsers/w3x/doo/terraindoodad.js","mdx/parsers/w3x/doo/file.js","mdx/parsers/w3x/imp/import.js","mdx/parsers/w3x/imp/file.js","mdx/parsers/w3x/w3u/modification.js","mdx/parsers/w3x/w3u/modifiedobject.js","mdx/parsers/w3x/w3u/modificationtable.js","mdx/parsers/w3x/w3d/file.js","mdx/parsers/w3x/w3e/corner.js","mdx/parsers/w3x/w3e/file.js","mdx/parsers/w3x/w3i/player.js","mdx/parsers/w3x/w3i/force.js","mdx/parsers/w3x/w3i/upgradeavailabilitychange.js","mdx/parsers/w3x/w3i/techavailabilitychange.js","mdx/parsers/w3x/w3i/randomunit.js","mdx/parsers/w3x/w3i/randomunittable.js","mdx/parsers/w3x/w3i/randomitem.js","mdx/parsers/w3x/w3i/randomitemset.js","mdx/parsers/w3x/w3i/randomitemtable.js","mdx/parsers/w3x/w3i/file.js","mdx/parsers/w3x/w3u/file.js","mdx/parsers/w3x/wct/customtexttrigger.js","mdx/parsers/w3x/wct/file.js","mdx/parsers/w3x/wtg/triggercategory.js","mdx/parsers/w3x/wtg/variable.js","mdx/parsers/w3x/wtg/subparameters.js","mdx/parsers/w3x/wtg/parameter.js","mdx/parsers/w3x/wtg/eca.js","mdx/parsers/w3x/wtg/trigger.js","mdx/parsers/w3x/wtg/file.js","mdx/common/tokenstream.js","mdx/parsers/w3x/wts/file.js","mdx/parsers/w3x/unitsdoo/droppeditem.js","mdx/parsers/w3x/unitsdoo/droppeditemset.js","mdx/parsers/w3x/unitsdoo/inventoryitem.js","mdx/parsers/w3x/unitsdoo/modifiedability.js","mdx/parsers/w3x/unitsdoo/randomunit.js","mdx/parsers/w3x/unitsdoo/unit.js","mdx/parsers/w3x/unitsdoo/file.js","mdx/parsers/w3x/map.js","mdx/parsers/w3x/mmp/minimapicon.js","mdx/parsers/w3x/w3c/camera.js","mdx/parsers/w3x/w3r/region.js","mdx/parsers/w3x/w3s/sound.js","mdx/parsers/w3x/w3f/maptitle.js","mdx/parsers/w3x/w3f/maporder.js","mdx/parsers/w3x/w3f/index.js","mdx/parsers/w3x/index.js","mdx/parsers/w3x/doo/index.js","mdx/parsers/w3x/imp/index.js","mdx/parsers/w3x/mmp/index.js","mdx/parsers/w3x/mmp/file.js","mdx/parsers/w3x/shd/index.js","mdx/parsers/w3x/shd/file.js","mdx/parsers/w3x/w3c/index.js","mdx/parsers/w3x/w3c/file.js","mdx/parsers/w3x/w3d/index.js","mdx/parsers/w3x/w3e/index.js","mdx/parsers/w3x/w3i/index.js","mdx/parsers/w3x/w3o/index.js","mdx/parsers/w3x/w3o/file.js","mdx/parsers/w3x/w3r/index.js","mdx/parsers/w3x/w3r/file.js","mdx/parsers/w3x/w3s/index.js","mdx/parsers/w3x/w3s/file.js","mdx/parsers/w3x/w3u/index.js","mdx/parsers/w3x/wct/index.js","mdx/parsers/w3x/wpm/index.js","mdx/parsers/w3x/wpm/file.js","mdx/parsers/w3x/wtg/index.js","mdx/parsers/w3x/wtg/triggerdata.js","mdx/parsers/w3x/wts/index.js","mdx/parsers/w3x/unitsdoo/index.js","mdx/parsers/w3x/w3f/file.js","mdx/parsers/mdlx/extent.js","mdx/parsers/mdlx/sequence.js","mdx/parsers/mdlx/tracks.js","mdx/parsers/mdlx/animations.js","mdx/parsers/mdlx/animationmap.js","mdx/parsers/mdlx/animatedobject.js","mdx/parsers/mdlx/layer.js","mdx/parsers/mdlx/material.js","mdx/parsers/mdlx/texture.js","mdx/parsers/mdlx/textureanimation.js","mdx/parsers/mdlx/geoset.js","mdx/parsers/mdlx/geosetanimation.js","mdx/parsers/mdlx/genericobject.js","mdx/parsers/mdlx/bone.js","mdx/parsers/mdlx/light.js","mdx/parsers/mdlx/helper.js","mdx/parsers/mdlx/attachment.js","mdx/parsers/mdlx/particleemitter.js","mdx/parsers/mdlx/particleemitter2.js","mdx/parsers/mdlx/ribbonemitter.js","mdx/parsers/mdlx/camera.js","mdx/parsers/mdlx/eventobject.js","mdx/parsers/mdlx/collisionshape.js","mdx/parsers/mdlx/unknownchunk.js","mdx/parsers/mdlx/model.js","mdx/parsers/mdlx/index.js","mdx/parsers/index.js","mdx/common/math.js","mdx/common/canvas.js","mdx/common/fetchdatatype.js","mdx/common/stringhash.js","mdx/viewer/gl/shader.js","mdx/viewer/gl/program.js","mdx/viewer/gl/gl.js","mdx/viewer/promiseresource.js","mdx/common/gl-matrix-addon.js","mdx/viewer/camera.js","mdx/viewer/node.js","mdx/viewer/scene.js","mdx/viewer/resource.js","mdx/viewer/texture.js","mdx/viewer/handlers/imagetexture/texture.js","mdx/viewer/handlers/imagetexture/handler.js","mdx/viewer/genericresource.js","game/jass2js/gameConstants.js","game/jass2js/proxy.js","game/jass2js/gameFunctions.js","game/ui/customUiApi.ts","game/ui/adapter.ts","game/ui/frames.ts","game/ui/init.ts","game/ui/fdf.ts","mdx/viewer/handlers/toc.ts","game/jass2js/JassVisitor.js","game/jass2js/JassRuntime.js","mdx/viewer/handlers/jass.ts","mdx/utils/promise.js","mdx/viewer/viewer.js","mdx/viewer/modelview.js","mdx/viewer/texturedmodelview.js","mdx/viewer/model.js","mdx/viewer/texturedmodel.js","mdx/viewer/handlers/geo/model.js","mdx/viewer/bucket.js","mdx/viewer/handlers/geo/bucket.js","mdx/viewer/modelinstance.js","mdx/viewer/texturedmodelinstance.js","mdx/viewer/handlers/geo/modelinstance.js","mdx/viewer/shaders.js","mdx/viewer/handlers/geo/shaders.js","mdx/viewer/handlers/geo/handler.js","mdx/viewer/handlers/geo/modelview.js","mdx/viewer/handlers/geo/index.js","mdx/viewer/handlers/mdx/sd.js","mdx/common/interpolator.js","mdx/viewer/handlers/mdx/animatedobject.js","mdx/viewer/handlers/mdx/textureanimation.js","mdx/common/arrayunique.js","mdx/viewer/handlers/mdx/filtermode.js","mdx/viewer/handlers/mdx/layer.js","mdx/viewer/handlers/mdx/geosetanimation.js","mdx/viewer/handlers/mdx/geoset.js","mdx/viewer/handlers/mdx/batch.js","mdx/viewer/handlers/mdx/replaceableids.js","mdx/viewer/handlers/mdx/genericobject.js","mdx/viewer/handlers/mdx/bone.js","mdx/viewer/handlers/mdx/light.js","mdx/viewer/handlers/mdx/helper.js","mdx/viewer/handlers/mdx/attachment.js","mdx/viewer/handlers/mdx/modelparticleemitter.js","mdx/viewer/handlers/mdx/modelparticleemitter2.js","mdx/viewer/handlers/mdx/modelribbonemitter.js","mdx/viewer/handlers/mdx/camera.js","mdx/utils/mappeddata.js","mdx/common/audio.js","mdx/viewer/handlers/mdx/modeleventobject.js","mdx/viewer/handlers/mdx/collisionshape.js","mdx/viewer/handlers/mdx/model.js","mdx/common/bounds.js","mdx/viewer/handlers/mdx/sharedemitter.js","mdx/viewer/handlers/mdx/particle.js","mdx/viewer/handlers/mdx/particleemitter.js","mdx/viewer/handlers/mdx/sharedgeometryemitter.js","mdx/viewer/handlers/mdx/particle2.js","mdx/viewer/handlers/mdx/particleemitter2.js","mdx/viewer/handlers/mdx/ribbon.js","mdx/viewer/handlers/mdx/ribbonemitter.js","mdx/viewer/handlers/mdx/eventobjectspn.js","mdx/viewer/handlers/mdx/eventobjectspnemitter.js","mdx/viewer/handlers/mdx/eventobjectspl.js","mdx/viewer/handlers/mdx/eventobjectsplemitter.js","mdx/viewer/handlers/mdx/eventobjectubr.js","mdx/viewer/handlers/mdx/eventobjectubremitter.js","mdx/viewer/handlers/mdx/eventobjectsndemitter.js","mdx/viewer/handlers/mdx/bucket.js","mdx/viewer/handlers/mdx/node.js","mdx/viewer/handlers/mdx/attachmentinstance.js","mdx/viewer/handlers/mdx/particleemitterview.js","mdx/viewer/handlers/mdx/particleemitter2view.js","mdx/viewer/handlers/mdx/ribbonemitterview.js","mdx/viewer/handlers/mdx/eventobjectemitterview.js","mdx/viewer/handlers/mdx/modelinstance.js","mdx/viewer/handlers/mdx/shaders.js","mdx/viewer/handlers/mdx/handler.js","mdx/viewer/handlers/mdx/modelview.js","mdx/viewer/handlers/mdx/index.js","mdx/viewer/handlers/imagetexture/index.js","mdx/viewer/handlers/w3x/shaders.js","mdx/viewer/handlers/w3x/variations.js","mdx/viewer/handlers/w3x/terrainmodel.js","mdx/viewer/handlers/w3x/splatmodel.js","mdx/viewer/handlers/w3x/standsequence.js","mdx/viewer/handlers/w3x/viewer.js","mdx/viewer/handlers/w3x/index.js","mdx/index.js","mdx/viewer/index.js","mdx/viewer/handlers/index.js","files/FileModel.js","objects/ObjectModel.js","objects/ObjectValue.js","objects/ObjectData.js","objects/ObjectView.js","files/FileCtx.js","files/FileList.js","files/FileSlk2.js","files/FileHex.js","text/TextView.js","utils/string.js","files/FileText.js","files/FileImage.js","files/FileAudio.js","jass/keywords.js","files/FileJass.js","files/FileData.js","files/FileSlk.js","files/GameFileData.js","files/FileView.js","MapHome.js","jass/JassView.js","MapView.js","DataView.js","HomePage.js","App.js","index.js"],"names":["global","CstParser","EMPTY_ALT","EOF","require","JassLexer","tokenVocabulary","jassTokens","key","Object","hasOwnProperty","call","JassParser","constructor","super","$","this","RULE","MANY","OR","ALT","SUBRULE","typeDefinition","nativeBlock","globalsBlock","functionBlock","CONSUME","TYPE","CONSUME1","ID","CONSUME2","EXTENDS","CONSUME3","NOTHING","OPTION","ARRAY","CONSTANT","LABEL","type","OPTION3","EQUALS","expression","LOCAL","left","op","right","ParentheticalExpression","NotExpression","NegateExpression","IDLITERAL","STRINGLITERAL","HEX_CONSTANT","DOLLAR_HEX_CONSTANT","RAWCODE","jassValueOf","FunctionReferenceExpression","INTEGER","NULL","FALSE","TRUE","REAL","OR2","AND","EQUALSEQUALS","LESSOREQUALS","GREATEROREQUALS","LESS","GREATER","NOTEQUALS","PLUS","MINUS","MULT","DIV","SUBRULE2","FUNCTION","arrayAccess","LPAREN","argList","RPAREN","LSQUAREPAREN","RSQUAREPAREN","NOT","DEF","COMMA","label","callStatement","setStatement","returnStatement","exitWhenStatement","localVars","loopStatement","ifStatement","CALL","functionCallExpression","SET","RETURN","EXITWHEN","LOOP","statement","ENDLOOP","IF","THEN","MANY2","elseIfStatement","MANY3","elseStatement","CONSUME4","ENDIF","ELSEIF","ELSE","param","GLOBALS","globalVar","ENDGLOBALS","NATIVE","TAKES","paramList","RETURNS","ENDFUNCTION","performSelfAnalysis","visitor","visit","d","depth","Array","visitArray","visitObject","keys","length","image","console","log","indent","tokenType","name","endLine","endColumn","element","__proto__","i","fill","join","module","exports","parse","inputText","rule","debug","parserInstance","lexResult","tokenize","input","tokens","constVisitor","cstPostRule","output","errors","Error","message","__webpack_require__","p","__filename","process","__dirname","ArchiveLoader","_scriptName","document","currentScript","src","undefined","moduleArg","readyPromiseResolve","readyPromiseReject","read_","readAsync","readBinary","Module","readyPromise","Promise","resolve","reject","ENVIRONMENT_IS_WEB","window","ENVIRONMENT_IS_WORKER","importScripts","ENVIRONMENT_IS_NODE","versions","node","moduleOverrides","assign","thisProgram","quit_","status","toThrow","scriptDirectory","fs","nodePath","filename","binary","isFileURI","URL","normalize","readFileSync","ret","buffer","Uint8Array","onload","onerror","readFile","err","data","argv","replace","slice","exitCode","self","location","href","startsWith","substr","lastIndexOf","url","xhr","XMLHttpRequest","open","send","responseText","responseType","response","fetch","credentials","then","ok","arrayBuffer","wasmBinary","wasmMemory","out","bind","error","HEAP8","HEAPU8","HEAPU32","ABORT","updateMemoryViews","b","Int8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","__ATPRERUN__","__ATINIT__","__ATPOSTRUN__","addOnPostRun","cb","unshift","runDependencies","runDependencyWatcher","dependenciesFulfilled","abort","what","e","WebAssembly","RuntimeError","wasmBinaryFile","isDataURI","findWasmBinary","path","f","getBinarySync","file","instantiateArrayBuffer","binaryFile","imports","receiver","getBinaryPromise","instantiate","reason","ExitStatus","callRuntimeCallbacks","callbacks","shift","noExitRuntime","stackRestore","val","__emscripten_stack_restore","stackSave","_emscripten_stack_get_current","UTF8Decoder","TextDecoder","UTF8ArrayToString","heapOrArray","idx","maxBytesToRead","endIdx","endPtr","decode","subarray","str","u0","u1","u2","String","fromCharCode","ch","UTF8ToString","ptr","ExceptionInfo","[object Object]","excPtr","destructor","caught","rethrown","set_adjusted_ptr","set_type","set_destructor","adjustedPtr","___cxa_is_pointer_type","get_type","adjusted","get_adjusted_ptr","growMemory","size","pages","byteLength","grow","ENV","getEnvStrings","strings","env","USER","LOGNAME","PATH","PWD","HOME","LANG","navigator","languages","_","x","push","_proc_exit","code","convertI32PairToI53Checked","lo","hi","NaN","wasmTable","calledRun","printCharBuffers","printChar","stream","curr","wasmTableMirror","getWasmTableEntry","funcPtr","func","get","wasmImports","condition","line","k","init","uncaughtExceptionCount","o","u","dest","num","copyWithin","Infinity","q","requestedSize","oldSize","alignUp","multiple","cutDown","overGrownHeapSize","Math","min","newSize","max","s","__environ","environ_buf","bufSize","forEach","string","charCodeAt","stringToAscii","t","penviron_count","penviron_buf_size","v","implicit","r","fd","l","offset_low","offset_high","whence","newOffset","j","iov","iovcnt","pnum","len","a","index","a1","sp","_setThrew","a2","a3","g","a4","c","a5","m","dynCall_ji","w","n","dynCall_viji","h","postResult","wasmExports","callback","info","receiveInstance","instance","id","clearInterval","removeRunDependency","result","instantiateStreaming","catch","createWasm","a0","run","doRun","postRun","preRun","setTimeout","runCaller","pop","Worker","createToken","Lexer","pattern","group","SKIPPED","line_breaks","ActiveContainer","React","Component","render","children","exact","strict","activeClassName","className","activeStyle","style","isActive","getIsActive","props","child","Children","only","createElement","Route","_ref","match","cloneElement","trim","contextTypes","router","PropTypes","shape","history","isRequired","createHref","defaultProps","createChainedFunction","_len","arguments","funcs","_key","filter","reduce","acc","_len2","args","_key2","apply","ErrorView","scrollIntoView","SearchBox","context","onGlobalKeyDown","which","keycode","codes","ctrlKey","show","preventDefault","f3","shiftKey","findPrev","findNext","_input","focus","select","hide","setState","results","onSearch","value","onKeyDown","esc","enter","onChange","target","state","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","componentDidUpdate","prevProps","prevState","found","count","classNames","search-hidden","ref","pos","disabled","onClick","title","glyph","withAsync","requests","Loading","_WithAsync","requestNames","setStateChecked","unmounted","updateRequests","request","shouldComponentUpdate","nextProps","nextState","some","every","success","failure","loaded","displayName","concat","Cache","cache","counter","subs","subscribe","unsubscribe","_start","_stop","opt","curl","refresh","text","res","json","compressed","parseInt","headers","uncompressed","JSON","scrollView","PopupWrap","setActive","OverlayNav","active","overlay","OverlayTrigger","$history","ScrollSaverComponent","onScroll","scrollTop","scrollTimeout","clearTimeout","pathname","hash","onRef","ScrollSaver","downloadBlob","blob","createObjectURL","el","setAttribute","display","body","appendChild","click","removeChild","revokeObjectURL","cryptTable","pathHashTyped","hashType","seed","seed1","seed2","pathHash","imExt","delta","u32","org","makeUid","toString","padStart","parseUid","isNaN","equalUid","wasm","images_","fileId","hasFile","_hasFile","loadBinary","buf","_loadFile","flags","loadFile","encoding","loadImage","_loadImage","Blob","loadJASS","options","_malloc","mem","restoreInt","restoreId","insertLines","restoreStrings","renameGlobals","renameFunctions","renameLocals","inlineFunctions","getObjectName","_loadJASS","_free","lines","dec","prev","loadArchive","LoaderModule","locateFile","LoaderBinary","array","addr","set","_openArchive","parseMapPromise","worker","meta","map","progress","terminate","ArrayBuffer","isView","postMessage","MapParser","onProgress","notifyComp","pendingNotify","setNotifyComponent","comp","setNotification","notifyMessage","postProcess","values","objects","obj","repl","toLowerCase","reader","FileReader","onabort","readAsArrayBuffer","BaseData","build","core","listFile","jass","icon","iconByName","MapData","archive","files_","isMap","objects_","version","tileset","backgroundImage","backgroundSize","AppCache","root","baseData_","mapNames_","mapData_","maps","dataStore","IdbKvStore","nameStore","proms","ready","all","images","names","icons_","Map","imageList","uid","forceUpdate","custom","customDesc","entries","_ref2","desc","metaRaw","meta_","isLocal","arc","hasData","col","row","backgroundPosition","loadMap","abortMap","parser","stage","onMapProgress","beginMapLoad","remove","finishMapLoad","failMapLoad","unloadMap","confirm","Context","createContext","DataContext","MapsContext","TitleContext","Title","PureComponent","updateTitle","indexOf","splice","getTitle","combiner","Provider","contextType","current","Options","localStorage","getItem","update","setItem","stringify","objects_types","unit","item","destructible","doodad","ability","buff","upgrade","ObjectMenuInner","params","NavDropdown","objectTypes","Item","LinkContainer","to","NavItem","event-key","ObjectMenu","component","DataMenu2","Consumer","Fragment","NavLink","RawNames","BuildCtx","TypeCtx","IdCtx","RawNamesSwitch","ObjectIcon","object","nextComma","instr","UpgradeData","atdb","atdm","levb","levm","levc","hpxb","hpxm","mnxb","mnxm","mvxb","mvxm","mnrb","mnrm","hpob","hpom","manb","manm","movb","movm","atxb","atxm","lumb","lumm","atrb","atrm","atsb","atsm","spib","spim","hprb","hprm","sigb","sigm","atcb","atcm","adlb","adlm","minb","minm","raib","raim","entb","entm","enwb","audb","audm","asdb","asdm","asrb","asrm","roob","urob","uart","utma","ttma","TileSets","A","B","K","Y","X","J","D","C","I","F","L","W","N","O","Z","G","V","Q","*","DestructableCategory","P","DoodadCategory","S","E","TechList","HERO","TALT","TWN1","TWN2","TWN3","TWN4","TWN5","TWN6","TWN7","TWN8","TWN9","getString","cmp","cur","listObjectData","rawNames","getInt","use","levels","metaNames","field","m2","getName","sort","category","categories","localeCompare","specific","fname","ObjectFilters","base","order","race","hostilepal","campaign","special","isbldg","class","hero","isEffect","DataCompiler","outJs","outLines","onObject","curJs","onValue","translateSub","types","parseFloat","toFixed","stringExt","find","translate","split","part","iValue","flag","processObject","processSingle","preview","DataDownload","setOption","setType","onDownload","encoded","TextEncoder","encode","onHide","dataDownload","defaultState","Modal","Header","closeButton","Body","FormGroup","controlId","FormLabel","FormControl","componentClass","FormCheck","inline","checked","Footer","Button","bsStyle","ObjectName","raw","ObjectLink","Link","selected","searched","ObjectItem","parent","height","upVisit","fn","downVisit","renderLine","ObjectGroup","filters","toggle","expanded","collapse","expand","level","_title","cat","rest","childrenByName","openHeight","top","modHeight","onResize","expandItem","sub","onDoubleClick","firstLevelChild","mid","subIndex","lineStyle","ObjectList","search","searchResults","onSearchKeyDown","_list","forceUpdateGrid","re","RegExp","isMatch","propernames","matched","rowRenderer","_ref3","flNode","showDownload","onCloseDownload","_data","_type","_id","scrollToRow","Panel","placeholder","onSwitch","AutoSizer","_ref4","width","List","rowCount","rowHeight","ColorGroup","arr","color","tagString","regex","exec","substring","TooltipContent","objectId","setObject","useState","useEffect","async","fetchObject","Popover","Content","description","alt","Tooltip","IniFile","properties","sections","load","section","save","getSection","ini","SlkFile","rows","y","token","valueString","comments","cols","slk","int8","int16","int32","uint8","uint16","uint32","float32","float64","uint8ToInt8","uint8ToInt16","uint8ToUint16","uint8ToUint24","uint8ToUint32","uint8ToFloat32","uint8ToFloat64","int8ToUint8","int16ToUint8","int32ToUint8","uint16ToUint8","uint32ToUint8","float32ToUint8","float64ToUint8","BinaryStream","byteOffset","TypeError","uint8array","substream","remaining","skip","bytes","seek","tell","peek","allowNulls","RangeError","read","peekUntilNull","readUntilNull","peekCharArray","readCharArray","readInt8","readInt16","readInt32","readUint8","readUint16","readUint32","readFloat32","readFloat64","readInt8Array","view","readInt16Array","offset","readInt32Array","readUint8Array","readUint16Array","readUint32Array","readFloat32Array","readFloat64Array","readTypedArray","write","writeInt8","writeInt16","writeInt32","writeUint8","writeUint16","writeUint32","writeFloat32","writeFloat64","writeInt8Array","writeInt16Array","writeInt32Array","writeUint8Array","writeUint16Array","writeUint32Array","writeFloat32Array","writeFloat64Array","writeTypedArray","RandomItem","chance","RandomItemSet","items","getByteLength","Doodad","variation","angle","scale","life","itemTable","itemSets","editorId","itemSet","TerrainDoodad","War3MapDoo","doodads","terrainDoodads","terrainDoodad","Import","isCustom","War3MapImp","entry","has","delete","rename","newName","Modification","variableType","levelOrVariation","dataPointer","useOptionalInts","ModifiedObject","oldId","newId","modifications","modification","ModificationTable","War3MapW3d","originalTable","customTable","Corner","groundHeight","waterHeight","mapEdge","ramp","blight","water","boundary","groundTexture","cliffVariation","groundVariation","cliffTexture","layerHeight","waterAndEdge","textureAndFlags","cliffTextureAndLayer","War3MapW3e","haveCustomTileset","groundTilesets","cliffTilesets","mapSize","centerOffset","corners","columns","column","corner","groundTileset","cliffTileset","Player","isFixedStartPosition","startLocation","allyLowPriorities","allyHighPriorities","Force","playerMasks","UpgradeAvailabilityChange","playerFlags","levelAffected","availability","TechAvailabilityChange","RandomUnit","ids","positions","RandomUnitTable","columnTypes","units","RandomItemTable","sets","War3MapW3i","saves","editorVersion","author","recommendedPlayers","cameraBounds","cameraBoundsComplements","playableSize","campaignBackground","loadingScreenModel","loadingScreenText","loadingScreenTitle","loadingScreenSubtitle","loadingScreen","prologueScreenModel","prologueScreenText","prologueScreenTitle","prologueScreenSubtitle","useTerrainFog","fogHeight","fogDensity","fogColor","globalWeather","soundEnvironment","lightEnvironmentTileset","waterVertexColor","players","forces","upgradeAvailabilityChanges","techAvailabilityChanges","randomUnitTables","randomItemTables","gameVersionMajor","gameVersionMinor","gameVersionPatch","gameVersionBuild","lua","player","force","upgradeAvailabilityChange","techAvailabilityChange","randomUnitTable","randomItemTable","change","table","War3MapW3u","CustomTextTrigger","textLength","War3MapWct","comment","trigger","triggers","TriggerCategory","isComment","Variable","isArray","arraySize","isInitialized","initialValue","SubParameters","beginParameters","parameters","triggerData","getFunction","parameter","Parameter","subParameters","arrayIndex","ECA","isEnabled","ecas","isChildECA","eca","Trigger","isInitiallyOff","runOnInitialization","isCustomText","War3MapWtg","variables","variable","TokenStream","ident","fractionDigits","decoder","DataView","accessPosition","getUint8","readUntil","fromIndex","cc","inComment","inString","readInt","readFloat","readKeyframe","readIntArray","readFloatArray","readColor","readVectorArray","writeColor","writeLine","writeFlag","writeAttrib","writeFloatAttrib","formatFloat","writeStringAttrib","writeArrayAttrib","writeFloatArrayAttrib","formatFloatArray","writeTypedArrayAttrib","writeKeyframe","start","writeArray","writeFloatArray","writeVectorArray","startBlock","endBlock","repeat","startObjectBlock","header","endBlockComma","unindent","War3MapWts","stringMap","content","DroppedItem","DroppedItemSet","InventoryItem","slot","ModifiedAbility","activeForAutocast","heroLevel","Unit","unknown","hitpoints","mana","droppedItemTable","droppedItemSets","goldAmount","targetAcquisition","heroStrength","heroAgility","heroIntelligence","itemsInInventory","modifiedAbilities","randomFlag","itemClass","unitGroup","positionInGroup","customTeamColor","waygate","creationNumber","modifiedAbility","randomUnit","droppedItemSet","itemInInventory","War3MapUnitsDoo","Set","it","add","War3Map","readonly","maxPlayers","getFileNames","setImportsFile","archiveBuffer","typedArray","writer","getImportNames","import","getScript","readHelper","Constructor","readImports","readMapInformation","readEnvironment","readDoodads","readUnits","readTriggers","readCustomTextTriggers","readStringTable","readModifications","fileNames","MinimapIcon","Camera","targetLocation","rotation","angleOfAttack","distance","roll","fieldOfView","farClippingPlane","nearClippingPlane","cinematicName","Region","bottom","weatherEffectId","ambientSound","Sound","eaxEffect","fadeInRate","fadeOutRate","volume","pitch","channel","minDistance","maxDistance","distanceCutoff","u3","u4","u5","u6","u7","u8","MapTitle","visible","chapterTitle","mapTitle","MapOrder","w3x","doo","File","imp","mmp","icons","shd","shadows","w3c","cameras","camera","w3d","w3e","w3i","w3o","destructables","abilities","buffs","upgrades","w3r","regions","region","calcSize","w3s","sounds","sound","w3u","wct","wpm","pathing","wtg","TriggerData","functions","presets","externalTypes","externalFunctions","externalPresets","addTriggerData","isExternal","addTriggerTypes","addTriggerDataFunctions","addTriggerDataPresets","skipped","scriptName","argument","getBaseType","isBaseFunction","getPreset","preset","isCustomPreset","wts","unitsdoo","w3f","campaignVersion","difficulty","mode","backgroundScreen","backgroundScreenPath","minimapImagePath","ambientSoundPath","terrainFog","fogStartZ","fogEndZ","userInterface","mapTitles","mapOrders","mapOrder","Extent","boundsRadius","readMdx","writeMdx","writeMdl","Sequence","interval","moveSpeed","rarity","syncPoint","extent","readMdl","readBlock","templatedTrack","DataType","frame","inTan","outTan","interpolationType","valueSize","UintTrack","FloatTrack","Vector3Track","Vector4Track","templatedAnimation","TrackType","globalSequenceId","tracks","tracksCount","track","numberOfTracks","UintAnimation","FloatAnimation","Vector3Animation","Vector4Animation","animationmap","KMTF","KMTA","KTAT","KTAR","KTAS","KGAO","KGAC","KLAS","KLAE","KLAC","KLAI","KLBI","KLBC","KLAV","KATV","KPEE","KPEG","KPLN","KPLT","KPEL","KPES","KPEV","KP2S","KP2R","KP2L","KP2G","KP2E","KP2N","KP2W","KP2V","KRHA","KRHB","KRAL","KRCO","KRTX","KRVS","KCTR","KTTR","KCRL","KGTR","KGRT","KGSC","AnimatedObject","animations","readAnimations","animation","animationMap","writeAnimations","readAnimation","writeAnimation","filterModeToMdx","None","Transparent","Blend","Additive","AddAlpha","Modulate","Modulate2x","filterModeToMdl","0","1","2","3","4","5","6","Layer","filterMode","textureId","textureAnimationId","coordId","alpha","readAnimatedBlock","Material","priorityPlane","layers","layer","Texture","replaceableId","TextureAnimation","Geoset","vertices","normals","faceTypeGroups","faceGroups","faces","vertexGroups","matrixGroups","matrixIndices","materialId","selectionGroup","selectionFlags","sequenceExtents","uvSets","sequenceExtent","uvSet","vertexGroup","indices","groups","matrix","groupSize","GeosetAnimation","geosetId","GenericObject","parentId","getGenericByteLength","eachAnimation","writeNonGenericAnimationChunks","writeGenericHeader","writeGenericAnimations","wantGeneric","isGeneric","Bone","geosetAnimationId","Light","attenuation","intensity","ambientColor","ambientIntensity","Helper","Attachment","attachmentId","ParticleEmitter","emissionRate","gravity","longitude","latitude","lifeSpan","speed","ParticleEmitter2","headOrTail","tailLength","timeMiddle","segmentColors","segmentAlphas","segmentScaling","headIntervals","tailIntervals","squirt","RibbonEmitter","heightAbove","heightBelow","textureSlot","position","targetPosition","EventObject","CollisionShape","UnknownChunk","tag","chunk","Model","animationFile","blendTime","sequences","globalSequences","materials","textures","textureAnimations","geosets","geosetAnimations","bones","lights","helpers","attachments","pivotPoints","particleEmitters","particleEmitters2","ribbonEmitters","eventObjects","collisionShapes","unknownChunks","loadMdx","loadMdl","loadVersionChunk","loadModelChunk","loadStaticObjects","loadGlobalSequenceChunk","loadDynamicObjects","loadPivotPointChunk","totalSize","saveMdx","saveVersionChunk","saveModelChunk","saveStaticObjectChunk","saveGlobalSequenceChunk","saveDynamicObjectChunk","savePivotPointChunk","globalSequence","getObjectsByteLength","pivotPoint","loadVersionBlock","loadModelBlock","loadNumberedObjectBlock","loadGlobalSequenceBlock","loadObject","loadPivotPointBlock","saveMdl","saveVersionBlock","saveModelBlock","saveStaticObjectsBlock","saveGlobalSequenceBlock","saveObjects","savePivotPointBlock","getStaticObjectsChunkByteLength","getDynamicObjectsChunkByteLength","parsers","mdlx","randomInRange","random","lerp","powerOfTwo","canvas","ctx","getContext","willReadFrequently","canvas2","ctx2","scaleNPOT","imageData","potWidth","potHeight","srcWidth","srcHeight","ImageData","putImageData","drawImage","getImageData","resizeImageData","fetchDataType","dataType","Image","stringHash","lineNumberReg","ShaderUnit","gl","createShader","webglResource","shaderType","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","lineNumber","integer","ShaderProgram","vertexShader","fragmentShader","createProgram","uniforms","attribs","shaders","attribsCount","attachShader","linkProgram","getProgramParameter","LINK_STATUS","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","getProgramInfoLog","extensionToCamelCase","ext","toUpperCase","WebGL","antialias","webgl2","extensions","extension","getSupportedExtensions","getExtension","getParameter","MAX_VERTEX_TEXTURE_IMAGE_UNITS","textureFloat","instancedArrays","VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE","VERTEX_ATTRIB_ARRAY_DIVISOR","drawArraysInstancedANGLE","drawArraysInstanced","drawElementsInstancedANGLE","drawElementsInstanced","vertexAttribDivisorANGLE","vertexAttribDivisor","texImage2D","RED","ALPHA","RG","LUMINANCE_ALPHA","internalformat","depthFunc","LEQUAL","enable","DEPTH_TEST","shaderUnits","shaderPrograms","currentShaderProgram","floatPrecision","shaderDefines","emptyTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","RGBA","UNSIGNED_BYTE","createShaderUnit","createShaderProgram","vertexSrc","fragmentSrc","VERTEX_SHADER","FRAGMENT_SHADER","shaderProgram","enableVertexAttribs","end","enableVertexAttribArray","disableVertexAttribs","disableVertexAttribArray","useShaderProgram","oldAttribs","newAttribs","useProgram","texture","activeTexture","TEXTURE0","PromiseResource","EventEmitter","promise","emit","VEC3_UNIT_X","vec3","fromValues","VEC3_UNIT_Y","VEC3_UNIT_Z","VEC3_ZERO","create","VEC3_ONE","QUAT_DEFAULT","quat","heap","vec4","unproject","inverseMatrix","viewport","z","transformMat4","distanceToPlane","plane","point","normalizePlane","vectorHeap","vectorHeap2","vectorHeap3","quatHeap","matHeap","mat4","rect","isPerspective","fov","aspect","isOrtho","leftClipPlane","rightClipPlane","bottomClipPlane","topClipPlane","nearClipPlane","farClipPlane","inverseRotation","worldMatrix","projectionMatrix","worldProjectionMatrix","inverseWorldMatrix","inverseRotationMatrix","inverseWorldProjectionMatrix","directionX","directionY","directionZ","vectors","billboardedVectors","planes","dirty","perspective","near","far","ortho","copy","setLocation","move","setRotation","rotate","mul","setRotationAngles","horizontalAngle","verticalAngle","identity","rotateAngles","rotateAround","conjugate","transformQuat","setRotationAround","setRotationAroundAngles","rotateX","rotateZ","face","worldUp","lookAt","getRotation","moveToAndFace","reset","fromQuat","negate","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","unpackPlanes","invert","testSphere","center","radius","cameraToWorld","worldToCamera","worldToScreen","round","screenToWorldRay","locationHeap","rotationHeap","scalingHeap","nodeMixin","superclass","pivot","localLocation","localRotation","localScale","worldLocation","worldRotation","worldScale","inverseWorldLocation","inverseWorldRotation","inverseWorldScale","localMatrix","dontInheritTranslation","dontInheritRotation","dontInheritScaling","wasDirty","setPivot","setScale","varying","setUniformScale","uniform","setTransformation","resetTransformation","movePivot","rotateLocal","uniformScale","setParent","recalculateTransformation","computedLocation","computedScaling","parentPivot","parentInverseScale","parentScale","fromRotationTranslationScale","scene","updateObject","updateChildren","SceneNode","EventNode","SkeletalNode","shared","billboarded","billboardedX","billboardedY","billboardedZ","computedRotation","convertBasis","fromRotationTranslationScaleOrigin","NODE_SHARED_SIZE","ndcHeap","Scene","viewer","instances","instanceSet","modelViews","modelViewSet","rendered","renderedInstances","renderedParticles","renderedBuckets","renderCalls","audioEnabled","audioContext","PI","configureOverheadPerspective","heightAboveScene","setAxisAngle","AudioContext","resume","disableAudio","suspend","addInstance","removeInstance","modelView","sceneChanged","addView","removeView","clear","detach","removeScene","listener","setPosition","isVisible","bounds","model","renderOpaque","renderTranslucent","clearEmittedObjects","Resource","handler","pathSolver","fetchUrl","loadend","setMaxListeners","loadData","setLoaded","lateLoad","unload","whenLoaded","timeoutId","once","thenAction","resourceData","wrapS","wrapT","setParameters","magFilter","minFilter","webgl","CLAMP_TO_EDGE","ImageTexture","HTMLImageElement","HTMLVideoElement","HTMLCanvasElement","imageToImageData","originalData","LINEAR_MIPMAP_LINEAR","generateMipmap","WebGLTexture","imagetexture_handler","GenericResource","JASS_MAX_ARRAY_SIZE","PLAYER_NEUTRAL_PASSIVE","PLAYER_NEUTRAL_AGGRESSIVE","PLAYER_COLOR_RED","PLAYER_COLOR_BLUE","PLAYER_COLOR_CYAN","PLAYER_COLOR_PURPLE","PLAYER_COLOR_YELLOW","PLAYER_COLOR_ORANGE","PLAYER_COLOR_GREEN","PLAYER_COLOR_PINK","PLAYER_COLOR_LIGHT_GRAY","PLAYER_COLOR_LIGHT_BLUE","PLAYER_COLOR_AQUA","PLAYER_COLOR_BROWN","RACE_HUMAN","RACE_ORC","RACE_UNDEAD","RACE_NIGHTELF","RACE_DEMON","RACE_OTHER","PLAYER_GAME_RESULT_VICTORY","PLAYER_GAME_RESULT_DEFEAT","PLAYER_GAME_RESULT_TIE","PLAYER_GAME_RESULT_NEUTRAL","ALLIANCE_PASSIVE","ALLIANCE_HELP_REQUEST","ALLIANCE_HELP_RESPONSE","ALLIANCE_SHARED_XP","ALLIANCE_SHARED_SPELLS","ALLIANCE_SHARED_VISION","ALLIANCE_SHARED_CONTROL","ALLIANCE_SHARED_ADVANCED_CONTROL","ALLIANCE_RESCUABLE","ALLIANCE_SHARED_VISION_FORCED","VERSION_REIGN_OF_CHAOS","VERSION_FROZEN_THRONE","ATTACK_TYPE_NORMAL","ATTACK_TYPE_MELEE","ATTACK_TYPE_PIERCE","ATTACK_TYPE_SIEGE","ATTACK_TYPE_MAGIC","ATTACK_TYPE_CHAOS","ATTACK_TYPE_HERO","DAMAGE_TYPE_UNKNOWN","DAMAGE_TYPE_NORMAL","DAMAGE_TYPE_ENHANCED","DAMAGE_TYPE_FIRE","DAMAGE_TYPE_COLD","DAMAGE_TYPE_LIGHTNING","DAMAGE_TYPE_POISON","DAMAGE_TYPE_DISEASE","DAMAGE_TYPE_DIVINE","DAMAGE_TYPE_MAGIC","DAMAGE_TYPE_SONIC","DAMAGE_TYPE_ACID","DAMAGE_TYPE_FORCE","DAMAGE_TYPE_DEATH","DAMAGE_TYPE_MIND","DAMAGE_TYPE_PLANT","DAMAGE_TYPE_DEFENSIVE","DAMAGE_TYPE_DEMOLITION","DAMAGE_TYPE_SLOW_POISON","DAMAGE_TYPE_SPIRIT_LINK","DAMAGE_TYPE_SHADOW_STRIKE","DAMAGE_TYPE_UNIVERSAL","WEAPON_TYPE_WHOKNOWS","WEAPON_TYPE_METAL_LIGHT_CHOP","WEAPON_TYPE_METAL_MEDIUM_CHOP","WEAPON_TYPE_METAL_HEAVY_CHOP","WEAPON_TYPE_METAL_LIGHT_SLICE","WEAPON_TYPE_METAL_MEDIUM_SLICE","WEAPON_TYPE_METAL_HEAVY_SLICE","WEAPON_TYPE_METAL_MEDIUM_BASH","WEAPON_TYPE_METAL_HEAVY_BASH","WEAPON_TYPE_METAL_MEDIUM_STAB","WEAPON_TYPE_METAL_HEAVY_STAB","WEAPON_TYPE_WOOD_LIGHT_SLICE","WEAPON_TYPE_WOOD_MEDIUM_SLICE","WEAPON_TYPE_WOOD_HEAVY_SLICE","WEAPON_TYPE_WOOD_LIGHT_BASH","WEAPON_TYPE_WOOD_MEDIUM_BASH","WEAPON_TYPE_WOOD_HEAVY_BASH","WEAPON_TYPE_WOOD_LIGHT_STAB","WEAPON_TYPE_WOOD_MEDIUM_STAB","WEAPON_TYPE_CLAW_LIGHT_SLICE","WEAPON_TYPE_CLAW_MEDIUM_SLICE","WEAPON_TYPE_CLAW_HEAVY_SLICE","WEAPON_TYPE_AXE_MEDIUM_CHOP","WEAPON_TYPE_ROCK_HEAVY_BASH","PATHING_TYPE_ANY","PATHING_TYPE_WALKABILITY","PATHING_TYPE_FLYABILITY","PATHING_TYPE_BUILDABILITY","PATHING_TYPE_PEONHARVESTPATHING","PATHING_TYPE_BLIGHTPATHING","PATHING_TYPE_FLOATABILITY","PATHING_TYPE_AMPHIBIOUSPATHING","MOUSE_BUTTON_TYPE_LEFT","MOUSE_BUTTON_TYPE_MIDDLE","MOUSE_BUTTON_TYPE_RIGHT","RACE_PREF_HUMAN","RACE_PREF_ORC","RACE_PREF_NIGHTELF","RACE_PREF_UNDEAD","RACE_PREF_DEMON","RACE_PREF_RANDOM","RACE_PREF_USER_SELECTABLE","MAP_CONTROL_USER","MAP_CONTROL_COMPUTER","MAP_CONTROL_RESCUABLE","MAP_CONTROL_NEUTRAL","MAP_CONTROL_CREEP","MAP_CONTROL_NONE","GAME_TYPE_MELEE","GAME_TYPE_FFA","GAME_TYPE_USE_MAP_SETTINGS","GAME_TYPE_BLIZ","GAME_TYPE_ONE_ON_ONE","GAME_TYPE_TWO_TEAM_PLAY","GAME_TYPE_THREE_TEAM_PLAY","GAME_TYPE_FOUR_TEAM_PLAY","MAP_FOG_HIDE_TERRAIN","MAP_FOG_MAP_EXPLORED","MAP_FOG_ALWAYS_VISIBLE","MAP_USE_HANDICAPS","MAP_OBSERVERS","MAP_OBSERVERS_ON_DEATH","MAP_FIXED_COLORS","MAP_LOCK_RESOURCE_TRADING","MAP_RESOURCE_TRADING_ALLIES_ONLY","MAP_LOCK_ALLIANCE_CHANGES","MAP_ALLIANCE_CHANGES_HIDDEN","MAP_CHEATS","MAP_CHEATS_HIDDEN","MAP_LOCK_SPEED","MAP_LOCK_RANDOM_SEED","MAP_SHARED_ADVANCED_CONTROL","MAP_RANDOM_HERO","MAP_RANDOM_RACES","MAP_RELOADED","MAP_PLACEMENT_RANDOM","MAP_PLACEMENT_FIXED","MAP_PLACEMENT_USE_MAP_SETTINGS","MAP_PLACEMENT_TEAMS_TOGETHER","MAP_LOC_PRIO_LOW","MAP_LOC_PRIO_HIGH","MAP_LOC_PRIO_NOT","MAP_DENSITY_NONE","MAP_DENSITY_LIGHT","MAP_DENSITY_MEDIUM","MAP_DENSITY_HEAVY","MAP_DIFFICULTY_EASY","MAP_DIFFICULTY_NORMAL","MAP_DIFFICULTY_HARD","MAP_DIFFICULTY_INSANE","MAP_SPEED_SLOWEST","MAP_SPEED_SLOW","MAP_SPEED_NORMAL","MAP_SPEED_FAST","MAP_SPEED_FASTEST","PLAYER_SLOT_STATE_EMPTY","PLAYER_SLOT_STATE_PLAYING","PLAYER_SLOT_STATE_LEFT","SOUND_VOLUMEGROUP_UNITMOVEMENT","SOUND_VOLUMEGROUP_UNITSOUNDS","SOUND_VOLUMEGROUP_COMBAT","SOUND_VOLUMEGROUP_SPELLS","SOUND_VOLUMEGROUP_UI","SOUND_VOLUMEGROUP_MUSIC","SOUND_VOLUMEGROUP_AMBIENTSOUNDS","SOUND_VOLUMEGROUP_FIRE","GAME_STATE_DIVINE_INTERVENTION","GAME_STATE_DISCONNECTED","GAME_STATE_TIME_OF_DAY","PLAYER_STATE_GAME_RESULT","PLAYER_STATE_RESOURCE_GOLD","PLAYER_STATE_RESOURCE_LUMBER","PLAYER_STATE_RESOURCE_HERO_TOKENS","PLAYER_STATE_RESOURCE_FOOD_CAP","PLAYER_STATE_RESOURCE_FOOD_USED","PLAYER_STATE_FOOD_CAP_CEILING","PLAYER_STATE_GIVES_BOUNTY","PLAYER_STATE_ALLIED_VICTORY","PLAYER_STATE_PLACED","PLAYER_STATE_OBSERVER_ON_DEATH","PLAYER_STATE_OBSERVER","PLAYER_STATE_UNFOLLOWABLE","PLAYER_STATE_GOLD_UPKEEP_RATE","PLAYER_STATE_LUMBER_UPKEEP_RATE","PLAYER_STATE_GOLD_GATHERED","PLAYER_STATE_LUMBER_GATHERED","PLAYER_STATE_NO_CREEP_SLEEP","UNIT_STATE_LIFE","UNIT_STATE_MAX_LIFE","UNIT_STATE_MANA","UNIT_STATE_MAX_MANA","AI_DIFFICULTY_NEWBIE","AI_DIFFICULTY_NORMAL","AI_DIFFICULTY_INSANE","PLAYER_SCORE_UNITS_TRAINED","PLAYER_SCORE_UNITS_KILLED","PLAYER_SCORE_STRUCT_BUILT","PLAYER_SCORE_STRUCT_RAZED","PLAYER_SCORE_TECH_PERCENT","PLAYER_SCORE_FOOD_MAXPROD","PLAYER_SCORE_FOOD_MAXUSED","PLAYER_SCORE_HEROES_KILLED","PLAYER_SCORE_ITEMS_GAINED","PLAYER_SCORE_MERCS_HIRED","PLAYER_SCORE_GOLD_MINED_TOTAL","PLAYER_SCORE_GOLD_MINED_UPKEEP","PLAYER_SCORE_GOLD_LOST_UPKEEP","PLAYER_SCORE_GOLD_LOST_TAX","PLAYER_SCORE_GOLD_GIVEN","PLAYER_SCORE_GOLD_RECEIVED","PLAYER_SCORE_LUMBER_TOTAL","PLAYER_SCORE_LUMBER_LOST_UPKEEP","PLAYER_SCORE_LUMBER_LOST_TAX","PLAYER_SCORE_LUMBER_GIVEN","PLAYER_SCORE_LUMBER_RECEIVED","PLAYER_SCORE_UNIT_TOTAL","PLAYER_SCORE_HERO_TOTAL","PLAYER_SCORE_RESOURCE_TOTAL","PLAYER_SCORE_TOTAL","EVENT_GAME_VICTORY","EVENT_GAME_END_LEVEL","EVENT_GAME_VARIABLE_LIMIT","EVENT_GAME_STATE_LIMIT","EVENT_GAME_TIMER_EXPIRED","EVENT_GAME_ENTER_REGION","EVENT_GAME_LEAVE_REGION","EVENT_GAME_TRACKABLE_HIT","EVENT_GAME_TRACKABLE_TRACK","EVENT_GAME_SHOW_SKILL","EVENT_GAME_BUILD_SUBMENU","EVENT_PLAYER_STATE_LIMIT","EVENT_PLAYER_ALLIANCE_CHANGED","EVENT_PLAYER_DEFEAT","EVENT_PLAYER_VICTORY","EVENT_PLAYER_LEAVE","EVENT_PLAYER_CHAT","EVENT_PLAYER_END_CINEMATIC","EVENT_PLAYER_UNIT_ATTACKED","EVENT_PLAYER_UNIT_RESCUED","EVENT_PLAYER_UNIT_DEATH","EVENT_PLAYER_UNIT_DECAY","EVENT_PLAYER_UNIT_DETECTED","EVENT_PLAYER_UNIT_HIDDEN","EVENT_PLAYER_UNIT_SELECTED","EVENT_PLAYER_UNIT_DESELECTED","EVENT_PLAYER_UNIT_CONSTRUCT_START","EVENT_PLAYER_UNIT_CONSTRUCT_CANCEL","EVENT_PLAYER_UNIT_CONSTRUCT_FINISH","EVENT_PLAYER_UNIT_UPGRADE_START","EVENT_PLAYER_UNIT_UPGRADE_CANCEL","EVENT_PLAYER_UNIT_UPGRADE_FINISH","EVENT_PLAYER_UNIT_TRAIN_START","EVENT_PLAYER_UNIT_TRAIN_CANCEL","EVENT_PLAYER_UNIT_TRAIN_FINISH","EVENT_PLAYER_UNIT_RESEARCH_START","EVENT_PLAYER_UNIT_RESEARCH_CANCEL","EVENT_PLAYER_UNIT_RESEARCH_FINISH","EVENT_PLAYER_UNIT_ISSUED_ORDER","EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER","EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER","EVENT_PLAYER_UNIT_ISSUED_UNIT_ORDER","EVENT_PLAYER_HERO_LEVEL","EVENT_PLAYER_HERO_SKILL","EVENT_PLAYER_HERO_REVIVABLE","EVENT_PLAYER_HERO_REVIVE_START","EVENT_PLAYER_HERO_REVIVE_CANCEL","EVENT_PLAYER_HERO_REVIVE_FINISH","EVENT_PLAYER_UNIT_SUMMON","EVENT_PLAYER_UNIT_DROP_ITEM","EVENT_PLAYER_UNIT_PICKUP_ITEM","EVENT_PLAYER_UNIT_USE_ITEM","EVENT_PLAYER_UNIT_LOADED","EVENT_UNIT_DAMAGED","EVENT_UNIT_DEATH","EVENT_UNIT_DECAY","EVENT_UNIT_DETECTED","EVENT_UNIT_HIDDEN","EVENT_UNIT_SELECTED","EVENT_UNIT_DESELECTED","EVENT_UNIT_STATE_LIMIT","EVENT_UNIT_ACQUIRED_TARGET","EVENT_UNIT_TARGET_IN_RANGE","EVENT_UNIT_ATTACKED","EVENT_UNIT_RESCUED","EVENT_UNIT_CONSTRUCT_CANCEL","EVENT_UNIT_CONSTRUCT_FINISH","EVENT_UNIT_UPGRADE_START","EVENT_UNIT_UPGRADE_CANCEL","EVENT_UNIT_UPGRADE_FINISH","EVENT_UNIT_TRAIN_START","EVENT_UNIT_TRAIN_CANCEL","EVENT_UNIT_TRAIN_FINISH","EVENT_UNIT_RESEARCH_START","EVENT_UNIT_RESEARCH_CANCEL","EVENT_UNIT_RESEARCH_FINISH","EVENT_UNIT_ISSUED_ORDER","EVENT_UNIT_ISSUED_POINT_ORDER","EVENT_UNIT_ISSUED_TARGET_ORDER","EVENT_UNIT_HERO_LEVEL","EVENT_UNIT_HERO_SKILL","EVENT_UNIT_HERO_REVIVABLE","EVENT_UNIT_HERO_REVIVE_START","EVENT_UNIT_HERO_REVIVE_CANCEL","EVENT_UNIT_HERO_REVIVE_FINISH","EVENT_UNIT_SUMMON","EVENT_UNIT_DROP_ITEM","EVENT_UNIT_PICKUP_ITEM","EVENT_UNIT_USE_ITEM","EVENT_UNIT_LOADED","EVENT_WIDGET_DEATH","EVENT_DIALOG_BUTTON_CLICK","EVENT_DIALOG_CLICK","EVENT_GAME_LOADED","EVENT_GAME_TOURNAMENT_FINISH_SOON","EVENT_GAME_TOURNAMENT_FINISH_NOW","EVENT_GAME_SAVE","EVENT_PLAYER_ARROW_LEFT_DOWN","EVENT_PLAYER_ARROW_LEFT_UP","EVENT_PLAYER_ARROW_RIGHT_DOWN","EVENT_PLAYER_ARROW_RIGHT_UP","EVENT_PLAYER_ARROW_DOWN_DOWN","EVENT_PLAYER_ARROW_DOWN_UP","EVENT_PLAYER_ARROW_UP_DOWN","EVENT_PLAYER_ARROW_UP_UP","EVENT_PLAYER_UNIT_SELL","EVENT_PLAYER_UNIT_CHANGE_OWNER","EVENT_PLAYER_UNIT_SELL_ITEM","EVENT_PLAYER_UNIT_SPELL_CHANNEL","EVENT_PLAYER_UNIT_SPELL_CAST","EVENT_PLAYER_UNIT_SPELL_EFFECT","EVENT_PLAYER_UNIT_SPELL_FINISH","EVENT_PLAYER_UNIT_SPELL_ENDCAST","EVENT_PLAYER_UNIT_PAWN_ITEM","EVENT_UNIT_SELL","EVENT_UNIT_CHANGE_OWNER","EVENT_UNIT_SELL_ITEM","EVENT_UNIT_SPELL_CHANNEL","EVENT_UNIT_SPELL_CAST","EVENT_UNIT_SPELL_EFFECT","EVENT_UNIT_SPELL_FINISH","EVENT_UNIT_SPELL_ENDCAST","EVENT_UNIT_PAWN_ITEM","LESS_THAN","LESS_THAN_OR_EQUAL","EQUAL","GREATER_THAN_OR_EQUAL","GREATER_THAN","NOT_EQUAL","UNIT_TYPE_HERO","UNIT_TYPE_DEAD","UNIT_TYPE_STRUCTURE","UNIT_TYPE_FLYING","UNIT_TYPE_GROUND","UNIT_TYPE_ATTACKS_FLYING","UNIT_TYPE_ATTACKS_GROUND","UNIT_TYPE_MELEE_ATTACKER","UNIT_TYPE_RANGED_ATTACKER","UNIT_TYPE_GIANT","UNIT_TYPE_SUMMONED","UNIT_TYPE_STUNNED","UNIT_TYPE_PLAGUED","UNIT_TYPE_SNARED","UNIT_TYPE_UNDEAD","UNIT_TYPE_MECHANICAL","UNIT_TYPE_PEON","UNIT_TYPE_SAPPER","UNIT_TYPE_TOWNHALL","UNIT_TYPE_ANCIENT","UNIT_TYPE_TAUREN","UNIT_TYPE_POISONED","UNIT_TYPE_POLYMORPHED","UNIT_TYPE_SLEEPING","UNIT_TYPE_RESISTANT","UNIT_TYPE_ETHEREAL","UNIT_TYPE_MAGIC_IMMUNE","ITEM_TYPE_PERMANENT","ITEM_TYPE_CHARGED","ITEM_TYPE_POWERUP","ITEM_TYPE_ARTIFACT","ITEM_TYPE_PURCHASABLE","ITEM_TYPE_CAMPAIGN","ITEM_TYPE_MISCELLANEOUS","ITEM_TYPE_UNKNOWN","ITEM_TYPE_ANY","ITEM_TYPE_TOME","CAMERA_FIELD_TARGET_DISTANCE","CAMERA_FIELD_FARZ","CAMERA_FIELD_ANGLE_OF_ATTACK","CAMERA_FIELD_FIELD_OF_VIEW","CAMERA_FIELD_ROLL","CAMERA_FIELD_ROTATION","CAMERA_FIELD_ZOFFSET","BLEND_MODE_NONE","BLEND_MODE_DONT_CARE","BLEND_MODE_KEYALPHA","BLEND_MODE_BLEND","BLEND_MODE_ADDITIVE","BLEND_MODE_MODULATE","BLEND_MODE_MODULATE_2X","RARITY_FREQUENT","RARITY_RARE","TEXMAP_FLAG_NONE","TEXMAP_FLAG_WRAP_U","TEXMAP_FLAG_WRAP_V","TEXMAP_FLAG_WRAP_UV","FOG_OF_WAR_MASKED","FOG_OF_WAR_FOGGED","FOG_OF_WAR_VISIBLE","CAMERA_MARGIN_LEFT","CAMERA_MARGIN_RIGHT","CAMERA_MARGIN_TOP","CAMERA_MARGIN_BOTTOM","EFFECT_TYPE_EFFECT","EFFECT_TYPE_TARGET","EFFECT_TYPE_CASTER","EFFECT_TYPE_SPECIAL","EFFECT_TYPE_AREA_EFFECT","EFFECT_TYPE_MISSILE","EFFECT_TYPE_LIGHTNING","SOUND_TYPE_EFFECT","SOUND_TYPE_EFFECT_LOOPED","gameTypes","prop","Reflect","allowSetProp","defineProperty","writable","enumerable","createProxied","ctor","Proxy","ArrayList","transform","getAt","factory","put","contains","includes","any","timer","handle","periodic","timeout","timerExpire","callT","beginT","resumeDelay","timeoutSeconds","handlerFunc","performance","now","_this$handlerFunc","execute","listenExpire","destroy","getElapsed","pause","elapsed","timers","timerListen","timerExpireEvent","evaluate","stateRef","logcall","gameStateEvents","gameEvents","unitEvents","playerUnitEvents","timerExpireEvents","VariableEvents","actions","slotState","TechResearched","TechMaxAllowed","AlliancePlayers","Structures","TypedUnits","Units","unitEvent","whichTrigger","whichUnit","whichUnitEvent","playerUnitEvent","whichPlayer","whichPlayerUnitEvent","eventFilter","whichState","opcode","limitval","propWatcher","listeners","watchTarget","reciver","whichPropName","asEventAgent","listenEvent","whichListenTarget","eventListeners","jassNativeFunctions","app","startLocations","gameState","compute","getNumber","logCalls","GameTypeSupported","GameTypeSelected","GamePlacement","GameSpeed","GameDifficulty","ResourceDensity","CreatureDensity","NbShops","fogMaskEnabled","midiSound","gameUI","frameDefs","loadedFdfs","DefineStartLocation","whichStartLoc","startLoc","DefineStartLocationLoc","whichLocation","SetStartLocPrioCount","prioSlotCount","priority","SetStartLocPrio","prioSlotIndex","otherStartLocIndex","GetStartLocPrioSlot","GetStartLocPrio","SetGameTypeSupported","whichGameType","SetMapFlag","whichMapFlag","SetGamePlacement","whichPlacementType","SetGameSpeed","whichspeed","SetGameDifficulty","whichdifficulty","GetTeams","GetPlayers","IsGameTypeSupported","GetGameTypeSelected","IsMapFlagSet","GetGamePlacement","GetGameSpeed","GetGameDifficulty","GetResourceDensity","GetCreatureDensity","GetStartLocationX","whichStartLocation","GetStartLocationY","GetStartLocationLoc","SetPlayerTeam","whichTeam","team","SetPlayerStartLocation","startLocIndex","ForcePlayerStartLocation","SetPlayerColor","SetPlayerAlliance","sourcePlayer","otherPlayer","whichAllianceSetting","SetPlayerTaxRate","whichResource","rate","SetPlayerController","controlType","contoller","SetPlayerName","GetPlayerTeam","GetPlayerStartLocation","GetPlayerColor","GetPlayerSelectable","Selectable","GetPlayerController","GetPlayerSlotState","DestroyTimer","whichTimer","TimerStart","TimerGetElapsed","TimerGetTimeout","PauseTimer","ResumeTimer","CreateForce","DestroyForce","whichForce","ForceAddPlayer","ForceRemovePlayer","ForceClear","ForceEnumPlayers","ForceEnumPlayersCounted","countLimit","ForceEnumAllies","ForceEnumEnemies","ForForce","Rect","minx","miny","maxx","maxy","CreateTrigger","DestroyTrigger","distroy","ResetTrigger","EnableTrigger","enabled","DisableTrigger","IsTriggerEnabled","GetFilterUnit","FilterUnitIterator","GetEnumUnit","EnumUnitIterator","GetFilterItem","FilterItemIterator","GetEnumItem","EnumItemIterator","GetFilterPlayer","FilterPlayerIterator","GetEnumPlayer","EnumPlayerIterator","And","operandA","operandB","Or","Not","operand","Filter","DestroyFilter","DestroyBoolExpr","TriggerRegisterVariableEvent","varName","runtime","TriggerRegisterTimerEvent","TimerEvents","TriggerRegisterTimerExpireEvent","TriggerRegisterGameStateEvent","TriggerRegisterDialogButtonEvent","whichButton","dialog","TriggerRegisterGameEvent","whichGameEvent","TriggerRegisterPlayerEvent","whichPlayerEvent","TriggerRegisterPlayerUnitEvent","TriggerRegisterUnitEvent","whichEvent","TriggerAddAction","actionFunc","TriggerRemoveAction","whichAction","TriggerClearActions","TriggerEvaluate","TriggerExecute","unitid","createUnit","creationArgs","SetUnitState","whichUnitState","newVal","SetUnitAcquireRange","newAcquireRange","SetUnitCreepGuard","creepGuard","GetUnitAcquireRange","GetUnitTurnSpeed","GetUnitPropWindow","GetUnitFlyHeight","GetUnitDefaultAcquireRange","GetUnitDefaultTurnSpeed","GetUnitDefaultPropWindow","GetUnitDefaultFlyHeight","SetUnitOwner","changeColor","SetUnitColor","whichColor","SetUnitScale","scaleX","scaleY","scaleZ","SetUnitTimeScale","timeScale","SetUnitBlendTime","SetUnitVertexColor","red","green","blue","QueueUnitAnimation","whichAnimation","SetUnitAnimation","SetUnitAnimationByIndex","SetUnitAnimationWithRarity","AddUnitAnimationProperties","animProperties","SetUnitLookAt","whichBone","lookAtTarget","offsetX","offsetY","offsetZ","ResetUnitLookAt","SetResourceAmount","amount","AddItemToAllStock","itemId","currentStock","stockMax","AddItemToStock","AddUnitToAllStock","unitId","AddUnitToStock","RemoveItemFromAllStock","RemoveItemFromStock","RemoveUnitFromAllStock","RemoveUnitFromStock","SetAllItemTypeSlots","slots","SetAllUnitTypeSlots","SetItemTypeSlots","SetUnitTypeSlots","GetUnitUserData","SetUnitUserData","GetPlayerUnitCount","includeIncomplete","GetPlayerTypedUnitCount","unitName","includeUpgrades","GetPlayerStructureCount","GetPlayerState","whichPlayerState","GetPlayerScore","whichPlayerScore","GetPlayerAlliance","GetPlayerHandicap","GetPlayerHandicapXP","SetPlayerHandicap","handicap","SetPlayerHandicapXP","SetPlayerTechMaxAllowed","techid","maximum","GetPlayerTechMaxAllowed","AddPlayerTechResearched","SetPlayerTechResearched","setToLevel","GetPlayerTechResearched","specificonly","GetPlayerTechCount","SetPlayerState","IsFogMaskEnabled","IsFogEnabled","fogEnabled","VersionGet","SetFloatGameState","whichFloatGameState","GetFloatGameState","SetIntegerGameState","whichIntegerGameState","GetIntegerGameState","SetTerrainFogEx","zstart","zend","density","SetDayNightModels","terrainDNCFile","unitDNCFile","CreateTimerDialog","alert","DestroyTimerDialog","whichDialog","TimerDialogSetTitle","TimerDialogSetTitleColor","titleColor","TimerDialogSetTimeColor","timeColor","TimerDialogSetSpeed","speedMultFactor","TimerDialogDisplay","showTimerDialog","IsTimerDialogDisplayed","displayed","TimerDialogSetRealTimeRemaining","timeRemaining","SetCameraBounds","x1","y1","x2","y2","x3","y3","x4","y4","GetCameraBoundMinX","GetCameraBoundMinY","GetCameraBoundMaxX","GetCameraBoundMaxY","NewSoundEnvironment","environmentName","CreateSound","fileName","looping","is3D","stopwhenoutofrange","eaxSetting","CreateSoundFromLabel","soundLabel","CreateMIDISound","SetMapMusic","musicName","AddWeatherEffect","where","effectID","EnableWeatherEffect","whichEffect","Preloader","GetPlayerId","SetPlayerRaceSelectable","raceSelectable","SetPlayerRacePreference","racePerf","gamePlacement","GetCameraMargin","SetTeams","teams","SetPlayers","CreateTimer","CreateGroup","SetMapName","_this$app$map","_this$app$map$wts","mapName","SetMapDescription","_this$app$map2","_this$app$map2$wts","mapDescription","GetPlayerNeutralPassive","GetPlayerNeutralAggressive","GetBJPlayerNeutralVictim","GetBJPlayerNeutralExtra","GetBJMaxPlayers","GetBJMaxPlayerSlots","FRAMEPOINT_TOPLEFT","framepointtypeId","handleId","FRAMEPOINT_TOP","FRAMEPOINT_TOPRIGHT","FRAMEPOINT_LEFT","FRAMEPOINT_CENTER","FRAMEPOINT_RIGHT","FRAMEPOINT_BOTTOMLEFT","FRAMEPOINT_BOTTOM","FRAMEPOINT_BOTTOMRIGHT","FRAMEEVENT_CONTROL_CLICK","frameeventtypeId","FRAMEEVENT_MOUSE_ENTER","FRAMEEVENT_MOUSE_LEAVE","FRAMEEVENT_MOUSE_UP","FRAMEEVENT_MOUSE_DOWN","FRAMEEVENT_MOUSE_WHEEL","FRAMEEVENT_CHECKBOX_CHECKED","FRAMEEVENT_CHECKBOX_UNCHECKED","FRAMEEVENT_EDITBOX_TEXT_CHANGED","FRAMEEVENT_MOUSE_DOUBLECLICK","FRAMEEVENT_SLIDER_VALUE_CHANGED","FRAMEEVENT_EDITBOX_ENTER","frameEventMap","frameMap","nodeMap","positionDependencies","WeakMap","reversePositionDependencies","markDeps","side","relative","deps","reverseDeps","resolveX","relativeSide","getSize","xAnchor","getXAnchor","xOffset","getFrameScale","resolveY","yAnchor","getYAnchor","yOffset","widthFrom","oldOpacity","opacity","oldVisibility","visibility","px2wc","clientWidth","heightFrom","clientHeight","implicitWidth","implicitHeight","bot","relativeHeight","relativeTop","relativeWidth","relativeLeft","getGlobalScale","innerWidth","wc2px","px","wcy2px","innerHeight","updateSizeAndPosition","updated","getAnchor","wcx2px","Adapter","createNode","selectAll","markOrigin","setTooltip","addFrameListener","addListener","urlRewriter","hFrame","hParent","div","def","SetAllPoints","onmouseover","border","ht","setInterval","span","createTipSpan","backgroundColor","innerText","onmouseleave","dataset","parentNode","from","querySelectorAll","HTMLElement","origin","classList","originframetypeId","frameLib","tooltip","BlzFrameSetVisible","html","setHTML","fontSize","visibilityChange","originalLeft","originalTop","event","stringEvent","posRelatativeToWindow","posRelatativeToParent","parseString","warn","parseNumber","FrameLib","adapter","createFrame","BlzCreateFrame","BlzCreateSimpleFrame","BlzCreateFrameByType","BlzDestroyFrame","BlzFrameSetPoint","BlzFrameSetAbsPoint","BlzFrameClearAllPoints","BlzFrameSetAllPoints","BlzFrameIsVisible","BlzGetFrameByName","BlzFrameGetName","BlzFrameClick","BlzFrameSetText","BlzFrameGetText","BlzFrameAddText","BlzFrameSetTextSizeLimit","BlzFrameGetTextSizeLimit","BlzFrameSetTextColor","BlzFrameSetFocus","BlzFrameSetModel","BlzFrameSetEnable","BlzFrameGetEnable","BlzFrameSetAlpha","BlzFrameGetAlpha","BlzFrameSetSpriteAnimate","BlzFrameSetTexture","BlzFrameSetScale","BlzFrameSetTooltip","BlzFrameCageMouse","BlzFrameSetValue","BlzFrameGetValue","BlzFrameSetMinMaxValue","BlzFrameSetStepSize","BlzFrameSetSize","BlzFrameSetVertexColor","BlzFrameSetLevel","BlzFrameSetParent","BlzFrameGetParent","BlzFrameGetHeight","BlzFrameGetWidth","BlzFrameSetFont","BlzFrameSetTextAlignment","BlzTriggerRegisterFrameEvent","BlzGetTriggerFrame","BlzGetTriggerFrameEvent","BlzGetTriggerFrameValue","BlzGetTriggerFrameText","BlzFrameGetChildrenCount","BlzFrameGetChild","BlzGetOriginFrame","BlzEnableUIAutoPosition","BlzHideOriginFrames","BlzConvertColor","idNext","frameType","_def$inherits","fh","newFrame","framehandleId","setAllPoints","inherits","decorateFileNames","functionalChildren","property","_inherits$properties","styles","controlStyles","_inherits$children","owner","typeName","relativePoint","pointMap","leftPoints","rightPoints","topPoints","bottomPoints","_frame$text","modelFile","cameraIndex","_frame$alpha","primaryProp","texFile","blend","minValue","maxValue","stepSize","vert","horz","eventId","agentId","events","initUI","tokenizeFdf","contents","testAddAndAdvance","regexp","lastIndex","parseSingleToken","next","parseProperty","eat","parseFrame","opening","parseFrameOpening","inheritsChildren","parseFrameBody","parseInclude","parseStrings","parseFdf","frames","toc","fdfHandler","tocDocument","fromEntries","fdf","loadFdf","install","addHandler","loadingFdfs","fdfs","resolveToc","JassVisitor_JassParser","BasicJassVisitor","getBaseCstVisitorConstructorWithDefaults","NL","NL2","padleft","minus","jass2js_stack","jassAstNode","pad","autoID","$symbol","_jass2js","jass2js","convertToJs","checkJs","convertToTs","jass2ts","lock","stack","locateInStack","jassNativeFunctionDecl","paramVars","resolvingVars","resolvingFunctions","jass2js_debug","functionDecls","native","jassTypeDef","extendFrom","program","globalVars","jassfile","natives","globals","fnDecls","requiredVars","requiredFunctions","callstatement","jassSetAssign","jassFunctionDecl","jassElseIfStatement","predicate","jassBracketed","statements","jassElseStatement","jassIfStatement","jassOp","jassValue","jassParamList","jassArgumentList","expressions","jassReturn","nothing","jassNothing","jassParamDecl","jassNull","jassRefExpression","jassUnaryExpression","jassBinaryExpression","jassArrayAccess","jassVarAccess","fnScoped","globalVarDecls","loopstatement","exithenstatement","jassVarDecl","scope","isArrayType","padEnd","jassType","jassGlobalVar","declaration","jassFunctionCall","bg","inVarDecl","enumName","enums","isPromisedFunction","vardecls","endsWith","jassIdentifier","rt","resolvingTypes","usages","JassVisitor","api","validateVisitor","addResolvingSymbol","resovingSymbols","visitImage","tktype","constant","returnType","stm","createJassExpression","expr","innerExpr","localvardeclaration","functionName","fa","inputstr","option","parsed","debugParser","JassRuntime","fileSymbols","unresolved","constants","scripts","converted","promised","jassCode","parseTarget","replaceAll","jsCode","blobUrl","script","head","globalThis","loadStart","enum","Function","directConvert","triggerParams","checkNative","resolveFunctions","resolveVars","vm","config","main","resources","promises","resource","ModelViewer","appendParam","resourcesMap","frameTime","shaderMap","handlers","scenes","resourcesLoading","on","noCulling","noUpdating","textureAtlases","batchSize","renderedScenes","enableAudio","imageTextureHandler","addScene","findHandler","extention","serverFetch","originalSrc","handlerAndDataType","registerEvents","exists","loadGeneric","originalPath","appyCallback","loadShader","vertex","fragment","loadTextureAtlas","textureAtlas","atlasData","texturesPerRow","ceil","sqrt","floor","createTextureAtlas","getTextureAtlas","atlas","whenAllLoaded","toBlob","updateAndRender","startFrame","depthMask","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","_this","ModelView","sceneData","getShallowCopy","applyShallowCopy","equals","addSceneData","createSceneData","baseIndex","buckets","usedBuckets","neededBuckets","oldScene","instancesCount","Bucket","TexturedModelView","dst","dstTextures","views","Instance","View","viewChanged","shallowView","TexturedModel","GeometryModel","geometry","material","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","uvBuffer","uvs","faceBuffer","ELEMENT_ARRAY_BUFFER","edgeBuffer","edges","boundingRadius","vertexArray","uvArray","faceArray","edgeArray","bytesPerElement","BYTES_PER_ELEMENT","faceIndexType","UNSIGNED_SHORT","UNSIGNED_INT","edgeIndexType","twoSided","noDepthTest","noDepthSet","uvScale","uvOffset","vertexColor","edgeColor","renderMode","isBGR","isBlended","translucent","opaque","bucket","shader","uniformMatrix4fv","u_mvp","TEXTURE15","boneTexture","uniform1i","u_boneMap","uniform1f","u_vectorSize","vectorSize","u_rowSize","rowSize","instanceIdAttrib","a_InstanceID","instanceIdBuffer","vertexAttribPointer","a_position","FLOAT","a_uv","disable","CULL_FACE","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","u_texture","colorAttrib","a_color","hasTexture","u_hasTexture","u_isEdge","uniform2fv","u_uvScale","u_uvOffset","u_isBGR","u_alphaMod","vertexColorBuffer","TRIANGLES","edgeColorBuffer","LINES","renderBuckets","currentValue","baseInstance","GeometryBucket","boneArrayInstanceSize","numberOfBones","boneArray","boneTextureWidth","boneTextureHeight","NEAREST","RGBA32F","vertexColorArray","DYNAMIC_DRAW","edgeColorArray","instanceOffset","culled","texSubImage2D","bufferSubData","ModelInstance","paused","shown","hidden","updateTimers","updateAnimations","setScene","TexturedModelInstance","setTexture","GeometryModelInstance","setVertexColor","setEdgeColor","geo_shaders","vs","ps","geo_handler","batchCount","geo","templatedSdSequence","interpolator","sd","keyframes","isGlobalSequence","defval","keyframe","keyframeCount","firstValue","getValue","getKeyframe","minVal","maxVal","forcedInterpMap","defVals","templatedSd","SequenceType","forcedInterp","sequence","isVariant","getValues","ScalarSd","factorTimes2","hermite","invt","inverseFactorTimesTwo","bezier","Vector3Sd","Vector4Sd","slerp","sqlerp","createTypedSd","ClassObject","getUintValue","defaultValue","getFloatValue","getVector3Value","getVector4Value","getTranslation","getScale","isTranslationVariant","isRotationVariant","isScaleVariant","unique","reverse","emitterFilterMode","ONE","ZERO","SRC_COLOR","DEST_COLOR","layerId","unshaded","sphereEnvironmentMap","unfogged","depthMaskValue","alphaTestValue","blendSrc","blendDst","blended","DST_COLOR","layerFilterMode","uvDivisor","textureAnimation","variants","translation","hasSlotAnim","hasTranslationAnim","hasRotationAnim","hasScaleAnim","isAlphaVariant","isTextureIdVariant","textureIds","u_alphaTest","getAlpha","getTextureId","geosetAnimation","getColor","isColorVariant","ShallowGeoset","offsets","uvSetSize","elements","a_normal","a_bones","a_boneNumber","geoset","textureCoordinateSets","uvsetSize","boneIndices","boneNumbers","slices","boneCount","locationArray","normalArray","uvsArray","boneIndexArray","boneNumberArray","hasAnim","Batch","replaceableids","11","21","31","32","33","34","35","36","37","cameraAnchored","bone","light","eventObject","attachment","particleEmitter","collisionShape","ribbonEmitter","emitterUsesMdlOrUnshaded","emitterUsesTgaOrSortPrimitivesFarZ","lineEmitter","modelSpace","xYQuad","anyBillboarding","generic","getVisibility","getAttenuationStart","getAttenuationEnd","getIntensity","getAmbientIntensity","getAmbientColor","internalModel","emitter","internalResource","getSpeed","getLatitude","getLongitude","getLifeSpan","getGravity","getEmissionRate","dimensions","teamColored","replaceableIds","tail","cellWidth","cellHeight","colors","scaling","intervals","getWidth","getLength","getVariation","getHeightBelow","getHeightAbove","getTextureSlot","zero","getPositionTranslation","getTargetTranslation","MappedData","uint8Array","loadText","mapped","getRow","getProperty","setRow","OfflineAudioContext","mappedDataCallback","decodedDataCallback","decodeAudioData","decodedBuffers","vec2","tables","StartR","StartG","StartB","StartA","MiddleR","MiddleG","MiddleB","MiddleA","EndR","EndG","EndB","EndA","Scale","Columns","Rows","UVLifespanStart","UVLifespanEnd","LifespanRepeat","UVDecayStart","UVDecayEnd","DecayRepeat","intervalTimes","Lifespan","Decay","lifespan","BirthTime","PauseTime","BlendMode","SoundLabel","DistanceCutoff","MaxDistance","MinDistance","Pitch","pitchVariance","PitchVariance","Volume","FileNames","DirectoryBase","getValueAtTime","hasLayerAnims","hasGeosetAnims","batches","opaqueBatches","translucentBatches","genericObjects","sortedGenericObjects","hierarchy","replaceables","Parser","minz","maxz","dx","dy","dz","extentToSphere","usingTeamTextures","textureRes","loadTeamTextures","vMaterial","vLayer","batchId","vGeoset","batch","setupGeosets","helper","particleEmitter2","setupHierarchy","setupVariants","teamColors","teamGlows","shallowGeosets","typedArrays","totalArrayOffset","elementTypedArrays","totalElementOffset","verticesOffset","normalsOffset","uvSetsOffset","boneIndicesOffset","boneNumbersOffset","__webglArrayBuffer","__webglElementBuffer","teamColor","a_teamColor","a_vertexColor","colorBuffer","instanceId","unbind","a_geosetColor","a_layerAlpha","uvTransRot","uvScaleSprite","renderBatch","shallowGeoset","replaceable","isTeamColor","u_isTeamColor","u_hasSlotAnim","u_hasTranslationAnim","u_hasRotationAnim","u_hasScaleAnim","uniform2f","geosetColor","a_uvTransRot","a_uvScaleSprite","layerAlpha","geosetColorsBuffer","layersBuffer","layerAlphasData","renderBatches","eventObjectEmitters","u_isRibbonEmitter","SharedEmitter","modelObject","alive","emitObject","emitterView","createObject","health","updateData","emission","currentEmission","velocityHeap","latitudeHeap","lifeSpanHeap","gravityHeap","speedHeap","Particle","internalInstance","velocity","nodes","rotateY","setSequence","frameTimeS","SharedGeometryEmitter","bufferSize","sizeNeeded","elementsPerEmit","lta","lba","rta","rba","rgb","u_dimensions","a_uva_rgb","drawArrays","colorHeap","widthHeap","lengthHeap","variationHeap","vec3Heap","Particle2","nodeScale","isHead","dt","scaleAndAdd","factor","firstColor","lifeFactor","spriteCount","scalex","scaley","scalez","py","pz","vx","vy","pv1","pv2","pv3","pv4","offsetx","offsety","offsetz","startx","starty","startz","endx","endy","endz","normal","cross","normalX","normalY","normalZ","belowHeap","aboveHeap","alphaHeap","slotHeap","Ribbon","currentRibbon","ribbonCount","lastEmit","lastVertices","animatedAlpha","animatedSlot","chainLengthFactor","locationInChain","EventObjectSpn","EventObjectSpnEmitter","EventObjectSpl","emitterScale","first","second","time","EventObjectSplEmitter","EventObjectUbr","third","EventObjectUbrEmitter","EventObjectSndEmitter","panner","createPanner","source","createBufferSource","refDistance","connect","destination","colorData","geosetColorsData","layersData","uvTransformsData","geosetCount","layerCount","worldMatrices","geosetColors","layerAlphas","uvOffsets","uvScales","uvRots","particleEmitterViews","particleEmitter2Views","ribbonEmitterViews","eventObjectEmitterViews","instanceOffset4","instanceOffset5","instanceOffset7","geosetIndex","geosetIndex4","layerIndex","layerIndex4","uvBase","MdxNode","visibilityHeap","AttachmentInstance","setSequenceLoopMode","dontInheritScale","emissionRateHeap","ParticleEmitterView","allowParticleSpawn","ParticleEmitter2View","lastEmissionKey","RibbonEmitterView","EventObjectEmitterView","lastTrack","translationHeap","scaleHeap","textureIdHeap","sortedNodes","sequenceLoopMode","forced","sharedNodeData","Node","count3","count4","count16","pivots","localLocations","localRotations","localScales","worldLocations","worldRotations","worldScales","inverseWorldLocations","invereseWorldRotations","inverseWorldScales","localMatrices","i3","i33","i4","i44","i16","i1616","createSkeletalNodes","nodeIndex","initNode","attachmentInstance","genericObject","gen","resetEventEmitters","updateNodes","objectVisible","nodeVisible","wasReallyDirty","updateBatches","i2","setTeamColor","getAttachment","eventEmitterView","mdx_shaders","vsParticles","fsParticles","mdx_handler","imagetexture","standardShader","particleShader","particles","mdx","w3x_shaders","vsGround","fsGround","vsWater","fsWater","vsCliffs","fsCliffs","vsUberSplat","fsUberSplat","vsSimpleModel","fsSimpleModel","cliffVariations","AAAB","AAAC","AABA","AABB","AABC","AACA","AACB","AACC","ABAA","ABAB","ABAC","ABBA","ABBB","ABBC","ABCA","ABCB","ABCC","ACAA","ACAB","ACAC","ACBA","ACBB","ACBC","ACCA","ACCB","ACCC","BAAA","BAAB","BAAC","BABA","BABB","BABC","BACA","BACB","BACC","BBAA","BBAB","BBAC","BBBA","BBCA","BCAA","BCAB","BCAC","BCBA","BCCA","CAAA","CAAB","CAAC","CABA","CABB","CABC","CACA","CACB","CACC","CBAA","CBAB","CBAC","CBBA","CBCA","CCAA","CCAB","CCAC","CCBA","CCCA","cityCliffVariations","getCliffVariation","dir","TerrainModel","locations","loader","MdxParser","uvs2","uvsOffset","uvs2Offset","totalLength","tex","texturesOffset","locationAndTextureBuffer","TEXTURE1","disabledMips","a_instancePosition","a_instanceTexture","a_uv1","a_uv2","SplatModel","x0","y0","zoffs","ix0","ix1","iy0","iy1","newVerts","step","addBatch","iy","ix","i0","uniform4fv","u_color","drawElements","sequenceSorter","sequenceMatch","selectSequence","original","animProps","filtered","filterSequences","findIndex","sequencesLeft","standSequence","standOnRepeat","normalHeap1","normalHeap2","handlers_w3x","MapViewer","wc3PathSolver","mapData","geoHandler","mdxHandler","tocHandler","groundShader","waterShader","cliffShader","simpleModelShader","uberSplatShader","waterIndex","waterIncreasePerFrame","anyReady","terrainCliffsAndWaterLoaded","terrainData","cliffTypesData","waterData","terrainReady","cliffsReady","shadowsReady","terrain","cliffTypes","terrainObjects","doodadsAndDestructiblesLoaded","doodadsData","doodadMetaData","destructableMetaData","doodadsReady","uberSplats","uberSplatsReady","unitsAndItemsLoaded","unitsData","unitMetaData","uberSplatData","unitsReady","shadowMap","R8","renderGround","heightMap","cliffHeightMap","instanceBuffer","instanceCount","textureBuffer","variationBuffer","heightMapSize","terrainRenderData","tilesetTextures","instanceAttrib","positionAttrib","texturesAttrib","a_textures","variationsAttrib","a_variations","u_offset","u_size","u_pixel","u_heightMap","u_tilesets","u_shadowMap","u_heightMap0","u_tilesetHeight","u_tilesetCount","tilesetsTexture","TEXTURE2","TEXTURE3","renderWater","mapBounds","waterHeightMap","waterBuffer","isWaterAttrib","a_isWater","u_waterHeightMap","u_waterMap","u_offsetHeight","waterHeightOffset","u_tileIndex","u_maxDeepColor","maxDeepColor","u_minDeepColor","minDeepColor","u_maxShallowColor","maxShallowColor","uniform4f","u_mapBounds","waterTexture","renderCliffs","u_centerOffset","u_texture1","u_texture2","cliffTextures","cliff","cliffModels","renderUberSplats","blendEquation","FUNC_ADD","splat","uberSplatModels","waterTextures","mapMpq","mapFlags","mapPathSolver","calculateRamps","doodadsLoaded","unitsLoaded","loadTerrainCliffsAndWater","shadowTextures","loadDoodadsAndDestructibles","loadUnitsAndItems","loadGameUI","numVar","numvar","fileVar","colorr","colorg","colorb","shadow","addShadow","mpqFile","texfile","texid","inPlayableArea","unitsDoo","splats","clone","modelscale","rowTeamColor","teamcolor","rowMoveHeight","moveheight","ubersplat","Dir","unitshadow","shadowX","shadowx","shadowY","shadowy","shadowW","shadoww","shadowH","shadowh","buildingshadow","animprops","createUberSplatModes","splatPromises","models","unitInst","tilesets","blightTextureIndex","texDir","waterRow","texRate","Dmax_R","Dmax_G","Dmax_B","Dmax_A","Dmin_R","Dmin_G","Dmin_B","Dmin_A","Smax_R","Smax_G","Smax_B","Smax_A","minShallowColor","Smin_R","Smin_G","Smin_B","Smin_A","numTex","createTilesetsAndWaterTextures","cliffHeights","cornerHeights","waterHeights","cornerTextures","cornerVariations","waterFlags","cliffs","cliffPathTex","pathtex","pathTex","rampType","bottomLeft","rampAdjust","isWater","rampModelDir","rampName","cliffType","isCliff","bottomLeftLayer","bottomRightLayer","topLeftLayer","topRightLayer","cliffFileName","cliffModelDir","bottomLeftTexture","cornerTexture","bottomRightTexture","topLeftTexture","topRightTexture","bitset","R32F","createWaves","cliffPromises","ramps","adjust","ae","cf","rampFileName","bf","ty","tx","tile","ah","bh","dh","tilesetsCount","cliffGroundIndex","whichCliff","whichTileset","groundTile","tileID","applyModificationFile","dataMap","metadataMap","modificationFile","applyModificationTable","modificationTable","modificationObject","metadata","groundNormal","cellX","cellY","bottomRight","topLeft","topRight","heightAt","sqX","sqY","shadowSize","shadowData","ox","oy","wavesCliff","wavesRolling","shoreline","shoreDir","shoreSFile","outsideCorner","shoreOCFile","insideCorner","shoreICFile","rotation2","ad","bd","cd","dd","rot","deselect","selModels","doSelectUnits","selScale","selZ","selectUnit","ray","eMid","eSize","rDir","entity","entDist","ent","dlen","sqrLen","dp","dot","sqrDist","sel","selectUnits","src_mdx","glMatrix","v3pos","v3dir","v3up","v3sub","m4rot","f32rot","TeamColors","FileModelView","yaw","onMouseDown","onMouseMove","onMouseUp","dragPos","clientX","clientY","dim","setCamera","removeEvents","onMouseWheel","deltaY","seq","cam","animate","ts","requestAnimationFrame","fromRotation","vFov","atan","tan","freeCamera","cancelAnimationFrame","modelLoaded","clearColor","isPortrait","resolvePath","bin","portrait","onWheel","ObjectModel","setPopup","popup","ReactDOM","createPortal","ObjectTooltip","ObjectLinkRaw","StringPopupCell","onMouseOver","getBoundingClientRect","documentElement","onMouseOut","onMouseEnter","onMouseLeave","PopupCell","scrollWidth","offsetWidth","closest","StringPopup","StringIconPopup","onLoad","loading","StringIcon","placement","ObjectSubValue","_ref5","ObjectSubValueRaw","_ref6","ObjectValue","_ref7","SubValue","list","formatString","ObjectDataBodyEx","ObjectDataBody","DragHandle","stopPropagation","buttons","removeListeners","ObjectData","sliderPos","setSliderPos","table_","setRef","ObjectViewComponent","setRawNames","minSize","resizable","ObjectViewInner","ObjectView","processFiles","listfile","dirs","files","pl","unk","nameCompare","FileLink","FileItem","upSearchVisit","downSearchVisit","FileDirectory","subDir","subFile","expandFile","parts","preSelect","firstLevelNode","FileListInner","stateChanged","hasSearchResult","rowRendererSearch","_panel","EmptyPanel","FileList","Cell","FileSlkView","rowGetter","getColumnWidth","renderColumns","Column","dataKey","cellRenderer","cellData","rowIndex","Number","isInteger","tableWidth","Table","overscanRowCount","FileHexView","foo","bar","digits","byte","nil","numDigits","getChildIndex","childNodes","getChildrenLength","textContent","getNodeOffset","anchor","anchorOffset","parentElement","highlightMatches","matches","TextView","searchText","searchMatches","selection","onCopy","_node","getSelection","tempNodes","anchorPos","nodeToPos2","anchorNode","focusPos","focusNode","focusOffset","tsBegin","tsEnd","csBeginNode","csBegin","csEndNode","csEnd","nodeType","prepend","tempNode","whiteSpace","append","insertBefore","onSelect","suppressSelect","badNode","_firstLine","_lastLine","p2n","posToNode","tsPos","nodeToPos","csPos","setBaseAndExtent","searchPos","selectRange","unsuppress","cellRangeRenderer","defaultCellRangeRenderer","highlightExpr","highlightFunc","padding","searchRegex","lineIndex","findMatches","searchMatch","plain","isValidElement","replaceReact","data-line-number","rowMeasure","heights","setScroll","scrollToPosition","_scrollTop","setList","findDOMNode","direction","allMatches","nextPos","textLower","lineLower","curMatch","getAttribute","lineNode","querySelector","posToNode2","findNodeOffset","fromPos","toPos","_lines","recomputeRowHeights","_heights","_avgHeight","sum","estimatedRowSize","FileTextView","imageInfo","getUint32","format","getInt16","hdrPos","FileImageView","FileAudioView","audio","controls","controlsList","parseKeywords","common","commonRe","blizzard","inFunc","inGlob","tokenRe","RowHeight","FileJassView","tokenFunc","chr","com","kw","keywords","gameFileTypes","war3map.doo","Formats","war3map.imp","war3map.mmp","war3map.shd","war3mapUnits.doo","war3map.w3c","war3map.w3d","war3map.w3e","war3map.w3f","war3map.w3i","war3map.w3o","war3map.w3r","war3map.w3s","war3map.w3u","war3map.wct","war3map.wpm","war3map.wtg","war3map.wts","FileData","panel","isJass","maxLength","textHeights","makePanel","renderPane","ObjectInspector","expandLevel","Type","iotaX","iotaY","GameFileImage","GameFileLoader","GameFileData","ab","FileViewComponent","FileView","MapHome","JassOptions","number","numOption","setter","indentFlag","renameFunctionsFlag","renameGlobalsFlag","renameLocalsFlag","JassViewerWithData","onSearchChange","_search","elt","Navbar","fluid","Nav","rootClose","Form","pullLeft","_saver","JassViewParser","realOptions","JassViewInner","jassFormatting","JassView","itemGroupTypes","computeDrops","drops","addTable","addItem","tableId","columnId","tbl","chance2","DropInfo","setExpanded","useContext","SelectionWindow","coords","pressed","unregisterEvents","gameData","misc","xpFunction","xpTable","xpA","xpB","xpC","makeXpFunction","totalXp","dropDiv","makeDrop","levelDiv","xp","AsyncSelectionWindow","notifications","onContextMenu","dragStart","dragButton","rc","dragSelection","selrect","cos","sin","vel","abs","prevTs","rOffsets","ang","dist","_ref8","dataPath","addNotification","expires","_ref9","_ref10","expiring","_ref11","_ref12","_ref13","Switch","MapView","MapLink","MapList","collapsed","paths","descs","Comp","subLists","freeItems","HomePage","messageType","parseFile","FormFileLabel","accept","Spinner","WithData","Redirect","App","dropping","onLoading","onDrop","dataTransfer","kind","getAsFile","getDropFile","onDragEnter","setDropping","onDragOver","isDropFile","onDragLeave","inc","Brand","DataMenu","AppLoader","MapDialog","renderStep","dialogClassName","Root","mapLoadName","mapLoadProgress","mapLoadStatus","mapLoadError","onCloseMapDialog","navigateTo","Router","basename","getElementById"],"mappings":"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","file":"static/js/main.081d426a.chunk.js","sourcesContent":["/* eslint-disable */\nconst { CstParser, EMPTY_ALT, EOF } = require('chevrotain');\nconst { JassLexer, tokenVocabulary: jassTokens } = require('./JassLexer');\nfor (const key in jassTokens) {\n  if (Object.hasOwnProperty.call(jassTokens, key)) {\n    global[key] = jassTokens[key];\n  }\n}\n/* eslint-disable no-undef */  \n\nclass JassParser extends CstParser {\n  constructor() {\n    super(jassTokens);\n    const $ = this;\n\n    $.RULE('program', () => {\n      $.MANY(() => {\n        $.OR([\n          { ALT: () => $.SUBRULE($.typeDefinition) },\n          { ALT: () => $.SUBRULE($.nativeBlock) },\n          { ALT: () => $.SUBRULE($.globalsBlock) },\n          { ALT: () => $.SUBRULE($.functionBlock) },\n        ]);\n      })\n    });\n    $.RULE('typeDefinition', () => {\n      $.CONSUME(TYPE);\n      $.CONSUME1(ID);\n      $.CONSUME2(EXTENDS);\n      $.CONSUME3(ID);\n    });\n\n    $.RULE('type', () => {\n      $.OR([\n        { ALT: () => $.CONSUME(NOTHING) },\n        {\n          ALT: () => {\n            $.CONSUME(ID);\n            $.OPTION(() => $.CONSUME(ARRAY));\n          }\n        }\n      ])\n    });\n    $.RULE('globalVar', () => {\n      $.OPTION(() => $.CONSUME(CONSTANT), { LABEL: 'constant' });\n      // typeName\n      $.SUBRULE($.type, { LABEL: 'type' });\n      // identifier\n      $.CONSUME2(ID, { LABEL: 'label' });\n      $.OPTION3(() => {\n        $.CONSUME(EQUALS);\n        $.SUBRULE($.expression)\n      });\n    });\n    $.RULE('localVars', () => {\n      $.CONSUME1(LOCAL);\n      // typeName\n      $.SUBRULE($.type, { LABEL: 'type' });\n      // identifier\n      $.CONSUME2(ID, { LABEL: 'label' });\n      $.OPTION3(() => {\n        $.CONSUME(EQUALS);\n        $.SUBRULE($.expression)\n      });\n    });\n\n    $.RULE('expression', () => {\n      const left = { LABEL: 'left' }\n      const op = { LABEL: 'op' }\n      const right = { LABEL: 'right' }\n      $.OR([\n        { ALT: () => $.SUBRULE($.ParentheticalExpression, left) },\n        { ALT: () => $.SUBRULE($.NotExpression, left) },\n        { ALT: () => $.SUBRULE($.NegateExpression, left) },\n        { ALT: () => $.CONSUME(IDLITERAL, left) },\n        { ALT: () => $.CONSUME(STRINGLITERAL, left) },\n        { ALT: () => $.CONSUME(HEX_CONSTANT, left) },\n        { ALT: () => $.CONSUME(DOLLAR_HEX_CONSTANT, left) },\n        { ALT: () => $.CONSUME(RAWCODE, left) },\n        { ALT: () => $.SUBRULE($.jassValueOf, left) },\n        { ALT: () => $.SUBRULE($.FunctionReferenceExpression, left) },\n        { ALT: () => $.CONSUME(INTEGER, left) },\n        { ALT: () => $.CONSUME(NULL, left) },\n        { ALT: () => $.CONSUME(FALSE, left) },\n        { ALT: () => $.CONSUME(TRUE, left) },\n        { ALT: () => $.CONSUME(REAL, left) },\n      ]);\n      $.OPTION(() => {\n        $.OR2([\n          { ALT: () => $.CONSUME(AND, op) },\n          { ALT: () => $.CONSUME(OR, op) },\n          { ALT: () => $.CONSUME(EQUALSEQUALS, op) },\n          { ALT: () => $.CONSUME(LESSOREQUALS, op) },\n          { ALT: () => $.CONSUME(GREATEROREQUALS, op) },\n          { ALT: () => $.CONSUME(LESS, op) },\n          { ALT: () => $.CONSUME(GREATER, op) },\n          { ALT: () => $.CONSUME(NOTEQUALS, op) },\n          { ALT: () => $.CONSUME(PLUS, op) },\n          { ALT: () => $.CONSUME(MINUS, op) },\n          { ALT: () => $.CONSUME(MULT, op) },\n          { ALT: () => $.CONSUME(DIV, op) },\n        ]);\n        $.SUBRULE2($.expression, right)\n      })\n    });\n\n    $.RULE('StringLiteralExpression', () => {\n      $.CONSUME(STRINGLITERAL)\n    });\n    $.RULE('HexIntegerLiteralExpression', () => {\n      $.CONSUME(HEX_CONSTANT)\n    });\n    $.RULE('DollarHexIntegerLiteralExpression', () => {\n      $.CONSUME(DOLLAR_HEX_CONSTANT)\n    });\n\n    $.RULE('FunctionReferenceExpression', () => {\n      $.CONSUME1(FUNCTION)\n      $.CONSUME2(ID)\n    });\n\n    $.RULE('jassValueOf', () => {\n      const d = $.CONSUME(ID)\n      $.OPTION(() => {\n        $.OR([\n          { ALT: () => $.SUBRULE($.arrayAccess) },\n          {\n            ALT: () => {\n              $.CONSUME2(LPAREN)\n              $.SUBRULE($.argList)\n              $.CONSUME3(RPAREN)\n            }\n          },\n          {\n            ALT: () => {\n              $.CONSUME(LPAREN)\n              $.CONSUME(RPAREN)\n            }\n          }\n        ]);\n      })\n    });\n\n    $.RULE('functionCallExpression', () => {\n      let x1 = $.CONSUME1(ID)\n      let x2 = $.CONSUME2(LPAREN)\n      let x3 = $.OPTION(() => $.SUBRULE($.argList));\n      let x4 = $.CONSUME3(RPAREN)\n    });\n\n\n    $.RULE('arrayAccess', () => {\n      $.CONSUME2(LSQUAREPAREN)\n      $.SUBRULE($.expression)\n      $.CONSUME3(RSQUAREPAREN)\n    });\n\n    $.RULE('ParentheticalExpression', () => {\n      $.CONSUME(LPAREN)\n      const d = $.SUBRULE($.expression)\n      $.CONSUME(RPAREN)\n    });\n\n    $.RULE('NotExpression', () => {\n      $.CONSUME(NOT)\n      $.SUBRULE($.expression)\n    });\n\n    $.RULE('NegateExpression', () => {\n      $.CONSUME(MINUS)\n      $.SUBRULE($.expression)\n    });\n\n\n    $.RULE('argList', () => {\n      const d = $.SUBRULE($.expression)\n      $.MANY({\n        DEF: () => {\n          const comma = $.CONSUME(COMMA);\n          $.SUBRULE2($.expression);\n        }\n      })\n      // $.OPTION(() => {\n      //   $.AT_LEAST_ONE_SEP({\n      //     SEP: COMMA,\n      //     DEF: () => {\n      //       const d = $.SUBRULE2($.expression);\n      //     }\n      //   })\n      // })\n    });\n\n    $.RULE('statement', () => {\n      const label = { LABEL: 'statements' };\n      $.OR([\n        { ALT: () => $.SUBRULE($.callStatement, label) },\n        { ALT: () => $.SUBRULE($.setStatement, label) },\n        { ALT: () => $.SUBRULE($.returnStatement, label) },\n        { ALT: () => $.SUBRULE($.exitWhenStatement, label) },\n        { ALT: () => $.SUBRULE($.localVars, label) },\n        { ALT: () => $.SUBRULE($.loopStatement, label) },\n        { ALT: () => $.SUBRULE($.ifStatement, label) },\n        // ALT: ()=>$.SUBRULE($.DebugStatement)\n      ]);\n    });\n    $.RULE('callStatement', () => {\n      $.CONSUME(CALL)\n      $.SUBRULE($.functionCallExpression)\n    });\n\n\n    $.RULE('setStatement', () => {\n      $.CONSUME1(SET)\n      $.CONSUME2(ID)\n      $.OPTION(() => $.SUBRULE($.arrayAccess))\n      $.CONSUME3(EQUALS)\n      $.SUBRULE($.expression)\n    });\n\n    $.RULE('returnStatement', () => {\n      $.CONSUME(RETURN)\n      $.OPTION(() => $.SUBRULE($.expression))\n    });\n\n    $.RULE('exitWhenStatement', () => {\n      $.CONSUME(EXITWHEN)\n      $.SUBRULE($.expression)\n    });\n\n    $.RULE('loopStatement', () => {\n      $.CONSUME(LOOP)\n      $.MANY(() => $.SUBRULE($.statement));\n      $.CONSUME(ENDLOOP)\n    });\n    $.RULE('ifStatement', () => {\n      $.CONSUME(IF)\n      $.SUBRULE($.expression, { LABEL: 'condition' })\n      $.CONSUME(THEN)\n      $.MANY(() => $.SUBRULE($.statement, { LABEL: 'statements' }));\n      $.MANY2(() => $.SUBRULE($.elseIfStatement, { LABEL: 'elseIfStatement' }));\n      $.MANY3(() => $.SUBRULE($.elseStatement, { LABEL: 'elseStatement' }));\n      $.CONSUME4(ENDIF)\n    });\n    $.RULE('elseIfStatement', () => {\n      $.CONSUME(ELSEIF)\n      $.SUBRULE($.expression, { LABEL: 'condition' })\n      $.CONSUME(THEN)\n      $.MANY(() => $.SUBRULE($.statement, { LABEL: 'statements' }));\n    });\n\n    $.RULE('elseStatement', () => {\n      $.CONSUME(ELSE)\n      $.MANY(() => $.SUBRULE($.statement, { LABEL: 'statements' }));\n    });\n\n    $.RULE('param', () => {\n      $.OR([\n        {\n          ALT: () => {\n            $.SUBRULE($.type)\n            $.CONSUME(ID)\n          }\n        },\n        { ALT: () => $.CONSUME(NOTHING) },\n      ])\n    });\n    $.RULE('paramList', () => {\n      const d = $.SUBRULE($.param)\n      $.MANY({\n        DEF: () => {\n          $.CONSUME(COMMA);\n          $.SUBRULE2($.param);\n        }\n      })\n    });\n    $.RULE('globalsBlock', () => {\n      $.CONSUME(GLOBALS);\n      $.MANY(() => $.SUBRULE($.globalVar, { LABEL: 'globalVars' }));\n      $.CONSUME(ENDGLOBALS);\n    });\n\n    $.RULE('nativeBlock', () => {\n      $.OPTION(() => $.CONSUME(CONSTANT));\n      $.CONSUME(NATIVE);\n      $.CONSUME(ID);\n      $.CONSUME(TAKES);\n      $.SUBRULE($.paramList);\n      $.CONSUME(RETURNS);\n      $.SUBRULE($.type, { LABEL: 'returnType' });\n    });\n\n\n\n    $.RULE('functionBlock', () => {\n      let a = $.OPTION(() => $.CONSUME(CONSTANT));\n      let b = $.CONSUME(FUNCTION);\n      let c = $.CONSUME(ID, { LABEL: 'functionName' });\n      let d = $.CONSUME(TAKES);\n      let e = $.SUBRULE($.paramList);\n      let f = $.CONSUME(RETURNS);\n      let j = $.SUBRULE($.type, { LABEL: 'returnType' });\n      let h = $.MANY(() => $.SUBRULE($.statement, 'statements'));\n      let i = $.CONSUME(ENDFUNCTION);\n    });\n    this.performSelfAnalysis()\n  }\n}\n\nclass visitor {\n  visit(d, depth) {\n    if (d instanceof Array) {\n      this.visitArray(d, depth);\n    }\n    else {\n      this.visitObject(d, depth);\n    }\n  }\n  visitObject(d, depth) {\n    if (!Object.keys(d).length) {\n      return;\n    }\n\n    if (d.image) {\n      console.log(this.indent(depth), '#' + d.tokenType.name, '\\'' + d.image + \"\\'\", ', end at line', d.endLine + ':' + d.endColumn);\n      return;\n    }\n    if (d.name) {\n      console.log(this.indent(depth), '#' + d.name);\n    }\n    for (const key in d) {\n      const element = d[key];\n      if (key == 'name') {\n        continue;\n      }\n      if (Object.hasOwnProperty.call(d, key)) {\n        if (element instanceof Array) {\n          this.visitArray(element, depth + 1);\n        }\n        else if (element.__proto__ && element.__proto__.constructor.name == 'String') {\n          console.log(this.indent(depth) + key, '=', '\\'' + element + '\\'');\n        }\n        // else if (element.__proto__ && element.__proto__.constructor.name == 'Number') {\n        //   console.log(this.indent(depth) + key, '=', element);\n        // }\n        else if (Object.keys(element).length) {\n          this.visitObject(element, depth + 1);\n        }\n        else {\n          console.log(this.indent(depth), '>', 'no-elements-found')\n        }\n      }\n    }\n  }\n  visitArray(d, depth) {\n    if (d instanceof Array) {\n      for (let i = 0; i < d.length; i++) {\n        const element = d[i];\n        this.visit(element, depth);\n      }\n    }\n  }\n  indent(depth) {\n    return new Array(depth * 2).fill(' ').join('');\n  }\n}\nmodule.exports = {\n  JassParser,\n  parse: function (inputText, rule, debug) {\n    const parserInstance = new JassParser();\n    const lexResult = JassLexer.tokenize(inputText);\n    parserInstance.input = lexResult.tokens;\n    parserInstance.debug = (rule && rule != 'program') || debug;\n    parserInstance.constVisitor = new visitor();\n    parserInstance.cstPostRule = function (d) {\n      if (this.debug)\n        this.constVisitor.visit(d, 0);\n    }\n    console.log('==== start parser program === ')\n    const output = parserInstance[rule || 'program']();\n    if (parserInstance.errors.length > 0) {\n      throw new Error(parserInstance.errors[0].message);\n    }\n    return output;\n  },\n};","module.exports = __webpack_public_path__ + \"static/media/ArchiveLoader.2fdd1a3c.wasm\";","/* eslint-disable */\nvar ArchiveLoader = (() => {\n  var _scriptName = typeof document != 'undefined' ? (document.currentScript && document.currentScript.src) : undefined;\n  if (typeof __filename != 'undefined') _scriptName || (_scriptName= __filename);\n  return (\nfunction(moduleArg = {}) {\n  var moduleRtn;\n\nvar Module=moduleArg;var readyPromiseResolve,readyPromiseReject;var readyPromise=new Promise((resolve,reject)=>{readyPromiseResolve=resolve;readyPromiseReject=reject});var ENVIRONMENT_IS_WEB=typeof window==\"object\";var ENVIRONMENT_IS_WORKER=typeof importScripts==\"function\";var ENVIRONMENT_IS_NODE=typeof process==\"object\"&&typeof process.versions==\"object\"&&typeof process.versions.node==\"string\";if(ENVIRONMENT_IS_NODE){}var moduleOverrides=Object.assign({},Module);var arguments_=[];var thisProgram=\"./this.program\";var quit_=(status,toThrow)=>{throw toThrow};var scriptDirectory=\"\";function locateFile(path){if(Module[\"locateFile\"]){return Module[\"locateFile\"](path,scriptDirectory)}return scriptDirectory+path}var read_,readAsync,readBinary;if(ENVIRONMENT_IS_NODE){var fs=require(\"fs\");var nodePath=require(\"path\");scriptDirectory=__dirname+\"/\";read_=(filename,binary)=>{filename=isFileURI(filename)?new URL(filename):nodePath.normalize(filename);return fs.readFileSync(filename,binary?undefined:\"utf8\")};readBinary=filename=>{var ret=read_(filename,true);if(!ret.buffer){ret=new Uint8Array(ret)}return ret};readAsync=(filename,onload,onerror,binary=true)=>{filename=isFileURI(filename)?new URL(filename):nodePath.normalize(filename);fs.readFile(filename,binary?undefined:\"utf8\",(err,data)=>{if(err)onerror(err);else onload(binary?data.buffer:data)})};if(!Module[\"thisProgram\"]&&process.argv.length>1){thisProgram=process.argv[1].replace(/\\\\/g,\"/\")}arguments_=process.argv.slice(2);quit_=(status,toThrow)=>{process.exitCode=status;throw toThrow}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){if(ENVIRONMENT_IS_WORKER){scriptDirectory=self.location.href}else if(typeof document!=\"undefined\"&&document.currentScript){scriptDirectory=document.currentScript.src}if(_scriptName){scriptDirectory=_scriptName}if(scriptDirectory.startsWith(\"blob:\")){scriptDirectory=\"\"}else{scriptDirectory=scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,\"\").lastIndexOf(\"/\")+1)}{read_=url=>{var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,false);xhr.send(null);return xhr.responseText};if(ENVIRONMENT_IS_WORKER){readBinary=url=>{var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,false);xhr.responseType=\"arraybuffer\";xhr.send(null);return new Uint8Array(xhr.response)}}readAsync=(url,onload,onerror)=>{if(isFileURI(url)){var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,true);xhr.responseType=\"arraybuffer\";xhr.onload=()=>{if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return}onerror()};xhr.onerror=onerror;xhr.send(null);return}fetch(url,{credentials:\"same-origin\"}).then(response=>{if(response.ok){return response.arrayBuffer()}return Promise.reject(new Error(response.status+\" : \"+response.url))}).then(onload,onerror)}}}else{}var out=Module[\"print\"]||console.log.bind(console);var err=Module[\"printErr\"]||console.error.bind(console);Object.assign(Module,moduleOverrides);moduleOverrides=null;if(Module[\"arguments\"])arguments_=Module[\"arguments\"];if(Module[\"thisProgram\"])thisProgram=Module[\"thisProgram\"];if(Module[\"quit\"])quit_=Module[\"quit\"];var wasmBinary;if(Module[\"wasmBinary\"])wasmBinary=Module[\"wasmBinary\"];var wasmMemory;var ABORT=false;var EXITSTATUS;var HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var b=wasmMemory.buffer;Module[\"HEAP8\"]=HEAP8=new Int8Array(b);Module[\"HEAP16\"]=HEAP16=new Int16Array(b);Module[\"HEAPU8\"]=HEAPU8=new Uint8Array(b);Module[\"HEAPU16\"]=HEAPU16=new Uint16Array(b);Module[\"HEAP32\"]=HEAP32=new Int32Array(b);Module[\"HEAPU32\"]=HEAPU32=new Uint32Array(b);Module[\"HEAPF32\"]=HEAPF32=new Float32Array(b);Module[\"HEAPF64\"]=HEAPF64=new Float64Array(b)}var __ATPRERUN__=[];var __ATINIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;function preRun(){if(Module[\"preRun\"]){if(typeof Module[\"preRun\"]==\"function\")Module[\"preRun\"]=[Module[\"preRun\"]];while(Module[\"preRun\"].length){addOnPreRun(Module[\"preRun\"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=true;callRuntimeCallbacks(__ATINIT__)}function postRun(){if(Module[\"postRun\"]){if(typeof Module[\"postRun\"]==\"function\")Module[\"postRun\"]=[Module[\"postRun\"]];while(Module[\"postRun\"].length){addOnPostRun(Module[\"postRun\"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(cb){__ATPRERUN__.unshift(cb)}function addOnInit(cb){__ATINIT__.unshift(cb)}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb)}var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;function addRunDependency(id){runDependencies++;Module[\"monitorRunDependencies\"]&&Module[\"monitorRunDependencies\"](runDependencies)}function removeRunDependency(id){runDependencies--;Module[\"monitorRunDependencies\"]&&Module[\"monitorRunDependencies\"](runDependencies);if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback()}}}function abort(what){Module[\"onAbort\"]&&Module[\"onAbort\"](what);what=\"Aborted(\"+what+\")\";err(what);ABORT=true;EXITSTATUS=1;what+=\". Build with -sASSERTIONS for more info.\";var e=new WebAssembly.RuntimeError(what);readyPromiseReject(e);throw e}var dataURIPrefix=\"data:application/octet-stream;base64,\";var isDataURI=filename=>filename.startsWith(dataURIPrefix);var isFileURI=filename=>filename.startsWith(\"file://\");function findWasmBinary(){var f=\"ArchiveLoader.wasm\";if(!isDataURI(f)){return locateFile(f)}return f}var wasmBinaryFile;function getBinarySync(file){if(file==wasmBinaryFile&&wasmBinary){return new Uint8Array(wasmBinary)}if(readBinary){return readBinary(file)}throw\"both async and sync fetching of the wasm failed\"}function getBinaryPromise(binaryFile){if(!wasmBinary){return new Promise((resolve,reject)=>{readAsync(binaryFile,response=>resolve(new Uint8Array(response)),error=>{try{resolve(getBinarySync(binaryFile))}catch(e){reject(e)}})})}return Promise.resolve().then(()=>getBinarySync(binaryFile))}function instantiateArrayBuffer(binaryFile,imports,receiver){return getBinaryPromise(binaryFile).then(binary=>WebAssembly.instantiate(binary,imports)).then(receiver,reason=>{err(`failed to asynchronously prepare wasm: ${reason}`);abort(reason)})}function instantiateAsync(binary,binaryFile,imports,callback){if(!binary&&typeof WebAssembly.instantiateStreaming==\"function\"&&!isDataURI(binaryFile)&&!isFileURI(binaryFile)&&!ENVIRONMENT_IS_NODE&&typeof fetch==\"function\"){return fetch(binaryFile,{credentials:\"same-origin\"}).then(response=>{var result=WebAssembly.instantiateStreaming(response,imports);return result.then(callback,function(reason){err(`wasm streaming compile failed: ${reason}`);err(\"falling back to ArrayBuffer instantiation\");return instantiateArrayBuffer(binaryFile,imports,callback)})})}return instantiateArrayBuffer(binaryFile,imports,callback)}function getWasmImports(){return{a:wasmImports}}function createWasm(){var info=getWasmImports();function receiveInstance(instance,module){wasmExports=instance.exports;wasmMemory=wasmExports[\"x\"];updateMemoryViews();wasmTable=wasmExports[\"z\"];addOnInit(wasmExports[\"y\"]);removeRunDependency(\"wasm-instantiate\");return wasmExports}addRunDependency(\"wasm-instantiate\");function receiveInstantiationResult(result){receiveInstance(result[\"instance\"])}if(Module[\"instantiateWasm\"]){try{return Module[\"instantiateWasm\"](info,receiveInstance)}catch(e){err(`Module.instantiateWasm callback failed with error: ${e}`);readyPromiseReject(e)}}if(!wasmBinaryFile)wasmBinaryFile=findWasmBinary();instantiateAsync(wasmBinary,wasmBinaryFile,info,receiveInstantiationResult).catch(readyPromiseReject);return{}}function write_output(ptr,size){window.postResult(HEAPU8.slice(ptr,ptr+size))}function ExitStatus(status){this.name=\"ExitStatus\";this.message=`Program terminated with exit(${status})`;this.status=status}var callRuntimeCallbacks=callbacks=>{while(callbacks.length>0){callbacks.shift()(Module)}};var noExitRuntime=Module[\"noExitRuntime\"]||true;var stackRestore=val=>__emscripten_stack_restore(val);var stackSave=()=>_emscripten_stack_get_current();var UTF8Decoder=typeof TextDecoder!=\"undefined\"?new TextDecoder(\"utf8\"):undefined;var UTF8ArrayToString=(heapOrArray,idx,maxBytesToRead)=>{var endIdx=idx+maxBytesToRead;var endPtr=idx;while(heapOrArray[endPtr]&&!(endPtr>=endIdx))++endPtr;if(endPtr-idx>16&&heapOrArray.buffer&&UTF8Decoder){return UTF8Decoder.decode(heapOrArray.subarray(idx,endPtr))}var str=\"\";while(idx<endPtr){var u0=heapOrArray[idx++];if(!(u0&128)){str+=String.fromCharCode(u0);continue}var u1=heapOrArray[idx++]&63;if((u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue}var u2=heapOrArray[idx++]&63;if((u0&240)==224){u0=(u0&15)<<12|u1<<6|u2}else{u0=(u0&7)<<18|u1<<12|u2<<6|heapOrArray[idx++]&63}if(u0<65536){str+=String.fromCharCode(u0)}else{var ch=u0-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}}return str};var UTF8ToString=(ptr,maxBytesToRead)=>ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):\"\";var ___assert_fail=(condition,filename,line,func)=>{abort(`Assertion failed: ${UTF8ToString(condition)}, at: `+[filename?UTF8ToString(filename):\"unknown filename\",line,func?UTF8ToString(func):\"unknown function\"])};class ExceptionInfo{constructor(excPtr){this.excPtr=excPtr;this.ptr=excPtr-24}set_type(type){HEAPU32[this.ptr+4>>2]=type}get_type(){return HEAPU32[this.ptr+4>>2]}set_destructor(destructor){HEAPU32[this.ptr+8>>2]=destructor}get_destructor(){return HEAPU32[this.ptr+8>>2]}set_caught(caught){caught=caught?1:0;HEAP8[this.ptr+12]=caught}get_caught(){return HEAP8[this.ptr+12]!=0}set_rethrown(rethrown){rethrown=rethrown?1:0;HEAP8[this.ptr+13]=rethrown}get_rethrown(){return HEAP8[this.ptr+13]!=0}init(type,destructor){this.set_adjusted_ptr(0);this.set_type(type);this.set_destructor(destructor)}set_adjusted_ptr(adjustedPtr){HEAPU32[this.ptr+16>>2]=adjustedPtr}get_adjusted_ptr(){return HEAPU32[this.ptr+16>>2]}get_exception_ptr(){var isPointer=___cxa_is_pointer_type(this.get_type());if(isPointer){return HEAPU32[this.excPtr>>2]}var adjusted=this.get_adjusted_ptr();if(adjusted!==0)return adjusted;return this.excPtr}}var exceptionLast=0;var uncaughtExceptionCount=0;var ___cxa_throw=(ptr,type,destructor)=>{var info=new ExceptionInfo(ptr);info.init(type,destructor);exceptionLast=ptr;uncaughtExceptionCount++;throw exceptionLast};var __abort_js=()=>{abort(\"\")};var __emscripten_memcpy_js=(dest,src,num)=>HEAPU8.copyWithin(dest,src,src+num);var __emscripten_throw_longjmp=()=>{throw Infinity};var getHeapMax=()=>2147483648;var growMemory=size=>{var b=wasmMemory.buffer;var pages=(size-b.byteLength+65535)/65536;try{wasmMemory.grow(pages);updateMemoryViews();return 1}catch(e){}};var _emscripten_resize_heap=requestedSize=>{var oldSize=HEAPU8.length;requestedSize>>>=0;var maxHeapSize=getHeapMax();if(requestedSize>maxHeapSize){return false}var alignUp=(x,multiple)=>x+(multiple-x%multiple)%multiple;for(var cutDown=1;cutDown<=4;cutDown*=2){var overGrownHeapSize=oldSize*(1+.2/cutDown);overGrownHeapSize=Math.min(overGrownHeapSize,requestedSize+100663296);var newSize=Math.min(maxHeapSize,alignUp(Math.max(requestedSize,overGrownHeapSize),65536));var replacement=growMemory(newSize);if(replacement){return true}}return false};var ENV={};var getExecutableName=()=>thisProgram||\"./this.program\";var getEnvStrings=()=>{if(!getEnvStrings.strings){var lang=(typeof navigator==\"object\"&&navigator.languages&&navigator.languages[0]||\"C\").replace(\"-\",\"_\")+\".UTF-8\";var env={USER:\"web_user\",LOGNAME:\"web_user\",PATH:\"/\",PWD:\"/\",HOME:\"/home/web_user\",LANG:lang,_:getExecutableName()};for(var x in ENV){if(ENV[x]===undefined)delete env[x];else env[x]=ENV[x]}var strings=[];for(var x in env){strings.push(`${x}=${env[x]}`)}getEnvStrings.strings=strings}return getEnvStrings.strings};var stringToAscii=(str,buffer)=>{for(var i=0;i<str.length;++i){HEAP8[buffer++]=str.charCodeAt(i)}HEAP8[buffer]=0};var _environ_get=(__environ,environ_buf)=>{var bufSize=0;getEnvStrings().forEach((string,i)=>{var ptr=environ_buf+bufSize;HEAPU32[__environ+i*4>>2]=ptr;stringToAscii(string,ptr);bufSize+=string.length+1});return 0};var _environ_sizes_get=(penviron_count,penviron_buf_size)=>{var strings=getEnvStrings();HEAPU32[penviron_count>>2]=strings.length;var bufSize=0;strings.forEach(string=>bufSize+=string.length+1);HEAPU32[penviron_buf_size>>2]=bufSize;return 0};var runtimeKeepaliveCounter=0;var keepRuntimeAlive=()=>noExitRuntime||runtimeKeepaliveCounter>0;var _proc_exit=code=>{EXITSTATUS=code;if(!keepRuntimeAlive()){Module[\"onExit\"]&&Module[\"onExit\"](code);ABORT=true}quit_(code,new ExitStatus(code))};var exitJS=(status,implicit)=>{EXITSTATUS=status;_proc_exit(status)};var _exit=exitJS;var _fd_close=fd=>52;var convertI32PairToI53Checked=(lo,hi)=>hi+2097152>>>0<4194305-!!lo?(lo>>>0)+hi*4294967296:NaN;function _fd_seek(fd,offset_low,offset_high,whence,newOffset){var offset=convertI32PairToI53Checked(offset_low,offset_high);return 70}var printCharBuffers=[null,[],[]];var printChar=(stream,curr)=>{var buffer=printCharBuffers[stream];if(curr===0||curr===10){(stream===1?out:err)(UTF8ArrayToString(buffer,0));buffer.length=0}else{buffer.push(curr)}};var _fd_write=(fd,iov,iovcnt,pnum)=>{var num=0;for(var i=0;i<iovcnt;i++){var ptr=HEAPU32[iov>>2];var len=HEAPU32[iov+4>>2];iov+=8;for(var j=0;j<len;j++){printChar(fd,HEAPU8[ptr+j])}num+=len}HEAPU32[pnum>>2]=num;return 0};var wasmTableMirror=[];var wasmTable;var getWasmTableEntry=funcPtr=>{var func=wasmTableMirror[funcPtr];if(!func){if(funcPtr>=wasmTableMirror.length)wasmTableMirror.length=funcPtr+1;wasmTableMirror[funcPtr]=func=wasmTable.get(funcPtr)}return func};var wasmImports={d:___assert_fail,k:___cxa_throw,o:__abort_js,u:__emscripten_memcpy_js,p:__emscripten_throw_longjmp,q:_emscripten_resize_heap,s:_environ_get,t:_environ_sizes_get,v:_exit,r:_fd_close,l:_fd_seek,j:_fd_write,a:invoke_ii,b:invoke_iii,e:invoke_iiii,g:invoke_iiiii,c:invoke_iiiiii,m:invoke_ji,f:invoke_vi,w:invoke_vii,i:invoke_viii,n:invoke_viji,h:write_output};var wasmExports=createWasm();var ___wasm_call_ctors=()=>(___wasm_call_ctors=wasmExports[\"y\"])();var _malloc=Module[\"_malloc\"]=a0=>(_malloc=Module[\"_malloc\"]=wasmExports[\"A\"])(a0);var _free=Module[\"_free\"]=a0=>(_free=Module[\"_free\"]=wasmExports[\"B\"])(a0);var _openArchive=Module[\"_openArchive\"]=(a0,a1)=>(_openArchive=Module[\"_openArchive\"]=wasmExports[\"C\"])(a0,a1);var _hasFile=Module[\"_hasFile\"]=(a0,a1)=>(_hasFile=Module[\"_hasFile\"]=wasmExports[\"D\"])(a0,a1);var _loadFile=Module[\"_loadFile\"]=(a0,a1,a2)=>(_loadFile=Module[\"_loadFile\"]=wasmExports[\"E\"])(a0,a1,a2);var _loadImage=Module[\"_loadImage\"]=(a0,a1)=>(_loadImage=Module[\"_loadImage\"]=wasmExports[\"F\"])(a0,a1);var _loadJASS=Module[\"_loadJASS\"]=a0=>(_loadJASS=Module[\"_loadJASS\"]=wasmExports[\"G\"])(a0);var _setThrew=(a0,a1)=>(_setThrew=wasmExports[\"H\"])(a0,a1);var __emscripten_stack_restore=a0=>(__emscripten_stack_restore=wasmExports[\"I\"])(a0);var _emscripten_stack_get_current=()=>(_emscripten_stack_get_current=wasmExports[\"J\"])();var ___cxa_is_pointer_type=a0=>(___cxa_is_pointer_type=wasmExports[\"K\"])(a0);var dynCall_ji=Module[\"dynCall_ji\"]=(a0,a1)=>(dynCall_ji=Module[\"dynCall_ji\"]=wasmExports[\"L\"])(a0,a1);var dynCall_viji=Module[\"dynCall_viji\"]=(a0,a1,a2,a3,a4)=>(dynCall_viji=Module[\"dynCall_viji\"]=wasmExports[\"M\"])(a0,a1,a2,a3,a4);function invoke_iiii(index,a1,a2,a3){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2,a3)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_ii(index,a1){var sp=stackSave();try{return getWasmTableEntry(index)(a1)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_iii(index,a1,a2){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_iiiii(index,a1,a2,a3,a4){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2,a3,a4)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_vi(index,a1){var sp=stackSave();try{getWasmTableEntry(index)(a1)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_viii(index,a1,a2,a3){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2,a3)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_iiiiii(index,a1,a2,a3,a4,a5){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2,a3,a4,a5)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_vii(index,a1,a2){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_viji(index,a1,a2,a3,a4){var sp=stackSave();try{dynCall_viji(index,a1,a2,a3,a4)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}function invoke_ji(index,a1){var sp=stackSave();try{return dynCall_ji(index,a1)}catch(e){stackRestore(sp);if(e!==e+0)throw e;_setThrew(1,0)}}var calledRun;dependenciesFulfilled=function runCaller(){if(!calledRun)run();if(!calledRun)dependenciesFulfilled=runCaller};function run(){if(runDependencies>0){return}preRun();if(runDependencies>0){return}function doRun(){if(calledRun)return;calledRun=true;Module[\"calledRun\"]=true;if(ABORT)return;initRuntime();readyPromiseResolve(Module);if(Module[\"onRuntimeInitialized\"])Module[\"onRuntimeInitialized\"]();postRun()}if(Module[\"setStatus\"]){Module[\"setStatus\"](\"Running...\");setTimeout(function(){setTimeout(function(){Module[\"setStatus\"](\"\")},1);doRun()},1)}else{doRun()}}if(Module[\"preInit\"]){if(typeof Module[\"preInit\"]==\"function\")Module[\"preInit\"]=[Module[\"preInit\"]];while(Module[\"preInit\"].length>0){Module[\"preInit\"].pop()()}}run();Module[\"ready\"]=new Promise(function(resolve,reject){delete Module[\"then\"];Module[\"onAbort\"]=function(what){reject(what)};addOnPostRun(function(){resolve(Module)})});moduleRtn=readyPromise;\n\n\n  return moduleRtn;\n}\n);\n})();\nif (typeof exports === 'object' && typeof module === 'object')\n  module.exports = ArchiveLoader;\nelse if (typeof define === 'function' && define['amd'])\n  define([], () => ArchiveLoader);\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"604ee34ce8efa1c49074.worker.js\");\n};","const { createToken, Lexer } = require('chevrotain')\n\nconst tokens = [\n  createToken({\n    name: 'comment',\n    pattern: /\\/\\/.*/,\n    group: Lexer.SKIPPED\n  }),\n  createToken({\n    name: 'whitespace',\n    pattern: /\\s+/,\n    group: Lexer.SKIPPED\n  }),\n  createToken({ name: 'RAWCODE', pattern: /('''.*?''')/ }),\n  createToken({ name: 'COMMA', pattern: /,/ }),\n  createToken({ name: 'IF', pattern: /if/ }),\n  createToken({ name: 'THEN', pattern: /then/ }),\n  createToken({ name: 'ELSEIF', pattern: /elseif/ }),\n  createToken({ name: 'ELSE', pattern: /else/ }),\n  createToken({ name: 'ENDIF', pattern: /endif/ }),\n  createToken({ name: 'GLOBALS', pattern: /globals/ }),\n  createToken({ name: 'ENDGLOBALS', pattern: /endglobals/ }),\n  createToken({ name: 'FUNCTION', pattern: /function/ }),\n  createToken({ name: 'TAKES', pattern: /takes/ }),\n  createToken({ name: 'TYPE', pattern: /type/ }),\n  createToken({ name: 'ARRAY', pattern: /array/ }),\n  createToken({ name: 'NULL', pattern: /null/ }),\n  createToken({ name: 'TRUE', pattern: /true/ }),\n  createToken({ name: 'FALSE', pattern: /false/ }),\n  createToken({ name: 'CONSTANT', pattern: /constant/ }),\n  createToken({ name: 'HEX_CONSTANT', pattern: /0x(([0-9]|[a-f]|[A-F])*)/ }),\n  createToken({ name: 'DOLLAR_HEX_CONSTANT', pattern: /\\$(([0-9]|[A-F])*)/ }),\n  createToken({ name: 'RETURNS', pattern: /returns/ }),\n  createToken({ name: 'RETURN', pattern: /return/ }),\n  createToken({ name: 'EXTENDS', pattern: /extends/ }),\n  createToken({ name: 'NATIVE', pattern: /native/ }),\n  createToken({ name: 'ENDFUNCTION', pattern: /endfunction/ }),\n  createToken({ name: 'AND', pattern: /and(?=[\\s()])/ }),\n  createToken({ name: 'OR', pattern: /or(?=[\\s()])/ }),\n  createToken({ name: 'LOCAL', pattern: /local/ }),\n  createToken({ name: 'SET', pattern: /set(?=\\s)/ }),\n  createToken({ name: 'LOOP', pattern: /loop(?=\\s)/ }),\n  createToken({ name: 'EXITWHEN', pattern: /exitwhen/ }),\n  createToken({ name: 'ENDLOOP', pattern: /endloop/ }),\n  createToken({ name: 'NOTHING', pattern: /nothing/ }),\n  createToken({ name: 'NOT', pattern: /not/ }),\n  createToken({ name: 'CALL', pattern: /call(?=\\s)/ }),\n  createToken({ name: 'MULT', pattern: /\\*/ }),\n  createToken({ name: 'DIV', pattern: /\\// }),\n  createToken({ name: 'PLUS', pattern: /\\+/ }),\n  createToken({ name: 'MINUS', pattern: /-/ }),\n  createToken({ name: 'ID', pattern: /[a-zA-Z]\\w*/ }),\n  createToken({ name: 'LPAREN', pattern: /\\(/ }),\n  createToken({ name: 'RPAREN', pattern: /\\)/ }),\n  createToken({ name: 'LSQUAREPAREN', pattern: /\\[/ }),\n  createToken({ name: 'RSQUAREPAREN', pattern: /\\]/ }),\n  createToken({ name: 'NOTEQUALS', pattern: /!=/ }),\n  createToken({ name: 'EQUALSEQUALS', pattern: /==/ }),\n  createToken({ name: 'LESSOREQUALS', pattern: /<=/ }),\n  createToken({ name: 'GREATEROREQUALS', pattern: />=/ }),\n  createToken({ name: 'EQUALS', pattern: /=/ }),\n  createToken({ name: 'LESS', pattern: /</ }),\n  createToken({ name: 'GREATER', pattern: />/ }),\n  createToken({ name: 'IDLITERAL', pattern: /'.*?'/ }),\n  createToken({ name: 'STRINGLITERAL', pattern: /\"[\\s\\S]*?\"/, line_breaks: true }),\n  createToken({ name: 'REAL', pattern: /[0-9]+\\.[0-9]+/ }),\n  createToken({ name: 'INTEGER', pattern: /[0-9]+/ }),\n  createToken({ name: 'NL', pattern: /[\\r\\n]+/ }),\n]\n\nconst tokenVocabulary = {}\n\ntokens.forEach(tokenType => {\n  tokenVocabulary[tokenType.name] = tokenType\n})\nconst JassLexer = new Lexer(tokens)\n\nmodule.exports = {\n  JassLexer,\n  tokenVocabulary\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Route } from 'react-router-dom';\n\nclass ActiveContainer extends React.Component {\n  static contextTypes = {\n    router: PropTypes.shape({\n      history: PropTypes.shape({\n        push: PropTypes.func.isRequired,\n        replace: PropTypes.func.isRequired,\n        createHref: PropTypes.func.isRequired,\n      }).isRequired,\n    }).isRequired,\n  };\n\n  static propTypes = {\n    children: PropTypes.element.isRequired,\n    path: PropTypes.string.isRequired,\n    exact: PropTypes.bool,\n    strict: PropTypes.bool,\n    className: PropTypes.string,\n    activeClassName: PropTypes.string,\n    style: PropTypes.object,\n    activeStyle: PropTypes.object,\n    isActive: PropTypes.func,\n  };\n\n  static defaultProps = {\n    exact: false,\n    strict: false,\n    activeClassName: 'active',\n  };\n\n  render() {\n    const {\n      children,\n      path,\n      exact,\n      strict,\n      activeClassName,\n      className,\n      activeStyle,\n      style,\n      isActive: getIsActive,\n      ...props\n    } = this.props;\n\n    const child = React.Children.only(children);\n\n    return (\n      <Route\n        path={path}\n        exact={exact}\n        strict={strict}\n        children={({ location, match }) => {\n          const isActive = !!(getIsActive ? getIsActive(match, location) : match);\n\n          return React.cloneElement(\n            child,\n            {\n              ...props,\n              className: [className, child.props.className, isActive ? activeClassName : null]\n                .join(' ').trim(),\n              style: isActive ? { ...style, ...activeStyle } : style,\n            }\n          );\n        }}\n      />\n    );\n  }\n}\n\nexport { ActiveContainer };\nexport default ActiveContainer;","function createChainedFunction(...funcs) {\n  return funcs.filter(f => f != null).reduce((acc, f) => {\n    if (acc === null) return f;\n\n    return function chainedFunction(...args) {\n      acc.apply(this, args);\n      f.apply(this, args);\n    };\n  }, null);\n}\n\nexport { createChainedFunction };\nexport default createChainedFunction;\n","import React from 'react';\nimport { Alert } from 'react-bootstrap';\n\nconst ErrorView = ({type, ...props}) => {\n  let error = \"Unknown error.\";\n  Object.keys(props).some(id => {\n    if (props[id] && props[id].error) {\n      error = props[id].error;\n      return true;\n    }\n    return false;\n  });\n  return (\n    <div className=\"app-body\">\n      <Alert bsStyle={type || \"danger\"}>\n        <strong>Error:</strong> {error}\n      </Alert>\n    </div>\n  );\n};\n\nexport { ErrorView };\nexport default ErrorView;\n","function scrollParent(element, includeHidden) {\n  // from jQuery UI\n  const position = window.getComputedStyle(element).position;\n  if (position === \"fixed\") {\n    return element.ownerDocument || document;\n  }\n  const excludeStaticParent = (position === \"absolute\");\n  const overflowRegex = (includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/);\n\n  let parent = element.parentNode;\n  while (parent && parent.nodeType !== 9) {\n    if (parent.nodeType === 1) {\n      const style = window.getComputedStyle(parent);\n      if (excludeStaticParent && style.position === \"static\") {\n        // no\n      } else if (overflowRegex.test(style.overflow + style.overflowX + style.overflowY)) {\n        return parent;\n      }\n    }\n    parent = parent.parentNode;\n  }\n  return element.ownerDocument || document;\n}\n\nfunction scrollIntoView(element, padding=60) {\n  const parent = scrollParent(element);\n  const rect = element.getBoundingClientRect();\n  const parentRect = parent.getBoundingClientRect();\n  const parentStyle = window.getComputedStyle(parent);\n\n  const parentLeft = parentRect.left + parseFloat(parentStyle.borderLeftWidth);\n  const parentTop = parentRect.top + parseFloat(parentStyle.borderTopWidth);\n  const left = rect.left - parentLeft;\n  const top = rect.top - parentTop;\n  const right = rect.right - parentLeft;\n  const bottom = rect.bottom - parentTop;\n\n  const deltaLeft = Math.min(left - padding, left >= parent.clientWidth ?\n    (left + right - parent.clientWidth) / 2 : Math.max(right + padding - parent.clientWidth, 0));\n  const deltaTop = Math.min(top - padding, top >= parent.clientHeight ?\n    (top + bottom - parent.clientHeight) / 2 : Math.max(bottom + padding - parent.clientHeight, 0));\n  if (deltaLeft) parent.scrollLeft += deltaLeft;\n  if (deltaTop) parent.scrollTop += deltaTop;\n}\n\nexport { scrollParent, scrollIntoView };\nexport default scrollIntoView;\n","import React from 'react';\nimport keycode from 'keycode';\nimport classNames from 'classnames';\n\n\nimport './SearchBox.scss';\n\nclass SearchBox extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {results: null, show: false};\n  }\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.onGlobalKeyDown);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.onGlobalKeyDown);\n  }\n  onGlobalKeyDown = (e) => {\n    switch (e.which) {\n    case keycode.codes.f:\n      if (e.ctrlKey) {\n        this.show();\n        e.preventDefault();\n      }\n      break;\n    case keycode.codes.f3:\n      this.show();\n      if (e.shiftKey) {\n        this.findPrev();\n      } else {\n        this.findNext();        \n      }\n      if (this._input) {\n        this._input.focus();\n        this._input.select();\n      }\n      e.preventDefault();\n      break;\n    default:\n    }\n  }\n  show() {\n    this.setState({show: true});\n    if (this._input) {\n      this._input.focus();\n      this._input.select();\n    }\n  }\n  hide = () => {\n    this.setState({results: this.props.onSearch(\"\", 0)});\n    this.setState({show: false});\n  }\n  findNext = () => {\n    if (this._input) this.setState({results: this.props.onSearch(this._input.value, 1)});\n  }\n  findPrev = () => {\n    if (this._input) this.setState({results: this.props.onSearch(this._input.value, -1)});\n  }\n  onKeyDown = (e) => {\n    switch (e.which) {\n    case keycode.codes.esc:\n      this.hide();\n      break;\n    case keycode.codes.enter:\n      this.findNext();\n      break;\n    default:\n    }\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (this.state.show && !prevState.show && this._input) {\n      this._input.select();\n      this._input.focus();\n    }\n  }\n  onChange = (e) => {\n    this.setState({results: this.props.onSearch(e.target.value, 0)});\n  }\n  render() {\n    const { show, results } = this.state;\n    const found = (results && results.count);\n    return (\n      <div className={classNames(\"SearchBox\", {\"search-hidden\": !show})} onKeyDown={this.onKeyDown}>\n        <input type=\"text\" ref={node => this._input = node} onChange={this.onChange}/>\n        {!!results && <span className=\"count\">{(results.pos + 1) + \"/\" + results.count}</span>}\n        <span className=\"separator\"/>\n        <button disabled={!found} onClick={this.findPrev} title=\"Previous\"><span glyph=\"chevron-up\"/></button>\n        <button disabled={!found} onClick={this.findNext} title=\"Next\"><span glyph=\"chevron-down\"/></button>\n        <button onClick={this.hide} title=\"Close find bar\"><span glyph=\"remove\"/></button>\n      </div>\n    );\n  }\n}\n\nexport { SearchBox };\nexport default SearchBox;\n","import React from 'react';\n\nexport function withAsync(requests, Component, Loading, Error) {\n  const requestNames = Object.keys(requests);\n  return class WithAsync extends React.Component {\n    static displayName = `WithAsync(${Component.displayName || Component.name || \"Component\"})`\n\n    constructor(props, context) {\n      super(props, context);\n      const state = {};\n      requestNames.forEach(name => state[name] = {});\n      this.state = state;\n    }\n\n    setStateChecked(...args) {\n      if (!this.unmounted) {\n        this.setState(...args);\n      }\n    }\n\n    updateRequests(props, context) {\n      requestNames.forEach(name => {\n        const request = (typeof requests[name] === \"function\" ? requests[name](props, context) : requests[name]);\n        if (this.state[name].request !== request) {\n          if (request.then) {\n            this.setState({[name]: {request}}, () => {\n              request.then(result => this.setStateChecked(prevState => {\n                if (prevState[name].request === request) return {[name]: {request, result}};\n              }), error => this.setStateChecked(prevState => {\n                if (prevState[name].request === request) return {[name]: {request, error}};\n              }));\n            });\n          } else {\n            this.setState({[name]: {request, result: request}});\n          }\n        }\n      });\n    }\n\n    componentDidMount() {\n      this.updateRequests(this.props, this.context);\n    }\n    componentDidUpdate() {\n      this.updateRequests(this.props, this.context);\n    }\n\n    componentWillUnmount() {\n      this.unmounted = true;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n      return requestNames.some(name => \"error\" in nextState[name]) ||\n             requestNames.every(name => \"result\" in nextState[name]);\n    }\n\n    render() {\n      const success = {}, failure = {}, props = {...this.props};\n      let loaded = true, errors = false;\n      requestNames.forEach(name => {\n        delete props[name];\n        const data = this.state[name];\n        if (\"result\" in data) {\n          success[name] = data.result;\n        } else if (\"error\" in data) {\n          failure[name] = data.error;\n          errors = true;\n        } else {\n          loaded = false;\n        }\n      });\n      if (errors) {\n        return Error ? <Error {...props} {...failure}/> : null;\n      } else if (loaded) {\n        return <Component {...props} {...success}/>;\n      } else {\n        return Loading ? <Loading {...props}/> : null;\n      }\n    }\n  }\n}\n\nexport function withAsyncLoading(requests, Component, Error) {\n  return withAsync(requests, Component, Component, Error);\n}\n\nexport default withAsync;\n","class Cache {\n  constructor() {\n    this.cache = {};\n    this.counter = 0;\n    this.subs = [];\n  }\n  subscribe(func) {\n    this.subs.push(func);\n    func(this.counter);\n  }\n  unsubscribe(func) {\n    this.subs = this.subs.filter(f => f !== func);\n  }\n  _start() {\n    this.counter += 1;\n    this.subs.forEach(func => func(this.counter));\n  }\n  _stop() {\n    this.counter -= 1;\n    this.subs.forEach(func => func(this.counter));\n  }\n  fetch(url, opt) {\n    opt = opt || {};\n    const type = (opt.type || \"json\");\n    let curl = `${url}$${type}`;\n    if (opt.info) curl += \"$info\";\n    if (!opt.refresh && this.cache[curl]) return this.cache[curl];\n    const get = this.cache[curl] = fetch(url).then(response => {\n      if (response.ok) {\n        if (type === \"binary\") {\n          return response.arrayBuffer();\n        } else if (type === \"text\") {\n          return response.text();\n        } else {\n          if (!opt.info) {\n            let res = response.json();\n            if (opt.process) {\n              res = res.then(v => opt.process(v));\n            }\n            return res;\n          }\n          return response.text().then(text => ({\n            compressed: parseInt(response.headers.get(\"Content-Length\"), 10),\n            uncompressed: text.length,\n            json: JSON.parse(text)\n          }));\n        }\n      } else {\n        return response.json().then(err => Promise.reject(err));\n      }\n    });\n    if (opt.global) {\n      this._start();\n      get.then(() => this._stop(), () => this._stop());\n    }\n    return get;\n  }\n  refresh(url, opt) {\n    return this.fetch(url, {...opt, refresh: true});\n  }\n}\n\nexport { Cache };\nexport default Cache;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Route } from 'react-router-dom';\nimport { scrollIntoView } from './scrollIntoView';\n\nfunction scrollView(Component, params) {\n  const $history = \"$history\";\n  const $hash = \"$hash\";\n\n  class ScrollView extends React.Component {\n    static displayName = `ScrollView(${Component.displayName || Component.name || \"Component\"})`\n\n    onScroll = () => {\n      if (this.scrollTimeout) clearTimeout(this.scrollTimeout);\n      this.scrollTimeout = setTimeout(() => {\n        const history = this.props[$history];\n        if (this.node) history.replace(history.location.pathname + history.location.hash, {scrollTop: this.node.scrollTop});\n      }, 500);\n    }\n\n    nodeRef(node) {\n      node = ReactDOM.findDOMNode(node);\n      if (node === this.node) return;\n      if (this.node) this.node.removeEventListener(\"scroll\", this.onScroll);\n      this.node = node;\n      if (node) node.addEventListener(\"scroll\", this.onScroll);\n    }\n    nodeRefRef = node => {\n      if (this.props.nodeRef) this.props.nodeRef(node);\n      if (this.betterRef) return;\n      this.nodeRef(node);\n    }\n    nodeRefParam = node => {\n      if (!node) this.betterRef = false;\n      this.nodeRef(node);\n      if (node) this.betterRef = true;\n    }\n\n    onHashChanged(highlight, props) {\n      const { [$hash]: hash, onHashLink } = (props || this.props);\n      if (!hash) return false;\n      const element = document.getElementById(hash.substr(1));\n      if (!element) return false;\n      scrollIntoView(element);\n      if (highlight && onHashLink) onHashLink(element);\n      return true;\n    }\n    onParamsChanged() {\n      const state = this.props[$history].location.state;\n      if (this.node && state && state.scrollTop != null) {\n        this.node.scrollTop = state.scrollTop;\n      } else if (!this.onHashChanged(true) && this.node) {\n        this.node.scrollTop = 0;\n      }\n    }\n\n    componentDidMount() {\n      this.onParamsChanged();\n    }\n\n    shouldComponentUpdate(nextProps) {\n      if (Object.keys(nextProps).some(key => (\n        key !== $hash && key !== $history && key !== \"viewRef\" && nextProps[key] !== this.props[key]\n      ))) {\n        return true;\n      }\n      if (nextProps[$hash] !== this.props[$hash]) {\n        this.onHashChanged(false, nextProps);\n      }\n      return false;\n    }\n\n    componentDidUpdate(prevProps) {\n      if (params && params.some(key => this.props[key] !== prevProps[key])) {\n        this.onParamsChanged();\n      } else if (this.props[$hash] !== prevProps[$hash]) {\n        this.onHashChanged(false);\n      }\n    }\n  \n    render() {\n      const {[$history]: history, [$hash]: hash, nodeRef, onHashLink, ...props} = this.props;\n      return <Component ref={this.nodeRefRef} nodeRef={this.nodeRefParam} {...props}/>;\n    }\n  };\n\n  return props => <Route render={({location: {hash}, history}) => <ScrollView {...props} {...{[$hash]: hash, [$history]: history}}/>}/>;\n}\n\nexport { scrollView };\nexport default scrollView;\n","import React from 'react';\nimport { OverlayTrigger } from 'react-bootstrap';\n\nclass PopupWrap extends React.Component {\n  componentDidMount() {\n    this.props.setActive(true);\n  }\n  componentWillUnmount() {\n    this.props.setActive(false);\n  }\n  render() {\n    const {setActive, children, ...props} = this.props;\n    const child = React.Children.only(children);\n    return React.cloneElement(child, props);\n  }\n}\n\nexport default class OverlayNav extends React.Component {\n  state = {active: false}\n\n  setActive = active => this.setState({active})\n\n  render() {\n    const {children, overlay, ...props} = this.props;\n    const child = React.Children.only(children);\n    return (\n      <OverlayTrigger overlay={<PopupWrap setActive={this.setActive}>{overlay}</PopupWrap>} {...props}>\n        {React.cloneElement(child, {active: this.state.active})}\n      </OverlayTrigger>\n    )\n  }\n}\n\nexport { OverlayNav };\n","import React from 'react';\nimport { Route } from 'react-router-dom';\n\nconst $history = \"$history\";\n\nclass ScrollSaverComponent extends React.Component {\n  onScroll = scrollTop => {\n    if (this.scrollTimeout) {\n      clearTimeout(this.scrollTimeout);\n    }\n    this.scrollTimeout = setTimeout(() => {\n      delete this.scrollTimeout;\n      const history = this.props[$history];\n      history.replace(history.location.pathname + history.location.hash, {scrollTop});\n    }, 500);\n  }\n\n  componentDidMount() {\n    const state = this.props[$history].location.state;\n    if (state && state.scrollTop != null) {\n      this.props.callback(state.scrollTop);\n    }\n    if (this.props.onRef) {\n      this.props.onRef(this);\n    }\n  }\n  componentWillUnmount() {\n    if (this.props.onRef) {\n      this.props.onRef(null);\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nexport const ScrollSaver = props => <Route render={({history}) => <ScrollSaverComponent {...props} {...{[$history]: history}}/>}/>;\nexport default ScrollSaver;\n","export default function downloadBlob(blob, name) {\n  const url = URL.createObjectURL(blob);\n  const el = document.createElement(\"a\");\n  el.setAttribute(\"href\", url);\n  el.setAttribute(\"download\", name);\n  el.style.display = \"none\";\n  document.body.appendChild(el);\n  el.click();\n  setTimeout(() => {\n    document.body.removeChild(el);\n    URL.revokeObjectURL(url);\n  });\n}\n\nexport { downloadBlob };\n","let cryptTable = null;\n\nexport function pathHashTyped(name, hashType = 1) {\n  if (!cryptTable) {\n    cryptTable = new Uint32Array(1280);\n    let seed = 0x00100001;\n    for (let i = 0; i < 256; i++) {\n      for (let j = i; j < 1280; j += 256) {\n        seed = (seed * 125 + 3) % 0x2AAAAB;\n        const a = (seed & 0xFFFF) << 16;\n        seed = (seed * 125 + 3) % 0x2AAAAB;\n        const b = (seed & 0xFFFF);\n        cryptTable[j] = a | b;\n      }\n    }\n  }\n  let seed1 = 0x7FED7FED;\n  let seed2 = 0xEEEEEEEE;\n  for (let i = 0; i < name.length; ++i) {\n    let ch = name.charCodeAt(i);\n    if (ch >= 0x61 && ch <= 0x7A) {\n      ch -= 0x20;\n    }\n    if (ch === 0x2F) {\n      ch = 0x5C;\n    }\n    seed1 = cryptTable[hashType * 256 + ch] ^ (seed1 + seed2);\n    seed2 = (ch + seed1 + seed2 * 33 + 3) | 0;\n  }\n  return seed1;\n}\n\nexport default function pathHash(name, imExt) {\n  let m;\n  if (imExt && (m = name.match(/^(.*)\\.(?:blp|dds|gif|jpg|jpeg|png|tga)$/i))) {\n    name = m[1];\n  }\n  let delta = 0;\n  if (m = name.match(/^([A-Z])\\.w3mod:(.*)$/)) {\n    delta = m[1].charCodeAt(0) - 64;\n    name = m[2];\n  }\n  const u32 = new Uint32Array(2);\n  u32[0] = pathHashTyped(name, 1);\n  u32[1] = pathHashTyped(name, 2);\n  if (delta) {\n    let org = u32[0];\n    u32[0] += delta;\n    if (u32[0] < org) {\n      u32[1] += 1;\n    }\n  }\n  return u32;\n}\n\nexport function makeUid(id) {\n  return id[1].toString(16).padStart(8, '0') + id[0].toString(16).padStart(8, '0');\n}\n\nexport function parseUid(id) {\n  const u32 = new Uint32Array(2);\n  u32[0] = parseInt(id.substr(8, 8), 16);\n  u32[1] = parseInt(id.substr(0, 8), 16);\n  if (isNaN(u32[0]) || isNaN(u32[1])) {\n    return null;\n  }\n  return u32;\n}\n\nexport function equalUid(a, b) {\n  if (!a !== !b) return false;\n  if (!a) return true;\n  return a[0] === b[0] && a[1] === b[1];\n}\n","import LoaderBinary from './ArchiveLoader.wasm';\nimport LoaderModule from './ArchiveLoader.jscc';\nimport pathHash, { makeUid } from 'data/hash';\nimport encoding from 'text-encoding';\n\nclass ArchiveLoader {\n  images_ = {}\n\n  constructor(wasm) {\n    this.wasm = wasm;\n  }\n\n  fileId(name) {\n    if (typeof name === \"string\") {\n      return pathHash(name);\n    } else if (name != null && typeof name[0] === \"number\") {\n      return name;\n    } else {\n      return null;\n    }\n  }\n\n  hasFile(name) {\n    const id = this.fileId(name);\n    if (id == null) return false;\n    return this.wasm._hasFile(id[0], id[1]) !== 0;\n  }\n\n  loadBinary(name) {\n    const id = this.fileId(name);\n    if (id == null) return null;\n    let result = null;\n    window.postResult = buf => result = buf;\n    const res = this.wasm._loadFile(id[0], id[1], 1);\n    delete window.postResult;\n    if (!result) {\n      return null;\n    }\n    return {data: result, flags: res};\n  }\n\n  loadFile(name) {\n    const id = this.fileId(name);\n    if (id == null) return null;\n    let result = null;\n    window.postResult = buf => result = buf;\n    this.wasm._loadFile(id[0], id[1]);\n    delete window.postResult;\n    if (!result) {\n      return null;\n    }\n    return new encoding.TextDecoder().decode(result);\n  }\n\n  loadImage(name) {\n    const id = this.fileId(name);\n    if (id == null) return null;\n    const key = makeUid(id);\n\n    if (this.images_[key]) return this.images_[key];\n\n    let result = null;\n    window.postResult = buf => result = buf;\n    this.wasm._loadImage(id[0], id[1]);\n    delete window.postResult;\n    if (!result) {\n      return null;\n    }\n\n    const blob = new Blob([result], {type: \"image/png\"});\n    return this.images_[key] = URL.createObjectURL(blob);\n  }\n\n  loadJASS(options) {\n    options = options || {};\n    const opt = this.wasm._malloc(10);\n    const mem = this.wasm.HEAPU8;\n    mem[opt + 0] = options.indent || 0;\n    mem[opt + 1] = options.restoreInt || 0;\n    mem[opt + 2] = options.restoreId || 0;\n    mem[opt + 3] = options.insertLines || 0;\n    mem[opt + 4] = options.restoreStrings || 0;\n    mem[opt + 5] = options.renameGlobals || 0;\n    mem[opt + 6] = options.renameFunctions || 0;\n    mem[opt + 7] = options.renameLocals || 0;\n    mem[opt + 8] = options.inlineFunctions || 0;\n    mem[opt + 9] = options.getObjectName || 0;\n    let result = null;\n    window.postResult = buf => result = buf;\n    this.wasm._loadJASS(opt);\n    delete window.postResult;\n    this.wasm._free(opt);\n\n    if (!result) {\n      return null;\n    }\n\n    const lines = [];\n    const dec = new encoding.TextDecoder();\n    let prev = 0;\n    for (let i = 0; i < result.length; ++i) {\n      if (result[i] === 0) {\n        lines.push(dec.decode(result.subarray(prev, i)));\n        prev = i + 1;\n      }\n    }\n    return lines;\n  }\n}\n\nexport default function loadArchive(data) {\n  const u32 = new Uint32Array(data.buffer || data, 0, 1);\n  if (u32[0] !== 0x31585A47) {\n    return Promise.reject(\"Outdated archive format. Try parsing the map again.\");\n  }\n  return LoaderModule({\n    locateFile(name) {\n      if (name === \"ArchiveLoader.wasm\") {\n        return LoaderBinary;\n      } else {\n        return name;\n      }\n    }\n  }).then(wasm => {\n    const array = new Uint8Array(data);\n    const addr = wasm._malloc(array.length);\n    wasm.HEAPU8.set(array, addr);\n    wasm._openArchive(addr, array.length);\n    wasm._free(addr);\n\n    return new ArchiveLoader(wasm);\n  });\n}\n","import encoding from 'text-encoding';\nimport Worker from './parser.worker.js';\n\nconst parseMapPromise = (worker, meta, map, progress) => new Promise((resolve, reject) => {\n  worker.addEventListener(\"message\", e => {\n    if (e.data.progress) {\n      if (progress) progress(e.data.progress);\n    } else if (e.data.result) {\n      worker.terminate();\n      resolve(e.data.result);\n    } else {\n      let error = e.data.error;\n      if (error instanceof ArrayBuffer || ArrayBuffer.isView(error)) {\n        error = new encoding.TextDecoder().decode(error);\n      }\n      worker.terminate();\n      reject(error);\n    }\n  });\n  worker.postMessage({meta, map});\n});\n\nexport default class MapParser {\n  worker = new Worker();\n\n  onProgress = () => undefined;\n\n  async parse(meta, map) {\n    meta = await meta;\n    this.onProgress(0);\n    return await parseMapPromise(this.worker, meta, map, this.onProgress);\n  }\n\n  terminate() {\n    this.worker.terminate();\n  }\n}\n","let notifyComp = null;\nlet pendingNotify = null;\n\nexport function setNotifyComponent(comp) {\n  notifyComp = comp;\n  if (comp && pendingNotify) {\n    comp.setNotification(pendingNotify.message, pendingNotify.type);\n    pendingNotify = null;\n  }\n}\nexport function notifyMessage(message, type=\"info\") {\n  if (notifyComp) {\n    notifyComp.setNotification(message, type);\n  } else {\n    pendingNotify = {message, type};\n  }\n}\n","import React from 'react';\nimport { Cache } from 'utils';\nimport pathHash, { makeUid } from './hash';\nimport loadArchive from 'maps/archive';\nimport MapParser from 'maps/parser';\nimport { notifyMessage } from 'notify';\nimport IdbKvStore from 'idb-kv-store';\n\nconst postProcess = data => {\n  Object.values(data.objects).forEach(obj => {\n    const repl = {};\n    Object.keys(obj.data).forEach(key => repl[key.toLowerCase()] = obj.data[key]);\n    obj.data = repl;\n  });\n  return data;\n};\n\nconst readFile = file => new Promise((resolve, reject) => {\n  const reader = new FileReader();\n  reader.onload = () => resolve(reader.result);\n  reader.onerror = () => reject(reader.error);\n  reader.onabort = () => reject();\n  reader.readAsArrayBuffer(file);\n});\n\nclass BaseData {\n  constructor(cache, build, name) {\n    this.cache = cache;\n    this.id = build;\n    this.name = name;\n    this.core = true;\n  }\n\n  objects() {\n    return this.cache.fetch(`/api/${this.id}.json`, {global: true, process: postProcess});\n  }\n\n  listFile() {\n    return this.cache.fetch(`/api/rootlist.txt`, {global: true, type: \"text\"});\n  }\n\n  hasFile() {\n    return false;\n  }\n\n  file() {\n    return null;\n  }\n  binary() {\n    return null;\n  }\n  image(name) {\n    return this.cache.image(name);\n  }\n\n  jass() {\n    return null;\n  }\n\n  icon(id) {\n    return this.cache.icon(id);\n  }\n  iconByName(name) {\n    return this.cache.iconByName(name);\n  }\n}\n\nconst fileId = (name, imExt) => {\n  if (typeof name === \"string\") {\n    return pathHash(name, imExt);\n  } else if (name != null && typeof name[0] === \"number\") {\n    return name;\n  } else {\n    return null;\n  }\n};\n\nclass MapData {\n  files_ = {};\n  images_ = {};\n\n  constructor(cache, archive, id, name) {\n    this.cache = cache;\n    this.archive = archive;\n    this.id = id;\n    this.name = name.replace(/\\|(c[0-9a-fA-F]{6,8}|r)/g, \"\");\n    this.isMap = true;\n  }\n\n  objects() {\n    if (this.objects_) {\n      return this.objects_;\n    }\n    const text = this.archive.loadFile(\"objects.json\");\n    if (!text) {\n      const version = Math.max(...Object.keys(this.cache.versions));\n      const data = this.cache.data(version);\n      return this.objects_ = (data ? data.then(v => v.objects()) : Promise.resolve(null));\n    }\n    return this.objects_ = Promise.resolve(text ? postProcess(JSON.parse(text)) : null);\n  }\n\n  listFile() {\n    return this.file(\"listfile.txt\");\n  }\n\n  hasFile(name) {\n    return this.archive.hasFile(fileId(name));\n  }\n\n  file(name) {\n    if (this.files_.hasOwnProperty(name)) {\n      return this.files_[name];\n    }\n    return this.files_[name] = this.archive.loadFile(name);\n  }\n  binary(name) {\n    return this.archive.loadBinary(name);\n  }\n\n  jass(options) {\n    return this.archive.loadJASS(options);\n  }\n\n  image(name, tileset) {\n    return this.archive.loadImage(name) || this.cache.image(name, tileset);\n  }\n\n  icon(id) {\n    const image = this.archive.loadImage(id);\n    if (image) {\n      return {\n        backgroundImage: `url(${image})`,\n        backgroundSize: \"100%\",\n      };\n    } else {\n      return this.cache.icon(id);\n    }\n  }\n\n  iconByName(name) {\n    return this.icon(pathHash(name));\n  }\n}\n\nexport default class AppCache extends Cache {\n  static Context = React.createContext(null);\n  static DataContext = React.createContext(null);\n  static MapsContext = React.createContext({});\n\n  constructor(root) {\n    super();\n    this.root = root;\n\n    try {\n      this.dataStore = new IdbKvStore(\"mapData\");\n      this.nameStore = new IdbKvStore(\"mapNames\");\n    } catch (e) {\n      this.dataStore = null;\n      this.nameStore = null;\n    }\n\n    const proms = [\n      this.fetch('/api/images.dat', {type: \"binary\"}),\n      this.fetch('/api/versions.json'),\n    ];\n    if (this.nameStore) {\n      proms.push(this.nameStore.json());\n    }\n    this.ready = Promise.all(proms).then(([images, versions, names]) => {\n      this.icons_ = new Map();\n      const imageList = new Uint32Array(images);\n      for (let i = 0; i < imageList.length; i += 2) {\n        // this will cause precision loss but we have to deal with it\n        const uid = makeUid(imageList.subarray(i, i + 2));\n        this.icons_.set(uid, (i / 2) + 1000 * 256);\n      }\n  \n      this.versions = versions.versions;\n\n      if (names) {\n        this.maps = names;\n        this.root.forceUpdate();\n      }\n\n      if (versions.custom) {\n        this.custom = {};\n        this.customDesc = {};\n        Object.entries(versions.custom).forEach(([id, info]) => {\n          this.maps[id] = info.name;\n          this.custom[id] = info.data;\n          this.customDesc[id] = info.desc;\n        });\n      }\n    });\n  }\n\n  baseData_ = {};\n  mapNames_ = {};\n  mapData_ = {};\n  maps = {};\n\n  metaRaw() {\n    return this.fetch('/api/meta.gzx', {type: \"binary\", global: true});\n  }\n  meta() {\n    if (this.meta_) {\n      return this.meta_;\n    }\n    return this.meta_ = this.metaRaw().then(data => loadArchive(data));\n  }\n\n  isLocal(build) {\n    return !!(this.maps[build] && !this.custom[build]);\n  }\n\n  data(build) {\n    if (this.maps[build]) {\n      if (this.mapData_[build]) {\n        return this.mapData_[build];\n      }\n      if (this.custom && this.custom[build]) {\n        return this.mapData_[build] = this.fetch(`/api/${this.custom[build]}`, {type: \"binary\", global: true})\n          .then(data => loadArchive(data))\n          .then(arc => new MapData(this, arc, build, this.maps[build]));\n      } else {\n        return this.mapData_[build] = this.dataStore.get(build)\n          .then(blob => readFile(blob))\n          .then(data => loadArchive(data))\n          .then(arc => new MapData(this, arc, build, this.maps[build]))\n          .catch(err => Promise.reject(notifyMessage(err.toString(), \"danger\")));\n      }\n    } else if (this.versions[build]) {\n      if (this.baseData_[build]) {\n        return this.baseData_[build];\n      }\n      return this.baseData_[build] = Promise.resolve(new BaseData(this, build, this.versions[build]));\n    }\n    return null;\n  }\n  hasData(build) {\n    return !!(this.maps[build] || this.versions[build]);\n  }\n\n  icon(id) {\n    const index = this.icons_.get(makeUid(id));\n    if (index) {\n      const col = index % 16;\n      const row = ((index / 16) | 0) % 16;\n      const image = (index / 256) | 0;\n      return {\n        backgroundImage: `url(/api/icons${image}.png)`,\n        backgroundPosition: `-${col * 16}px -${row * 16}px`,\n      };\n    } else {\n      return null;\n    }\n  }\n  iconByName(name) {\n    return this.icon(pathHash(name));\n  }\n\n  image(name, tileset) {\n    let id = fileId(name, true);\n    const uid = makeUid(id);\n    let path = `/api/images/${uid}`;\n    if (tileset) {\n      path += `?tileset=${tileset}`;\n    }\n    return path;\n  }\n\n  binary(name, tileset) {\n    let id = fileId(name, true);\n    const uid = makeUid(id);\n    let path = `/api/files/${uid}`;\n    if (tileset) {\n      path += `?tileset=${tileset}`;\n    }\n    return path;\n  }\n\n  loadMap(file) {\n    this.abortMap();\n    const meta = this.metaRaw();\n    readFile(file).then(map => {\n      this.parser = new MapParser();\n      this.parser.onProgress = stage => this.root.onMapProgress(stage);\n      this.root.beginMapLoad(file.name);\n      this.parser.parse(meta, map)\n        .then(data => {\n          delete this.parser;\n\n          let id = 1;\n          while (this.maps.hasOwnProperty(`map${id}`)) {\n            id += 1;\n          }\n          id = `map${id}`;\n    \n          if (this.dataStore) {\n            Promise.all([\n              this.nameStore.set(id, file.name),\n              this.dataStore.set(id, new Blob([data], {type: \"application/octet-stream\"}))\n            ]).catch(() => {\n              this.nameStore.remove(id);\n              this.dataStore.remove(id);\n            });\n          }\n\n          this.maps = {...this.maps, [id]: file.name};\n          this.mapData_[id] = loadArchive(data).then(arc => new MapData(this, arc, id, file.name))\n            .catch(err => Promise.reject(notifyMessage(err.toString(), \"danger\")));\n\n          this.root.finishMapLoad(id);\n        })\n        .catch(err => {\n          delete this.parser;\n\n          this.root.failMapLoad(typeof err === \"string\" ? err : false);\n          console.error(err);\n        });\n    });\n  }\n  abortMap() {\n    if (this.parser) {\n      this.parser.terminate();\n      delete this.parser;\n    }\n  }\n\n  unloadMap(id) {\n    if (this.maps[id]) {\n      if (window.confirm(`Are you sure you want to unload ${this.maps[id]}?`)) {\n        this.maps = {...this.maps};\n        delete this.maps[id];\n        delete this.mapData_[id];\n        if (this.dataStore) {\n          this.dataStore.remove(id);\n          this.nameStore.remove(id);\n        }\n        this.root.forceUpdate();\n      }\n    }\n  }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst TitleContext = React.createContext(null);\n\nexport default class Title extends React.PureComponent {\n  static contextType = TitleContext;\n  static propTypes = {\n    title: PropTypes.string.isRequired,\n    combiner: PropTypes.func,\n  }\n  static defaultProps = {\n    combiner: (prev, current) => `${prev} - ${current}`,\n  }\n\n  children = []\n\n  componentDidMount() {\n    if (this.context) {\n      this.context.children.push(this);\n      this.context.updateTitle();\n    }\n  }\n  componentDidUpdate() {\n    this.updateTitle();\n  }\n  componentWillUnmount() {\n    if (this.context) {\n      let index = this.context.children.indexOf(this);\n      if (index >= 0) {\n        this.context.children.splice(index, 1);\n        if (index >= this.context.children.length) {\n          this.context.updateTitle();\n        }\n      }\n    }\n  }\n\n  updateTitle() {\n    let root = this;\n    while (root.context) {\n      root = root.context;\n    }\n    document.title = root.getTitle();\n  }\n  getTitle(prev) {\n    let {title, combiner} = this.props;\n    if (prev) {\n      title = combiner(prev, title);\n    }\n    if (this.children.length) {\n      title = this.children[this.children.length - 1].getTitle(title);\n    }\n    return title;\n  }\n\n  render() {\n    const {children} = this.props;\n    if (!children) {\n      return null;\n    }\n    return (\n      <TitleContext.Provider value={this}>\n        {children}\n      </TitleContext.Provider>\n    );\n  }\n}\n","import React from 'react';\n\nexport default class Options extends React.Component {\n  static Context = React.createContext({});\n\n  constructor(props) {\n    super(props);\n\n    const state = {};\n    if (window.localStorage) {\n      const value = window.localStorage.getItem(\"options\");\n      if (value) {\n        try {\n          Object.assign(state, JSON.parse(value));\n        } catch (e) {\n        }\n      }\n    }\n    state.update = (name, value) => this.setState({[name]: value});\n    this.state = state;\n  }\n\n  componentDidUpdate() {\n    if (window.localStorage) {\n      const opt = {...this.state};\n      delete opt.update;\n      window.localStorage.setItem(\"options\", JSON.stringify(opt));\n    }\n  }\n\n  render() {\n    return (\n      <Options.Context.Provider value={this.state}>\n        {this.props.children}\n      </Options.Context.Provider>\n    );\n  }\n}\n","export default {\n  \"unit\": \"Units\",\n  \"item\": \"Items\",\n  \"destructible\": \"Destructibles\",\n  \"doodad\": \"Doodads\",\n  \"ability\": \"Abilities\",\n  \"buff\": \"Buffs/Effects\",\n  \"upgrade\": \"Upgrades\",\n};\n","import React from 'react';\nimport { Route } from 'react-router-dom';\nimport { Nav, NavItem, NavDropdown, NavLink } from 'react-bootstrap';\nimport { LinkContainer } from 'react-router-bootstrap';\nimport './DataMenu.scss'\n\nimport AppCache from './data/cache';\nimport objectTypes from './objects/types';\n\nconst ObjectMenuInner = ({ match: { params: { build, type } } }) => (\n  <NavDropdown title={objectTypes[type] || \"Objects\"} active={objectTypes[type] != null} id=\"objects-menu\">\n    {Object.keys(objectTypes).map(t => (\n      <NavDropdown.Item key={t} href={`/${build}/${t}`}>\n        <LinkContainer to={`/${build}/${t}`}>\n          <NavItem event-key={`objects.${t}`}>\n            <span className={`ObjectIcon ${t}`} />{objectTypes[t]}\n          </NavItem>\n        </LinkContainer>\n      </NavDropdown.Item>\n    ))}\n  </NavDropdown>\n);\n\nconst ObjectMenu = () => <Route path=\"/:build/:type?\" component={ObjectMenuInner} />;\n\n// const DataMenu = () => (\n//   <AppCache.DataContext.Consumer>\n//     {data => (\n//       <Nav>\n//         <LinkContainer to={`/${data.id}`} exact>\n//           <NavItem event-key=\"build\">{data.name}</NavItem>\n//         </LinkContainer>\n//         <LinkContainer to={`/${data.id}/files`}>\n//           <NavItem event-key=\"files\">Files</NavItem>\n//         </LinkContainer>\n//         {(!data.isMap || data.hasFile(\"objects.json\")) && <ObjectMenu />}\n//         {(!!data.isMap) && (\n//           <LinkContainer to={`/${data.id}/map`}>\n//             <NavItem event-key=\"map\">Map</NavItem>\n//           </LinkContainer>\n//         )}\n//         {(data.hasFile(\"war3map.j\") || data.hasFile(\"Scripts\\\\war3map.j\")) && (\n//           <LinkContainer to={`/${data.id}/script`}>\n//             <NavItem event-key=\"script\">Script</NavItem>\n//           </LinkContainer>\n//         )}\n//       </Nav>\n//     )}\n//   </AppCache.DataContext.Consumer>\n// );\nconst DataMenu2 = () => (\n  <AppCache.DataContext.Consumer>\n    {data => (\n      <React.Fragment>\n        <ul className='DataMenu'>\n          <LinkContainer className='title' to={`/${data.id}`} exact>\n            <li><NavLink event-key=\"build\">{data.name}</NavLink></li>\n          </LinkContainer>\n          <li>\n            <LinkContainer to={`/${data.id}/files`}>\n              <NavLink event-key=\"files\">Files</NavLink>\n            </LinkContainer>\n          </li>\n          {(!data.isMap || data.hasFile(\"objects.json\")) &&\n            <React.Fragment>\n              <li className='sep'> | </li>\n              <li > <ObjectMenu /></li>\n            </React.Fragment>\n          }\n          {(!!data.isMap) && (\n            <React.Fragment>\n              <li className='sep'> | </li>\n              <li> <LinkContainer to={`/${data.id}/map`}>\n                <NavLink event-key=\"map\">Map</NavLink>\n              </LinkContainer>\n              </li>\n            </React.Fragment>\n          )}\n          {(data.hasFile(\"war3map.j\") || data.hasFile(\"Scripts\\\\war3map.j\")) && (\n            <React.Fragment>\n              <li className='sep'> | </li>\n              <li> <LinkContainer to={`/${data.id}/script`}>\n                <NavLink event-key=\"script\">Script</NavLink>\n              </LinkContainer>\n              </li>\n            </React.Fragment>\n          )}\n        </ul>\n      </React.Fragment>\n    )}\n  </AppCache.DataContext.Consumer >\n);\n\nexport default DataMenu2;\n","import React from 'react';\nimport AppCache from 'data/cache';\n\nexport const RawNames = React.createContext(false);\nexport const SortNames = React.createContext(true);\nexport const BuildCtx = React.createContext(0);\nexport const TypeCtx = React.createContext(\"\");\nexport const IdCtx = React.createContext(\"\");\nexport const RawNamesSwitch = React.createContext(undefined); \n\nexport const ObjectIcon = ({object}) => (\n  <AppCache.DataContext.Consumer>\n    {cache => {\n      if (!object || object.icon == null) {\n        return null;\n      }\n      const icon = cache.icon(object.icon);\n      return <span className=\"Icon\" style={icon}/>;\n    }}\n  </AppCache.DataContext.Consumer>\n);\n\nexport function nextComma(str, c) {\n  if (c >= str.length) return -1;\n  let instr = false;\n  for (++c; c < str.length; ++c) {\n    if (str[c] === '\"') {\n      instr = !instr;\n    }\n    if (str[c] === ',' && !instr) {\n      return c;\n    }\n  }\n  return c;\n}\n\nexport const UpgradeData = {\n  \"atdb\": \"Attack Dice Bonus - Base\",\n  \"atdm\": \"Attack Dice Bonus - Increment\",\n  \"levb\": \"Ability Level Bonus - Base\",\n  \"levm\": \"Ability Level Bonus - Increment\",\n  \"levc\": \"Ability Affected\",\n  \"hpxb\": \"Hit Point Bonus - Base\",\n  \"hpxm\": \"Hit Point Bonus - Increment\",\n  \"mnxb\": \"Mana Point Bonus - Base\",\n  \"mnxm\": \"Mana Point Bonus - Increment\",\n  \"mvxb\": \"Movement Speed Bonus - Base\",\n  \"mvxm\": \"Movement Speed Bonus - Increment\",\n  \"mnrb\": \"Mana Regeneration Bonus (%) - Base\",\n  \"mnrm\": \"Mana Regeneration Bonus (%) - Increment\",\n  \"hpob\": \"Hit Point Bonus (%) - Base\",\n  \"hpom\": \"Hit Point Bonus (%) - Increment\",\n  \"manb\": \"Mana Point Bonus (%) - Base\",\n  \"manm\": \"Mana Point Bonus (%) - Increment\",\n  \"movb\": \"Movement Speed Bonus (%) - Base\",\n  \"movm\": \"Movement Speed Bonus (%) - Increment\",\n  \"atxb\": \"Attack Damage Bonus - Base\",\n  \"atxm\": \"Attack Damage Bonus - Increment\",\n  \"lumb\": \"Lumber Harvest Bonus - Base\",\n  \"lumm\": \"Lumber Harvest Bonus - Increment\",\n  \"atrb\": \"Attack Range Bonus - Base\",\n  \"atrm\": \"Attack Range Bonus - Increment\",\n  \"atsb\": \"Attack Speed Bonus (%) - Base\",\n  \"atsm\": \"Attack Speed Bonus (%) - Increment\",\n  \"spib\": \"Spike Damage - Base\",\n  \"spim\": \"Spike Damage - Increment\",\n  \"hprb\": \"Hit Point Regeneration Bonus (%) - Base\",\n  \"hprm\": \"Hit Point Regeneration Bonus (%) - Increment\",\n  \"sigb\": \"Sight Range Bonus - Base\",\n  \"sigm\": \"Sight Range Bonus - Increment\",\n  \"atcb\": \"Attack Target Count Bonus - Base\",\n  \"atcm\": \"Attack Target Count Bonus - Increment\",\n  \"adlb\": \"Attack Damage Loss Bonus - Base\",\n  \"adlm\": \"Attack Damage Loss Bonus - Increment\",\n  \"minb\": \"Gold Harvest Bonus - Base\",\n  \"minm\": \"Gold Harvest Bonus - Increment\",\n  \"raib\": \"Raise Dead Duration Bonus - Base\",\n  \"raim\": \"Raise Dead Duration Bonus - Increment\",\n  \"entb\": \"Gold Harvest Bonus (Entangle) - Base\",\n  \"entm\": \"Gold Harvest Bonus (Entangle) - Increment\",\n  \"enwb\": \"Attacks to Enable\",\n  \"audb\": \"Aura Data Bonus - Base\",\n  \"audm\": \"Aura Data Bonus - Increment\",\n  \"asdb\": \"Attack Spill Distance Bonus - Base\",\n  \"asdm\": \"Attack Spill Distance Bonus - Increment\",\n  \"asrb\": \"Attack Spill Radius Bonus - Base\",\n  \"asrm\": \"Attack Spill Radius Bonus - Increment\",\n  \"roob\": \"Attacks to Enable (Rooted)\",\n  \"urob\": \"Attacks to Enable (Uprooted)\",\n  \"uart\": \"New Defense Type\",\n  \"utma\": \"New Availability\",\n  \"ttma\": \"Unit Type Affected\",\n};\n\nexport const TileSets = {\n  \"A\": \"Ashenvale\",\n  \"B\": \"Barrens\",\n  \"K\": \"Black Citadel\",\n  \"Y\": \"Cityscape\",\n  \"X\": \"Dalaran\",\n  \"J\": \"Dalaran Ruins\",\n  \"D\": \"Dungeon\",\n  \"C\": \"Felwood\",\n  \"I\": \"Icecrown Glacier\",\n  \"F\": \"Lordaeron Fall\",\n  \"L\": \"Lordaeron Summer\",\n  \"W\": \"Lordaeron Winter\",\n  \"N\": \"Northrend\",\n  \"O\": \"Outland\",\n  \"Z\": \"Sunken Ruins\",\n  \"G\": \"Underground\",\n  \"V\": \"Village\",\n  \"Q\": \"Village Fall\",\n  \"*\": \"All\",\n};\nexport const DestructableCategory = {\n  \"D\": \"Trees/Destructibles\",\n  \"P\": \"Pathing Blockers\",\n  \"B\": \"Bridges/Ramps\",\n};\nexport const DoodadCategory = {\n  \"O\": \"Props\",\n  \"S\": \"Structures\",\n  \"W\": \"Water\",\n  \"C\": \"Cliff/Terrain\",\n  \"E\": \"Environment\",\n  \"Z\": \"Cinematic\",\n};\nexport const TechList = {\n  \"HERO\": \"Any Hero\",\n  \"TALT\": \"Any Altar\",\n  \"TWN1\": \"Any Tier 1 Hall\",\n  \"TWN2\": \"Any Tier 2 Hall\",\n  \"TWN3\": \"Any Tier 3 Hall\",\n  \"TWN4\": \"Any Tier 4 Hall\",\n  \"TWN5\": \"Any Tier 5 Hall\",\n  \"TWN6\": \"Any Tier 6 Hall\",\n  \"TWN7\": \"Any Tier 7 Hall\",\n  \"TWN8\": \"Any Tier 8 Hall\",\n  \"TWN9\": \"Any Tier 9 Hall\",\n};\n\nexport function getString(object, col, index=-1) {\n  const text = object.data[col.toLowerCase()] || \"\";\n  if (index < 0) {\n    const cmp = nextComma(text, -1);\n    if (cmp >= 2 && cmp >= text.length && text[0] === '\"' && text[cmp - 1] === '\"') {\n      return text.substr(1, cmp - 2);\n    } else {\n      return text;\n    }\n  } else {\n    let pos = -1;\n    let cur = 0;\n    let prev = 0;\n    while ((pos = nextComma(text, pos)) >= 0) {\n      if (cur === index) {\n        if (pos - prev >= 2 && text[prev] === '\"' && text[pos - 1] === '\"') {\n          return text.substr(prev + 1, pos - prev - 2);\n        } else {\n          return text.substr(prev, pos - prev);\n        }\n      }\n      prev = pos + 1;\n      cur++;\n    }\n    return \"\";\n  }\n}\n\nexport function listObjectData(object, data, rawNames, callback) {\n  const type = object.type === \"item\" ? \"unit\" : object.type;\n  const meta = data.meta[type] || [];\n\n  const getName = meta => {\n    if (object.type !== \"upgrade\") return meta.display;\n    const m = meta.field.match(/^(base|mod|code)(\\d)$/);\n    if (!m) return meta.display;\n    const effect = object.data[`effect${m[2]}`] || \"\";\n    const m2 = effect.match(/^r([a-z][a-z][a-z])$/);\n    if (!m2) return null;\n    const name = UpgradeData[m2[1] + m[1][0]];\n    if (!name) return null;\n    return meta.display.replace(\"%s\", name);\n  };\n\n  const getInt = col => {\n    col = col.toLowerCase();\n    return object.data[col] && (parseInt(object.data[col], 10) || 0);\n  }\n\n  let use = 0;\n  let levels = 0;\n  switch (object.type) {\n  case \"unit\":\n    if (getInt(\"isbldg\")) {\n      use = 4;\n    } else if (object.id.match(/^[A-Z]/)) {\n      use = 2;\n    } else {\n      use = 1;\n    }\n    break;\n  case \"item\":\n    use = 8;\n    break;\n  case \"ability\":\n    levels = getInt(\"levels\");\n    if (object.data.code) {\n      callback(\"code\", rawNames ? \"code\" : \"Ability Code\", object.data.code, {type: \"abilCode\"});\n    }\n    break;\n  case \"doodad\":\n    levels = getInt(\"numVar\");\n    break;\n  case \"upgrade\":\n    levels = getInt(\"maxlevel\");\n    break;\n  default:\n  }\n\n  const metaNames = new Map();\n  meta.forEach(row => metaNames.set(row, getName(row)));\n  meta.filter(row => metaNames.get(row)).sort((a, b) => {\n    if ((a.flags & 16) !== (b.flags & 16)) return (a.flags & 16) - (b.flags & 16);\n    if (a.category !== b.category) return data.categories[a.category].localeCompare(data.categories[b.category]);\n    return metaNames.get(a).localeCompare(metaNames.get(b));\n  }).forEach(row => {\n    if ((row.flags & use) !== use) {\n      return;\n    }\n    if (row.specific && row.specific.indexOf(object.type === \"ability\" ? object.data.code : object.id) < 0) {\n      return;\n    }\n\n    if ((row.flags & 16) && !levels) {\n      return;\n    }\n\n    let field = row.field;\n    if (row.data) {\n      field += String.fromCharCode(65 + row.data - 1);\n    }\n    if (row.flags & 16) {\n      for (let i = 0; i < levels; ++i) {\n        let fname = field;\n        if (row.index < 0) {\n          if (row.flags & 32) {\n            if (i > 0) fname += i;\n          } else {\n            fname += (i + 1);\n          }\n        }\n        const value = (row.index < 0 ? getString(object, fname, -1) : getString(object, field, i));\n        callback(`${field}${i}`, rawNames ? fname : `Level ${i + 1} - ${data.categories[row.category]} - ${metaNames.get(row)}`, value, row);\n      }\n    } else {\n      const value = getString(object, field, row.index);\n      callback(`${field}${row.index}`, rawNames ? field : `${data.categories[row.category]} - ${metaNames.get(row)}`, value, row);\n    }\n  });\n};\n\nconst ObjectFilters = {};\n\nObjectFilters.unit = [\n  {\n    name: obj => obj.base ? \"Custom Units\" : \"Standard Units\",\n    order: [\"Standard Units\", \"Custom Units\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.race) {\n      case \"human\": return \"Human\";\n      case \"orc\": return \"Orc\";\n      case \"undead\": return \"Undead\";\n      case \"nightelf\": return \"Night Elf\";\n      case \"naga\": return \"Neutral - Naga\";\n      default:\n        if (parseInt(obj.data.hostilepal, 10)) {\n          return \"Neutral Hostile\";\n        } else {\n          return \"Neutral Passive\";\n        }\n      }\n    },\n    order: [\"Human\", \"Orc\", \"Undead\", \"Night Elf\", \"Neutral - Naga\", \"Neutral Hostile\", \"Neutral Passive\"],\n  },\n  {\n    name: obj => parseInt(obj.data.campaign, 10) ? \"Campaign\" : \"Melee\",\n    order: [\"Melee\", \"Campaign\"],\n  },\n  {\n    name: obj => {\n      if (parseInt(obj.data.special, 10)) {\n        return \"Special\";\n      } else if (parseInt(obj.data.isbldg, 10)) {\n        return \"Buildings\";\n      } else if (obj.id.match(/^[A-Z]/)) {\n        return \"Heroes\";\n      } else {\n        return \"Units\";\n      }\n    },\n    order: [\"Units\", \"Buildings\", \"Heroes\", \"Special\"],\n  },\n];\n\nObjectFilters.item = [\n  {\n    name: obj => obj.base ? \"Custom Items\" : \"Standard Items\",\n    order: [\"Standard Items\", \"Custom Items\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.class) {\n      case \"PowerUp\": return \"Power Up\";\n      default: return obj.data.class;\n      }\n    },\n    order: [\"Permanent\", \"Charged\", \"Power Up\", \"Artifact\", \"Purchasable\", \"Campaign\", \"Miscellaneous\"],\n  },\n];\n\nObjectFilters.destructible = [\n  {\n    name: obj => obj.base ? \"Custom Destructibles\" : \"Standard Destructibles\",\n    order: [\"Standard Destructibles\", \"Custom Destructibles\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.category) {\n      case \"D\": return \"Trees/Destructibles\";\n      case \"P\": return \"Pathing Blockers\";\n      case \"B\": return \"Bridges/Ramps\";\n      default: return \"Others\";\n      }\n    },\n    order: [\"Trees/Destructibles\", \"Pathing Blockers\", \"Bridges/Ramps\", \"Others\"],\n  },\n];\n\nObjectFilters.doodad = [\n  {\n    name: obj => obj.base ? \"Custom Doodads\" : \"Standard Doodads\",\n    order: [\"Standard Doodads\", \"Custom Doodads\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.category) {\n      case \"O\": return \"Props\";\n      case \"S\": return \"Structures\";\n      case \"W\": return \"Water\";\n      case \"C\": return \"Cliff/Terrain\";\n      case \"E\": return \"Environment\";\n      case \"Z\": return \"Cinematic\";\n      default: return \"Others\";\n      }\n    },\n    order: [\"Props\", \"Structures\", \"Water\", \"Cliff/Terrain\", \"Environment\", \"Cinematic\", \"Others\"],\n  },\n];\n\nObjectFilters.ability = [\n  {\n    name: obj => obj.base ? \"Custom Abilities\" : \"Standard Abilities\",\n    order: [\"Standard Abilities\", \"Custom Abilities\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.race) {\n      case \"human\": return \"Human\";\n      case \"orc\": return \"Orc\";\n      case \"undead\": return \"Undead\";\n      case \"nightelf\": return \"Night Elf\";\n      case \"creeps\": return \"Neutral Hostile\";\n      case \"naga\": return \"Neutral Passive\";\n      case \"demon\": return \"Neutral Passive\";\n      default: return \"Special\";\n      }\n    },\n    order: [\"Human\", \"Orc\", \"Undead\", \"Night Elf\", \"Neutral Hostile\", \"Neutral Passive\", \"Special\"],\n  },\n  {\n    name: obj => {\n      if (parseInt(obj.data.hero, 10)) {\n        return \"Heroes\";\n      } else if (parseInt(obj.data.item, 10)) {\n        return \"Items\";\n      } else {\n        return \"Units\";\n      }\n    },\n    order: [\"Units\", \"Heroes\", \"Items\"],\n  },\n];\n\nObjectFilters.buff = [\n  {\n    name: obj => obj.base ? \"Custom Buffs/Effects\" : \"Standard Buffs/Effects\",\n    order: [\"Standard Buffs/Effects\", \"Custom Buffs/Effects\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.race) {\n      case \"human\": return \"Human\";\n      case \"orc\": return \"Orc\";\n      case \"undead\": return \"Undead\";\n      case \"nightelf\": return \"Night Elf\";\n      default: return \"Special\";\n      }\n    },\n    order: [\"Human\", \"Orc\", \"Undead\", \"Night Elf\", \"Special\"],\n  },\n  {\n    name: obj => {\n      if (parseInt(obj.data.isEffect, 10)) {\n        return \"Effect\";\n      } else {\n        return \"Buff\";\n      }\n    },\n    order: [\"Buff\", \"Effect\"],\n  },\n];\n\nObjectFilters.upgrade = [\n  {\n    name: obj => obj.base ? \"Custom Upgrades\" : \"Standard Upgrades\",\n    order: [\"Standard Upgrades\", \"Custom Upgrades\"],\n  },\n  {\n    name: obj => {\n      switch (obj.data.race) {\n      case \"human\": return \"Human\";\n      case \"orc\": return \"Orc\";\n      case \"undead\": return \"Undead\";\n      case \"nightelf\": return \"Night Elf\";\n      default: return \"Special\";\n      }\n    },\n    order: [\"Human\", \"Orc\", \"Undead\", \"Night Elf\", \"Special\"],\n  },\n];\n\nexport { ObjectFilters };\n","import React from 'react';\nimport encoding from 'text-encoding';\nimport { Modal, Button, FormGroup, FormLabel, FormControl,FormCheck } from 'react-bootstrap';\nimport objectTypes from './types';\nimport { listObjectData, TileSets, DestructableCategory, DoodadCategory, TechList } from './ObjectCtx';\nimport { downloadBlob } from 'utils';\nimport Options from 'data/options';\n\nclass DataCompiler {\n  constructor(type, json, names) {\n    this.type = type;\n    this.json = json;\n    this.names = names;\n\n    if (this.json) {\n      this.outJs = {};\n    } else {\n      this.outLines = [];\n    }\n  }\n\n  onObject(id) {\n    if (this.json) {\n      this.curJs = {};\n      this.outJs[id] = this.curJs;\n    } else {\n      this.outLines.push(`[${id}]`);\n    }\n  }\n\n  onValue(key, value) {\n    if (this.json) {\n      this.curJs[key] = value;\n    } else {\n      this.outLines.push(`${key}=${value}`);\n    }\n  }\n\n  translateSub(value, meta, data) {\n    let type = meta.type;\n    if (type === \"lightningList\") {\n      type = \"lightningEffect\";\n    }\n    if (data.types[type]) {\n      if (!value || value === \"_\") return \"None\";\n      return data.types[type][value] || \"value\";\n    }\n    switch (type) {\n    case \"bool\": return parseInt(value, 10) ? \"True\" : \"False\";\n    case \"string\": return value === \"_\" ? \"\" : value;\n    case \"char\": return value;\n    case \"int\": return parseInt(value, 10) || 0;\n    case \"real\":\n    case \"unreal\": return (parseFloat(value) || 0).toFixed(meta.stringExt || 2);\n    case \"destructableCategory\": return DestructableCategory[value] || value;\n    case \"tilesetList\": return TileSets[value] || value;\n    case \"doodadCategory\": return DoodadCategory[value] || value;\n  \n    case \"techList\":\n      if (TechList[value]) return TechList[value];\n      // fall through\n    case \"buffCode\": case \"buffList\":\n    case \"effectCode\": case \"effectList\":\n    case \"unitCode\": case \"unitList\":\n    case \"abilCode\": case \"abilityList\": case \"heroAbilityList\":\n    case \"itemCode\": case \"itemList\":\n    case \"upgradeCode\": case \"upgradeList\":\n      if (value === \"_\") return \"\";\n      const obj = data.objects.find(obj => obj.id === value);\n      return obj ? obj.name : value;\n    default:\n      return value !== \"_\" && (value || \"None\");\n    }\n  }\n\n  translate(value, meta, data) {\n    if (meta.type.indexOf(\"List\") >= 0) {\n      if (value === \"_\" || value === \"\") {\n        return \"\";\n      }\n      return value.split(\",\").map(part => this.translateSub(part, meta, data)).join(\", \");\n    } else if (meta.type.indexOf(\"Flags\") >= 0) {\n      const iValue = parseInt(value, 10);\n      return [...Array(31)].map((v, i) => i).filter(i => ((1 << i) & iValue) !== 0).map(flag => this.translateSub(flag, meta, data)).join(\", \");\n    } else if (meta.type === \"string\") {\n      if (value === \"_\") {\n        return \"\";\n      }\n      return value;\n    } else {\n      return this.translateSub(value, meta, data);\n    }\n  }\n\n  processObject(obj, data) {\n    this.onObject(obj.id);\n    if (this.names < 2) {\n      listObjectData(obj, data, this.names === 1, (key, name, value, meta) => {\n        if (this.names === 0) {\n          value = this.translate(value, meta, data);\n        }\n        this.onValue(name, value);\n      });\n    } else {\n      Object.keys(obj.data).sort().forEach(key => this.onValue(key, obj.data[key]));\n    }\n  }\n\n  process(data) {\n    data.objects.forEach(obj => {\n      if (this.type !== \"all\" && this.type !== obj.type) {\n        return;\n      }\n      this.processObject(obj, data);\n    });\n  }\n  processSingle(data) {\n    const obj = this.type === \"all\" ? data.objects[0] : data.objects.find(obj => obj.type === this.type);\n    if (obj) {\n      this.processObject(obj, data);\n    }\n  }\n\n  get output() {\n    if (this.json === 0) {\n      return this.outLines.join(\"\\r\\n\");\n    } else if (this.json === 1) {\n      return JSON.stringify(this.outJs).replace(/\\n/g, \"\\r\\n\");\n    } else {\n      return JSON.stringify(this.outJs, null, 2).replace(/\\n/g, \"\\r\\n\");\n    }\n  }\n\n  get preview() {\n    let out;\n    if (this.json === 0) {\n      out = this.outLines.join(\"\\n\");\n    } else if (this.json === 1) {\n      out = JSON.stringify(this.outJs);\n    } else if (this.json === 2) {\n      out = JSON.stringify(this.outJs, null, 2);\n    }\n    return out.slice(0, 1000);\n  }\n}\n\nexport default class DataDownload extends React.PureComponent {\n  static contextType = Options.Context;\n  static defaultState = {type: \"all\", json: 0, names: 0};\n  state = {}\n\n  get options() {\n    return this.context.dataDownload || DataDownload.defaultState;\n  }\n  setOption = (name, value) => {\n    const opt = {...this.options};\n    opt[name] = value;\n    this.context.update(\"dataDownload\", opt);\n  }\n\n  componentDidUpdate() {\n    if (this.props.show !== this.state.show) {\n      this.setState({show: this.props.show}, () => this.setOption(\"type\", this.props.show));\n    }\n  }\n\n  setType = e => this.setOption(\"type\", e.target.value);\n\n  onDownload = () => {\n    const { type, json, names } = this.options;\n\n    const comp = new DataCompiler(type, json, names);\n    comp.process(this.props.data);\n\n    const encoded = new encoding.TextEncoder().encode(comp.output);\n    const blob = new Blob([encoded], {type: \"text/plain\"});\n    downloadBlob(blob, type + \".txt\");\n\n    this.props.onHide();\n  }\n\n  render() {\n    const { show, onHide } = this.props;\n    const { type, json, names } = this.options;\n\n    const comp = new DataCompiler(type, json, names);\n    comp.processSingle(this.props.data);\n\n    return (\n      <Modal show={!!show} onHide={onHide}>\n        <Modal.Header closeButton>\n          <Modal.Title>Download data</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <form>\n            <FormGroup controlId=\"formType\">\n              <FormLabel>Object type</FormLabel>\n              <FormControl componentClass=\"select\" value={type} onChange={this.setType}>\n                {Object.keys(objectTypes).map(t => <option key={t} value={t}>{objectTypes[t]}</option>)}\n                <option value=\"all\">All (Combined)</option>\n              </FormControl>\n            </FormGroup>\n            <FormGroup>\n              <FormCheck name=\"json\" inline checked={json === 0} onChange={() => this.setOption(\"json\", 0)}>\n                Text\n              </FormCheck>{' '}\n              <FormCheck name=\"json\" inline checked={json === 1} onChange={() => this.setOption(\"json\", 1)}>\n                JSON\n              </FormCheck>\n              <FormCheck name=\"json\" inline checked={json === 2} onChange={() => this.setOption(\"json\", 2)}>\n                Indented JSON\n              </FormCheck>\n            </FormGroup>\n            <FormGroup>\n              <FormCheck name=\"names\" inline checked={names === 0} onChange={() => this.setOption(\"names\", 0)}>\n                Editor names\n              </FormCheck>{' '}\n              <FormCheck name=\"names\" inline checked={names === 1} onChange={() => this.setOption(\"names\", 1)}>\n                Code names\n              </FormCheck>\n              <FormCheck name=\"names\" inline checked={names === 2} onChange={() => this.setOption(\"names\", 2)}>\n                Raw data\n              </FormCheck>\n            </FormGroup>\n          </form>\n          <div className=\"dataPreview\">\n            {comp.preview}\n          </div>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button bsStyle=\"info\" onClick={this.onDownload}>Download</Button>\n          <Button onClick={onHide}>Cancel</Button>\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n}\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport classNames from 'classnames';\nimport { RawNames, RawNamesSwitch, SortNames, BuildCtx, TypeCtx, IdCtx, ObjectFilters, ObjectIcon } from './ObjectCtx';\nimport { FormControl, Button, Glyphicon } from 'react-bootstrap';\nimport { AutoSizer, List } from 'react-virtualized';\nimport DataDownload from './DataDownload';\n\nimport Panel from 'react-flex-panel';\n\nimport './ObjectList.scss';\n\nconst ObjectName = ({ object }) => (\n  <RawNames.Consumer>\n    {raw => {\n      if (raw) {\n        if (object.base) {\n          return `${object.id}:${object.base} (${object.name})`;\n        } else {\n          return `${object.id} (${object.name})`;\n        }\n      } else {\n        return object.name;\n      }\n    }}\n  </RawNames.Consumer>\n);\n\nconst ObjectLink = ({ object }) => (\n  <BuildCtx.Consumer>\n    {build => (\n      <TypeCtx.Consumer>\n        {type => (\n          <IdCtx.Consumer>\n            {id => (\n              <Link to={`/${build}/${type}/${object.id}`}\n                className={classNames(\"ObjectLink\", { selected: id === object.id, searched: object.searched })}>\n                <ObjectIcon object={object} />\n                <span className=\"ObjectName\"><ObjectName object={object} /></span>\n              </Link>\n            )}\n          </IdCtx.Consumer>\n        )}\n      </TypeCtx.Consumer>\n    )}\n  </BuildCtx.Consumer>\n);\n\nclass ObjectItem {\n  constructor(object, parent) {\n    this.object = object;\n    this.object.parent = this;\n    this.object.upVisit = (fn) => {\n      fn(this.object);\n      this.object.parent.upVisit(fn);\n    }\n    this.parent = parent;\n  }\n  height = 1;\n  upVisit(fn) {\n    fn(this);\n    this.parent.upVisit(fn);\n  }\n  downVisit(fn) {\n    fn(this);\n    fn(this.object);\n  }\n  render() {\n    return <ObjectLink object={this.object} />;\n  }\n  renderLine(index) {\n    return this.render();\n  }\n}\n\nclass ObjectGroup {\n  constructor(objects, filters, parent, title) {\n    this.parent = parent;\n    this.level = (parent ? parent.level + 1 : 0);\n    this.count = objects.length;\n    this._title = title;\n    if (title) {\n      this.title = `${title} (${this.count})`;\n    }\n\n    if (filters && filters.length) {\n      this.filter = filters[0];\n      const subs = {};\n      objects.forEach(obj => {\n        const cat = filters[0].name(obj);\n        subs[cat] = (subs[cat] || []);\n        subs[cat].push(obj);\n      });\n      const rest = filters.slice(1);\n      this.childrenByName = {};\n      this.children = filters[0].order.filter(cat => !parent || subs[cat]).map(cat => {\n        return this.childrenByName[cat] = new ObjectGroup(subs[cat] || [], rest, this, cat);\n      });\n    } else {\n      this.children = objects.map(obj => new ObjectItem(obj, this)).sort((a, b) => a.object.name.localeCompare(b.object.name));\n    }\n    this.openHeight = parent ? 1 : 0;\n    this.children.forEach(c => {\n      c.top = this.openHeight;\n      this.openHeight += c.height;\n    });\n    if (!parent) {\n      this.expanded = true;\n    } else if (this.level > 1) {\n      this.expanded = false;\n    } else {\n      this.expanded = this.count > 0;\n    }\n  }\n  upVisit(fn) {\n    fn(this);\n    this.parent && this.parent.upVisit(fn);\n  }\n  downVisit(fn) {\n    fn(this);\n    this.children.forEach(x => x.downVisit(fn));\n\n  }\n  modHeight(delta, child) {\n    let index = child ? this.children.indexOf(child) : -1;\n    if (index >= 0) {\n      while (++index < this.children.length) {\n        this.children[index].top += delta;\n      }\n    }\n    this.openHeight += delta;\n    if (this.parent && this.expanded) {\n      this.parent.modHeight(delta, this);\n    } else if (this.onResize) {\n      this.onResize(this.height);\n    }\n  }\n\n  get height() {\n    return this.expanded ? this.openHeight : 1;\n  }\n\n  expandItem(object) {\n    if (this.filter) {\n      const name = this.filter.name(object);\n      const sub = this.childrenByName[name];\n      if (sub) {\n        sub.expand();\n        return sub.expandItem(object) + sub.top;\n      }\n    } else {\n      const sub = this.children.find(obj => obj.object === object);\n      if (sub) {\n        return sub.top;\n      }\n    }\n    return 0;\n  }\n\n  expand() {\n    if (!this.expanded && this.count > 0) {\n      this.expanded = true;\n      if (this.parent) {\n        this.parent.modHeight(this.openHeight - 1, this);\n      }\n    }\n  }\n\n  collapse() {\n    if (this.expanded && this.parent) {\n      this.expanded = false;\n      this.parent.modHeight(1 - this.openHeight, this);\n    }\n  }\n\n  toggle = () => {\n    if (this.expanded) {\n      this.collapse();\n    } else {\n      this.expand();\n    }\n  }\n\n  render() {\n    let n = 0;\n    this.downVisit(node => n += ((node.__proto__.constructor.name == 'ObjectItem' && node.searched) ? 1 : 0));\n    if (n) {\n      this.title = `${this._title} (${n}/${this.count})`;\n    }\n    if (!this.parent) {\n      return null;\n    }\n    return (\n      <div className={classNames(\"ObjectGroup\", { expanded: this.expanded, searched: this.searched })}>\n        <span className=\"toggle\" onClick={this.toggle} />\n        <span onDoubleClick={this.toggle}><span className=\"Icon\" />\n          <span className='title'>{this.title}</span>\n        </span>\n      </div>\n    );\n  }\n  firstLevelChild(index) {\n    if (this.expanded) {\n      let left = 0, right = this.children.length - 1;\n      while (left < right) {\n        const mid = (left + right + 1) >> 1;\n        if (this.children[mid].top > index) {\n          right = mid - 1;\n        } else {\n          left = mid;\n        }\n      }\n      return this.children[left]\n    }\n    return null;\n  }\n  renderLine(index) {\n    if (this.parent && !index) {\n      return this.render();\n    }\n    if (this.expanded) {\n      let left = 0, right = this.children.length - 1;\n      while (left < right) {\n        const mid = (left + right + 1) >> 1;\n        if (this.children[mid].top > index) {\n          right = mid - 1;\n        } else {\n          left = mid;\n        }\n      }\n      const subIndex = index - this.children[left].top;\n      const line = this.children[left].renderLine(subIndex);\n      let lineStyle = null;\n      if (left < this.children.length - 1) {\n        if (subIndex === 0) {\n          lineStyle = \"tLine\";\n        } else {\n          lineStyle = \"line\";\n        }\n      } else if (subIndex === 0) {\n        lineStyle = \"halfLine\";\n      }\n      if (this.parent) {\n        return (\n          <div className={classNames(\"indent\", lineStyle)}>\n            {line}\n          </div>\n        );\n      } else {\n        return line;\n      }\n    }\n  }\n}\n\nexport class ObjectList extends React.PureComponent {\n  state = { search: \"\", searchResults: null };\n\n  static contextType = RawNames;\n\n  onSearchKeyDown = (e) => {\n    if (e.which === 27) {\n      this.setState({ search: \"\", searchResults: null });\n      if (this._list) {\n        this._list.forceUpdateGrid();\n      }\n    }\n  }\n  onSearch = (e) => {\n    const { data, type } = this.props;\n    const search = e.target.value.trim();\n    console.log(search)\n    let found = 0;\n\n     // reset\n     this.group.downVisit((node) => {\n      node.searched = false;\n    });\n    if (search) {\n      const re = new RegExp(\"\\\\b\" + search.replace(/[|\\\\{}()[\\]^$+*?.]/g, \"\\\\$&\"), \"i\");\n      const isMatch = obj => {\n        if (obj.type !== type) return false;\n        if (this.context && obj.id.match(re)) return true;\n        if (obj.name.match(re)) return true;\n        if (obj.data.propernames && obj.data.propernames.match(re)) return true;\n        if (obj.name.indexOf(search) != -1) {\n          // console.log('matching', search, obj)\n          return true;\n        }\n        return false;\n      };\n     \n      data.objects.forEach(obj => {\n        const matched = isMatch(obj);\n        if (matched) {\n          obj.upVisit((node) => {\n            node.searched = node.searched | matched;\n            if (node.searched) {\n              found++;\n              // console.log('found', found, node);\n            }\n          })\n        }\n      });\n\n    }\n    // console.log('forceUpdateGrid')\n    if (this._list) {\n      this._list.forceUpdateGrid();\n    }\n    this.setState({ search: e.target.value, searchResults: found });\n  }\n\n\n  onResize = () => {\n    this.forceUpdate();\n  }\n\n  rowRenderer = ({ index, ...options }) => {\n    const { key, style } = options;\n    const flNode = this.group.firstLevelChild(index);\n    return (\n      <div className={classNames(\"TreeRow\", { searched: flNode && flNode.searched })} key={key} style={style}>\n        {this.group.renderLine(index)}\n      </div>\n    );\n  }\n\n  onDownload = () => {\n    this.setState({ showDownload: this.props.type });\n  }\n  onCloseDownload = () => {\n    this.setState({ showDownload: false });\n  }\n\n  render() {\n    const { data, type, id, className, ...props } = this.props;\n    const { search, searchResults, showDownload } = this.state;\n    if (!this.group || this.group._data !== data || this.group._type !== type) {\n      const filters = ObjectFilters[type];\n      if (!filters) {\n        return null;\n      }\n      this.group = new ObjectGroup(data.objects.filter(obj => obj.type === type), filters);\n      this.group._data = data;\n      this.group._type = type;\n      this.group.onResize = this.onResize;\n      setTimeout(() => {\n        if (this._list) {\n          this._list.forceUpdateGrid();\n        }\n      });\n    }\n    if (!searchResults && this.group._id !== id) {\n      const object = data.objects.find(obj => obj.type === type && obj.id === id);\n      if (object) {\n        this.group.onResize = null;\n        const index = this.group.expandItem(object);\n        this.group.onResize = this.onResize;\n        this.group._id = id;\n        setTimeout(() => {\n          if (this._list) {\n            this._list.scrollToRow(index);\n          }\n        });\n      }\n    }\n    return (\n      <Panel className={classNames(className, \"ObjectList\")} {...props}>\n        <DataDownload data={data} show={showDownload} onHide={this.onCloseDownload} />\n        <div className=\"search-box\">\n          <FormControl type=\"text\" value={search} placeholder=\"Search\" onKeyDown={this.onSearchKeyDown} onChange={this.onSearch} />\n          <Button active={!!showDownload} onClick={this.onDownload} size=\"small\"><span glyph=\"download-alt\" /></Button>\n          <RawNames.Consumer>\n            {rawNames => (\n              <RawNamesSwitch.Consumer>\n                {onSwitch => <Button active={rawNames} onClick={onSwitch} size=\"small\"><span glyph=\"cog\" /></Button>}\n              </RawNamesSwitch.Consumer>\n            )}\n          </RawNames.Consumer>\n        </div>\n        <div className=\"ObjectListItems\">\n          <AutoSizer>\n            {({ width, height }) => (\n              <List className=\"ObjectLines\"\n                ref={node => this._list = node}\n                width={width}\n                height={height}\n                rowCount={this.group.height}\n                rowHeight={18}\n                rowRenderer={this.rowRenderer}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      </Panel>\n    );\n  }\n}\n","import React from 'react';\n\nfunction ColorGroup(arr, color) {\n  return key => <span style={{ color }} key={key}>{arr}</span>;\n}\n\nexport default function tagString(value, data) {\n  const result = [];\n  let color = null;\n  let top = result;\n  value = value.split(\"\\n\").join(\"|n\");\n  const regex = /<(\\w+),(\\w+)(,%)?>|\\|([rn])|\\|c[0-9a-zA-Z]{2}([0-9a-zA-Z]{6})/gi;\n  let prev = 0, match = null;\n  while (match = regex.exec(value)) {\n    if (match.index > prev) {\n      top.push(value.substring(prev, match.index));\n    }\n    if (match[1]) {\n      const object = data && data.objects.find(obj => obj.id === match[1]);\n      const key = match[2].toLowerCase();\n      if (object && object.data[key]) {\n        top.push(parseFloat(object.data[key]) * (match[3] ? 100 : 1));\n      } else {\n        top.push(match[0]);\n      }\n    } else if (match[4] === \"n\" || match[4] === \"N\") {\n      top.push(<br key={top.length} />);\n    } else if (match[4] === \"r\" || match[4] === \"R\" || match[5]) {\n      if (color) {\n        result.push(color(result.length));\n        top = result;\n        color = null;\n      }\n      if (match[5]) {\n        top = [];\n        color = ColorGroup(top, \"#\" + match[5]);\n      }\n    }\n    prev = match.index + match[0].length;\n  }\n  if (prev < value.length) {\n    top.push(value.substring(prev));\n  }\n  if (color) {\n    result.push(color(result.length));\n  }\n  return result;\n}\n","import React, { useState, useEffect } from 'react';\nimport { OverlayTrigger, Popover } from 'react-bootstrap';\nimport AppCache from 'data/cache';\nimport { tagString } from 'data/tagString';\n\n// 假定已经存在的辅助函数或组件\nimport { ObjectIcon } from './ObjectCtx';\n// import { getObjectById } from './dataUtils'; // 假定这是一个实用函数，用于根据ID获取对象详情\n\nconst TooltipContent = ({ objectId }) => {\n  const [object, setObject] = useState(null);\n\n  useEffect(() => {\n    async function fetchObject() {\n      const data = objectId; //await getObjectById(objectId);\n      setObject(data);\n    }\n    if (objectId) {\n      fetchObject();\n    }\n  }, [objectId]);\n\n  if (!object) return <Popover.Title>Loading...</Popover.Title>;\n\n  return (\n    <div>\n      <Popover.Title>{object.name}</Popover.Title>\n      <Popover.Content>\n        {object.description || \"No description available.\"}\n        {object.icon && (\n          <img\n            src={AppCache.image(object.icon)}\n            alt={`${object.name} Icon`}\n            className=\"object-icon\"\n          />\n        )}\n      </Popover.Content>\n    </div>\n  );\n};\n\nconst Tooltip = ({ objectId, children }) => {\n  return (\n    <OverlayTrigger\n      overlay={\n        <Popover id='objectId'>\n          <TooltipContent objectId={objectId} />\n        </Popover>\n      }>\n      {typeof children === 'string' ? (\n        <span>{children}</span>\n      ) : (\n        children\n      )}\n    </OverlayTrigger>\n  );\n};\n\nexport default Tooltip;","/**\n * An INI file.\n */\nexport default class IniFile {\n  /**\n   * @param {?string} buffer\n   */\n  constructor(buffer) {\n    /** @member {Map<string, string>} */\n    this.properties = new Map();\n    /** @member {Map<string, Map<string, string>>} */\n    this.sections = new Map();\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {string} buffer\n   */\n  load(buffer) {\n    // All properties added until a section is reached are added to the properties map.\n    // Once a section is reached, any further properties will be added to it until matching another section, etc.\n    let section = this.properties;\n    let sections = this.sections;\n\n    for (let line of buffer.split(/\\r\\n?|\\n/)) {\n      // INI defines comments as starting with a semicolon ';'.\n      // However, Warcraft 3 INI files use normal C comments '//'.\n      // In addition, Warcraft 3 files have empty lines.\n      // Therefore, ignore any line matching any of these conditions.\n      if (line.length && !line.startsWith('//') && !line.startsWith(';')) {\n        let match = line.match(/^\\[(.+?)\\]/);\n\n        if (match) {\n          let name = match[1].trim().toLowerCase();\n\n          section = sections.get(name);\n\n          if (!section) {\n            section = new Map();\n\n            sections.set(name, section);\n          }\n        } else {\n          match = line.match(/^(.+?)=(.*?)$/);\n\n          if (match) {\n            section.set(match[1].toLowerCase(), match[2]);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * @return {string}\n   */\n  save() {\n    let lines = [];\n\n    for (let [key, value] of this.properties) {\n      lines.push(`${key}=${value}`);\n    }\n\n    for (let [name, section] of this.sections) {\n      lines.push(`[${name}]`);\n\n      for (let [key, value] of section) {\n        lines.push(`${key}=${value}`);\n      }\n    }\n\n    return lines.join('\\r\\n');\n  }\n\n  /**\n   * @param {string} name\n   * @return {Map<string, string>}\n   */\n  getSection(name) {\n    return this.sections.get(name.toLowerCase());\n  }\n}\n","import IniFile from './file';\n\nexport default {\n  IniFile,\n};\n","/**\n * A SLK table file.\n */\nexport default class SlkFile {\n  /**\n   * @param {?string} buffer\n   */\n  constructor(buffer) {\n    /** @member {Array<Array<string>>} */\n    this.rows = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {string} buffer\n   */\n  load(buffer) {\n    if (!buffer.startsWith('ID')) {\n      throw new Error('WrongMagicNumber');\n    }\n\n    let rows = this.rows;\n    let x = 0;\n    let y = 0;\n\n    for (let line of buffer.split('\\n')) {\n      // The B command is supposed to define the total number of columns and rows, however in UbetSplatData.slk it gives wrong information\n      // Therefore, just ignore it, since JavaScript arrays grow as they want either way\n      if (line[0] !== 'B') {\n        for (let token of line.split(';')) {\n          let op = token[0];\n          let valueString = token.substring(1).trim();\n          let value;\n\n          if (op === 'X') {\n            x = parseInt(valueString, 10) - 1;\n          } else if (op === 'Y') {\n            y = parseInt(valueString, 10) - 1;\n          } else if (op === 'K') {\n            if (!rows[y]) {\n              rows[y] = [];\n            }\n\n            if (valueString[0] === '\"') {\n              value = valueString.substring(1, valueString.length - 1);\n            } else if (valueString === 'TRUE') {\n              value = true;\n            } else if (valueString === 'FALSE') {\n              value = false;\n            } else {\n              value = parseFloat(valueString);\n            }\n\n            rows[y][x] = value;\n          } else if (op === 'A') {\n            if (!this.comments) {\n              this.comments = [];\n            }\n            if (!this.comments[y]) {\n              this.comments[y] = [];\n            }\n            this.comments[y][x] = valueString;\n          }\n        }\n      }\n    }\n\n    this.cols = this.rows.reduce((m, r) => Math.max(m, r.length), 0);\n  }\n}\n","import SlkFile from './file';\n\nexport default {\n  SlkFile,\n};\n","let buffer = new ArrayBuffer(8);\nlet int8 = new Int8Array(buffer);\nlet int16 = new Int16Array(buffer);\nlet int32 = new Int32Array(buffer);\nlet uint8 = new Uint8Array(buffer);\nlet uint16 = new Uint16Array(buffer);\nlet uint32 = new Uint32Array(buffer);\nlet float32 = new Float32Array(buffer);\nlet float64 = new Float64Array(buffer);\n\n/**\n * Type cast a 8 bit unsigned integer to a 8 bits signed integer.\n *\n * @param {number} a\n * @return {number}\n */\nexport function uint8ToInt8(a) {\n  uint8[0] = a;\n\n  return int8[0];\n}\n\n/**\n * Type cast two 8 bit unsigned integers to a 16 bits signed integer.\n *\n * @param {number} a\n * @param {number} b\n * @return {number}\n */\nexport function uint8ToInt16(a, b) {\n  uint8[0] = a;\n  uint8[1] = b;\n\n  return int16[0];\n}\n\n/**\n * Type cast four 8 bit unsigned integers to a 32 bits signed integer.\n *\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @param {number} d\n * @return {number}\n */\nexport function uint8ToInt32(a, b, c, d) {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n\n  return int32[0];\n}\n\n/**\n * Type cast two 8 bit unsigned integers to a 16 bits unsigned integer.\n *\n * @param {number} a\n * @param {number} b\n * @return {number}\n */\nexport function uint8ToUint16(a, b) {\n  uint8[0] = a;\n  uint8[1] = b;\n\n  return uint16[0];\n}\n\n/**\n * Type cast three 8 bit unsigned integers to a 24 bits unsigned integer.\n *\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @return {number}\n */\nexport function uint8ToUint24(a, b, c) {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = 0;\n\n  return uint32[0];\n}\n\n/**\n * Type cast four 8 bit unsigned integers to a 32 bits unsigned integer.\n *\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @param {number} d\n * @return {number}\n */\nexport function uint8ToUint32(a, b, c, d) {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n\n  return uint32[0];\n}\n\n/**\n * Type cast four 8 bit unsigned integers to a 32 bits IEEE float.\n *\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @param {number} d\n * @return {number}\n */\nexport function uint8ToFloat32(a, b, c, d) {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n\n  return float32[0];\n}\n\n/**\n * Type cast eight 8 bit unsigned integers to a 64 bits IEEE float.\n *\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @param {number} d\n * @param {number} e\n * @param {number} f\n * @param {number} g\n * @param {number} h\n * @return {number}\n */\nexport function uint8ToFloat64(a, b, c, d, e, f, g, h) {\n  uint8[0] = a;\n  uint8[1] = b;\n  uint8[2] = c;\n  uint8[3] = d;\n  uint8[4] = e;\n  uint8[5] = f;\n  uint8[6] = g;\n  uint8[7] = h;\n\n  return float64[0];\n}\n\n/**\n * Type cast a 8 bit signed integer to a 8 bit unsigned integer.\n *\n * @param {number} a\n * @return {number}\n */\nexport function int8ToUint8(a) {\n  uint8[0] = a;\n\n  return int8[0];\n}\n\n/**\n * Type cast a 16 bit signed integer to two 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function int16ToUint8(out, a) {\n  int16[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n\n  return out;\n}\n\n/**\n * Type cast a 24 bit signed integer to three 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function int24ToUint8(out, a) {\n  int32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n\n  return out;\n}\n\n/**\n * Type cast a 32 bit signed integer to four 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function int32ToUint8(out, a) {\n  int32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n\n  return out;\n}\n\n/**\n * Type cast a 16 bit unsigned integer to two 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function uint16ToUint8(out, a) {\n  uint16[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n\n  return out;\n}\n\n/**\n * Type cast a 24 bit unsigned integer to three 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function uint24ToUint8(out, a) {\n  uint32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n\n  return out;\n}\n\n/**\n * Type cast a 32 bit unsigned integer to four 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function uint32ToUint8(out, a) {\n  uint32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n\n  return out;\n}\n\n/**\n * Type cast a 32 bit IEEE float to four 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function float32ToUint8(out, a) {\n  float32[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n\n  return out;\n}\n\n/**\n * Type cast a 64 bit IEEE float to eight 8 bit unsigned integers.\n * The result is stored in out.\n *\n * @param {Uint8Array} out\n * @param {number} a\n * @return {Uint8Array}\n */\nexport function float64ToUint8(out, a) {\n  float64[0] = a;\n\n  out[0] = uint8[0];\n  out[1] = uint8[1];\n  out[2] = uint8[2];\n  out[3] = uint8[3];\n  out[4] = uint8[4];\n  out[5] = uint8[5];\n  out[6] = uint8[6];\n  out[7] = uint8[7];\n\n  return out;\n}\n\n/**\n * Type cast a normal JavaScript number to a 32 bits unsigned integer.\n *\n * @param {number} number\n * @return {number}\n */\nexport function numberToUint32(number) {\n  uint32[0] = number;\n\n  return uint32[0];\n}\n\n/**\n * Interperts a string as a base 256 number.\n *\n * @param {string} string\n * @return {number}\n */\nexport function stringToBase256(string) {\n  let number = 0;\n\n  for (let c of string) {\n    number = number * 256 + c.charCodeAt(0);\n  }\n\n  return number;\n}\n\n/**\n * Interperts a number as a base 256 string.\n *\n * @param {number} number\n * @return {string}\n */\nexport function base256ToString(number) {\n  let array = [];\n\n  while (number > 0) {\n    array.push(String.fromCharCode(number % 256));\n    number = Math.floor(number / 256);\n  }\n\n  return array.reverse().join('');\n}\n","import {uint8ToInt8, uint8ToInt16, uint8ToInt32, uint8ToUint16, uint8ToUint32, uint8ToFloat32, uint8ToFloat64, int8ToUint8, int16ToUint8, int32ToUint8, uint16ToUint8, uint32ToUint8, float32ToUint8, float64ToUint8} from './typecast';\n\n// Memory for all of the xxxToUint type casts.\nlet uint8 = new Uint8Array(8);\n\n/**\n * A binary stream.\n */\nexport default class BinaryStream {\n  /**\n   * @param {ArrayBuffer|ArrayBufferView} buffer\n   * @param {number=} byteOffset\n   * @param {number=} byteLength\n   */\n  constructor(buffer, byteOffset, byteLength) {\n    // If given a view, use its properties.\n    if (ArrayBuffer.isView(buffer)) {\n      buffer = buffer.buffer;\n      byteOffset = buffer.byteOffset;\n      byteLength = buffer.byteLength;\n    }\n\n    if (!(buffer instanceof ArrayBuffer)) {\n      throw new TypeError(`BinaryStream: expected ArrayBuffer or ArrayBufferView, got ${buffer}`);\n    }\n\n    /** @member {ArrayBuffer} */\n    this.buffer = buffer;\n    /** @member {Uint8Array} */\n    this.uint8array = new Uint8Array(buffer, byteOffset, byteLength);\n    /** @member {number} */\n    this.index = 0;\n    /** @member {number} */\n    this.byteLength = buffer.byteLength;\n  }\n\n  /**\n   * Create a subreader of this reader, at its position, with the given byte length\n   *\n   * @param {number} byteLength\n   * @return {BinaryStream}\n   */\n  substream(byteLength) {\n    return new BinaryStream(this.buffer, this.index, byteLength);\n  }\n\n  /**\n   * Get the remaining bytes\n   *\n   * @return {number}\n   */\n  remaining() {\n    return this.byteLength - this.index;\n  }\n\n  /**\n   * Skip a number of bytes\n   *\n   * @param {number} bytes\n   */\n  skip(bytes) {\n    this.index += bytes;\n  }\n\n  /**\n   * Set the reader's index\n   *\n   * @param {number} index\n   */\n  seek(index) {\n    this.index = index;\n  }\n\n  /**\n   * Get the reader's index\n   *\n   * @return {number}\n   */\n  tell() {\n    return this.index;\n  }\n\n  /**\n   * Peek a string\n   *\n   * @param {number} size\n   * @param {boolean=} allowNulls\n   * @return {string}\n   */\n  peek(size, allowNulls) {\n    let uint8array = this.uint8array;\n    let index = this.index;\n    let codes = [];\n\n    if (index + size > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0; i < size; i++) {\n      let b = uint8array[index + i];\n\n      // Avoid \\0\n      if (allowNulls || b > 0) {\n        codes.push(b);\n      }\n    }\n\n    return String.fromCharCode(...codes);\n  }\n\n  /**\n   * Read a string\n   *\n   * @param {number} size\n   * @param {boolean=} allowNulls\n   * @return {string}\n   */\n  read(size, allowNulls) {\n    // If the size isn't specified, default to everything\n    size = size || this.remaining();\n\n    let data = this.peek(size, allowNulls);\n\n    this.index += size;\n\n    return data;\n  }\n\n  /**\n   * Peeks a string until finding a null byte\n   *\n   * @return {string}\n   */\n  peekUntilNull() {\n    let uint8array = this.uint8array;\n    let index = this.index;\n    let b = uint8array[index];\n    let i = 0;\n\n    while (b !== 0 && index + i < uint8array.length) {\n      i += 1;\n      b = uint8array[index + i];\n    }\n\n    return String.fromCharCode(...uint8array.subarray(index, index + i));\n  }\n\n  /**\n   * Read a string until finding a null byte\n   *\n   * @param {number} size\n   * @return {string}\n   */\n  readUntilNull() {\n    let data = this.peekUntilNull();\n\n    this.index += data.length + 1; // +1 for the \\0 itself\n\n    return data;\n  }\n\n  /**\n   * Peek a character array.\n   *\n   * @param {number} size\n   * @return {Array<string>}\n   */\n  peekCharArray(size) {\n    let uint8array = this.uint8array;\n    let index = this.index;\n    let data = [];\n\n    if (index + size > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0; i < size; i++) {\n      data[i] = String.fromCharCode(uint8array[index + i]);\n    }\n\n    return data;\n  }\n\n  /**\n   * Read a character array.\n   *\n   * @param {number} size\n   * @return {Array<string>}\n   */\n  readCharArray(size) {\n    let data = this.peekCharArray(size);\n\n    this.index += size;\n\n    return data;\n  }\n\n  /**\n   * Read a 8 bit signed integer\n   *\n   * @return {number}\n   */\n  readInt8() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    if (index + 1 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToInt8(uint8array[index]);\n\n    this.index += 1;\n\n    return data;\n  }\n\n  /**\n   * Read a 16 bit signed integer\n   *\n   * @return {number}\n   */\n  readInt16() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    if (index + 2 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToInt16(uint8array[index], uint8array[index + 1]);\n\n    this.index += 2;\n\n    return data;\n  }\n\n  /**\n   * Read a 32 bit signed integer\n   *\n   * @return {number}\n   */\n  readInt32() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    if (index + 4 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToInt32(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3]);\n\n    this.index += 4;\n\n    return data;\n  }\n\n  /**\n   * Read a 8 bit unsigned integer\n   *\n   * @return {number}\n   */\n  readUint8() {\n    if (this.index + 1 > this.uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = this.uint8array[this.index];\n\n    this.index += 1;\n\n    return data;\n  }\n\n  /**\n   * Read a 16 bit unsigned integer\n   *\n   * @return {number}\n   */\n  readUint16() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + 2 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToUint16(uint8array[index], uint8array[index + 1]);\n\n    this.index += 2;\n\n    return data;\n  }\n\n  /**\n   * Read a 32 bit unsigned integer\n   *\n   * @return {number}\n   */\n  readUint32() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + 4 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToUint32(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3]);\n\n    this.index += 4;\n\n    return data;\n  }\n\n  /**\n   * Read a 32 bit float\n   *\n   * @return {number}\n   */\n  readFloat32() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + 4 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToFloat32(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3]);\n\n    this.index += 4;\n\n    return data;\n  }\n\n  /**\n   * Read a 64 bit float\n   *\n   * @return {number}\n   */\n  readFloat64() {\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + 8 > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    let data = uint8ToFloat64(uint8array[index], uint8array[index + 1], uint8array[index + 2], uint8array[index + 3], uint8array[index + 4], uint8array[index + 5], uint8array[index + 6], uint8array[index + 7]);\n\n    this.index += 8;\n\n    return data;\n  }\n\n  /**\n   * Read an array of 8 bit signed integers into the given view\n   *\n   * @param {Int8Array|number} view\n   * @return {Int8Array}\n   */\n  readInt8Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Int8Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = uint8ToInt8(uint8array[index + i]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 16 bit signed integers into the given view\n   *\n   * @param {Int16Array|number} view\n   * @return {Int16Array}\n   */\n  readInt16Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Int16Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 2;\n\n      view[i] = uint8ToInt16(uint8array[offset], uint8array[offset + 1]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 32 bit signed integers into the given view\n   *\n   * @param {Int32Array|number} view\n   * @return {Int32Array}\n   */\n  readInt32Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Int32Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 4;\n\n      view[i] = uint8ToInt16(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 8 bit unsigned integers into the given view\n   *\n   * @param {Uint8Array|number} view\n   * @return {Uint8Array}\n   */\n  readUint8Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Uint8Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = uint8array[index + i];\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 16 bit unsigned integers into the given view\n   *\n   * @param {Uint16Array|number} view\n   * @return {Uint16Array}\n   */\n  readUint16Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Uint16Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 2;\n\n      view[i] = uint8ToUint16(uint8array[offset], uint8array[offset + 1]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 32 bit unsigned integers into the given view\n   *\n   * @param {Uint32Array|number} view\n   * @return {Uint32Array}\n   */\n  readUint32Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Uint32Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 4;\n\n      view[i] = uint8ToUint32(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 32 bit floats into the given view\n   *\n   * @param {Float32Array|number} view\n   * @return {Float32Array}\n   */\n  readFloat32Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Float32Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 4;\n\n      view[i] = uint8ToFloat32(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read an array of 64 bit floats into the given view\n   *\n   * @param {Float64Array|number} view\n   * @return {Float64Array}\n   */\n  readFloat64Array(view) {\n    if (!ArrayBuffer.isView(view)) {\n      view = new Float64Array(view);\n    }\n\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + view.byteLength > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 8;\n\n      view[i] = uint8ToFloat64(uint8array[offset], uint8array[offset + 1], uint8array[offset + 2], uint8array[offset + 3], uint8array[offset + 4], uint8array[offset + 5], uint8array[offset + 6], uint8array[offset + 7]);\n    }\n\n    this.index += view.byteLength;\n\n    return view;\n  }\n\n  /**\n   * Read into a typed array.\n   *\n   * @param {ArrayBufferView} view\n   */\n  readTypedArray(view) {\n    let buffer = new Uint8Array(view.buffer, view.byteOffset, view.byteLength);\n    let index = this.index;\n    let uint8array = this.uint8array;\n    if (index + buffer.length > uint8array.length) {\n      throw new RangeError(`BinaryStream: read outside of range`);\n    }\n\n    for (let i = 0, l = buffer.length; i < l; i++) {\n      buffer[i] = uint8array[index + i];\n    }\n\n    this.index += buffer.length;\n  }\n\n  /**\n   * Write a string\n   *\n   * @param {string} value\n   */\n  write(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n    let count = value.length;\n\n    for (let i = 0; i < count; i++) {\n      uint8array[index + i] = value.charCodeAt(i);\n    }\n\n    this.index += count;\n  }\n\n  /**\n   * Write a 8 bit signed integer\n   *\n   * @param {number} value\n   */\n  writeInt8(value) {\n    this.uint8array[this.index] = int8ToUint8(value);\n    this.index += 1;\n  }\n\n  /**\n   * Write a 16 bit signed integer\n   *\n   * @param {number} value\n   */\n  writeInt16(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    int16ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n\n    this.index += 2;\n  }\n\n  /**\n   * Write a 32 bit signed integer\n   *\n   * @param {number} value\n   */\n  writeInt32(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    int32ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n\n    this.index += 4;\n  }\n\n  /**\n   * Write a 8 bit unsigned integer\n   *\n   * @param {number} value\n   */\n  writeUint8(value) {\n    this.uint8array[this.index] = value;\n    this.index += 1;\n  }\n\n  /**\n   * Write a 16 bit unsigned integer\n   *\n   * @param {number} value\n   */\n  writeUint16(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    uint16ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n\n    this.index += 2;\n  }\n\n  /**\n   * Write a 32 bit unsigned integer\n   *\n   * @param {number} value\n   */\n  writeUint32(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    uint32ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n\n    this.index += 4;\n  }\n\n  /**\n   * Write a 32 bit float\n   *\n   * @param {number} value\n   */\n  writeFloat32(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    float32ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n\n    this.index += 4;\n  }\n\n  /**\n   * Write a 64 bit float\n   *\n   * @param {number} value\n   */\n  writeFloat64(value) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    float64ToUint8(uint8, value);\n\n    uint8array[index] = uint8[0];\n    uint8array[index + 1] = uint8[1];\n    uint8array[index + 2] = uint8[2];\n    uint8array[index + 3] = uint8[3];\n    uint8array[index + 4] = uint8[4];\n    uint8array[index + 5] = uint8[5];\n    uint8array[index + 6] = uint8[6];\n    uint8array[index + 7] = uint8[7];\n\n    this.index += 8;\n  }\n\n  /**\n   * Write an array of 8 bit signed integers\n   *\n   * @param {Int8Array} view\n   */\n  writeInt8Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      uint8array[index + i] = int8ToUint8(view[i]);\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 16 bit signed integers\n   *\n   * @param {Int16Array} view\n   */\n  writeInt16Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 2;\n\n      int16ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 32 bit signed integers\n   *\n   * @param {Int32Array} view\n   */\n  writeInt32Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 4;\n\n      int32ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 8 bit unsigned integers\n   *\n   * @param {Uint8Array} view\n   */\n  writeUint8Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      uint8array[index + i] = view[i];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 16 bit unsigned integers\n   *\n   * @param {Uint16Array} view\n   */\n  writeUint16Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 2;\n\n      uint16ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 32 bit unsigned integers\n   *\n   * @param {Uint32Array} view\n   */\n  writeUint32Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 4;\n\n      uint32ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 32 bit floats\n   *\n   * @param {Float32Array} view\n   */\n  writeFloat32Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 4;\n\n      float32ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write an array of 64 bit floats\n   *\n   * @param {Float64Array} view\n   */\n  writeFloat64Array(view) {\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      let offset = index + i * 8;\n\n      float64ToUint8(uint8, view[i]);\n\n      uint8array[offset] = uint8[0];\n      uint8array[offset + 1] = uint8[1];\n      uint8array[offset + 2] = uint8[2];\n      uint8array[offset + 3] = uint8[3];\n      uint8array[offset + 4] = uint8[4];\n      uint8array[offset + 5] = uint8[5];\n      uint8array[offset + 6] = uint8[6];\n      uint8array[offset + 7] = uint8[7];\n    }\n\n    this.index += view.byteLength;\n  }\n\n  /**\n   * Write a typed array.\n   *\n   * @param {ArrayBufferView} view\n   */\n  writeTypedArray(view) {\n    let buffer = new Uint8Array(view.buffer);\n    let index = this.index;\n    let uint8array = this.uint8array;\n\n    for (let i = 0, l = buffer.length; i < l; i++) {\n      uint8array[index + i] = buffer[i];\n    }\n  }\n}\n","/**\n * A random item.\n */\nexport default class RandomItem {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.chance = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.read(4, true);\n    this.chance = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.write(this.id);\n    stream.writeInt32(this.chance);\n  }\n}\n","import RandomItem from './randomitem';\n\n/**\n * A random item set.\n */\nexport default class RandomItemSet {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Array<RandomItem>} */\n    this.items = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let item = new RandomItem();\n\n      item.load(stream);\n\n      this.items.push(item);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeUint32(this.items.length);\n\n    for (let item of this.items) {\n      item.save(stream);\n    }\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 4 + this.items.length * 8;\n  }\n}\n","import RandomItemSet from './randomitemset';\n\n/**\n * A doodad.\n */\nexport default class Doodad {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.variation = 0;\n    /** @member {Float32Array} */\n    this.location = new Float32Array(3);\n    /** @member {number} */\n    this.angle = 0;\n    /** @member {Float32Array} */\n    this.scale = new Float32Array([1, 1, 1]);\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.life = 0;\n    /** @member {number} */\n    this.itemTable = -1;\n    /** @member {Array<RandomItemSet>} */\n    this.itemSets = [];\n    /** @member {number} */\n    this.editorId = 0;\n    /** @member {Uint8Array} */\n    this.u1 = new Uint8Array(8);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  load(stream, version) {\n    this.id = stream.read(4, true);\n    this.variation = stream.readInt32();\n    this.location = stream.readFloat32Array(3);\n    this.angle = stream.readFloat32();\n    this.scale = stream.readFloat32Array(3);\n    this.flags = stream.readUint8();\n    this.life = stream.readUint8();\n\n    if (version > 7) {\n      this.itemTable = stream.readUint32();\n\n      for (let i = 0, l = stream.readUint32(); i < l; i++) {\n        let itemSet = new RandomItemSet();\n\n        itemSet.load(stream);\n\n        this.itemSets.push(itemSet);\n      }\n    }\n\n    this.editorId = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.write(this.id);\n    stream.writeInt32(this.variation);\n    stream.writeFloat32Array(this.location);\n    stream.writeFloat32(this.angle);\n    stream.writeFloat32Array(this.scale);\n    stream.writeUint8(this.flags);\n    stream.writeUint8(this.life);\n\n    if (version > 7) {\n      stream.writeUint32(this.itemTable);\n      stream.writeUint32(this.itemSets.length);\n\n      for (let itemSet of this.itemSets) {\n        itemSet.save(stream);\n      }\n    }\n\n    stream.writeInt32(this.editorId);\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 42;\n\n    if (version > 7) {\n      size += 8;\n\n      for (let itemSet of this.itemSets) {\n        size += itemSet.getByteLength();\n      }\n    }\n\n    return size;\n  }\n}\n","/**\n * A terrain doodad.\n *\n * This type of doodad works much like cliffs.\n * It uses the height of the terrain, and gets affected by the ground heightmap.\n * It cannot be manipulated in any way in the World Editor once placed.\n * Indeed, the only way to change it is to remove it by changing cliffs around it.\n */\nexport default class TerrainDoodad {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.variation = 0;\n    /** @member {Uint32Array} */\n    this.location = new Uint32Array(2);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  load(stream, version) {\n    this.id = stream.read(4, true);\n    this.variation = stream.readUint32();\n    this.location = stream.readUint32Array(2);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.write(this.id);\n    stream.writeUint32(this.variation);\n    stream.writeUint32Array(this.location);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Doodad from './doodad';\nimport TerrainDoodad from './terraindoodad';\n\n/**\n * war3map.doo - the doodad and destructible file.\n */\nexport default class War3MapDoo {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {Uint8Array} */\n    this.u1 = new Uint8Array(4);\n    /** @member {Array<Doodad>} */\n    this.doodads = [];\n    /** @member {Uint8Array} */\n    this.u2 = new Uint8Array(4);\n    /** @member {Array<TerrainDoodad>} */\n    this.terrainDoodads = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    if (stream.read(4) !== 'W3do') {\n      return false;\n    }\n\n    this.version = stream.readInt32();\n    this.u1 = stream.readUint8Array(4);\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let doodad = new Doodad();\n\n      doodad.load(stream, this.version);\n\n      this.doodads.push(doodad);\n    }\n\n    this.u2 = stream.readUint8Array(4);\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let terrainDoodad = new TerrainDoodad();\n\n      terrainDoodad.load(stream, this.version);\n\n      this.terrainDoodads.push(terrainDoodad);\n    }\n\n    return true;\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.write('W3do');\n    stream.writeInt32(this.version);\n    stream.writeUint8Array(this.u1);\n    stream.writeUint32(this.doodads.length);\n\n    for (let doodad of this.doodads) {\n      doodad.save(stream, this.version);\n    }\n\n    stream.writeUint8Array(this.u2);\n    stream.writeUint32(this.terrainDoodads.length);\n\n    for (let terrainDoodad of this.terrainDoodads) {\n      terrainDoodad.save(stream, this.version);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 24 + this.terrainDoodads.length * 16;\n\n    for (let doodad of this.doodads) {\n      size += doodad.getByteLength(this.version);\n    }\n\n    return size;\n  }\n}\n","\n/**\n * An import.\n */\nexport default class Import {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.isCustom = 0;\n    /** @member {string} */\n    this.name = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.isCustom = stream.readUint8();\n    this.name = stream.readUntilNull();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeUint8(this.isCustom);\n    stream.write(`${this.name}\\0`);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 2 + this.name.length;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Import from './import';\n\n/**\n * war3map.imp - the import file.\n */\nexport default class War3MapImp {\n  /**\n   *\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 1;\n    /** @member {Map<string, Import>} */\n    this.entries = new Map();\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readUint32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let entry = new Import();\n\n      entry.load(stream);\n\n      if (entry.isCustom) {\n        this.entries.set(entry.name, entry);\n      } else {\n        this.entries.set(`war3mapimported\\\\${entry.name}`, entry);\n      }\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeUint32(this.version);\n    stream.writeUint32(this.entries.size);\n\n    for (let entry of this.entries.values()) {\n      entry.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 8;\n\n    for (let entry of this.entries.values()) {\n      size += entry.getByteLength();\n    }\n\n    return size;\n  }\n\n  /**\n   * @param {string} name\n   * @return {boolean}\n   */\n  set(name) {\n    if (!this.entries.has(name)) {\n      let entry = new Import();\n\n      entry.isCustom = 10;\n      entry.path = name;\n\n      this.entries.set(name, entry);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * @param {string} name\n   * @return {boolean}\n   */\n  has(name) {\n    return this.entries.has(name);\n  }\n\n  /**\n   * @param {string} name\n   * @return {boolean}\n   */\n  delete(name) {\n    return this.entries.delete(name);\n  }\n\n  /**\n   * @param {string} name\n   * @param {string} newName\n   * @return {boolean}\n   */\n  rename(name, newName) {\n    let entry = this.entries.get(name);\n\n    if (entry) {\n      entry.isCustom = 10;\n      entry.path = newName;\n\n      return true;\n    }\n\n    return false;\n  }\n}\n","/**\n * A modification.\n */\nexport default class Modification {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.variableType = 0;\n    /** @member {number} */\n    this.levelOrVariation = 0;\n    /** @member {number} */\n    this.dataPointer = 0;\n    /** @member {number} */\n    this.value = 0;\n    /** @member {number} */\n    this.u1 = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} useOptionalInts\n   */\n  load(stream, useOptionalInts) {\n    this.id = stream.read(4, true);\n    this.variableType = stream.readInt32();\n\n    if (useOptionalInts) {\n      this.levelOrVariation = stream.readInt32();\n      this.dataPointer = stream.readInt32();\n    }\n\n    if (this.variableType === 0) {\n      this.value = stream.readInt32();\n    } else if (this.variableType === 1 || this.variableType === 2) {\n      this.value = stream.readFloat32();\n    } else if (this.variableType === 3) {\n      this.value = stream.readUntilNull();\n    } else {\n      throw new Error(`Modification: unknown variable type ${this.variableType}`);\n    }\n\n    this.u1 = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} useOptionalInts\n   */\n  save(stream, useOptionalInts) {\n    stream.write(this.id);\n    stream.writeInt32(this.variableType);\n\n    if (useOptionalInts) {\n      stream.writeInt32(this.levelOrVariation);\n      stream.writeInt32(this.dataPointer);\n    }\n\n    if (this.variableType === 0) {\n      stream.writeInt32(this.value);\n    } else if (this.variableType === 1 || this.variableType === 2) {\n      stream.writeFloat32(this.value);\n    } else if (this.variableType === 3) {\n      stream.write(`${this.value}\\0`);\n    } else {\n      throw new Error(`Modification: unknown variable type ${this.variableType}`);\n    }\n\n    stream.writeInt32(this.u1);\n  }\n\n  /**\n   * @param {number} useOptionalInts\n   * @return {number}\n   */\n  getByteLength(useOptionalInts) {\n    let size = 12;\n\n    if (useOptionalInts) {\n      size += 8;\n    }\n\n    if (this.variableType === 3) {\n      size += 1 + this.value.length;\n    } else {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","import Modification from './modification';\n\n/**\n * A modified object.\n */\nexport default class ModifiedObject {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.oldId = '\\0\\0\\0\\0';\n    /** @member {string} */\n    this.newId = '\\0\\0\\0\\0';\n    /** @member {Array<Modification>} */\n    this.modifications = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} useOptionalInts\n   */\n  load(stream, useOptionalInts) {\n    this.oldId = stream.read(4, true);\n    this.newId = stream.read(4, true);\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let modification = new Modification();\n\n      modification.load(stream, useOptionalInts);\n\n      this.modifications[i] = modification;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} useOptionalInts\n   */\n  save(stream, useOptionalInts) {\n    if (this.oldId) {\n      stream.write(this.oldId);\n    } else {\n      stream.writeUint32(0);\n    }\n\n    if (this.newId) {\n      stream.write(this.newId);\n    } else {\n      stream.writeUint32(0);\n    }\n\n    stream.writeUint32(this.modifications.length);\n\n    for (let modification of this.modifications) {\n      modification.save(stream, useOptionalInts);\n    }\n  }\n\n  /**\n   * @param {number} useOptionalInts\n   * @return {number}\n   */\n  getByteLength(useOptionalInts) {\n    let size = 12;\n\n    for (let modification of this.modifications) {\n      size += modification.getByteLength(useOptionalInts);\n    }\n\n    return size;\n  }\n}\n","import ModifiedObject from './modifiedobject';\n\n/**\n * A modification table.\n */\nexport default class ModificationTable {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Array<ModifiedObject>} */\n    this.objects = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} useOptionalInts\n   */\n  load(stream, useOptionalInts) {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let object = new ModifiedObject();\n\n      object.load(stream, useOptionalInts);\n\n      this.objects[i] = object;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} useOptionalInts\n   */\n  save(stream, useOptionalInts) {\n    stream.writeUint32(this.objects.length);\n\n    for (let object of this.objects) {\n      object.save(stream, useOptionalInts);\n    }\n  }\n\n  /**\n   * @param {number} useOptionalInts\n   * @return {number}\n   */\n  getByteLength(useOptionalInts) {\n    let size = 4;\n\n    for (let object of this.objects) {\n      size += object.getByteLength(useOptionalInts);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport ModificationTable from '../w3u/modificationtable';\n\n/**\n * war3map.w3d - the doodad modification file.\n *\n * Also used for war3map.w3a (abilities), and war3map.w3q (upgrades).\n */\nexport default class War3MapW3d {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {ModificationTable} */\n    this.originalTable = new ModificationTable();\n    /** @member {ModificationTable} */\n    this.customTable = new ModificationTable();\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n    this.originalTable.load(stream, true);\n    this.customTable.load(stream, true);\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    this.originalTable.save(stream, true);\n    this.customTable.save(stream, true);\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 4 + this.originalTable.getByteLength(true) + this.customTable.getByteLength(true);\n  }\n}\n","/**\n * A tile corner.\n */\nexport default class Corner {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.groundHeight = 0;\n    /** @member {number} */\n    this.waterHeight = 0;\n    /** @member {number} */\n    this.mapEdge = 0;\n    /** @member {number} */\n    this.ramp = 0;\n    /** @member {number} */\n    this.blight = 0;\n    /** @member {number} */\n    this.water = 0;\n    /** @member {number} */\n    this.boundary = 0;\n    /** @member {number} */\n    this.groundTexture = 0;\n    /** @member {number} */\n    this.cliffVariation = 0;\n    /** @member {number} */\n    this.groundVariation = 0;\n    /** @member {number} */\n    this.cliffTexture = 0;\n    /** @member {number} */\n    this.layerHeight = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.groundHeight = (stream.readInt16() - 8192) / 512;\n\n    let waterAndEdge = stream.readInt16();\n\n    this.waterHeight = ((waterAndEdge & 0x3FFF) - 8192) / 512;\n    this.mapEdge = waterAndEdge & 0x4000;\n\n    let textureAndFlags = stream.readUint8();\n\n    this.ramp = textureAndFlags & 0b00010000;\n    this.blight = textureAndFlags & 0b00100000;\n    this.water = textureAndFlags & 0b01000000;\n    this.boundary = textureAndFlags & 0b10000000;\n\n    this.groundTexture = textureAndFlags & 0b00001111;\n\n    let variation = stream.readUint8();\n\n    this.cliffVariation = (variation & 0b11100000) >>> 5;\n    this.groundVariation = variation & 0b00011111;\n\n    let cliffTextureAndLayer = stream.readUint8();\n\n    this.cliffTexture = (cliffTextureAndLayer & 0b11110000) >>> 4;\n    this.layerHeight = cliffTextureAndLayer & 0b00001111;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt16(this.groundHeight * 512 + 8192);\n    stream.writeInt16(this.waterHeight * 512 + 8192 + this.mapEdge << 14);\n    stream.writeUint8((this.ramp << 4) | (this.blight << 5) | (this.water << 6) | (this.boundary << 7) | this.groundTexture);\n    stream.writeUint8((this.cliffVariation << 5) | this.groundVariation);\n    stream.writeUint8((this.cliffTexture << 4) + this.layerHeight);\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Corner from './corner';\n\n/**\n * war3map.w3e - the environment file.\n */\nexport default class War3MapW3e {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {string} */\n    this.tileset = 'A';\n    /** @member {number} */\n    this.haveCustomTileset = 0;\n    /** @member {Array<string>} */\n    this.groundTilesets = [];\n    /** @member {Array<string>} */\n    this.cliffTilesets = [];\n    /** @member {Int32Array} */\n    this.mapSize = new Int32Array(2);\n    /** @member {Float32Array} */\n    this.centerOffset = new Float32Array(2);\n    /** @member {Array<Array<Corner>>} */\n    this.corners = [];\n\n    if (buffer instanceof ArrayBuffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    if (stream.read(4) !== 'W3E!') {\n      return false;\n    }\n\n    this.version = stream.readInt32();\n    this.tileset = stream.read(1);\n    this.haveCustomTileset = stream.readInt32();\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      this.groundTilesets[i] = stream.read(4);\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      this.cliffTilesets[i] = stream.read(4);\n    }\n\n    this.mapSize = stream.readInt32Array(2);\n    this.centerOffset = stream.readFloat32Array(2);\n\n    let [columns, rows] = this.mapSize;\n\n    for (let row = 0; row < rows; row++) {\n      this.corners[row] = [];\n\n      for (let column = 0; column < columns; column++) {\n        let corner = new Corner();\n\n        corner.load(stream);\n\n        this.corners[row][column] = corner;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.write('W3E!');\n    stream.writeInt32(this.version);\n    stream.write(this.tileset);\n    stream.writeInt32(this.haveCustomTileset);\n    stream.writeUint32(this.groundTilesets.length);\n\n    for (let groundTileset of this.groundTilesets) {\n      stream.write(groundTileset);\n    }\n\n    stream.writeUint32(this.cliffTilesets.length);\n\n    for (let cliffTileset of this.cliffTilesets) {\n      stream.write(cliffTileset);\n    }\n\n    stream.writeInt32Array(this.mapSize);\n    stream.writeFloat32Array(this.centerOffset);\n\n    for (let row of this.corners) {\n      for (let corner of row) {\n        corner.save(stream);\n      }\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 37 + (this.groundTilesets.length * 4) + (this.cliffTilesets.length * 4) + (this.mapSize[0] * this.mapSize[1] * 7);\n  }\n}\n","/**\n * A player.\n */\nexport default class Player {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.id = 0;\n    /** @member {number} */\n    this.type = 0;\n    /** @member {number} */\n    this.race = 0;\n    /** @member {number} */\n    this.isFixedStartPosition = 0;\n    /** @member {string} */\n    this.name = '';\n    /** @member {Float32Array} */\n    this.startLocation = new Float32Array(2);\n    /** @member {number} */\n    this.allyLowPriorities = 0;\n    /** @member {number} */\n    this.allyHighPriorities = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.readInt32();\n    this.type = stream.readInt32();\n    this.race = stream.readInt32();\n    this.isFixedStartPosition = stream.readInt32();\n    this.name = stream.readUntilNull();\n    this.startLocation = stream.readFloat32Array(2);\n    this.allyLowPriorities = stream.readUint32();\n    this.allyHighPriorities = stream.readUint32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.id);\n    stream.writeInt32(this.type);\n    stream.writeInt32(this.race);\n    stream.writeInt32(this.isFixedStartPosition);\n    stream.write(`${this.name}\\0`);\n    stream.writeFloat32Array(this.startLocation);\n    stream.writeUint32(this.allyLowPriorities);\n    stream.writeUint32(this.allyHighPriorities);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 33 + this.name.length;\n  }\n}\n","/**\n * A force.\n */\nexport default class Force {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.playerMasks = 0;\n    /** @member {string} */\n    this.name = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.flags = stream.readUint32();\n    this.playerMasks = stream.readUint32();\n    this.name = stream.readUntilNull();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeUint32(this.flags);\n    stream.writeUint32(this.playerMasks);\n    stream.write(`${this.name}\\0`);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 9 + this.name.length;\n  }\n}\n","/**\n * An upgrade availability change.\n */\nexport default class UpgradeAvailabilityChange {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.playerFlags = 0;\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.levelAffected = 0;\n    /** @member {number} */\n    this.availability = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.playerFlags = stream.readUint32();\n    this.id = stream.read(4, true);\n    this.levelAffected = stream.readInt32();\n    this.availability = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeUint32(this.playerFlags);\n    stream.write(this.id);\n    stream.writeInt32(this.levelAffected);\n    stream.writeInt32(this.availability);\n  }\n}\n","/**\n * A tech availablity change.\n */\nexport default class TechAvailabilityChange {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.playerFlags = 0;\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.playerFlags = stream.readUint32();\n    this.id = stream.read(4, true);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeUint32(this.playerFlags);\n    stream.write(this.id);\n  }\n}\n","/**\n * A random unit.\n */\nexport default class RandomUnit {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.chance = 0;\n    /** @member {Array<string>} */\n    this.ids = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} positions\n   */\n  load(stream, positions) {\n    this.chance = stream.readInt32();\n\n    for (let i = 0; i < positions; i++) {\n      this.ids[i] = stream.read(4, true);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.chance);\n\n    for (let id of this.ids) {\n      stream.write(id);\n    }\n  }\n}\n","import RandomUnit from './randomunit';\n\n/**\n * A random unit table.\n */\nexport default class RandomUnitTable {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.id = 0;\n    /** @member {string} */\n    this.name = '';\n    /** @member {number} */\n    this.positions = 0;\n    /** @member {Int32Array} */\n    this.columnTypes = new Int32Array(1);\n    /** @member {Array<RandomUnit>} */\n    this.units = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.readInt32();\n    this.name = stream.readUntilNull();\n    this.positions = stream.readInt32();\n    this.columnTypes = stream.readInt32Array(this.positions);\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let unit = new RandomUnit();\n\n      unit.load(stream, this.positions);\n\n      this.units[i] = unit;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.id);\n    stream.write(`${this.name}\\0`);\n    stream.writeInt32(this.positions);\n    stream.writeInt32Array(this.columnTypes);\n    stream.writeUint32(this.units.length);\n\n    for (let unit of this.units) {\n      unit.save(stream);\n    }\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 13 + this.name.length + this.columnTypes.byteLength + (this.units.length * (4 + 4 * this.positions));\n  }\n}\n","/**\n * A random item.\n */\nexport default class RandomItem {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.chance = 0;\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.chance = stream.readInt32();\n    this.id = stream.read(4, true);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.chance);\n    stream.write(this.id);\n  }\n}\n","import RandomItem from './randomitem';\n\n/**\n * A random item set.\n */\nexport default class RandomItemSet {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Array<RandomItem>} */\n    this.items = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let item = new RandomItem();\n\n      item.load(stream);\n\n      this.items[i] = item;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeUint32(this.items.length);\n\n    for (let item of this.items) {\n      item.save(stream);\n    }\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 4 + this.items.length * 8;\n  }\n}\n","import RandomItemSet from './randomitemset';\n\n/**\n * A random item table.\n */\nexport default class RandomItemTable {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.id = 0;\n    /** @member {string} */\n    this.name = '';\n    /** @member {Array<RandomItemSet>} */\n    this.sets = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.readInt32();\n    this.name = stream.readUntilNull();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let set = new RandomItemSet();\n\n      set.load(stream);\n\n      this.sets[i] = set;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.id);\n    stream.write(`${this.name}\\0`);\n    stream.writeUint32(this.sets.length);\n\n    for (let set of this.sets) {\n      set.save(stream);\n    }\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 9 + this.name.length;\n\n    for (let set of this.sets) {\n      size += set.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Player from './player';\nimport Force from './force';\nimport UpgradeAvailabilityChange from './upgradeavailabilitychange';\nimport TechAvailabilityChange from './techavailabilitychange';\nimport RandomUnitTable from './randomunittable';\nimport RandomItemTable from './randomitemtable';\n\n/**\n * war3map.w3i - the general information file.\n */\nexport default class War3MapW3i {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {number} */\n    this.saves = 0;\n    /** @member {number} */\n    this.editorVersion = 0;\n    /** @member {string} */\n    this.name = '';\n    /** @member {string} */\n    this.author = '';\n    /** @member {string} */\n    this.description = '';\n    /** @member {string} */\n    this.recommendedPlayers = '';\n    /** @member {Float32Array} */\n    this.cameraBounds = new Float32Array(8);\n    /** @member {Int32Array} */\n    this.cameraBoundsComplements = new Int32Array(4);\n    /** @member {Int32Array} */\n    this.playableSize = new Int32Array(2);\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {string} */\n    this.tileset = '\\0';\n    /** @member {number} */\n    this.campaignBackground = 0;\n    /** @member {string} */\n    this.loadingScreenModel = '';\n    /** @member {string} */\n    this.loadingScreenText = '';\n    /** @member {string} */\n    this.loadingScreenTitle = '';\n    /** @member {string} */\n    this.loadingScreenSubtitle = '';\n    /** @member {number} */\n    this.loadingScreen = 0;\n    /** @member {string} */\n    this.prologueScreenModel = '';\n    /** @member {string} */\n    this.prologueScreenText = '';\n    /** @member {string} */\n    this.prologueScreenTitle = '';\n    /** @member {string} */\n    this.prologueScreenSubtitle = '';\n    /** @member {number} */\n    this.useTerrainFog = 0;\n    /** @member {Float32Array} */\n    this.fogHeight = new Float32Array(2);\n    /** @member {number} */\n    this.fogDensity = 0;\n    /** @member {Uint8Array} */\n    this.fogColor = new Uint8Array(4);\n    /** @member {number} */\n    this.globalWeather = 0;\n    /** @member {string} */\n    this.soundEnvironment = '';\n    /** @member {string} */\n    this.lightEnvironmentTileset = '\\0';\n    /** @member {Uint8Array} */\n    this.waterVertexColor = new Uint8Array(4);\n    /** @member {Array<Player>} */\n    this.players = [];\n    /** @member {Array<Force>} */\n    this.forces = [];\n    /** @member {Array<UpgradeAvailabilityChange>} */\n    this.upgradeAvailabilityChanges = [];\n    /** @member {Array<TechAvailabilityChange>} */\n    this.techAvailabilityChanges = [];\n    /** @member {Array<RandomUnitTable>} */\n    this.randomUnitTables = [];\n    /** @member {Array<RandomItemTable>} */\n    this.randomItemTables = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n    this.saves = stream.readInt32();\n    this.editorVersion = stream.readInt32();\n    if (this.version >= 27) {\n      this.gameVersionMajor = stream.readInt32();\n      this.gameVersionMinor = stream.readInt32();\n      this.gameVersionPatch = stream.readInt32();\n      this.gameVersionBuild = stream.readInt32();\n    }\n    this.name = stream.readUntilNull();\n    this.author = stream.readUntilNull();\n    this.description = stream.readUntilNull();\n    this.recommendedPlayers = stream.readUntilNull();\n    this.cameraBounds = stream.readFloat32Array(8);\n    this.cameraBoundsComplements = stream.readInt32Array(4);\n    this.playableSize = stream.readInt32Array(2);\n    this.flags = stream.readUint32();\n    this.tileset = stream.read(1);\n    this.campaignBackground = stream.readInt32();\n\n    if (this.version > 24) {\n      this.loadingScreenModel = stream.readUntilNull();\n    }\n\n    this.loadingScreenText = stream.readUntilNull();\n    this.loadingScreenTitle = stream.readUntilNull();\n    this.loadingScreenSubtitle = stream.readUntilNull();\n    this.loadingScreen = stream.readInt32();\n\n    if (this.version > 24) {\n      this.prologueScreenModel = stream.readUntilNull();\n    }\n\n    this.prologueScreenText = stream.readUntilNull();\n    this.prologueScreenTitle = stream.readUntilNull();\n    this.prologueScreenSubtitle = stream.readUntilNull();\n\n    if (this.version > 24) {\n      this.useTerrainFog = stream.readInt32();\n      this.fogHeight = stream.readFloat32Array(2);\n      this.fogDensity = stream.readFloat32();\n      this.fogColor = stream.readUint8Array(4);\n      this.globalWeather = stream.readInt32();\n      this.soundEnvironment = stream.readUntilNull();\n      this.lightEnvironmentTileset = stream.read(1, true);\n      this.waterVertexColor = stream.readUint8Array(4);\n    }\n\n    if (this.version >= 27) {\n      this.lua = stream.readInt32();\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let player = new Player();\n\n      player.load(stream);\n\n      this.players[i] = player;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let force = new Force();\n\n      force.load(stream);\n\n      this.forces[i] = force;\n    }\n    if (stream.index === stream.byteLength - 1) { return; }\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let upgradeAvailabilityChange = new UpgradeAvailabilityChange();\n\n      upgradeAvailabilityChange.load(stream);\n\n      this.upgradeAvailabilityChanges[i] = upgradeAvailabilityChange;\n    }\n    if (stream.index >= stream.byteLength - 1) {\n      return;\n    }\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let techAvailabilityChange = new TechAvailabilityChange();\n\n      techAvailabilityChange.load(stream);\n\n      this.techAvailabilityChanges[i] = techAvailabilityChange;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let randomUnitTable = new RandomUnitTable();\n\n      randomUnitTable.load(stream);\n\n      this.randomUnitTables[i] = randomUnitTable;\n    }\n\n    if (this.version > 24) {\n      for (let i = 0, l = stream.readInt32(); i < l; i++) {\n        let randomItemTable = new RandomItemTable();\n\n        randomItemTable.load(stream);\n\n        this.randomItemTables[i] = randomItemTable;\n      }\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    stream.writeInt32(this.saves);\n    stream.writeInt32(this.editorVersion);\n    stream.write(`${this.name}\\0`);\n    stream.write(`${this.author}\\0`);\n    stream.write(`${this.description}\\0`);\n    stream.write(`${this.recommendedPlayers}\\0`);\n    stream.writeFloat32Array(this.cameraBounds);\n    stream.writeInt32Array(this.cameraBoundsComplements);\n    stream.writeInt32Array(this.playableSize);\n    stream.writeUint32(this.flags);\n    stream.write(this.tileset);\n    stream.writeInt32(this.campaignBackground);\n\n    if (this.version > 24) {\n      stream.write(`${this.loadingScreenModel}\\0`);\n    }\n\n    stream.write(`${this.loadingScreenText}\\0`);\n    stream.write(`${this.loadingScreenTitle}\\0`);\n    stream.write(`${this.loadingScreenSubtitle}\\0`);\n    stream.writeInt32(this.loadingScreen);\n\n    if (this.version > 24) {\n      stream.write(`${this.prologueScreenModel}\\0`);\n    }\n\n    stream.write(`${this.prologueScreenText}\\0`);\n    stream.write(`${this.prologueScreenTitle}\\0`);\n    stream.write(`${this.prologueScreenSubtitle}\\0`);\n\n    if (this.version > 24) {\n      stream.writeInt32(this.useTerrainFog);\n      stream.writeFloat32Array(this.fogHeight);\n      stream.writeFloat32(this.fogDensity);\n      stream.writeUint8Array(this.fogColor);\n      stream.writeInt32(this.globalWeather);\n      stream.write(`${this.soundEnvironment}\\0`);\n      stream.write(this.lightEnvironmentTileset);\n      stream.writeUint8Array(this.waterVertexColor);\n    }\n\n    stream.writeUint32(this.players.length);\n\n    for (let player of this.players) {\n      player.save(stream);\n    }\n\n    stream.writeUint32(this.forces.length);\n\n    for (let force of this.forces) {\n      force.save(stream);\n    }\n\n    stream.writeUint32(this.upgradeAvailabilityChanges.length);\n\n    for (let change of this.upgradeAvailabilityChanges) {\n      change.save(stream);\n    }\n\n    stream.writeUint32(this.techAvailabilityChanges.length);\n\n    for (let change of this.techAvailabilityChanges) {\n      change.save(stream);\n    }\n\n    stream.writeUint32(this.randomUnitTables.length);\n\n    for (let table of this.randomUnitTables) {\n      table.save(stream);\n    }\n\n    if (this.version > 24) {\n      stream.writeUint32(this.randomItemTables.length);\n\n      for (let table of this.randomItemTables) {\n        table.save(stream);\n      }\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 111 + this.name.length + this.author.length + this.description.length + this.recommendedPlayers.length + this.loadingScreenText.length + this.loadingScreenTitle.length + this.loadingScreenSubtitle.length + this.prologueScreenText.length + this.prologueScreenTitle.length + this.prologueScreenSubtitle.length;\n\n    for (let player of this.players) {\n      size += player.getByteLength();\n    }\n\n    for (let force of this.forces) {\n      size += force.getByteLength();\n    }\n\n    size += this.upgradeAvailabilityChanges.length * 16;\n\n    size += this.techAvailabilityChanges.length * 8;\n\n    for (let table of this.randomUnitTables) {\n      size += table.getByteLength();\n    }\n\n    if (this.version > 24) {\n      size += 36 + this.loadingScreenModel.length + this.prologueScreenModel.length + this.soundEnvironment.length;\n\n      for (let table of this.randomItemTables) {\n        size += table.getByteLength();\n      }\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport ModificationTable from './modificationtable';\n\n/**\n * war3map.w3u - the unit modification file.\n *\n * Also used for war3map.w3t (items), war3map.w3b (destructibles), and war3map.w3h (buffs).\n */\nexport default class War3MapW3u {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {ModificationTable} */\n    this.originalTable = new ModificationTable();\n    /** @member {ModificationTable} */\n    this.customTable = new ModificationTable();\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n    this.originalTable.load(stream, false);\n    this.customTable.load(stream, false);\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    this.originalTable.save(stream, false);\n    this.customTable.save(stream, false);\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 4 + this.originalTable.getByteLength(false) + this.customTable.getByteLength(false);\n  }\n}\n","/**\n * A custom text trigger.\n */\nexport default class CustomTextTrigger {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.text = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    let textLength = stream.readInt32();\n\n    if (textLength) {\n      this.text = stream.read(textLength - 1);\n      stream.skip(1);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    let text = this.text;\n\n    if (text.length) {\n      stream.writeInt32(this.text.length + 1);\n      stream.write(`${this.text}\\0`);\n    } else {\n      stream.writeInt32(0);\n    }\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 4;\n\n    if (this.text.length) {\n      size += this.text.length + 1;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport CustomTextTrigger from './customtexttrigger';\n\n/**\n * war3map.wct - the custom text (jass) trigger file.\n */\nexport default class War3MapWct {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {string} */\n    this.comment = '';\n    /** @member {?CustomTextTrigger} */\n    this.trigger = null;\n    /** @member {Array<CustomTextTrigger>} */\n    this.triggers = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n\n    if (this.version === 1) {\n      this.comment = stream.readUntilNull();\n\n      let trigger = new CustomTextTrigger();\n\n      trigger.load(stream);\n\n      this.trigger = trigger;\n    }\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let trigger = new CustomTextTrigger();\n\n      trigger.load(stream);\n\n      this.triggers[i] = trigger;\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n\n    if (this.version === 1) {\n      stream.write(`${this.comment}\\0`);\n      this.trigger.save(stream);\n    }\n\n    stream.writeUint32(this.triggers.length);\n\n    for (let trigger of this.triggers) {\n      trigger.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 8;\n\n    if (this.version === 1) {\n      size += this.comment.length + 1 + this.trigger.getByteLength();\n    }\n\n    for (let trigger of this.triggers) {\n      size += trigger.getByteLength();\n    }\n\n    return size;\n  }\n}\n","/**\n * A Trigger category.\n * Used to scope triggers together in a Folder-like hierarchy.\n */\nexport default class TriggerCategory {\n  /**\n   *\n   */\n  constructor() {\n    this.id = 0;\n    this.name = '';\n    this.isComment = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  load(stream, version) {\n    this.id = stream.readInt32();\n    this.name = stream.readUntilNull();\n\n    if (version === 7) {\n      this.isComment = stream.readInt32();\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.writeInt32(this.id);\n    stream.write(`${this.name}\\0`);\n\n    if (version === 7) {\n      stream.writeInt32(this.isComment);\n    }\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 5 + this.name.length;\n\n    if (version === 7) {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","/**\n * A global variable.\n */\nexport default class Variable {\n  /**\n   *\n   */\n  constructor() {\n    this.name = '';\n    this.type = '';\n    this.u1 = 0;\n    this.isArray = 0;\n    this.arraySize = 0;\n    this.isInitialized = 0;\n    this.initialValue = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  load(stream, version) {\n    this.name = stream.readUntilNull();\n    this.type = stream.readUntilNull();\n    this.u1 = stream.readInt32();\n    this.isArray = stream.readInt32();\n\n    if (version === 7) {\n      this.arraySize = stream.readInt32();\n    }\n\n    this.isInitialized = stream.readInt32();\n    this.initialValue = stream.readUntilNull();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.write(`${this.name}\\0`);\n    stream.write(`${this.type}\\0`);\n    stream.writeInt32(this.u1);\n    stream.writeInt32(this.isArray);\n\n    if (version === 7) {\n      stream.writeInt32(this.arraySize);\n    }\n\n    stream.writeInt32(this.isInitialized);\n    stream.write(`${this.initialValue}\\0`);\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 15 + this.name.length + this.type.length + this.initialValue.length;\n\n    if (version === 7) {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","import Parameter from './parameter';\n\n/**\n * A function call in an expression.\n */\nexport default class SubParameters {\n  /**\n   *\n   */\n  constructor() {\n    this.type = 0;\n    this.name = '';\n    this.beginParameters = 0;\n    this.parameters = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   * @param {TriggerData} triggerData\n   */\n  load(stream, version, triggerData) {\n    this.type = stream.readInt32();\n    this.name = stream.readUntilNull();\n    this.beginParameters = stream.readInt32();\n\n    if (this.beginParameters) {\n      let args = triggerData.getFunction(this.type, this.name).args;\n\n      for (let i = 0, l = args.length; i < l; i++) {\n        let parameter = new Parameter();\n\n        parameter.load(stream, version, triggerData);\n\n        this.parameters[i] = parameter;\n      }\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.writeInt32(this.type);\n    stream.write(`${this.name}\\0`);\n    stream.writeInt32(this.beginParameters);\n\n    for (let parameter of this.parameters) {\n      parameter.save(stream, version);\n    }\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 9 + this.name.length;\n\n    if (this.parameters.length) {\n      for (let parameter of this.parameters) {\n        size += parameter.getByteLength(version);\n      }\n    }\n\n    return size;\n  }\n}\n","import SubParameters from './subparameters';\n\n/**\n * A function parameter. Can be a function itself, in which case it will have a SubParameters structure.\n */\nexport default class Parameter {\n  /**\n   *\n   */\n  constructor() {\n    this.type = 0;\n    this.value = '';\n    this.subParameters = null;\n    this.u1 = 0;\n    this.isArray = 0;\n    this.arrayIndex = null;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   * @param {TriggerData} triggerData\n   */\n  load(stream, version, triggerData) {\n    this.type = stream.readInt32();\n    this.value = stream.readUntilNull();\n\n    if (stream.readInt32()) {\n      let subParameters = new SubParameters();\n\n      subParameters.load(stream, version, triggerData);\n\n      this.subParameters = subParameters;\n    }\n\n    if ((version === 4 && this.type === 2) || (version === 7 && this.subParameters)) {\n      this.u1 = stream.readInt32();\n    }\n\n    if ((version === 4 && this.type !== 2) || version === 7) {\n      this.isArray = stream.readInt32();\n    }\n\n    if (this.isArray) {\n      let arrayIndex = new Parameter();\n\n      arrayIndex.load(stream, version, triggerData);\n\n      this.arrayIndex = arrayIndex;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.writeInt32(this.type);\n    stream.write(`${this.value}\\0`);\n\n    if (this.subParameters) {\n      stream.writeInt32(1);\n      this.subParameters.save(stream, version);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if ((version === 4 && this.type === 2) || (version === 7 && this.subParameters)) {\n      stream.writeInt32(this.u1);\n    }\n\n    if ((version === 4 && this.type !== 2) || version === 7) {\n      stream.writeInt32(this.isArray);\n    }\n\n    if (this.isArray) {\n      this.arrayIndex.save(stream, version);\n    }\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 9 + this.value.length;\n\n    if (this.subParameters) {\n      size += this.subParameters.getByteLength(version);\n    }\n\n    if ((version === 4 && this.type === 2) || (version === 7 && this.subParameters)) {\n      size += 4;\n    }\n\n    if ((version === 4 && this.type !== 2) || version === 7) {\n      size += 4;\n    }\n\n    if (this.isArray) {\n      size += this.arrayIndex.getByteLength(version);\n    }\n\n    return size;\n  }\n}\n","import Parameter from './parameter';\n\n/**\n * An Event/Condition/Action.\n */\nexport default class ECA {\n  /**\n   *\n   */\n  constructor() {\n    this.type = -1;\n    this.group = -1;\n    this.name = '';\n    this.isEnabled = 0;\n    this.parameters = [];\n    this.ecas = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   * @param {boolean} isChildECA\n   * @param {TriggerData} triggerData\n   */\n  load(stream, version, isChildECA, triggerData) {\n    this.type = stream.readInt32();\n\n    if (isChildECA) {\n      this.group = stream.readUint32();\n    }\n\n    this.name = stream.readUntilNull();\n    this.isEnabled = stream.readInt32();\n\n    let args = triggerData.getFunction(this.type, this.name).args;\n\n    for (let i = 0, l = args.length; i < l; i++) {\n      let parameter = new Parameter();\n\n      parameter.load(stream, version, triggerData);\n\n      this.parameters[i] = parameter;\n    }\n\n    if (version === 7) {\n      for (let i = 0, l = stream.readUint32(); i < l; i++) {\n        let eca = new ECA();\n\n        eca.load(stream, version, true, triggerData);\n\n        this.ecas[i] = eca;\n      }\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.writeInt32(this.type);\n\n    if (this.group !== -1) {\n      stream.writeInt32(this.group);\n    }\n\n    stream.write(`${this.name}\\0`);\n    stream.writeInt32(this.isEnabled);\n\n    for (let parameter of this.parameters) {\n      parameter.save(stream, version);\n    }\n\n    if (version === 7) {\n      stream.writeUint32(this.ecas.length);\n\n      for (let eca of this.ecas) {\n        eca.save(stream, version);\n      }\n    }\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 9 + this.name.length;\n\n    if (this.group !== -1) {\n      size += 4;\n    }\n\n    for (let parameter of this.parameters) {\n      size += parameter.getByteLength(version);\n    }\n\n    if (version === 7) {\n      size += 4;\n\n      for (let eca of this.ecas) {\n        size += eca.getByteLength(version);\n      }\n    }\n\n    return size;\n  }\n}\n","import ECA from './eca';\n\n/**\n * A GUI Trigger.\n */\nexport default class Trigger {\n  /**\n   *\n   */\n  constructor() {\n    this.name = '';\n    this.description = '';\n    this.isComment = 0;\n    this.isEnabled = 0;\n    this.isCustom = 0;\n    this.isInitiallyOff = 0;\n    this.runOnInitialization = 0;\n    this.category = 0;\n    this.ecas = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   * @param {TriggerData} triggerData\n   */\n  load(stream, version, triggerData) {\n    this.name = stream.readUntilNull();\n    this.description = stream.readUntilNull();\n\n    if (version === 7) {\n      this.isComment = stream.readInt32();\n    }\n\n    this.isEnabled = stream.readInt32();\n    this.isCustomText = stream.readInt32();\n    this.isInitiallyOff = stream.readInt32();\n    this.runOnInitialization = stream.readInt32();\n    this.category = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let eca = new ECA();\n\n      eca.load(stream, version, false, triggerData);\n\n      this.ecas[i] = eca;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.write(`${this.name}\\0`);\n    stream.write(`${this.description}\\0`);\n\n    if (version === 7) {\n      stream.writeInt32(this.isComment);\n    }\n\n    stream.writeInt32(this.isEnabled);\n    stream.writeInt32(this.isCustomText);\n    stream.writeInt32(this.isInitiallyOff);\n    stream.writeInt32(this.runOnInitialization);\n    stream.writeInt32(this.category);\n    stream.writeUint32(this.ecas.length);\n\n    for (let eca of this.ecas) {\n      eca.save(stream, version);\n    }\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 26 + this.name.length + this.description.length;\n\n    if (version === 7) {\n      size += 4;\n    }\n\n    for (let eca of this.ecas) {\n      size += eca.getByteLength(version);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport TriggerCategory from './triggercategory';\nimport Variable from './variable';\nimport Trigger from './trigger';\n\n/**\n * war3map.wtg - the trigger file.\n */\nexport default class War3MapWtg {\n  /**\n   * @param {?ArrayBuffer} buffer\n   * @param {?TriggerData} triggerData\n   */\n  constructor(buffer, triggerData) {\n    this.version = 0;\n    this.categories = [];\n    this.u1 = 0;\n    this.variables = [];\n    this.triggers = [];\n\n    if (buffer) {\n      this.load(buffer, triggerData);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   * @param {TriggerData} triggerData\n   */\n  load(buffer, triggerData) {\n    let stream = new BinaryStream(buffer);\n\n    if (stream.read(4) !== 'WTG!') {\n      throw new Error('Not a WTG file');\n    }\n\n    this.version = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let category = new TriggerCategory();\n\n      category.load(stream, this.version);\n\n      this.categories[i] = category;\n    }\n\n    this.u1 = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let variable = new Variable();\n\n      variable.load(stream, this.version);\n\n      this.variables[i] = variable;\n    }\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let trigger = new Trigger();\n\n      trigger.load(stream, this.version, triggerData);\n\n      this.triggers[i] = trigger;\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.write('WTG!');\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.categories.length);\n\n    for (let category of this.categories) {\n      category.save(stream, this.version);\n    }\n\n    stream.writeInt32(this.u1);\n    stream.writeUint32(this.variables.length);\n\n    for (let variable of this.variables) {\n      variable.save(stream, this.version);\n    }\n\n    stream.writeUint32(this.triggers.length);\n\n    for (let trigger of this.triggers) {\n      trigger.save(stream, this.version);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 24;\n\n    for (let category of this.categories) {\n      size += category.getByteLength(this.version);\n    }\n\n    for (let variable of this.variables) {\n      size += variable.getByteLength(this.version);\n    }\n\n    for (let trigger of this.triggers) {\n      size += trigger.getByteLength(this.version);\n    }\n\n    return size;\n  }\n}\n","/**\n * Used to read and write structured text formats.\n */\nexport default class TokenStream {\n  /**\n   * @param {?string} buffer\n   */\n  constructor(buffer) {\n    this.buffer = buffer || '';\n    this.index = 0;\n    this.ident = 0; // Used for writing blocks nicely.\n    this.fractionDigits = 6; // The number of fraction digits when writing floats.\n    this.decoder = new TextDecoder('utf-8');\n    if (this.buffer instanceof ArrayBuffer) {\n      let view = new DataView(buffer);\n      this.length = buffer.byteLength / 4;\n      this.accessPosition = (index) => {\n        return view.getUint8(index)\n      }\n    }\n    else {\n      this.length = buffer.length;\n      this.accessPosition = (index) => {\n        return buffer[index];\n      }\n    }\n  }\n\n  readUntil(ch, fromIndex) {\n    this.index = fromIndex;\n    let token = '';\n    let d = [];\n    while (this.index < this.length) {\n      let c = this.accessPosition(this.index++);\n      let cc = String.fromCharCode(c);\n      if(cc==ch){\n        return this.decoder.decode(new Uint8Array(d))\n      }\n      token+=cc;\n      d.push(c)\n    }\n    return this.decoder.decode(new Uint8Array(d))\n  }\n\n  /**\n   * Reads the next token in the stream.\n   * Whitespaces are ignored outside of strings in the form of \"\".\n   * Comments in the form of // are ignored.\n   * Commas and colons are ignored as well.\n   * Curly braces are used as separators, generally to denote text blocks.\n   *\n   * For example, given the following string:\n   *\n   *     Header \"A String\" {\n   *         Name Value, // A Comment\n   *     }\n   *\n   * Read will return the values in order:\n   *\n   *     Header\n   *     \"A String\"\n   *     {\n   *     Name\n   *     Value\n   *     }\n   *\n   * There are wrappers around read, below, that help to read structured code, check them out!\n   *\n   * @return {?string}\n   */\n  read() {\n    let length = this.length;\n    let inComment = false;\n    let inString = false;\n    let token = '';\n\n\n    while (this.index < length) {\n      let c = this.accessPosition(this.index++);\n      c = String.fromCharCode(c);\n      if (inComment) {\n        if (c === '\\n') {\n          inComment = false;\n        }\n      } else if (inString) {\n        if (c === '\"') {\n          return token;\n        } else {\n          token += c;\n        }\n      } else if (c === ' ' || c === ',' || c === '\\t' || c === '\\n' || c === ':' || c === '\\r') {\n        if (token.length) {\n          return token;\n        }\n      } else if (c === '{' || c === '}') {\n        if (token.length) {\n          this.index--;\n          return token;\n        } else {\n          return c;\n        }\n      } else if (c === '/' && this.accessPosition(this.index) === '/') {\n        if (token.length) {\n          this.index--;\n          return token;\n        } else {\n          inComment = true;\n        }\n      } else if (c === '\"') {\n        if (token.length) {\n          this.index--;\n          return token;\n        } else {\n          inString = true;\n        }\n      } else {\n        token += c;\n      }\n    }\n  }\n\n  /**\n   * Reads the next token without advancing the stream.\n   *\n   * @return {string}\n   */\n  peek() {\n    let index = this.index;\n    let value = this.read();\n\n    this.index = index;\n\n    return value;\n  }\n\n  /**\n   * Reads the next token, and parses it as an integer.\n   *\n   * @return {number}\n   */\n  readInt() {\n    return parseInt(this.read());\n  }\n\n  /**\n   * Reads the next token, and parses it as a float.\n   *\n   * @return {number}\n   */\n  readFloat() {\n    return parseFloat(this.read());\n  }\n\n  /**\n   * Read an MDL keyframe value.\n   * If the value is a scalar, it us just the number.\n   * If the value is a vector, it is enclosed with curly braces.\n   * @param {Float32Array|Uint32Array} value\n   */\n  readKeyframe(value) {\n    if (value.length === 1) {\n      if (value instanceof Float32Array) {\n        value[0] = this.readFloat();\n      } else {\n        value[0] = this.readInt();\n      }\n    } else {\n      this.readTypedArray(value);\n    }\n  }\n\n  /**\n   * Reads an array of integers in the form:\n   *     { Value1, Value2, ..., ValueN }\n   *\n   * @param {ArrayBufferView} view\n   * @return {ArrayBufferView}\n   */\n  readIntArray(view) {\n    this.read(); // {\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = this.readInt();\n    }\n\n    this.read(); // }\n\n    return view;\n  }\n\n  /**\n   * Reads an array of floats in the form:\n   *     { Value1, Value2, ..., ValueN }\n   *\n   * @param {ArrayBufferView} view\n   * @return {ArrayBufferView}\n   */\n  readFloatArray(view) {\n    this.read(); // {\n\n    for (let i = 0, l = view.length; i < l; i++) {\n      view[i] = this.readFloat();\n    }\n\n    this.read(); // }\n\n    return view;\n  }\n\n  /**\n   * Reads into a uint or float typed array.\n   *\n   * @param {Uint32Array|Float32Array} view\n   */\n  readTypedArray(view) {\n    if (view instanceof Float32Array) {\n      this.readFloatArray(view);\n    } else {\n      this.readIntArray(view);\n    }\n  }\n\n  /**\n   * Reads a color in the form:\n   *\n   *      { R, G, B }\n   *\n   * The color is sizzled to BGR.\n   *\n   * @param {Float32Array} view\n   */\n  readColor(view) {\n    this.read(); // {\n\n    view[2] = this.readFloat();\n    view[1] = this.readFloat();\n    view[0] = this.readFloat();\n\n    this.read(); // }\n  }\n\n  /**\n   * {\n   *     { Value1, Value2, ..., ValueSize },\n   *     { Value1, Value2, ..., ValueSize },\n   *     ...\n   * }\n   *\n   * @param {ArrayBufferView} view\n   * @param {number} size\n   * @return {ArrayBufferView}\n   */\n  readVectorArray(view, size) {\n    this.read(); // {\n\n    for (let i = 0, l = view.length / size; i < l; i++) {\n      this.read(); // {\n\n      for (let j = 0; j < size; j++) {\n        view[i * size + j] = this.readFloat();\n      }\n\n      this.read(); // }\n    }\n\n    this.read(); // }\n\n    return view;\n  }\n\n  /**\n   * Helper generator for block reading.\n   * Let's say we have a block like so:\n   *     {\n   *         Key1 Value1\n   *         Key2 Value2\n   *         ...\n   *         KeyN ValueN\n   *     }\n   * The generator yields the keys one by one, and the caller needs to read the values based on the keys.\n   * It is used for most MDL blocks.\n   */\n  * readBlock() {\n    this.read(); // {\n\n    let token = this.read();\n\n    while (token !== '}') {\n      yield token;\n\n      token = this.read();\n    }\n  }\n\n  /**\n   * Writes a color in the form:\n   *\n   *      { B, G, R }\n   *\n   * The color is sizzled to RGB.\n   *\n   * @param {string} name 'Color' or 'static Color'.\n   * @param {Float32Array} view\n   */\n  writeColor(name, view) {\n    this.writeLine(`${name} { ${view[2]}, ${view[1]}, ${view[0]} },`);\n  }\n\n  /**\n   * Flag,\n   *\n   * @param {string} flag\n   */\n  writeFlag(flag) {\n    this.writeLine(`${flag},`);\n  }\n\n  /**\n   * Name Value,\n   *\n   * @param {string} name\n   * @param {number|string} value\n   */\n  writeAttrib(name, value) {\n    this.writeLine(`${name} ${value},`);\n  }\n\n  /**\n   * Same as writeAttrib, but formats the given number.\n   *\n   * @param {string} name\n   * @param {number} value\n   */\n  writeFloatAttrib(name, value) {\n    this.writeLine(`${name} ${this.formatFloat(value)},`);\n  }\n\n  /**\n   * Name \"Value\",\n   *\n   * @param {string} name\n   * @param {string} value\n   */\n  writeStringAttrib(name, value) {\n    this.writeLine(`${name} \"${value}\",`);\n  }\n\n  /**\n   * Name { Value0, Value1, ..., ValueN },\n   *\n   * @param {string} name\n   * @param {TypedArray} value\n   */\n  writeArrayAttrib(name, value) {\n    this.writeLine(`${name} { ${value.join(', ')} },`);\n  }\n\n  /**\n   * Name { Value0, Value1, ..., ValueN },\n   *\n   * @param {string} name\n   * @param {Float32Array} value\n   */\n  writeFloatArrayAttrib(name, value) {\n    this.writeLine(`${name} { ${this.formatFloatArray(value)} },`);\n  }\n\n  /**\n   * @param {string} name\n   * @param {Uint32Array|Float32Array} value\n   */\n  writeTypedArrayAttrib(name, value) {\n    if (value instanceof Float32Array) {\n      this.writeFloatArrayAttrib(name, value);\n    } else {\n      this.writeArrayAttrib(name, value);\n    }\n  }\n\n  /**\n   * Write an MDL keyframe.\n   *\n   * @param {string} start\n   * @param {Float32Array|Uint32Array} value\n   */\n  writeKeyframe(start, value) {\n    if (value.length === 1) {\n      if (value instanceof Float32Array) {\n        this.writeFloatAttrib(start, value[0]);\n      } else {\n        this.writeAttrib(start, value[0]);\n      }\n    } else {\n      this.writeTypedArrayAttrib(start, value);\n    }\n\n  }\n\n  /**\n   * { Value0, Value1, ..., ValueN },\n   *\n   * @param {TypedArray} value\n   */\n  writeArray(value) {\n    this.writeLine(`{ ${value.join(', ')} },`);\n  }\n\n  /**\n   * { Value0, Value1, ..., ValueN },\n   *\n   * @param {Float32Array} value\n   */\n  writeFloatArray(value) {\n    this.writeLine(`{ ${this.formatFloatArray(value)} },`);\n  }\n\n  /**\n   * Name Entries {\n   *     { Value1, Value2, ..., valueSize },\n   *     { Value1, Value2, ..., valueSize },\n   *     ...\n   * }\n   *\n   * @param {string} name\n   * @param {TypedArray} view\n   * @param {number} size\n   */\n  writeVectorArray(name, view, size) {\n    this.startBlock(name, view.length / size);\n\n    for (let i = 0, l = view.length; i < l; i += size) {\n      this.writeFloatArray(view.subarray(i, i + size));\n    }\n\n    this.endBlock();\n  }\n\n  /**\n   * Adds the given string to the buffer.\n   *\n   * @param {string} s\n   */\n  write(s) {\n    this.buffer += s;\n  }\n\n  /**\n   * Adds the given string to the buffer.\n   * The current indentation level is prepended, and the stream goes to the next line after the write.\n   *\n   * @param {string} line\n   */\n  writeLine(line) {\n    this.buffer += `${'\\t'.repeat(this.ident)}${line}\\n`;\n  }\n\n  /**\n   * Starts a new block in the form:\n   *\n   *      Header1 Header2 ... HeaderN {\n   *          ...\n   *      }\n   *\n   * @param {...string} headers\n   */\n  startBlock(...headers) {\n    if (headers.length) {\n      this.writeLine(`${headers.join(' ')} {`);\n    } else {\n      this.writeLine('{');\n    }\n\n    this.ident += 1;\n  }\n\n  /**\n   * Starts a new block in the form:\n   *\n   *      Header \"Name\" {\n   *          ...\n   *      }\n   *\n   * @param {string} header\n   * @param {string} name\n   */\n  startObjectBlock(header, name) {\n    this.writeLine(`${header} \"${name}\" {`);\n    this.ident += 1;\n  }\n\n  /**\n   * Ends a previously started block, and handles the indentation.\n   */\n  endBlock() {\n    this.ident -= 1;\n    this.writeLine('}');\n  }\n\n  /**\n   * Ends a previously started block, and handles the indentation.\n   * Adds a comma after the block end.\n   */\n  endBlockComma() {\n    this.ident -= 1;\n    this.writeLine('},');\n  }\n\n  /**\n   * Increases the indentation level for following line writes.\n   */\n  indent() {\n    this.ident += 1;\n  }\n\n  /**\n   * Decreases the indentation level for following line writes.\n   */\n  unindent() {\n    this.ident -= 1;\n  }\n\n  /**\n   * Formats a given float to the shorter of either its string representation, or its fixed point representation with the stream's fraction digits.\n   *\n   * @param {number} value\n   * @return {string}\n   */\n  formatFloat(value) {\n    let s = value.toString();\n    let f = value.toFixed(this.fractionDigits);\n\n    if (s.length > f.length) {\n      return f;\n    } else {\n      return s;\n    }\n  }\n\n  /**\n   * Uses formatFloat to format a whole array, and returns it as a comma separated string.\n   *\n   * @param {Float32Array} value\n   * @return {string}\n   */\n  formatFloatArray(value) {\n    let result = [];\n\n    for (let i = 0, l = value.length; i < l; i++) {\n      result[i] = this.formatFloat(value[i]);\n    }\n\n    return result.join(', ');\n  }\n}\n","import TokenStream from '../../../common/tokenstream';\n\nlet newLineRegex = /\\n/g;\nlet newLineLiteralRegex = /\\\\n/g;\n\n/**\n * war3map.wts - the string table file.\n *\n * Contains a map of number->string.\n * When other map data like triggers use the string TRIGSTR_XXX, where XXX is a number, the value will be fetched from the table.\n */\nexport default class War3MapWts {\n  /**\n   * @param {?string} buffer\n   */\n  constructor(buffer) {\n    /** @member {Map<number, string>} */\n    this.stringMap = new Map();\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {string} buffer\n   */\n  load(buffer) {\n    let stream = new TokenStream(buffer);\n    let token;\n\n    stream.index += 3; // ï»¿???\n\n    while ((token = stream.read())) {\n      if (token === 'STRING') {\n        let index = stream.readInt();\n\n        stream.read(); // {\n\n        let content = stream.readUntil('}',stream.index).trim();\n\n        this.stringMap.set(index, content);\n      }\n    }\n  }\n\n  /**\n   * @return {string}\n   */\n  save() {\n    let buffer = 'ï»¿'; // ï»¿???\n\n    for (let [key, value] of this.stringMap) {\n      buffer += `STRING ${key}\\n{\\n${value}\\n}\\n`;\n    }\n\n    return buffer;\n  }\n}\n","/**\n * A dropped item.\n */\nexport default class DroppedItem {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.chance = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.read(4, true);\n    this.chance = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.write(this.id);\n    stream.writeInt32(this.chance);\n  }\n}\n","import DroppedItem from './droppeditem';\n\n/**\n * A dropped item set.\n */\nexport default class DroppedItemSet {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Array<DroppedItem>} */\n    this.items = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let item = new DroppedItem();\n\n      item.load(stream);\n\n      this.items[i] = item;\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.items.length);\n\n    for (let item of this.items) {\n      item.save(stream);\n    }\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 4 + this.items.length * 8;\n  }\n}\n","/**\n * An inventory item.\n */\nexport default class InventoryItem {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.slot = 0;\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.slot = stream.readInt32();\n    this.id = stream.read(4, true);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.slot);\n    stream.write(this.id);\n  }\n}\n","/**\n * A modified ability.\n */\nexport default class ModifiedAbility {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.activeForAutocast = 0;\n    /** @member {number} */\n    this.heroLevel = 1;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.read(4, true);\n    this.activeForAutocast = stream.readInt32();\n    this.heroLevel = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.write(this.id);\n    stream.writeInt32(this.activeForAutocast);\n    stream.writeInt32(this.heroLevel);\n  }\n}\n","/**\n * A random unit.\n */\nexport default class RandomUnit {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.chance = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.id = stream.read(4, true);\n    this.chance = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.write(this.id);\n    stream.writeInt32(this.chance);\n  }\n}\n","import DroppedItemSet from './droppeditemset';\nimport InventoryItem from './inventoryitem';\nimport ModifiedAbility from './modifiedability';\nimport RandomUnit from './randomunit';\n\n/**\n * A unit.\n */\nexport default class Unit {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.id = '\\0\\0\\0\\0';\n    /** @member {number} */\n    this.variation = 0;\n    /** @member {Float32Array} */\n    this.location = new Float32Array(3);\n    /** @member {number} */\n    this.angle = 0;\n    /** @member {Float32Array} */\n    this.scale = new Float32Array([1, 1, 1]);\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.player = 0;\n    /** @member {number} */\n    this.unknown = 0;\n    /** @member {number} */\n    this.hitpoints = -1;\n    /** @member {number} */\n    this.mana = -1;\n    /** @member {number} */\n    this.droppedItemTable = -1; // VERSION 8\n    /** @member {Array<DroppedItemSet>} */\n    this.droppedItemSets = [];\n    /** @member {number} */\n    this.goldAmount = 0;\n    /** @member {number} */\n    this.targetAcquisition = 0;\n    /** @member {number} */\n    this.heroLevel = 0;\n    /** @member {number} */\n    this.heroStrength = 0; // VERSION 8\n    /** @member {number} */\n    this.heroAgility = 0; // VERSION 8\n    /** @member {number} */\n    this.heroIntelligence = 0; // VERSION 8\n    /** @member {Array<InventoryItem>} */\n    this.itemsInInventory = [];\n    /** @member {Array<ModifiedAbility>} */\n    this.modifiedAbilities = [];\n    /** @member {number} */\n    this.randomFlag = 0;\n    /** @member {Uint8Array} */\n    this.level = new Uint8Array(3);\n    /** @member {number} */\n    this.itemClass = 0;\n    /** @member {number} */\n    this.unitGroup = 0;\n    /** @member {number} */\n    this.positionInGroup = 0;\n    /** @member {Array<RandomUnit>} */\n    this.randomUnitTables = [];\n    /** @member {number} */\n    this.customTeamColor = 0;\n    /** @member {number} */\n    this.waygate = 0;\n    /** @member {number} */\n    this.creationNumber = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  load(stream, version) {\n    this.id = stream.read(4, true);\n    this.variation = stream.readInt32();\n    this.location = stream.readFloat32Array(3);\n    this.angle = stream.readFloat32();\n    this.scale = stream.readFloat32Array(3);\n    this.flags = stream.readUint8();\n    this.player = stream.readInt32();\n    this.unknown = stream.readUint16();\n    this.hitpoints = stream.readInt32();\n    this.mana = stream.readInt32();\n\n    if (version > 7) {\n      this.droppedItemTable = stream.readInt32();\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let set = new DroppedItemSet();\n\n      set.load(stream);\n\n      this.droppedItemSets[i] = set;\n    }\n\n    this.goldAmount = stream.readInt32();\n    this.targetAcquisition = stream.readFloat32();\n    this.heroLevel = stream.readInt32();\n\n    if (version > 7) {\n      this.heroStrength = stream.readInt32();\n      this.heroAgility = stream.readInt32();\n      this.heroIntelligence = stream.readInt32();\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let item = new InventoryItem();\n\n      item.load(stream);\n\n      this.itemsInInventory[i] = item;\n    }\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let modifiedAbility = new ModifiedAbility();\n\n      modifiedAbility.load(stream);\n\n      this.modifiedAbilities[i] = modifiedAbility;\n    }\n\n    this.randomFlag = stream.readInt32();\n\n    if (this.randomFlag === 0) {\n      this.level = stream.readUint8Array(3); // 24bit number\n      this.itemClass = stream.readUint8();\n    } else if (this.randomFlag === 1) {\n      this.unitGroup = stream.readUint32();\n      this.positionInGroup = stream.readUint32();\n    } else if (this.randomFlag === 2) {\n      for (let i = 0, l = stream.readInt32(); i < l; i++) {\n        let randomUnit = new RandomUnit();\n\n        randomUnit.load(stream);\n\n        this.randomUnitTables[i] = randomUnit;\n      }\n    }\n\n    this.customTeamColor = stream.readInt32();\n    this.waygate = stream.readInt32();\n    this.creationNumber = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} version\n   */\n  save(stream, version) {\n    stream.write(this.id);\n    stream.writeInt32(this.variation);\n    stream.writeFloat32Array(this.location);\n    stream.writeFloat32(this.angle);\n    stream.writeFloat32Array(this.scale);\n    stream.writeUint8(this.flags);\n    stream.writeInt32(this.player);\n    stream.writeUint16(this.unknown);\n    stream.writeInt32(this.hitpoints);\n    stream.writeInt32(this.mana);\n\n    if (version > 7) {\n      stream.writeInt32(this.droppedItemTable);\n    }\n\n    stream.writeInt32(this.droppedItemSets.length);\n\n    for (let droppedItemSet of this.droppedItemSets) {\n      droppedItemSet.save(stream);\n    }\n\n    stream.writeInt32(this.goldAmount);\n    stream.writeFloat32(this.targetAcquisition);\n    stream.writeInt32(this.heroLevel);\n\n    if (version > 7) {\n      stream.writeInt32(this.heroStrength);\n      stream.writeInt32(this.heroAgility);\n      stream.writeInt32(this.heroIntelligence);\n    }\n\n    stream.writeInt32(this.itemsInInventory.length);\n\n    for (let itemInInventory of this.itemsInInventory) {\n      itemInInventory.save(stream);\n    }\n\n    stream.writeInt32(this.modifiedAbilities.length);\n\n    for (let modifiedAbility of this.modifiedAbilities) {\n      modifiedAbility.save(stream);\n    }\n\n    stream.writeInt32(this.randomFlag);\n\n    if (this.randomFlag === 0) {\n      stream.writeUint8Array(this.level);\n      stream.writeUint8(this.itemClass);\n    } else if (this.randomFlag === 1) {\n      stream.writeUint32(this.unitGroup);\n      stream.writeUint32(this.positionInGroup);\n    } else if (this.randomFlag === 2) {\n      stream.writeInt32(this.randomUnitTables.length);\n\n      for (let randomUnitTable of this.randomUnitTables) {\n        randomUnitTable.save(stream);\n      }\n    }\n\n    stream.writeInt32(this.customTeamColor);\n    stream.writeInt32(this.waygate);\n    stream.writeInt32(this.creationNumber);\n  }\n\n  /**\n   * @param {number} version\n   * @return {number}\n   */\n  getByteLength(version) {\n    let size = 91;\n\n    if (version > 7) {\n      size += 16;\n    }\n\n    for (let droppedItemSet of this.droppedItemSets) {\n      size += droppedItemSet.getByteLength();\n    }\n\n    size += this.itemsInInventory.length * 8;\n\n    size += this.modifiedAbilities.length * 12;\n\n    if (this.randomFlag === 0) {\n      size += 4;\n    } else if (this.randomFlag === 1) {\n      size += 8;\n    } else if (this.randomFlag === 2) {\n      size += 4 + this.randomUnitTables.length * 8;\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../../common/binarystream';\nimport Unit from './unit';\n\n/**\n * war3mapUnits.doo - the units and items file.\n */\nexport default class War3MapUnitsDoo {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 8;\n    /** @member {number} */\n    this.unknown = 11;\n    /** @member {Array<Unit>} */\n    this.units = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    if (stream.read(4) !== 'W3do') {\n      return false;\n    }\n\n    this.version = stream.readInt32();\n    this.unknown = stream.readUint32();\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let unit = new Unit();\n\n      unit.load(stream, this.version);\n\n      this.units[i] = unit;\n    }\n    let types = new Set();\n    this.units.forEach(u => {\n      u.droppedItemSets.forEach(s => s.items.forEach(it => types.add(it.id)));\n    });\n    // console.log(types);\n\n    return true;\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.write('W3do');\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.unknown);\n    stream.writeInt32(this.units.length);\n\n    for (let unit of this.units) {\n      unit.save(stream, this.version);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 16;\n\n    for (let unit of this.units) {\n      size += unit.getByteLength(this.version);\n    }\n\n    return size;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport War3MapDoo from './doo/file';\nimport War3MapImp from './imp/file';\n// import War3MapMmp from './mmp/file';\n// import War3MapShd from './shd/file';\n// import War3MapW3c from './w3c/file';\nimport War3MapW3d from './w3d/file';\nimport War3MapW3e from './w3e/file';\nimport War3MapW3i from './w3i/file';\n// import War3MapW3o from './w3o/file';\n// import War3MapW3r from './w3r/file';\n// import War3MapW3s from './w3s/file';\nimport War3MapW3u from './w3u/file';\nimport War3MapWct from './wct/file';\n// import War3MapWpm from './wpm/file';\nimport War3MapWtg from './wtg/file';\nimport War3MapWts from './wts/file';\nimport War3MapUnitsDoo from './unitsdoo/file';\nconst decoder = new TextDecoder();\n/**\n * Warcraft 3 map (W3X and W3M).\n */\nexport default class War3Map {\n  /**\n   * @param {?ArrayBuffer} buffer If given an ArrayBuffer, load() will be called immediately\n   * @param {?boolean} readonly If true, disables editing and saving the map (and the internal archive), allowing to optimize other things\n   */\n  constructor(buffer, readonly) {\n    /** @member {number} */\n    this.unknown = 0;\n    /** @member {string} */\n    this.name = '';\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.maxPlayers = 0;\n    /** @member {War3MapImp} */\n    this.imports = new War3MapImp();\n    /** @member {boolean} */\n    this.readonly = !!readonly;\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * Load an existing map.\n   * Note that this clears the map from whatever it had in it before.\n   *\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  load(buffer) {\n    this.name = buffer.name;\n    this.archive = {\n      getFileNames() {\n        return buffer.listFile().split(\"\\n\").filter(n => n.length > 0);\n      },\n      get(name) {\n        const data = buffer.binary(name);\n        if (!data) {\n          return data;\n        }\n        return {\n          name,\n          arrayBuffer() {\n            return data.data.buffer;\n          }\n          ,\n          text(){\n            return decoder.decode(data.data);\n          }\n        };\n      },\n    };\n    return true;\n  }\n\n  /**\n   * Save this map.\n   * If the archive is in readonly mode, returns null.\n   *\n   * @return {?ArrayBuffer}\n   */\n  save() {\n    if (this.readonly) {\n      return null;\n    }\n\n    // Update the imports if needed.\n    this.setImportsFile();\n\n    let headerSize = 512;\n    let archiveBuffer = this.archive.save();\n    let buffer = new ArrayBuffer(headerSize + archiveBuffer.byteLength);\n    let typedArray = new Uint8Array(buffer);\n    let writer = new BinaryStream(buffer);\n\n    // Write the header.\n    writer.write('HM3W');\n    writer.writeUint32(this.u1);\n    writer.write(`${this.name}\\0`);\n    writer.writeUint32(this.flags);\n    writer.writeUint32(this.maxPlayers);\n\n    // Writer the archive.\n    typedArray.set(new Uint8Array(archiveBuffer), headerSize);\n\n    return buffer;\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   *\n   * @return {Array<string>}\n   */\n  getFileNames() {\n    return this.archive.getFileNames();\n  }\n\n  /**\n   * Gets a list of the file names imported in this map.\n   *\n   * @return {Array<string>}\n   */\n  getImportNames() {\n    let names = [];\n\n    for (let entry of this.imports.entries.values()) {\n      let isCustom = entry.isCustom;\n\n      if (isCustom === 10 || isCustom === 13) {\n        names.push(entry.name);\n      } else {\n        names.push(`war3mapImported\\\\${entry.name}`);\n      }\n    }\n\n    return names;\n  }\n\n  /**\n   * Sets the imports file with all of the imports.\n   * Does nothing if the archive is in readonly mode.\n   *\n   * @return {boolean}\n   */\n  setImportsFile() {\n    if (this.readonly) {\n      return false;\n    }\n\n    if (this.imports.entries.size > 0) {\n      return this.set('war3map.imp', this.imports.save());\n    }\n\n    return false;\n  }\n\n  /**\n   * Imports a file to this archive.\n   * If the file already exists, its buffer will be set.\n   * Files added to the archive but not to the imports list will be deleted by the World Editor automatically.\n   * This of course doesn't apply to internal map files.\n   * Does nothing if the archive is in readonly mode.\n   *\n   * @param {string} name\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  import(name, buffer) {\n    if (this.readonly) {\n      return false;\n    }\n\n    if (this.archive.set(name, buffer)) {\n      this.imports.set(name);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   *\n   * @param {string} name\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  set(name, buffer) {\n    if (this.readonly) {\n      return false;\n    }\n\n    return this.archive.set(name, buffer);\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   *\n   * @param {string} name\n   * @return {?MpqFile}\n   */\n  get(name) {\n    return this.archive.get(name);\n  }\n\n  /**\n   * Get the map's script file.\n   *\n   * @return {?string}\n   */\n  getScript() {\n    let file = this.get('war3map.j') || this.get('scripts\\\\war3map.j');\n\n    return file.text();\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   *\n   * @param {string} name\n   * @return {boolean}\n   */\n  has(name) {\n    return this.archive.has(name);\n  }\n\n  /**\n   * Deletes a file from the internal archive.\n   * Note that if the file is in the imports list, it will be removed from it too.\n   * Use this rather than the internal archive's delete.\n   *\n   * @param {string} name\n   * @return {boolean}\n   */\n  delete(name) {\n    if (this.readonly) {\n      return false;\n    }\n\n    // If this file is in the import list, remove it.\n    this.imports.delete(name);\n\n    return this.archive.delete(name);\n  }\n\n  /**\n   * A shortcut to the internal archive function.\n   *\n   * @param {string} name\n   * @param {string} newName\n   * @return {boolean}\n   */\n  rename(name, newName) {\n    if (this.readonly) {\n      return false;\n    }\n\n    if (this.archive.rename(name, newName)) {\n      // If the file was actually renamed, and it is an import, rename also the import entry.\n      this.imports.rename(name, newName);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * @param {string} path\n   * @param {Constructor} Constructor\n   * @return {Constructor|null|undefined}\n   */\n  readHelper(path, Constructor) {\n    let file = this.archive.get(path);\n\n    if (file) {\n      let buffer = file.arrayBuffer();\n\n      if (buffer) {\n        return new Constructor(buffer);\n      }\n\n      return null;\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Read the imports file.\n   */\n  readImports() {\n    let file = this.archive.get('war3map.imp');\n\n    if (file) {\n      let buffer = file.arrayBuffer();\n\n      if (buffer) {\n        this.imports.load(buffer);\n      }\n    }\n  }\n\n  /**\n   * Read the map information file.\n   *\n   * @return {?War3MapW3i}\n   */\n  readMapInformation() {\n    return this.readHelper('war3map.w3i', War3MapW3i);\n  }\n\n  /**\n   * Read the environment file.\n   *\n   * @return {?War3MapW3e}\n   */\n  readEnvironment() {\n    return this.readHelper('war3map.w3e', War3MapW3e);\n  }\n\n  /**\n   * Read and parse the doodads file.\n   *\n   * @return {?War3MapDoo}\n   */\n  readDoodads() {\n    let file = this.archive.get('war3map.doo');\n\n    if (file) {\n      return new War3MapDoo(file.arrayBuffer());\n    }\n  }\n\n  /**\n   * Read and parse the units file.\n   *\n   * @return {?War3MapUnitsDoo}\n   */\n  readUnits() {\n    let file = this.archive.get('war3mapUnits.doo');\n\n    if (file) {\n      return new War3MapUnitsDoo(file.arrayBuffer());\n    }\n  }\n\n  /**\n   * Read and parse the trigger file.\n   *\n   * @param {TriggerData} triggerData\n   * @return {?War3MapWtg}\n   */\n  readTriggers(triggerData) {\n    let file = this.archive.get('war3map.wtg');\n\n    if (file) {\n      return new War3MapWtg(file.arrayBuffer(), triggerData);\n    }\n  }\n\n  /**\n   * Read and parse the custom text trigger file.\n   *\n   * @return {?War3MapWct}\n   */\n  readCustomTextTriggers() {\n    let file = this.archive.get('war3map.wct');\n\n    if (file) {\n      return new War3MapWct(file.arrayBuffer());\n    }\n  }\n\n  /**\n   * Read and parse the string table file.\n   *\n   * @return {?War3MapWts}\n   */\n  readStringTable() {\n    let file = this.archive.get('war3map.wts');\n\n    if (file) {\n      return new War3MapWts(file.text());\n    }\n  }\n\n  /**\n   * Read and parse all of the modification tables.\n   *\n   * @return {Map}\n   */\n  readModifications() {\n    let modifications = {};\n\n    // useOptionalInts:\n    //      w3u: no (units)\n    //      w3t: no (items)\n    //      w3b: no (destructables)\n    //      w3d: yes (doodads)\n    //      w3a: yes (abilities)\n    //      w3h: no (buffs)\n    //      w3q: yes (upgrades)\n    let fileNames = ['w3u', 'w3t', 'w3b', 'w3d', 'w3a', 'w3h', 'w3q'];\n    let useOptionalInts = [false, false, false, true, true, false, true];\n\n    for (let i = 0, l = fileNames.length; i < l; i++) {\n      let file = this.archive.get(`war3map.${fileNames[i]}`);\n\n      if (file) {\n        let buffer = file.arrayBuffer();\n        let modification;\n\n        if (useOptionalInts[i]) {\n          modification = new War3MapW3d(buffer);\n        } else {\n          modification = new War3MapW3u(buffer);\n        }\n\n        modifications[fileNames[i]] = modification;\n      }\n    }\n\n    return modifications;\n  }\n}\n\n","/**\n * A minimap icon.\n */\nexport default class MinimapIcon {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.type = 0;\n    /** @member {Int32Array} */\n    this.location = new Int32Array(2);\n    /** @member {Uint8Array} */\n    this.color = new Uint8Array(4); // BGRA\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.type = stream.readInt32();\n    this.location = stream.readInt32Array(2);\n    this.color = stream.readUint8Array(4);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.type);\n    stream.writeInt32Array(this.location);\n    stream.writeUint8Array(this.color);\n  }\n}\n","/**\n * A camera.\n */\nexport default class Camera {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Float32Array} */\n    this.targetLocation = new Float32Array(3);\n    /** @member {number} */\n    this.rotation = 0;\n    /** @member {number} */\n    this.angleOfAttack = 0;\n    /** @member {number} */\n    this.distance = 0;\n    /** @member {number} */\n    this.roll = 0;\n    /** @member {number} */\n    this.fieldOfView = 0;\n    /** @member {number} */\n    this.farClippingPlane = 0;\n    /** @member {number} */\n    this.nearClippingPlane = 0;\n    /** @member {string} */\n    this.cinematicName = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.targetLocation = stream.readFloat32Array(3);\n    this.rotation = stream.readFloat32(); // in degrees\n    this.angleOfAttack = stream.readFloat32(); // in degrees\n    this.distance = stream.readFloat32();\n    this.roll = stream.readFloat32();\n    this.fieldOfView = stream.readFloat32(); // in degrees\n    this.farClippingPlane = stream.readFloat32();\n    this.nearClippingPlane = stream.readFloat32(); // probably near clipping plane\n    this.cinematicName = stream.readUntilNull();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeFloat32Array(this.targetLocation);\n    stream.writeFloat32(this.rotation);\n    stream.writeFloat32(this.angleOfAttack);\n    stream.writeFloat32(this.distance);\n    stream.writeFloat32(this.roll);\n    stream.writeFloat32(this.fieldOfView);\n    stream.writeFloat32(this.farClippingPlane);\n    stream.writeFloat32(this.nearClippingPlane);\n    stream.write(`${this.cinematicName}\\0`);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 41 + this.cinematicName.length;\n  }\n}\n","/**\n * A region.\n */\nexport default class Region {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.left = 0;\n    /** @member {number} */\n    this.right = 0;\n    /** @member {number} */\n    this.bottom = 0;\n    /** @member {number} */\n    this.top = 0;\n    /** @member {string} */\n    this.name = '';\n    /** @member {number} */\n    this.creationNumber = 0;\n    /** @member {string} */\n    this.weatherEffectId = '\\0\\0\\0\\0';\n    /** @member {string} */\n    this.ambientSound = '';\n    /** @member {Uint8Array} */\n    this.color = new Uint8Array(4);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.left = stream.readFloat32();\n    this.right = stream.readFloat32();\n    this.bottom = stream.readFloat32();\n    this.top = stream.readFloat32();\n    this.name = stream.readUntilNull();\n    this.creationNumber = stream.readUint32();\n    this.weatherEffectId = stream.read(4, true);\n    this.ambientSound = stream.readUntilNull();\n    this.color = stream.readUint8Array(4);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeFloat32(this.left);\n    stream.writeFloat32(this.right);\n    stream.writeFloat32(this.bottom);\n    stream.writeFloat32(this.top);\n    stream.write(`${this.name}\\0`);\n    stream.writeUint32(this.creationNumber);\n\n    if (this.weatherEffectId) {\n      stream.write(this.weatherEffectId);\n    } else {\n      stream.writeUint32(0);\n    }\n\n    stream.write(`${this.ambientSound}\\0`);\n    stream.writeUint8Array(this.color);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 30 + this.name.length + this.ambientSound.length;\n  }\n}\n","/**\n * A sound.\n */\nexport default class Sound {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.name = '';\n    /** @member {string} */\n    this.file = '';\n    /** @member {string} */\n    this.eaxEffect = '';\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.fadeInRate = 0;\n    /** @member {number} */\n    this.fadeOutRate = 0;\n    /** @member {number} */\n    this.volume = 0;\n    /** @member {number} */\n    this.pitch = 0;\n    /** @member {number} */\n    this.u1 = 0;\n    /** @member {number} */\n    this.u2 = 0;\n    /** @member {number} */\n    this.channel = 0;\n    /** @member {number} */\n    this.minDistance = 0;\n    /** @member {number} */\n    this.maxDistance = 0;\n    /** @member {number} */\n    this.distanceCutoff = 0;\n    /** @member {number} */\n    this.u3 = 0;\n    /** @member {number} */\n    this.u4 = 0;\n    /** @member {number} */\n    this.u5 = 0;\n    /** @member {number} */\n    this.u6 = 0;\n    /** @member {number} */\n    this.u7 = 0;\n    /** @member {number} */\n    this.u8 = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.name = stream.readUntilNull();\n    this.file = stream.readUntilNull();\n    this.eaxEffect = stream.readUntilNull();\n    this.flags = stream.readUint32();\n    this.fadeInRate = stream.readInt32();\n    this.fadeOutRate = stream.readInt32();\n    this.volume = stream.readInt32();\n    this.pitch = stream.readFloat32();\n    this.u1 = stream.readFloat32();\n    this.u2 = stream.readInt32();\n    this.channel = stream.readInt32();\n    this.minDistance = stream.readFloat32();\n    this.maxDistance = stream.readFloat32();\n    this.distanceCutoff = stream.readFloat32();\n    this.u3 = stream.readFloat32();\n    this.u4 = stream.readFloat32();\n    this.u5 = stream.readInt32();\n    this.u6 = stream.readFloat32();\n    this.u7 = stream.readFloat32();\n    this.u8 = stream.readFloat32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.write(`${this.name}\\0`);\n    stream.write(`${this.file}\\0`);\n    stream.write(`${this.eaxEffect}\\0`);\n    stream.writeUint32(this.flags);\n    stream.writeUint32(this.fadeInRate);\n    stream.writeUint32(this.fadeOutRate);\n    stream.writeUint32(this.volume);\n    stream.writeFloat32(this.pitch);\n    stream.writeFloat32(this.u1);\n    stream.writeInt32(this.u2);\n    stream.writeInt32(this.channel);\n    stream.writeFloat32(this.minDistance);\n    stream.writeFloat32(this.maxDistance);\n    stream.writeFloat32(this.distanceCutoff);\n    stream.writeFloat32(this.u3);\n    stream.writeFloat32(this.u4);\n    stream.writeInt32(this.u5);\n    stream.writeFloat32(this.u6);\n    stream.writeFloat32(this.u7);\n    stream.writeFloat32(this.u8);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 71 + this.name.length + this.file.length + this.eaxEffect.length;\n  }\n}\n","\n/**\n * A map title.\n */\nexport default class MapTitle {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.visible = 0;\n    /** @member {string} */\n    this.chapterTitle = '';\n    /** @member {string} */\n    this.mapTitle = '';\n    /** @member {string} */\n    this.path = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.visible = stream.readInt32();\n    this.chapterTitle = stream.readUntilNull();\n    this.mapTitle = stream.readUntilNull();\n    this.path = stream.readUntilNull();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt32(this.visible);\n    stream.write(`${this.chapterTitle}\\0`);\n    stream.write(`${this.mapTitle}\\0`);\n    stream.write(`${this.path}\\0`);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 7 + this.chapterTitle.length + this.mapTitle.length + this.path.length;\n  }\n}\n","\n/**\n * A map order.\n */\nexport default class MapOrder {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.u1 = 0;\n    /** @member {string} */\n    this.path = '';\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  load(stream) {\n    this.u1 = stream.readInt8();\n    this.path = stream.readUntilNull();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  save(stream) {\n    stream.writeInt8(this.u1);\n    stream.write(`${this.path}\\0`);\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 2 + this.path.length;\n  }\n}\n","import File from './file';\n\nexport default {\n  File,\n};\n","import Map from './map';\nimport doo from './doo';\nimport imp from './imp';\nimport mmp from './mmp';\nimport shd from './shd';\nimport w3c from './w3c';\nimport w3d from './w3d';\nimport w3e from './w3e';\nimport w3i from './w3i';\nimport w3o from './w3o';\nimport w3r from './w3r';\nimport w3s from './w3s';\nimport w3u from './w3u';\nimport wct from './wct';\nimport wpm from './wpm';\nimport wtg from './wtg';\nimport wts from './wts';\nimport unitsdoo from './unitsdoo';\nimport w3f from './w3f';\n\nexport default {\n  Map,\n  doo,\n  imp,\n  mmp,\n  shd,\n  w3c,\n  w3d,\n  w3e,\n  w3i,\n  w3o,\n  w3r,\n  w3s,\n  w3u,\n  wct,\n  wpm,\n  wtg,\n  wts,\n  unitsdoo,\n  w3f,\n};\n","import Doodad from './doodad';\nimport TerrainDoodad from './terraindoodad';\nimport File from './file';\n\nexport default {\n  Doodad,\n  TerrainDoodad,\n  File,\n};\n","import Import from './import';\nimport File from './file';\n\nexport default {\n  Import,\n  File,\n};\n","import MinimapIcon from './minimapicon';\nimport File from './file';\n\nexport default {\n  MinimapIcon,\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\nimport MinimapIcon from './minimapicon';\n\n/**\n * war3map.mmp - the minimap icon file.\n */\nexport default class War3MapMmp {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.u1 = 0;\n    /** @member {Array<MinimapIcon>} */\n    this.icons = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.u1 = stream.readInt32();\n\n    for (let i = 0, l = stream.readInt32(); i < l; i++) {\n      let icon = new MinimapIcon();\n\n      icon.load(stream);\n\n      this.icons[i] = icon;\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.u1);\n    stream.writeUint32(this.icons.length);\n\n    for (let icon of this.icons) {\n      icon.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 8 + this.icons.length * 16;\n  }\n}\n","import File from './file';\n\nexport default {\n  File,\n};\n","/**\n * war3map.shd - the shadow file.\n */\nexport default class War3MapShd {\n  /**\n   * @param {?ArrayBuffer} buffer\n   * @param {?number} width\n   * @param {?number} height\n   */\n  constructor(buffer, width, height) {\n    /** @member {Uint8Array} */\n    this.shadows = new Uint8Array(0);\n\n    if (buffer) {\n      this.load(buffer, width, height);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   * @param {number} width\n   * @param {number} height\n   */\n  load(buffer, width, height) {\n    this.shadows = new Uint8Array(buffer.slice(0, width * height * 16));\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    return this.shadows.slice().buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return this.shadows.length;\n  }\n}\n","import Camera from './camera';\nimport File from './file';\n\nexport default {\n  Camera,\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\nimport Camera from './camera';\n\n/**\n * war3map.w3c - the camera file.\n */\nexport default class War3MapW3c {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {Array<Camera>} */\n    this.cameras = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let camera = new Camera();\n\n      camera.load(stream);\n\n      this.cameras[i] = camera;\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.cameras.length);\n\n    for (let camera of this.cameras) {\n      camera.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 8;\n\n    for (let camera of this.cameras) {\n      size += camera.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import File from './file';\n\nexport default {\n  File,\n};\n","import Corner from './corner';\nimport File from './file';\n\nexport default {\n  Corner,\n  File,\n};\n","import Player from './player';\nimport Force from './force';\nimport UpgradeAvailabilityChange from './upgradeavailabilitychange';\nimport TechAvailabilityChange from './techavailabilitychange';\nimport RandomUnitTable from './randomunittable';\nimport RandomUnit from './randomunit';\nimport RandomItemTable from './randomitemtable';\nimport RandomItemSet from './randomitemset';\nimport RandomItem from './randomitem';\nimport File from './file';\n\nexport default {\n  Player,\n  Force,\n  UpgradeAvailabilityChange,\n  TechAvailabilityChange,\n  RandomUnitTable,\n  RandomUnit,\n  RandomItemTable,\n  RandomItemSet,\n  RandomItem,\n  File,\n};\n","import File from './file';\n\nexport default {\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\nimport War3MapW3u from '../w3u/file';\nimport War3MapW3d from '../w3d/file';\n\n/**\n * war3map.w3o - the combined modification file.\n *\n * Contains all of the modifications of a map.\n * Can be exported and imported via the World Editor.\n */\nexport default class War3MapW3o {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {?War3MapW3u} */\n    this.units = null;\n    /** @member {?War3MapW3u} */\n    this.items = null;\n    /** @member {?War3MapW3u} */\n    this.destructables = null;\n    /** @member {?War3MapW3d} */\n    this.doodads = null;\n    /** @member {?War3MapW3d} */\n    this.abilities = null;\n    /** @member {?War3MapW3u} */\n    this.buffs = null;\n    /** @member {?War3MapW3d} */\n    this.upgrades = null;\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n\n    if (stream.readInt32()) {\n      this.units = new War3MapW3u(stream);\n    }\n\n    if (stream.readInt32()) {\n      this.items = new War3MapW3u(stream);\n    }\n\n    if (stream.readInt32()) {\n      this.destructables = new War3MapW3u(stream);\n    }\n\n    if (stream.readInt32()) {\n      this.doodads = new War3MapW3d(stream);\n    }\n\n    if (stream.readInt32()) {\n      this.abilities = new War3MapW3d(stream);\n    }\n\n    if (stream.readInt32()) {\n      this.buffs = new War3MapW3u(stream);\n    }\n\n    if (stream.readInt32()) {\n      this.upgrades = new War3MapW3d(stream);\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n\n    if (this.units) {\n      stream.writeInt32(1);\n      this.units.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if (this.items) {\n      stream.writeInt32(1);\n      this.items.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if (this.destructables) {\n      stream.writeInt32(1);\n      this.destructables.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if (this.doodads) {\n      stream.writeInt32(1);\n      this.doodads.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if (this.abilities) {\n      stream.writeInt32(1);\n      this.abilities.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if (this.buffs) {\n      stream.writeInt32(1);\n      this.buffs.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    if (this.upgrades) {\n      stream.writeInt32(1);\n      this.upgrades.save(stream);\n    } else {\n      stream.writeInt32(0);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 32;\n\n    if (this.units) {\n      size += this.units.getByteLength();\n    }\n\n    if (this.items) {\n      size += this.items.getByteLength();\n    }\n\n    if (this.destructables) {\n      size += this.destructables.getByteLength();\n    }\n\n    if (this.doodads) {\n      size += this.doodads.getByteLength();\n    }\n\n    if (this.abilities) {\n      size += this.abilities.getByteLength();\n    }\n\n    if (this.buffs) {\n      size += this.buffs.getByteLength();\n    }\n\n    if (this.upgrades) {\n      size += this.upgrades.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import Region from './region';\nimport File from './file';\n\nexport default {\n  Region,\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\nimport Region from './region';\n\n/**\n * war3map.w3r - the region file.\n */\nexport default class War3MapW3r {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {Array<Region>} */\n    this.regions = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      this.regions[i] = new Region(stream);\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.regions.length);\n\n    for (let region of this.regions) {\n      region.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n    * @return {number}\n    */\n  getByteLength() {\n    let size = 8;\n\n    for (let regions of this.regions) {\n      size += regions.calcSize();\n    }\n\n    return size;\n  }\n}\n","import Sound from './sound';\nimport File from './file';\n\nexport default {\n  Sound,\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\nimport Sound from './sound';\n\n/**\n * war3map.w3s - the sound file.\n */\nexport default class War3MapW3s {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {Array<Sound>} */\n    this.sounds = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let sound = new Sound();\n\n      sound.load(stream);\n\n      this.sounds[i] = sound;\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.calcSize());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    stream.writeUint32(this.sounds.length);\n\n    for (let sound of this.sounds) {\n      sound.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 8;\n\n    for (let sound of this.sounds) {\n      size += sound.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import Modification from './modification';\nimport ModifiedObject from './modifiedobject';\nimport ModificationTable from './modificationtable';\nimport File from './file';\n\nexport default {\n  Modification,\n  ModifiedObject,\n  ModificationTable,\n  File,\n};\n","import CustomTextTrigger from './customtexttrigger';\nimport File from './file';\n\nexport default {\n  CustomTextTrigger,\n  File,\n};\n","import File from './file';\n\nexport default {\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\n\n/**\n * war3map.wpm - the pathing file.\n */\nexport default class War3MapWpm {\n  /**\n   * @param {?ArrayBuffer} buffer\n   */\n  constructor(buffer) {\n    /** @member {number} */\n    this.version = 0;\n    /** @member {number} */\n    this.size = new Int32Array(2);\n    /** @member {Uint8Array} */\n    this.pathing = new Uint8Array(1);\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   * @return {boolean}\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    if (stream.read(4) !== 'MP3W') {\n      return false;\n    }\n\n    this.version = stream.readInt32();\n    this.size = stream.readInt32Array(2);\n    this.pathing = stream.readUint8Array(this.size[0] * this.size[1]);\n\n    return true;\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.write('MP3W');\n    stream.writeInt32(this.version);\n    stream.writeInt32Array(this.size);\n    stream.writeUint8Array(this.pathing);\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 16 + (this.size[0] * this.size[1]);\n  }\n}\n","import ECA from './eca';\nimport Parameter from './parameter';\nimport SubParameters from './subparameters';\nimport Trigger from './trigger';\nimport TriggerCategory from './triggercategory';\nimport Variable from './variable';\nimport File from './file';\nimport TriggerData from './triggerdata';\n\nexport default {\n  ECA,\n  Parameter,\n  SubParameters,\n  Trigger,\n  TriggerCategory,\n  Variable,\n  File,\n  TriggerData,\n};\n","import IniFile from '../../ini/file';\n\n/**\n * Trigger data needed to load a WTG file.\n */\nexport default class TriggerData {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Object<string, string>} */\n    this.types = {};\n    /** @member {Array<Object>} */\n    this.functions = [{}, {}, {}, {}];\n    /** @member {Object<string, string>} */\n    this.presets = {};\n    /** @member {Object<string, string>} */\n    this.externalTypes = {};\n    /** @member {Array<Object>} */\n    this.externalFunctions = [{}, {}, {}, {}];\n    /** @member {Object<string, string>} */\n    this.externalPresets = {};\n  }\n\n  /**\n   * @param {string} buffer\n   * @param {boolean} isExternal\n   */\n  addTriggerData(buffer, isExternal) {\n    let types = this.types;\n    let functions = this.functions;\n    let presets = this.presets;\n\n    if (isExternal) {\n      types = this.externalTypes;\n      functions = this.externalFunctions;\n      presets = this.externalPresets;\n    }\n\n    let triggerData = new IniFile();\n\n    triggerData.load(buffer);\n\n    this.addTriggerTypes(types, triggerData.getSection('TriggerTypes'));\n    this.addTriggerDataFunctions(functions[0], triggerData.getSection('TriggerEvents'), 1);\n    this.addTriggerDataFunctions(functions[1], triggerData.getSection('TriggerConditions'), 1);\n    this.addTriggerDataFunctions(functions[2], triggerData.getSection('TriggerActions'), 1);\n    this.addTriggerDataFunctions(functions[3], triggerData.getSection('TriggerCalls'), 3);\n    this.addTriggerDataPresets(presets, triggerData.getSection('TriggerParams'));\n  }\n\n  /**\n   * @param {Object} types\n   * @param {Map<string, string>} section\n   */\n  addTriggerTypes(types, section) {\n    for (let [key, value] of section) {\n      let tokens = value.split(',');\n\n      types[key] = tokens[4] || '';\n    }\n  }\n\n  /**\n   * @param {Object} functions\n   * @param {Map<string, string>} section\n   * @param {number} skipped\n   */\n  addTriggerDataFunctions(functions, section, skipped) {\n    for (let [key, value] of section) {\n      // We don't care about metadata lines.\n      if (key[0] !== '_') {\n        let tokens = value.split(',').slice(skipped);\n        let args = [];\n\n        // Can be used by actions to make aliases.\n        let scriptName = section.get(`_${key}_scriptname`) || null;\n\n        for (let argument of tokens) {\n          // We don't care about constants.\n          if (isNaN(argument) && argument !== 'nothing' && argument !== '') {\n            args.push(argument);\n          }\n        }\n\n        functions[key] = {args, scriptName};\n      }\n    }\n  }\n\n  /**\n   * @param {Object} presets\n   * @param {Map<string, string>} section\n   */\n  addTriggerDataPresets(presets, section) {\n    for (let [key, value] of section) {\n      let tokens = value.split(',');\n\n      // Note that the operators are enclosed by \"\" for some reason.\n      // Note that string literals are enclosed by backticks.\n      presets[key] = tokens[2].replace(/\"/g, '').replace(/`/g, '\"');\n    }\n  }\n\n  /**\n   * Given a type, return its base type.\n   * Returns the given type if its not a child type.\n   *\n   * @param {string} type\n   * @return {string}\n   */\n  getBaseType(type) {\n    type = type.toLowerCase();\n\n    let base = this.types[type];\n\n    if (base === undefined) {\n      base = this.externalTypes[type];\n    }\n\n    // Same as !base, but be explicit to be clearer.\n    if (base === '' || base === undefined) {\n      return type;\n    }\n\n    return base;\n  }\n\n  /**\n   * @param {number} type\n   * @param {string} name\n   * @return {boolean}\n   */\n  isBaseFunction(type, name) {\n    name = name.toLowerCase();\n\n    if (this.functions[type][name]) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Gets the signature of the given function.\n   *\n   * @param {number} type\n   * @param {string} name\n   * @return {Array<string>}\n   */\n  getFunction(type, name) {\n    name = name.toLowerCase();\n\n    let args = this.functions[type][name];\n\n    if (!args) {\n      args = this.externalFunctions[type][name];\n\n      if (!args) {\n        throw new Error(`Tried to get signature for unknown function \"${name}\"`);\n      }\n    }\n\n    return args;\n  }\n\n  /**\n  * Gets a preset value.\n  *\n  * @param {string} name\n  * @return {string}\n  */\n  getPreset(name) {\n    name = name.toLowerCase();\n\n    let preset = this.presets[name];\n\n    if (preset === undefined) {\n      preset = this.externalPresets[name];\n\n      if (preset === undefined) {\n        throw new Error(`Failed to find a preset: ${name}`);\n      }\n    }\n\n    return preset;\n  }\n\n  /**\n   * Is the given preset a custom or standard one?\n   *\n   * @param {string} name\n   * @return {boolean}\n   */\n  isCustomPreset(name) {\n    name = name.toLowerCase();\n\n    if (this.presets[name] !== undefined) {\n      return false;\n    }\n\n    if (this.externalPresets[name] !== undefined) {\n      return true;\n    }\n\n    throw new Error(`Failed to find a preset: ${name}`);\n  }\n}\n","import File from './file';\n\nexport default {\n  File,\n};\n","import DroppedItem from './droppeditem';\nimport DroppedItemSet from './droppeditemset';\nimport InventoryItem from './inventoryitem';\nimport ModifiedAbility from './modifiedability';\nimport RandomUnit from './randomunit';\nimport Unit from './unit';\nimport File from './file';\n\nexport default {\n  DroppedItem,\n  DroppedItemSet,\n  InventoryItem,\n  ModifiedAbility,\n  RandomUnit,\n  Unit,\n  File,\n};\n","import BinaryStream from '../../../common/binarystream';\nimport MapTitle from './maptitle';\nimport MapOrder from './maporder';\n\n/**\n * war3campaign.w3f - the campaign information file.\n */\nexport default class War3CampaignW3f {\n  /**\n   *\n   */\n  constructor() {\n    this.version = 0;\n    this.campaignVersion = 0;\n    this.editorVersion = 0;\n    this.name = '';\n    this.difficulty = '';\n    this.author = '';\n    this.description = '';\n    this.mode = -1; // 0: fixed difficulty, only w3m maps, 1: variable difficulty, only w3m maps, 1: fixed..., contains w3x maps, 2: variable..., contains w3xm maps.\n    this.backgroundScreen = -1; // -1 = none or custom path\n    this.backgroundScreenPath = '';\n    this.minimapImagePath = '';\n    this.ambientSound = 0; // -1 = imported, 0 = none, >0 = preset index\n    this.ambientSoundPath = '';\n    this.terrainFog = 0; // 0 = not used, >0 = index of terrain fog style\n    this.fogStartZ = 0;\n    this.fogEndZ = 0;\n    this.fogDensity = 0;\n    this.fogColor = new Uint8Array(4);\n    this.userInterface = -1; // 0 = human\n    this.mapTitles = [];\n    this.mapOrders = [];\n  }\n\n  /**\n   * @param {ArrayBuffer} buffer\n   */\n  load(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    this.version = stream.readInt32();\n    this.campaignVersion = stream.readInt32();\n    this.editorVersion = stream.readInt32();\n    this.name = stream.readUntilNull();\n    this.difficulty = stream.readUntilNull();\n    this.author = stream.readUntilNull();\n    this.description = stream.readUntilNull();\n    this.mode = stream.readInt32();\n    this.backgroundScreen = stream.readInt32();\n    this.backgroundScreenPath = stream.readUntilNull();\n    this.minimapImagePath = stream.readUntilNull();\n    this.ambientSound = stream.readInt32();\n    this.ambientSoundPath = stream.readUntilNull();\n    this.terrainFog = stream.readInt32();\n    this.fogStartZ = stream.readFloat32();\n    this.fogEndZ = stream.readFloat32();\n    this.fogDensity = stream.readFloat32();\n    stream.readUint8Array(this.fogColor);\n    this.userInterface = stream.readInt32();\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let mapTitle = new MapTitle();\n\n      mapTitle.load(stream);\n\n      this.mapTitles[i] = mapTitle;\n    }\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let mapOrder = new MapOrder();\n\n      mapOrder.load(stream);\n\n      this.mapOrders[i] = mapOrder;\n    }\n  }\n\n  /**\n   * @return {ArrayBuffer}\n   */\n  save() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.writeInt32(this.version);\n    stream.writeInt32(this.campaignVersion);\n    stream.writeInt32(this.editorVersion);\n    stream.write(`${this.name}\\0`);\n    stream.write(`${this.difficulty}\\0`);\n    stream.write(`${this.author}\\0`);\n    stream.write(`${this.description}\\0`);\n    stream.writeInt32(this.mode);\n    stream.writeInt32(this.backgroundScreen);\n    stream.write(`${this.backgroundScreenPath}\\0`);\n    stream.write(`${this.minimapImagePath}\\0`);\n    stream.writeInt32(this.ambientSound);\n    stream.write(`${this.ambientSoundPath}\\0`);\n    stream.writeInt32(this.terrainFog);\n    stream.writeFloat32(this.fogStartZ);\n    stream.writeFloat32(this.fogEndZ);\n    stream.writeFloat32(this.fogDensity);\n    stream.writeUint8Array(this.fogColor);\n    stream.writeInt32(this.userInterface);\n    stream.writeUint32(this.mapTitles.length);\n\n    for (let title of this.mapTitles) {\n      title.save(stream);\n    }\n\n    stream.writeUint32(this.mapOrders.length);\n\n    for (let order of this.mapOrders) {\n      order.save(stream);\n    }\n\n    return buffer;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 63 + this.name.length + this.difficulty.length + this.author.length + this.description.length + this.backgroundScreenPath.length + this.minimapImagePath.length + this.ambientSoundPath.length;\n\n    for (let title of this.mapTitles) {\n      size += title.getByteLength();\n    }\n\n    for (let order of this.mapOrders) {\n      size += order.getByteLength();\n    }\n\n    return size;\n  }\n}\n","/**\n * An extent.\n */\nexport default class Extent {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.boundsRadius = 0;\n    /** @member {Float32Array} */\n    this.min = new Float32Array(3);\n    /** @member {Float32Array} */\n    this.max = new Float32Array(3);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    this.boundsRadius = stream.readFloat32();\n    stream.readFloat32Array(this.min);\n    stream.readFloat32Array(this.max);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeFloat32(this.boundsRadius);\n    stream.writeFloat32Array(this.min);\n    stream.writeFloat32Array(this.max);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    if (this.min[0] !== 0 || this.min[1] !== 0 || this.min[2] !== 0) {\n      stream.writeFloatArrayAttrib('MinimumExtent', this.min);\n    }\n\n    if (this.max[0] !== 0 || this.max[1] !== 0 || this.max[2] !== 0) {\n      stream.writeFloatArrayAttrib('MaximumExtent', this.max);\n    }\n\n    if (this.boundsRadius !== 0) {\n      stream.writeFloatAttrib('BoundsRadius', this.boundsRadius);\n    }\n  }\n}\n","import Extent from './extent';\n\n/**\n * A sequence.\n */\nexport default class Sequence {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.name = '';\n    /** @member {Uint32Array} */\n    this.interval = new Uint32Array(2);\n    /** @member {number} */\n    this.moveSpeed = 0;\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.rarity = 0;\n    /** @member {number} */\n    this.syncPoint = 0;\n    /** @member {Extent} */\n    this.extent = new Extent();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    this.name = stream.read(80);\n    stream.readUint32Array(this.interval);\n    this.moveSpeed = stream.readFloat32();\n    this.flags = stream.readUint32();\n    this.rarity = stream.readFloat32();\n    this.syncPoint = stream.readUint32();\n    this.extent.readMdx(stream);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.write(this.name);\n    stream.skip(80 - this.name.length);\n    stream.writeUint32Array(this.interval);\n    stream.writeFloat32(this.moveSpeed);\n    stream.writeUint32(this.flags);\n    stream.writeFloat32(this.rarity);\n    stream.writeUint32(this.syncPoint);\n    this.extent.writeMdx(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    this.name = stream.read();\n\n    for (let token of stream.readBlock()) {\n      if (token === 'Interval') {\n        stream.readIntArray(this.interval);\n      } else if (token === 'NonLooping') {\n        this.flags = 1;\n      } else if (token === 'MoveSpeed') {\n        this.moveSpeed = stream.readFloat();\n      } else if (token === 'Rarity') {\n        this.rarity = stream.readFloat();\n      } else if (token === 'MinimumExtent') {\n        stream.readFloatArray(this.extent.min);\n      } else if (token === 'MaximumExtent') {\n        stream.readFloatArray(this.extent.max);\n      } else if (token === 'BoundsRadius') {\n        this.extent.boundsRadius = stream.readFloat();\n      } else {\n        throw new Error(`Unknown token in Sequence: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('Anim', this.name);\n    stream.writeArrayAttrib('Interval', this.interval);\n\n    if (this.flags === 1) {\n      stream.writeFlag('NonLooping');\n    }\n\n    if (this.moveSpeed !== 0) {\n      stream.writeFloatAttrib('MoveSpeed', this.moveSpeed);\n    }\n\n    if (this.rarity !== 0) {\n      stream.writeFloatAttrib('Rarity', this.rarity);\n    }\n\n    this.extent.writeMdl(stream);\n    stream.endBlock();\n  }\n}\n","/**\n * A templated animation track.\n *\n * @param {Uint32Array|Float32Array} DataType\n * @param {number} size\n * @return {class}\n */\nconst templatedTrack = (DataType, size) => class {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.frame = 0;\n    /** @member {Uint32Array|Float32Array} */\n    this.value = new DataType(size);\n    /** @member {Uint32Array|Float32Array} */\n    this.inTan = new DataType(size);\n    /** @member {Uint32Array|Float32Array} */\n    this.outTan = new DataType(size);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} interpolationType\n   */\n  readMdx(stream, interpolationType) {\n    this.frame = stream.readUint32();\n    stream.readTypedArray(this.value);\n\n    if (interpolationType > 1) {\n      stream.readTypedArray(this.inTan);\n      stream.readTypedArray(this.outTan);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} interpolationType\n   */\n  writeMdx(stream, interpolationType) {\n    stream.writeUint32(this.frame);\n    stream.writeTypedArray(this.value);\n\n    if (interpolationType > 1) {\n      stream.writeTypedArray(this.inTan);\n      stream.writeTypedArray(this.outTan);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {number} interpolationType\n   */\n  readMdl(stream, interpolationType) {\n    this.frame = stream.readInt();\n    stream.readKeyframe(this.value);\n\n    if (interpolationType > 1) {\n      stream.read(); // InTan\n      stream.readKeyframe(this.inTan);\n      stream.read(); // OutTan\n      stream.readKeyframe(this.outTan);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {number} interpolationType\n   */\n  writeMdl(stream, interpolationType) {\n    stream.writeKeyframe(`${this.frame}:`, this.value);\n\n    if (interpolationType > 1) {\n      stream.indent();\n      stream.writeKeyframe('InTan', this.inTan);\n      stream.writeKeyframe('OutTan', this.outTan);\n      stream.unindent();\n    }\n  }\n\n  /**\n   * @param {number} interpolationType\n   * @return {number}\n   */\n  getByteLength(interpolationType) {\n    let valueSize = this.value.byteLength;\n    let size = 4 + valueSize;\n\n    if (interpolationType > 1) {\n      size += valueSize * 2;\n    }\n\n    return size;\n  }\n};\n\n/**\n * A uint track.\n */\nexport const UintTrack = templatedTrack(Uint32Array, 1);\n\n/**\n * A float track.\n */\nexport const FloatTrack = templatedTrack(Float32Array, 1);\n\n/**\n * A vector 3 track.\n */\nexport const Vector3Track = templatedTrack(Float32Array, 3);\n\n/**\n * A vector 4 track.\n */\nexport const Vector4Track = templatedTrack(Float32Array, 4);\n","import {UintTrack, FloatTrack, Vector3Track, Vector4Track} from './tracks';\n\n/**\n * A templated animation.\n *\n * @param {UintTrack|FloatTrack|Vector3Track|Vector4Track} TrackType\n * @return {class}\n */\nconst templatedAnimation = (TrackType) => class {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {string} */\n    this.name = '';\n    /** @member {number} */\n    this.interpolationType = 0;\n    /** @member {number} */\n    this.globalSequenceId = -1;\n    /** @member {Array<Track>} */\n    this.tracks = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {string} name\n   */\n  readMdx(stream, name) {\n    this.name = name;\n\n    const tracksCount = stream.readUint32();\n\n    this.interpolationType = stream.readUint32();\n    this.globalSequenceId = stream.readInt32();\n\n    for (let i = 0; i < tracksCount; i++) {\n      const track = new TrackType();\n\n      track.readMdx(stream, this.interpolationType);\n\n      this.tracks.push(track);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.write(this.name);\n    stream.writeUint32(this.tracks.length);\n    stream.writeUint32(this.interpolationType);\n    stream.writeInt32(this.globalSequenceId);\n\n    for (const track of this.tracks) {\n      track.writeMdx(stream, this.interpolationType);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {string} name\n   */\n  readMdl(stream, name) {\n    this.name = name;\n\n    const numberOfTracks = stream.readInt();\n\n    stream.read(); // {\n\n    const token = stream.read();\n\n    if (token === 'DontInterp') {\n      this.interpolationType = 0;\n    } else if (token === 'Linear') {\n      this.interpolationType = 1;\n    } else if (token === 'Hermite') {\n      this.interpolationType = 2;\n    } else if (token === 'Bezier') {\n      this.interpolationType = 3;\n    }\n\n    // GlobalSeqId only exists if it's not -1.\n    if (stream.peek() === 'GlobalSeqId') {\n      stream.read();\n\n      this.globalSequenceId = stream.readInt();\n    }\n\n    for (let i = 0; i < numberOfTracks; i++) {\n      const track = new TrackType();\n\n      track.readMdl(stream, this.interpolationType);\n\n      this.tracks[i] = track;\n    }\n\n    stream.read(); // }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {string} name\n   */\n  writeMdl(stream, name) {\n    stream.startBlock(name, this.tracks.length);\n\n    let token;\n\n    if (this.interpolationType === 0) {\n      token = 'DontInterp';\n    } else if (this.interpolationType === 1) {\n      token = 'Linear';\n    } else if (this.interpolationType === 2) {\n      token = 'Hermite';\n    } else if (this.interpolationType === 3) {\n      token = 'Bezier';\n    }\n\n    stream.writeFlag(token);\n\n    if (this.globalSequenceId !== -1) {\n      stream.writeAttrib('GlobalSeqId', this.globalSequenceId);\n    }\n\n    for (const track of this.tracks) {\n      track.writeMdl(stream, this.interpolationType);\n    }\n\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let tracks = this.tracks;\n    let size = 16;\n\n    if (tracks.length) {\n      size += tracks[0].getByteLength(this.interpolationType) * tracks.length;\n    }\n\n    return size;\n  }\n};\n\n/**\n * A uint animation.\n */\nexport const UintAnimation = templatedAnimation(UintTrack);\n\n/**\n * A float animation\n */\nexport const FloatAnimation = templatedAnimation(FloatTrack);\n\n/**\n * A vector 3 animation.\n */\nexport const Vector3Animation = templatedAnimation(Vector3Track);\n\n/**\n * A vector 4 animation.\n */\nexport const Vector4Animation = templatedAnimation(Vector4Track);\n","import {UintAnimation, FloatAnimation, Vector3Animation, Vector4Animation} from './animations';\n\n// A map from MDX animation tags to their equivalent MDL tokens, and the implementation objects.\nexport default {\n  // Layer\n  KMTF: ['TextureId', UintAnimation],\n  KMTA: ['Alpha', FloatAnimation],\n  // TextureAnimation\n  KTAT: ['Translation', Vector3Animation],\n  KTAR: ['Rotation', Vector4Animation],\n  KTAS: ['Scaling', Vector3Animation],\n  // GeosetAnimation\n  KGAO: ['Alpha', FloatAnimation],\n  KGAC: ['Color', Vector3Animation],\n  // Light\n  KLAS: ['AttenuationStart', FloatAnimation],\n  KLAE: ['AttenuationEnd', FloatAnimation],\n  KLAC: ['Color', Vector3Animation],\n  KLAI: ['Intensity', FloatAnimation],\n  KLBI: ['AmbientIntensity', FloatAnimation],\n  KLBC: ['AmbientColor', Vector3Animation],\n  KLAV: ['Visibility', FloatAnimation],\n  // Attachment\n  KATV: ['Visibility', FloatAnimation],\n  // ParticleEmitter\n  KPEE: ['EmissionRate', FloatAnimation],\n  KPEG: ['Gravity', FloatAnimation],\n  KPLN: ['Longitude', FloatAnimation],\n  KPLT: ['Latitude', FloatAnimation],\n  KPEL: ['LifeSpan', FloatAnimation],\n  KPES: ['Speed', FloatAnimation],\n  KPEV: ['Visibility', FloatAnimation],\n  // ParticleEmitter2\n  KP2S: ['Speed', FloatAnimation],\n  KP2R: ['Variation', FloatAnimation],\n  KP2L: ['Latitude', FloatAnimation],\n  KP2G: ['Gravity', FloatAnimation],\n  KP2E: ['EmissionRate', FloatAnimation],\n  KP2N: ['Length', FloatAnimation],\n  KP2W: ['Width', FloatAnimation],\n  KP2V: ['Visibility', FloatAnimation],\n  // RibbonEmitter\n  KRHA: ['HeightAbove', FloatAnimation],\n  KRHB: ['HeightBelow', FloatAnimation],\n  KRAL: ['Alpha', FloatAnimation],\n  KRCO: ['Color', Vector3Animation],\n  KRTX: ['TextureSlot', UintAnimation],\n  KRVS: ['Visibility', FloatAnimation],\n  // Camera\n  KCTR: ['Translation', Vector3Animation],\n  KTTR: ['Translation', Vector3Animation],\n  KCRL: ['Rotation', UintAnimation],\n  // GenericObject\n  KGTR: ['Translation', Vector3Animation],\n  KGRT: ['Rotation', Vector4Animation],\n  KGSC: ['Scaling', Vector3Animation],\n};\n","import animationMap from './animationmap';\n\n/**\n * The parent class for all objects that have animated data in them.\n */\nexport default class AnimatedObject {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Array<Animation>} */\n    this.animations = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} size\n   */\n  readAnimations(stream, size) {\n    while (size > 0) {\n      let name = stream.read(4, true);\n      let animation = new animationMap[name][1]();\n\n      animation.readMdx(stream, name);\n\n      size -= animation.getByteLength();\n\n      this.animations.push(animation);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeAnimations(stream) {\n    for (let animation of this.animations) {\n      animation.writeMdx(stream);\n    }\n  }\n\n  /**\n   * A wrapper around readBlock() which merges static tokens.\n   * E.g.: static Color\n   * This makes the condition blocks in the parent objects linear and simple.\n   *\n   * @param {BinaryStream} stream\n   */\n  * readAnimatedBlock(stream) {\n    for (let token of stream.readBlock()) {\n      if (token === 'static') {\n        yield `static ${stream.read()}`;\n      } else {\n        yield token;\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {string} name\n   */\n  readAnimation(stream, name) {\n    let animation = new animationMap[name][1]();\n\n    animation.readMdl(stream, name);\n\n    this.animations.push(animation);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {string} name\n   * @return {boolean}\n   */\n  writeAnimation(stream, name) {\n    for (let animation of this.animations) {\n      if (animation.name === name) {\n        animation.writeMdl(stream, animationMap[name][0]);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 0;\n\n    for (let animation of this.animations) {\n      size += animation.getByteLength();\n    }\n\n    return size;\n  }\n}\n","import AnimatedObject from './animatedobject';\n\nlet filterModeToMdx = {\n  None: 0,\n  Transparent: 1,\n  Blend: 2,\n  Additive: 3,\n  AddAlpha: 4,\n  Modulate: 5,\n  Modulate2x: 6,\n};\n\nlet filterModeToMdl = {\n  0: 'None',\n  1: 'Transparent',\n  2: 'Blend',\n  3: 'Additive',\n  4: 'AddAlpha',\n  5: 'Modulate',\n  6: 'Modulate2x',\n};\n\n/**\n * A layer.\n */\nexport default class Layer extends AnimatedObject {\n  /**\n   *\n   */\n  constructor() {\n    super();\n\n    /** @member {number} */\n    this.filterMode = 0;\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {number} */\n    this.textureId = -1;\n    /** @member {number} */\n    this.textureAnimationId = -1;\n    /** @member {number} */\n    this.coordId = 0;\n    /** @member {number} */\n    this.alpha = 1;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    this.filterMode = stream.readUint32();\n    this.flags = stream.readUint32();\n    this.textureId = stream.readInt32();\n    this.textureAnimationId = stream.readInt32();\n    this.coordId = stream.readUint32();\n    this.alpha = stream.readFloat32();\n\n    this.readAnimations(stream, size - 28);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n    stream.writeUint32(this.filterMode);\n    stream.writeUint32(this.flags);\n    stream.writeInt32(this.textureId);\n    stream.writeInt32(this.textureAnimationId);\n    stream.writeUint32(this.coordId);\n    stream.writeFloat32(this.alpha);\n\n    this.writeAnimations(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of this.readAnimatedBlock(stream)) {\n      if (token === 'FilterMode') {\n        this.filterMode = filterModeToMdx[stream.read()];\n      } else if (token === 'Unshaded') {\n        this.flags |= 0x1;\n      } else if (token === 'SphereEnvMap') {\n        this.flags |= 0x2;\n      } else if (token === 'TwoSided') {\n        this.flags |= 0x10;\n      } else if (token === 'Unfogged') {\n        this.flags |= 0x20;\n      } else if (token === 'NoDepthTest') {\n        this.flags |= 0x40;\n      } else if (token === 'NoDepthSet') {\n        this.flags |= 0x100;\n      } else if (token === 'static TextureID') {\n        this.textureId = stream.readInt();\n      } else if (token === 'TextureID') {\n        this.readAnimation(stream, 'KMTF');\n      } else if (token === 'TVertexAnimId') {\n        this.textureAnimationId = stream.readInt();\n      } else if (token === 'CoordId') {\n        this.coordId = stream.readInt();\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KMTA');\n      } else {\n        throw new Error(`Unknown token in Layer: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startBlock('Layer');\n\n    stream.writeAttrib('FilterMode', filterModeToMdl[this.filterMode]);\n\n    if (this.flags & 0x1) {\n      stream.writeFlag('Unshaded');\n    }\n\n    if (this.flags & 0x2) {\n      stream.writeFlag('SphereEnvMap');\n    }\n\n    if (this.flags & 0x10) {\n      stream.writeFlag('TwoSided');\n    }\n\n    if (this.flags & 0x20) {\n      stream.writeFlag('Unfogged');\n    }\n\n    if (this.flags & 0x40) {\n      stream.writeFlag('NoDepthTest');\n    }\n\n    if (this.flags & 0x100) {\n      stream.writeFlag('NoDepthSet');\n    }\n\n    if (!this.writeAnimation(stream, 'KMTF')) {\n      stream.writeAttrib('static TextureID', this.textureId);\n    }\n\n    if (this.textureAnimationId !== -1) {\n      stream.writeAttrib('TVertexAnimId', this.textureAnimationId);\n    }\n\n    if (this.coordId !== 0) {\n      stream.writeAttrib('CoordId', this.coordId);\n    }\n\n    if (!this.writeAnimation(stream, 'KMTA') && this.alpha !== 1) {\n      stream.writeFloatAttrib('static Alpha', this.alpha);\n    }\n\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 28 + super.getByteLength();\n  }\n}\n","import Layer from './layer';\n\n/**\n * A material.\n */\nexport default class Material {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.priorityPlane = 0;\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {Array<Layer>} */\n    this.layers = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    stream.readUint32(); // Don't care about the size.\n\n    this.priorityPlane = stream.readUint32();\n    this.flags = stream.readUint32();\n\n    stream.skip(4); // LAYS\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let layer = new Layer();\n\n      layer.readMdx(stream);\n\n      this.layers.push(layer);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n    stream.writeUint32(this.priorityPlane);\n    stream.writeUint32(this.flags);\n    stream.write('LAYS');\n    stream.writeUint32(this.layers.length);\n\n    for (let layer of this.layers) {\n      layer.writeMdx(stream);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of stream.readBlock()) {\n      if (token === 'ConstantColor') {\n        this.flags |= 0x1;\n      } else if (token === 'SortPrimsNearZ') {\n        this.flags |= 0x8;\n      } else if (token === 'SortPrimsFarZ') {\n        this.flags |= 0x10;\n      } else if (token === 'FullResolution') {\n        this.flags |= 0x20;\n      } else if (token === 'PriorityPlane') {\n        this.priorityPlane = stream.readInt();\n      } else if (token === 'Layer') {\n        let layer = new Layer();\n\n        layer.readMdl(stream);\n\n        this.layers.push(layer);\n      } else {\n        throw new Error(`Unknown token in Material: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startBlock('Material');\n\n    if (this.flags & 0x1) {\n      stream.writeFlag('ConstantColor');\n    }\n\n    if (this.flags & 0x8) {\n      stream.writeFlag('SortPrimsNearZ');\n    }\n\n    if (this.flags & 0x10) {\n      stream.writeFlag('SortPrimsFarZ');\n    }\n\n    if (this.flags & 0x20) {\n      stream.writeFlag('FullResolution');\n    }\n\n    if (this.priorityPlane !== 0) {\n      stream.writeAttrib('PriorityPlane', this.priorityPlane);\n    }\n\n    for (let layer of this.layers) {\n      layer.writeMdl(stream);\n    }\n\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 20;\n\n    for (let layer of this.layers) {\n      size += layer.getByteLength();\n    }\n\n    return size;\n  }\n}\n","/**\n * A texture.\n */\nexport default class Texture {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {number} */\n    this.replaceableId = 0;\n    /** @member {string} */\n    this.path = '';\n    /** @member {number} */\n    this.flags = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    this.replaceableId = stream.readUint32();\n    this.path = stream.read(260);\n    this.flags = stream.readUint32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.replaceableId);\n    stream.write(this.path);\n    stream.skip(260 - this.path.length);\n    stream.writeUint32(this.flags);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of stream.readBlock()) {\n      if (token === 'Image') {\n        this.path = stream.read();\n      } else if (token === 'ReplaceableId') {\n        this.replaceableId = stream.readInt();\n      } else if (token === 'WrapWidth') {\n        this.flags |= 0x1;\n      } else if (token === 'WrapHeight') {\n        this.flags |= 0x2;\n      } else {\n        throw new Error(`Unknown token in Texture: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startBlock('Bitmap');\n    stream.writeStringAttrib('Image', this.path);\n\n    if (this.replaceableId !== 0) {\n      stream.writeAttrib('ReplaceableId', this.replaceableId);\n    }\n\n    if (this.flags & 0x1) {\n      stream.writeFlag(`WrapWidth`);\n    }\n\n    if (this.flags & 0x2) {\n      stream.writeFlag(`WrapHeight`);\n    }\n\n    stream.endBlock();\n  }\n}\n","import AnimatedObject from './animatedobject';\n\n/**\n * A texture animation.\n */\nexport default class TextureAnimation extends AnimatedObject {\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    this.readAnimations(stream, size - 4);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n    this.writeAnimations(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of stream.readBlock()) {\n      if (token === 'Translation') {\n        this.readAnimation(stream, 'KTAT');\n      } else if (token === 'Rotation') {\n        this.readAnimation(stream, 'KTAR');\n      } else if (token === 'Scaling') {\n        this.readAnimation(stream, 'KTAS');\n      } else {\n        throw new Error(`Unknown token in TextureAnimation: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startBlock('TVertexAnim ');\n    this.writeAnimation(stream, 'KTAT');\n    this.writeAnimation(stream, 'KTAR');\n    this.writeAnimation(stream, 'KTAS');\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 4 + super.getByteLength();\n  }\n}\n","import Extent from './extent';\n\n/**\n * A geoset.\n */\nexport default class Geoset {\n  /**\n   *\n   */\n  constructor() {\n    /** @member {Float32Array} */\n    this.vertices = new Float32Array(0);\n    /** @member {Float32Array} */\n    this.normals = new Float32Array(0);\n    /** @member {Uint32Array} */\n    this.faceTypeGroups = new Uint32Array(0);\n    /** @member {Uint32Array} */\n    this.faceGroups = new Uint32Array(0);\n    /** @member {Uint16Array} */\n    this.faces = new Uint16Array(0);\n    /** @member {Uint8Array} */\n    this.vertexGroups = new Uint8Array(0);\n    /** @member {Uint32Array} */\n    this.matrixGroups = new Uint32Array(0);\n    /** @member {Uint32Array} */\n    this.matrixIndices = new Uint32Array(0);\n    /** @member {number} */\n    this.materialId = 0;\n    /** @member {number} */\n    this.selectionGroup = 0;\n    /** @member {number} */\n    this.selectionFlags = 0;\n    /** @member {Extent} */\n    this.extent = new Extent();\n    /** @member {Array<Extent>} */\n    this.sequenceExtents = [];\n    /** @member {Array<Float32Array>} */\n    this.uvSets = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    stream.readUint32(); // Don't care about the size.\n    stream.skip(4); // VRTX\n    this.vertices = stream.readFloat32Array(stream.readUint32() * 3);\n    stream.skip(4); // NRMS\n    this.normals = stream.readFloat32Array(stream.readUint32() * 3);\n    stream.skip(4); // PTYP\n    this.faceTypeGroups = stream.readUint32Array(stream.readUint32());\n    stream.skip(4); // PCNT\n    this.faceGroups = stream.readUint32Array(stream.readUint32());\n    stream.skip(4); // PVTX\n    this.faces = stream.readUint16Array(stream.readUint32());\n    stream.skip(4); // GNDX\n    this.vertexGroups = stream.readUint8Array(stream.readUint32());\n    stream.skip(4); // MTGC\n    this.matrixGroups = stream.readUint32Array(stream.readUint32());\n    stream.skip(4); // MATS\n    this.matrixIndices = stream.readUint32Array(stream.readUint32());\n    this.materialId = stream.readUint32();\n    this.selectionGroup = stream.readUint32();\n    this.selectionFlags = stream.readUint32();\n    this.extent.readMdx(stream);\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      let extent = new Extent();\n\n      extent.readMdx(stream);\n\n      this.sequenceExtents.push(extent);\n    }\n\n    stream.skip(4); // UVAS\n\n    for (let i = 0, l = stream.readUint32(); i < l; i++) {\n      stream.skip(4); // UVBS\n      this.uvSets.push(stream.readFloat32Array(stream.readUint32() * 2));\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n    stream.write('VRTX');\n    stream.writeUint32(this.vertices.length / 3);\n    stream.writeFloat32Array(this.vertices);\n    stream.write('NRMS');\n    stream.writeUint32(this.normals.length / 3);\n    stream.writeFloat32Array(this.normals);\n    stream.write('PTYP');\n    stream.writeUint32(this.faceTypeGroups.length);\n    stream.writeUint32Array(this.faceTypeGroups);\n    stream.write('PCNT');\n    stream.writeUint32(this.faceGroups.length);\n    stream.writeUint32Array(this.faceGroups);\n    stream.write('PVTX');\n    stream.writeUint32(this.faces.length);\n    stream.writeUint16Array(this.faces);\n    stream.write('GNDX');\n    stream.writeUint32(this.vertexGroups.length);\n    stream.writeUint8Array(this.vertexGroups);\n    stream.write('MTGC');\n    stream.writeUint32(this.matrixGroups.length);\n    stream.writeUint32Array(this.matrixGroups);\n    stream.write('MATS');\n    stream.writeUint32(this.matrixIndices.length);\n    stream.writeUint32Array(this.matrixIndices);\n    stream.writeUint32(this.materialId);\n    stream.writeUint32(this.selectionGroup);\n    stream.writeUint32(this.selectionFlags);\n    this.extent.writeMdx(stream);\n    stream.writeUint32(this.sequenceExtents.length);\n\n    for (let sequenceExtent of this.sequenceExtents) {\n      sequenceExtent.writeMdx(stream);\n    }\n\n    stream.write('UVAS');\n    stream.writeUint32(this.uvSets.length);\n\n    for (let uvSet of this.uvSets) {\n      stream.write('UVBS');\n      stream.writeUint32(uvSet.length / 2);\n      stream.writeFloat32Array(uvSet);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of stream.readBlock()) {\n      if (token === 'Vertices') {\n        this.vertices = stream.readVectorArray(new Float32Array(stream.readInt() * 3), 3);\n      } else if (token === 'Normals') {\n        this.normals = stream.readVectorArray(new Float32Array(stream.readInt() * 3), 3);\n      } else if (token === 'TVertices') {\n        this.uvSets.push(stream.readVectorArray(new Float32Array(stream.readInt() * 2), 2));\n      } else if (token === 'VertexGroup') {\n        // Vertex groups are stored in a block with no count, can't allocate the buffer yet.\n        let vertexGroups = [];\n\n        for (let vertexGroup of stream.readBlock()) {\n          vertexGroups.push(parseInt(vertexGroup));\n        }\n\n        this.vertexGroups = new Uint8Array(vertexGroups);\n      } else if (token === 'Faces') {\n        // For now hardcoded for triangles, until I see a model with something different.\n        this.faceTypeGroups = new Uint32Array([4]);\n\n        stream.readInt(); // number of groups, irrelevant for now\n\n        let count = stream.readInt();\n\n        stream.read(); // {\n        stream.read(); // Triangles\n        stream.read(); // {\n\n        this.faces = stream.readIntArray(new Uint16Array(count));\n\n        stream.read(); // }\n        stream.read(); // }\n      } else if (token === 'Groups') {\n        let indices = [];\n        let groups = [];\n\n        stream.readInt(); // matrices count\n        stream.readInt(); // total indices\n\n        // eslint-disable-next-line no-unused-vars\n        for (let matrix of stream.readBlock()) {\n          let size = 0;\n\n          for (let index of stream.readBlock()) {\n            indices.push(parseInt(index));\n            size += 1;\n          }\n\n          groups.push(size);\n        }\n\n        this.matrixIndices = new Uint32Array(indices);\n        this.matrixGroups = new Uint32Array(groups);\n      } else if (token === 'MinimumExtent') {\n        stream.readFloatArray(this.extent.min);\n      } else if (token === 'MaximumExtent') {\n        stream.readFloatArray(this.extent.max);\n      } else if (token === 'BoundsRadius') {\n        this.extent.boundsRadius = stream.readFloat();\n      } else if (token === 'Anim') {\n        let extent = new Extent();\n\n        for (token of stream.readBlock()) {\n          if (token === 'MinimumExtent') {\n            stream.readFloatArray(extent.min);\n          } else if (token === 'MaximumExtent') {\n            stream.readFloatArray(extent.max);\n          } else if (token === 'BoundsRadius') {\n            extent.boundsRadius = stream.readFloat();\n          }\n        }\n\n        this.sequenceExtents.push(extent);\n      } else if (token === 'MaterialID') {\n        this.materialId = stream.readInt();\n      } else if (token === 'SelectionGroup') {\n        this.selectionGroup = stream.readInt();\n      } else if (token === 'Unselectable') {\n        this.selectionFlags = 4;\n      } else {\n        throw new Error(`Unknown token in Geoset: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startBlock('Geoset');\n\n    stream.writeVectorArray('Vertices', this.vertices, 3);\n    stream.writeVectorArray('Normals', this.normals, 3);\n\n    for (let uvSet of this.uvSets) {\n      stream.writeVectorArray('TVertices', uvSet, 2);\n    }\n\n    stream.startBlock('VertexGroup');\n    for (let i = 0, l = this.vertexGroups.length; i < l; i++) {\n      stream.writeLine(`${this.vertexGroups[i]},`);\n    }\n    stream.endBlock();\n\n    // For now hardcoded for triangles, until I see a model with something different.\n    stream.startBlock('Faces', 1, this.faces.length);\n    stream.startBlock('Triangles');\n    stream.writeLine(`{ ${this.faces.join(', ')} },`);\n    stream.endBlock();\n    stream.endBlock();\n\n    stream.startBlock('Groups', this.matrixGroups.length, this.matrixIndices.length);\n    let index = 0;\n    for (let groupSize of this.matrixGroups) {\n      stream.writeArrayAttrib('Matrices', this.matrixIndices.subarray(index, index + groupSize));\n      index += groupSize;\n    }\n    stream.endBlock();\n\n    this.extent.writeMdl(stream);\n\n    for (let sequenceExtent of this.sequenceExtents) {\n      stream.startBlock('Anim');\n      sequenceExtent.writeMdl(stream);\n      stream.endBlock();\n    }\n\n    stream.writeAttrib('MaterialID', this.materialId);\n    stream.writeAttrib('SelectionGroup', this.selectionGroup);\n\n    if (this.selectionFlags === 4) {\n      stream.writeFlag('Unselectable');\n    }\n\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 120 + this.vertices.byteLength + this.normals.byteLength + this.faceTypeGroups.byteLength + this.faceGroups.byteLength + this.faces.byteLength + this.vertexGroups.byteLength + this.matrixGroups.byteLength + this.matrixIndices.byteLength + this.sequenceExtents.length * 28;\n\n    for (let uvSet of this.uvSets) {\n      size += 8 + uvSet.byteLength;\n    }\n\n    return size;\n  }\n}\n","import AnimatedObject from './animatedobject';\n\n/**\n * A geoset animation.\n */\nexport default class GeosetAnimation extends AnimatedObject {\n  /**\n   *\n   */\n  constructor() {\n    super();\n\n    /** @member {number} */\n    this.alpha = 1;\n    /** @member {number} */\n    this.flags = 0;\n    /** @member {Float32Array} */\n    this.color = new Float32Array([1, 1, 1]);\n    /** @member {number} */\n    this.geosetId = -1;\n    /** @member {Array<Animation>} */\n    this.animations = [];\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    this.alpha = stream.readFloat32();\n    this.flags = stream.readUint32();\n    stream.readFloat32Array(this.color);\n    this.geosetId = stream.readInt32();\n\n    this.readAnimations(stream, size - 28);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n    stream.writeFloat32(this.alpha);\n    stream.writeUint32(this.flags);\n    stream.writeFloat32Array(this.color);\n    stream.writeInt32(this.geosetId);\n\n    this.writeAnimations(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of this.readAnimatedBlock(stream)) {\n      if (token === 'DropShadow') {\n        this.flags |= 0x1;\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KGAO');\n      } else if (token === 'static Color') {\n        this.flags |= 0x2;\n        stream.readColor(this.color);\n      } else if (token === 'Color') {\n        this.flags |= 0x2;\n        this.readAnimation(stream, 'KGAC');\n      } else if (token === 'GeosetId') {\n        this.geosetId = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in GeosetAnimation: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startBlock('GeosetAnim');\n\n    if (this.flags & 0x1) {\n      stream.writeFlag('DropShadow');\n    }\n\n    if (!this.writeAnimation(stream, 'KGAO')) {\n      stream.writeFloatAttrib('static Alpha', this.alpha);\n    }\n\n    if (this.flags & 0x2) {\n      if (!this.writeAnimation(stream, 'KGAC') && (this.color[0] !== 1 || this.color[1] !== 1 || this.color[2] !== 1)) {\n        stream.writeColor('static Color ', this.color);\n      }\n    }\n\n    stream.writeAttrib('GeosetId', this.geosetId);\n\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 28 + super.getByteLength();\n  }\n}\n","import AnimatedObject from './animatedobject';\n\n/**\n * A generic object.\n *\n * The parent class for all objects that exist in the world, and may contain spatial animations.\n * This includes bones, particle emitters, and many other things.\n */\nexport default class GenericObject extends AnimatedObject {\n  /**\n   * @param {number} flags\n   */\n  constructor(flags) {\n    super();\n\n    /** @member {string} */\n    this.name = '';\n    /** @member {number} */\n    this.objectId = -1;\n    /** @member {number} */\n    this.parentId = -1;\n    /** @member {number} */\n    this.flags = flags || 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    this.name = stream.read(80);\n    this.objectId = stream.readInt32();\n    this.parentId = stream.readInt32();\n    this.flags = stream.readUint32();\n\n    this.readAnimations(stream, size - 96);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getGenericByteLength());\n    stream.write(this.name);\n    stream.skip(80 - this.name.length);\n    stream.writeInt32(this.objectId);\n    stream.writeInt32(this.parentId);\n    stream.writeUint32(this.flags);\n\n    for (let animation of this.eachAnimation(true)) {\n      animation.writeMdx(stream);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeNonGenericAnimationChunks(stream) {\n    for (let animation of this.eachAnimation(false)) {\n      animation.writeMdx(stream);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  * readMdl(stream) {\n    this.name = stream.read();\n\n    for (let token of this.readAnimatedBlock(stream)) {\n      if (token === 'ObjectId') {\n        this.objectId = stream.readInt();\n      } else if (token === 'Parent') {\n        this.parentId = stream.readInt();\n      } else if (token === 'BillboardedLockZ') {\n        this.flags |= 0x40;\n      } else if (token === 'BillboardedLockY') {\n        this.flags |= 0x20;\n      } else if (token === 'BillboardedLockX') {\n        this.flags |= 0x10;\n      } else if (token === 'Billboarded') {\n        this.flags |= 0x8;\n      } else if (token === 'CameraAnchored') {\n        this.flags |= 0x80;\n      } else if (token === 'DontInherit') {\n        for (token of stream.readBlock()) {\n          if (token === 'Rotation') {\n            this.flags |= 0x2;\n          } else if (token === 'Translation') {\n            this.flags |= 0x1;\n          } else if (token === 'Scaling') {\n            this.flags |= 0x4;\n          }\n        }\n      } else if (token === 'Translation') {\n        this.readAnimation(stream, 'KGTR');\n      } else if (token === 'Rotation') {\n        this.readAnimation(stream, 'KGRT');\n      } else if (token === 'Scaling') {\n        this.readAnimation(stream, 'KGSC');\n      } else {\n        yield token;\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeGenericHeader(stream) {\n    stream.writeAttrib('ObjectId', this.objectId);\n\n    if (this.parentId !== -1) {\n      stream.writeAttrib('Parent', this.parentId);\n    }\n\n    if (this.flags & 0x40) {\n      stream.writeFlag('BillboardedLockZ');\n    }\n\n    if (this.flags & 0x20) {\n      stream.writeFlag('BillboardedLockY');\n    }\n\n    if (this.flags & 0x10) {\n      stream.writeFlag('BillboardedLockX');\n    }\n\n    if (this.flags & 0x8) {\n      stream.writeFlag('Billboarded');\n    }\n\n    if (this.flags & 0x80) {\n      stream.writeFlag('CameraAnchored');\n    }\n\n    if (this.flags & 0x2) {\n      stream.writeFlag(`DontInherit { Rotation }`);\n    }\n\n    if (this.flags & 0x1) {\n      stream.writeFlag(`DontInherit { Translation }`);\n    }\n\n    if (this.flags & 0x4) {\n      stream.writeFlag(`DontInherit { Scaling }`);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeGenericAnimations(stream) {\n    this.writeAnimation(stream, 'KGTR');\n    this.writeAnimation(stream, 'KGRT');\n    this.writeAnimation(stream, 'KGSC');\n  }\n\n  /**\n   * Allows to easily iterate either the GenericObject animations or the parent object animations.\n   *\n   * @param {boolean} wantGeneric\n   */\n  * eachAnimation(wantGeneric) {\n    for (let animation of this.animations) {\n      let name = animation.name;\n      let isGeneric = (name === 'KGTR' || name === 'KGRT' || name === 'KGSC');\n\n      if ((wantGeneric && isGeneric) || (!wantGeneric && !isGeneric)) {\n        yield animation;\n      }\n    }\n  }\n\n  /**\n   * Gets the byte length of the GenericObject part of whatever this object this.\n   * This is needed because only the KGTR, KGRT, and KGSC animations actually belong to it.\n   *\n   * @return {number}\n   */\n  getGenericByteLength() {\n    let size = 96;\n\n    for (let animation of this.eachAnimation(true)) {\n      size += animation.getByteLength();\n    }\n\n    return size;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 96 + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A bone.\n */\nexport default class Bone extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x100);\n\n    /** @member {number} */\n    this.geosetId = -1;\n    /** @member {number} */\n    this.geosetAnimationId = -1;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    super.readMdx(stream);\n\n    this.geosetId = stream.readInt32();\n    this.geosetAnimationId = stream.readInt32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    super.writeMdx(stream);\n\n    stream.writeInt32(this.geosetId);\n    stream.writeInt32(this.geosetAnimationId);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'GeosetId') {\n        token = stream.read();\n\n        if (token === 'Multiple') {\n          this.geosetId = -1;\n        } else {\n          this.geosetId = parseInt(token);\n        }\n      } else if (token === 'GeosetAnimId') {\n        token = stream.read();\n\n        if (token === 'None') {\n          this.geosetAnimationId = -1;\n        } else {\n          this.geosetAnimationId = parseInt(token);\n        }\n      } else {\n        throw new Error(`Unknown token in Bone ${this.name}: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('Bone', this.name);\n    this.writeGenericHeader(stream);\n\n    let geosetId = this.geosetId;\n    let geosetAnimationId = this.geosetAnimationId;\n\n    if (geosetId === -1) {\n      geosetId = 'Multiple';\n    }\n\n    if (geosetAnimationId === -1) {\n      geosetAnimationId = 'None';\n    }\n\n    stream.writeAttrib('GeosetId', geosetId);\n    stream.writeAttrib('GeosetAnimId', geosetAnimationId);\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 8 + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A light.\n */\nexport default class Light extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x200);\n\n    /** @member {number} */\n    this.type = -1;\n    /** @member {Float32Array} */\n    this.attenuation = new Float32Array(2);\n    /** @member {Float32Array} */\n    this.color = new Float32Array(3);\n    /** @member {number} */\n    this.intensity = 0;\n    /** @member {Float32Array} */\n    this.ambientColor = new Float32Array(3);\n    /** @member {number} */\n    this.ambientIntensity = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.type = stream.readUint32();\n    stream.readFloat32Array(this.attenuation);\n    stream.readFloat32Array(this.color);\n    this.intensity = stream.readFloat32();\n    stream.readFloat32Array(this.ambientColor);\n    this.ambientIntensity = stream.readFloat32();\n\n    this.readAnimations(stream, size - this.getByteLength());\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeUint32(this.type);\n    stream.writeFloat32Array(this.attenuation);\n    stream.writeFloat32Array(this.color);\n    stream.writeFloat32(this.intensity);\n    stream.writeFloat32Array(this.ambientColor);\n    stream.writeFloat32(this.ambientIntensity);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'Omnidirectional') {\n        this.type = 0;\n      } else if (token === 'Directional') {\n        this.type = 1;\n      } else if (token === 'Ambient') {\n        this.type = 2;\n      } else if (token === 'static AttenuationStart') {\n        this.attenuation[0] = stream.readFloat();\n      } else if (token === 'AttenuationStart') {\n        this.readAnimation(stream, 'KLAS');\n      } else if (token === 'static AttenuationEnd') {\n        this.attenuation[1] = stream.readFloat();\n      } else if (token === 'AttenuationEnd') {\n        this.readAnimation(stream, 'KLAE');\n      } else if (token === 'static Intensity') {\n        this.intensity = stream.readFloat();\n      } else if (token === 'Intensity') {\n        this.readAnimation(stream, 'KLAI');\n      } else if (token === 'static Color') {\n        stream.readColor(this.color);\n      } else if (token === 'Color') {\n        this.readAnimation(stream, 'KLAC');\n      } else if (token === 'static AmbIntensity') {\n        this.ambientIntensity = stream.readFloat();\n      } else if (token === 'AmbIntensity') {\n        this.readAnimation(stream, 'KLBI');\n      } else if (token === 'static AmbColor') {\n        stream.readColor(this.ambientColor);\n      } else if (token === 'AmbColor') {\n        this.readAnimation(stream, 'KLBC');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KLAV');\n      } else {\n        throw new Error(`Unknown token in Light: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('Light', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.type === 0) {\n      stream.writeFlag('Omnidirectional');\n    } else if (this.type === 1) {\n      stream.writeFlag('Directional');\n    } else if (this.type === 2) {\n      stream.writeFlag('Ambient');\n    }\n\n    if (!this.writeAnimation(stream, 'KLAS')) {\n      stream.writeFloatAttrib('static AttenuationStart', this.attenuation[0]);\n    }\n\n    if (!this.writeAnimation(stream, 'KLAE')) {\n      stream.writeFloatAttrib('static AttenuationEnd', this.attenuation[1]);\n    }\n\n    if (!this.writeAnimation(stream, 'KLAI')) {\n      stream.writeFloatAttrib('static Intensity', this.intensity);\n    }\n\n    if (!this.writeAnimation(stream, 'KLAC')) {\n      stream.writeColor('static Color', this.color);\n    }\n\n    if (!this.writeAnimation(stream, 'KLBI')) {\n      stream.writeFloatAttrib('static AmbIntensity', this.ambientIntensity);\n    }\n\n    if (!this.writeAnimation(stream, 'KLBC')) {\n      stream.writeColor('static AmbColor', this.ambientColor);\n    }\n\n    this.writeAnimation(stream, 'KLAV');\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 48 + super.getByteLength();\n  }\n}\n\n","import GenericObject from './genericobject';\n\n/**\n * A helper.\n */\nexport default class Helper extends GenericObject {\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      throw new Error(`Unknown token in Helper: \"${token}\"`);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('Helper', this.name);\n    this.writeGenericHeader(stream);\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An attachment.\n */\nexport default class Attachment extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x800);\n\n    /** @member {string} */\n    this.path = '';\n    /** @member {number} */\n    this.attachmentId = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.path = stream.read(260);\n    this.attachmentId = stream.readInt32();\n\n    this.readAnimations(stream, size - this.getByteLength());\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.write(this.path);\n    stream.skip(260 - this.path.length);\n    stream.writeInt32(this.attachmentId);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'AttachmentID') {\n        this.attachmentId = stream.readInt();\n      } else if (token === 'Path') {\n        this.path = stream.read();\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KATV');\n      } else {\n        throw new Error(`Unknown token in Attachment ${this.name}: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('Attachment', this.name);\n    this.writeGenericHeader(stream);\n\n    stream.writeAttrib('AttachmentID', this.attachmentId); // Is this needed? MDX supplies it, but MdlxConv does not use it.\n\n    if (this.path.length) {\n      stream.writeStringAttrib('Path', this.path);\n    }\n\n    this.writeAnimation(stream, 'KATV');\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 268 + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A particle emitter.\n */\nexport default class ParticleEmitter extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x1000);\n\n    /** @member {number} */\n    this.emissionRate = 0;\n    /** @member {number} */\n    this.gravity = 0;\n    /** @member {number} */\n    this.longitude = 0;\n    /** @member {number} */\n    this.latitude = 0;\n    /** @member {string} */\n    this.path = '';\n    /** @member {number} */\n    this.lifeSpan = 0;\n    /** @member {number} */\n    this.speed = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.emissionRate = stream.readFloat32();\n    this.gravity = stream.readFloat32();\n    this.longitude = stream.readFloat32();\n    this.latitude = stream.readFloat32();\n    this.path = stream.read(260);\n    this.lifeSpan = stream.readFloat32();\n    this.speed = stream.readFloat32();\n\n    this.readAnimations(stream, size - this.getByteLength());\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.emissionRate);\n    stream.writeFloat32(this.gravity);\n    stream.writeFloat32(this.longitude);\n    stream.writeFloat32(this.latitude);\n    stream.write(this.path);\n    stream.skip(260 - this.path.length);\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeFloat32(this.speed);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'EmitterUsesMDL') {\n        this.flags |= 0x8000;\n      } else if (token === 'EmitterUsesTGA') {\n        this.flags |= 0x10000;\n      } else if (token === 'static EmissionRate') {\n        this.emissionRate = stream.readFloat();\n      } else if (token === 'EmissionRate') {\n        this.readAnimation(stream, 'KPEE');\n      } else if (token === 'static Gravity') {\n        this.gravity = stream.readFloat();\n      } else if (token === 'Gravity') {\n        this.readAnimation(stream, 'KPEG');\n      } else if (token === 'static Longitude') {\n        this.longitude = stream.readFloat();\n      } else if (token === 'Longitude') {\n        this.readAnimation(stream, 'KPLN');\n      } else if (token === 'static Latitude') {\n        this.latitude = stream.readFloat();\n      } else if (token === 'Latitude') {\n        this.readAnimation(stream, 'KPLT');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KPEV');\n      } else if (token === 'Particle') {\n        for (token of this.readAnimatedBlock(stream)) {\n          if (token === 'static LifeSpan') {\n            this.lifeSpan = stream.readFloat();\n          } else if (token === 'LifeSpan') {\n            this.readAnimation(stream, 'KPEL');\n          } else if (token === 'static InitVelocity') {\n            this.speed = stream.readFloat();\n          } else if (token === 'InitVelocity') {\n            this.readAnimation(stream, 'KPES');\n          } else if (token === 'Path') {\n            this.path = stream.read();\n          }\n        }\n      } else {\n        throw new Error(`Unknown token in ParticleEmitter: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('ParticleEmitter', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.flags & 0x8000) {\n      stream.writeFlag('EmitterUsesMDL');\n    }\n\n    if (this.flags & 0x10000) {\n      stream.writeFlag('EmitterUsesTGA');\n    }\n\n    if (!this.writeAnimation(stream, 'KPEE')) {\n      stream.writeFloatAttrib('static EmissionRate', this.emissionRate);\n    }\n\n    if (!this.writeAnimation(stream, 'KPEG')) {\n      stream.writeFloatAttrib('static Gravity', this.gravity);\n    }\n\n    if (!this.writeAnimation(stream, 'KPLN')) {\n      stream.writeFloatAttrib('static Longitude', this.longitude);\n    }\n\n    if (!this.writeAnimation(stream, 'KPLT')) {\n      stream.writeFloatAttrib('static Latitude', this.latitude);\n    }\n\n    this.writeAnimation(stream, 'KPEV');\n\n    stream.startBlock('Particle');\n\n    if (!this.writeAnimation(stream, 'KPEL')) {\n      stream.writeFloatAttrib('static LifeSpan', this.lifeSpan);\n    }\n\n    if (!this.writeAnimation(stream, 'KPES')) {\n      stream.writeFloatAttrib('static InitVelocity', this.speed);\n    }\n\n    if ((this.flags & 0x8000) || (this.flags & 0x10000)) {\n      stream.writeAttrib('Path', this.path);\n    }\n\n    stream.endBlock();\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 288 + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A particle emitter type 2.\n */\nexport default class ParticleEmitter2 extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super();\n\n    /** @member {number} */\n    this.speed = 0;\n    /** @member {number} */\n    this.variation = 0;\n    /** @member {number} */\n    this.latitude = 0;\n    /** @member {number} */\n    this.gravity = 0;\n    /** @member {number} */\n    this.lifeSpan = 0;\n    /** @member {number} */\n    this.emissionRate = 0;\n    /** @member {number} */\n    this.length = 0;\n    /** @member {number} */\n    this.width = 0;\n    /** @member {number} */\n    this.filterMode = 0;\n    /** @member {number} */\n    this.rows = 0;\n    /** @member {number} */\n    this.columns = 0;\n    /** @member {number} */\n    this.headOrTail = 0;\n    /** @member {number} */\n    this.tailLength = 0;\n    /** @member {number} */\n    this.timeMiddle = 0;\n    /** @member {Array<Float32Array>} */\n    this.segmentColors = [new Float32Array(3), new Float32Array(3), new Float32Array(3)];\n    /** @member {Uint8Array} */\n    this.segmentAlphas = new Uint8Array(3);\n    /** @member {Float32Array} */\n    this.segmentScaling = new Float32Array(3);\n    /** @member {Array<Uint32Array>} */\n    this.headIntervals = [new Uint32Array(3), new Uint32Array(3)];\n    /** @member {Array<Uint32Array>} */\n    this.tailIntervals = [new Uint32Array(3), new Uint32Array(3)];\n    /** @member {number} */\n    this.textureId = -1;\n    /** @member {number} */\n    this.squirt = 0;\n    /** @member {number} */\n    this.priorityPlane = 0;\n    /** @member {number} */\n    this.replaceableId = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    const size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.speed = stream.readFloat32();\n    this.variation = stream.readFloat32();\n    this.latitude = stream.readFloat32();\n    this.gravity = stream.readFloat32();\n    this.lifeSpan = stream.readFloat32();\n    this.emissionRate = stream.readFloat32();\n    this.length = stream.readFloat32();\n    this.width = stream.readFloat32();\n    this.filterMode = stream.readUint32();\n    this.rows = stream.readUint32();\n    this.columns = stream.readUint32();\n    this.headOrTail = stream.readUint32();\n    this.tailLength = stream.readFloat32();\n    this.timeMiddle = stream.readFloat32();\n    stream.readFloat32Array(this.segmentColors[0]);\n    stream.readFloat32Array(this.segmentColors[1]);\n    stream.readFloat32Array(this.segmentColors[2]);\n    stream.readUint8Array(this.segmentAlphas);\n    stream.readFloat32Array(this.segmentScaling);\n    stream.readUint32Array(this.headIntervals[0]);\n    stream.readUint32Array(this.headIntervals[1]);\n    stream.readUint32Array(this.tailIntervals[0]);\n    stream.readUint32Array(this.tailIntervals[1]);\n    this.textureId = stream.readInt32();\n    this.squirt = stream.readUint32();\n    this.priorityPlane = stream.readInt32();\n    this.replaceableId = stream.readUint32();\n\n    this.readAnimations(stream, size - this.getByteLength());\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.speed);\n    stream.writeFloat32(this.variation);\n    stream.writeFloat32(this.latitude);\n    stream.writeFloat32(this.gravity);\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeFloat32(this.emissionRate);\n    stream.writeFloat32(this.length);\n    stream.writeFloat32(this.width);\n    stream.writeUint32(this.filterMode);\n    stream.writeUint32(this.rows);\n    stream.writeUint32(this.columns);\n    stream.writeUint32(this.headOrTail);\n    stream.writeFloat32(this.tailLength);\n    stream.writeFloat32(this.timeMiddle);\n    stream.writeFloat32Array(this.segmentColors[0]);\n    stream.writeFloat32Array(this.segmentColors[1]);\n    stream.writeFloat32Array(this.segmentColors[2]);\n    stream.writeUint8Array(this.segmentAlphas);\n    stream.writeFloat32Array(this.segmentScaling);\n    stream.writeUint32Array(this.headIntervals[0]);\n    stream.writeUint32Array(this.headIntervals[1]);\n    stream.writeUint32Array(this.tailIntervals[0]);\n    stream.writeUint32Array(this.tailIntervals[1]);\n    stream.writeInt32(this.textureId);\n    stream.writeUint32(this.squirt);\n    stream.writeInt32(this.priorityPlane);\n    stream.writeUint32(this.replaceableId);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (const token of super.readMdl(stream)) {\n      if (token === 'SortPrimsFarZ') {\n        this.flags |= 0x10000;\n      } else if (token === 'Unshaded') {\n        this.flags |= 0x8000;\n      } else if (token === 'LineEmitter') {\n        this.flags |= 0x20000;\n      } else if (token === 'Unfogged') {\n        this.flags |= 0x40000;\n      } else if (token === 'ModelSpace') {\n        this.flags |= 0x80000;\n      } else if (token === 'XYQuad') {\n        this.flags |= 0x100000;\n      } else if (token === 'static Speed') {\n        this.speed = stream.readFloat();\n      } else if (token === 'Speed') {\n        this.readAnimation(stream, 'KP2S');\n      } else if (token === 'static Variation') {\n        this.variation = stream.readFloat();\n      } else if (token === 'Variation') {\n        this.readAnimation(stream, 'KP2R');\n      } else if (token === 'static Latitude') {\n        this.latitude = stream.readFloat();\n      } else if (token === 'Latitude') {\n        this.readAnimation(stream, 'KP2L');\n      } else if (token === 'static Gravity') {\n        this.gravity = stream.readFloat();\n      } else if (token === 'Gravity') {\n        this.readAnimation(stream, 'KP2G');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KP2V');\n      } else if (token === 'Squirt') {\n        this.squirt = 1;\n      } else if (token === 'LifeSpan') {\n        this.lifeSpan = stream.readFloat();\n      } else if (token === 'static EmissionRate') {\n        this.emissionRate = stream.readFloat();\n      } else if (token === 'EmissionRate') {\n        this.readAnimation(stream, 'KP2E');\n      } else if (token === 'static Width') {\n        this.width = stream.readFloat();\n      } else if (token === 'Width') {\n        this.readAnimation(stream, 'KP2W');\n      } else if (token === 'static Length') {\n        this.length = stream.readFloat();\n      } else if (token === 'Length') {\n        this.readAnimation(stream, 'KP2N');\n      } else if (token === 'Blend') {\n        this.filterMode = 0;\n      } else if (token === 'Additive') {\n        this.filterMode = 1;\n      } else if (token === 'Modulate') {\n        this.filterMode = 2;\n      } else if (token === 'Modulate2x') {\n        this.filterMode = 3;\n      } else if (token === 'AlphaKey') {\n        this.filterMode = 4;\n      } else if (token === 'Rows') {\n        this.rows = stream.readInt();\n      } else if (token === 'Columns') {\n        this.columns = stream.readInt();\n      } else if (token === 'Head') {\n        this.headOrTail = 0;\n      } else if (token === 'Tail') {\n        this.headOrTail = 1;\n      } else if (token === 'Both') {\n        this.headOrTail = 2;\n      } else if (token === 'TailLength') {\n        this.tailLength = stream.readFloat();\n      } else if (token === 'Time') {\n        this.timeMiddle = stream.readFloat();\n      } else if (token === 'SegmentColor') {\n        stream.read(); // {\n\n        for (let i = 0; i < 3; i++) {\n          stream.read(); // Color\n          stream.readColor(this.segmentColors[i]);\n        }\n\n        stream.read(); // }\n      } else if (token === 'Alpha') {\n        stream.readIntArray(this.segmentAlphas);\n      } else if (token === 'ParticleScaling') {\n        stream.readFloatArray(this.segmentScaling);\n      } else if (token === 'LifeSpanUVAnim') {\n        stream.readIntArray(this.headIntervals[0]);\n      } else if (token === 'DecayUVAnim') {\n        stream.readIntArray(this.headIntervals[1]);\n      } else if (token === 'TailUVAnim') {\n        stream.readIntArray(this.tailIntervals[0]);\n      } else if (token === 'TailDecayUVAnim') {\n        stream.readIntArray(this.tailIntervals[1]);\n      } else if (token === 'TextureID') {\n        this.textureId = stream.readInt();\n      } else if (token === 'ReplaceableId') {\n        this.replaceableId = stream.readInt();\n      } else if (token === 'PriorityPlane') {\n        this.priorityPlane = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in ParticleEmitter2: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('ParticleEmitter2', this.name);\n    this.writeGenericHeader(stream);\n\n    if (this.flags & 0x10000) {\n      stream.writeFlag('SortPrimsFarZ');\n    }\n\n    if (this.flags & 0x8000) {\n      stream.writeFlag('Unshaded');\n    }\n\n    if (this.flags & 0x20000) {\n      stream.writeFlag('LineEmitter');\n    }\n\n    if (this.flags & 0x40000) {\n      stream.writeFlag('Unfogged');\n    }\n\n    if (this.flags & 0x80000) {\n      stream.writeFlag('ModelSpace');\n    }\n\n    if (this.flags & 0x100000) {\n      stream.writeFlag('XYQuad');\n    }\n\n    if (!this.writeAnimation(stream, 'KP2S')) {\n      stream.writeFloatAttrib('static Speed', this.speed);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2R')) {\n      stream.writeFloatAttrib('static Variation', this.variation);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2L')) {\n      stream.writeFloatAttrib('static Latitude', this.latitude);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2G')) {\n      stream.writeFloatAttrib('static Gravity', this.gravity);\n    }\n\n    this.writeAnimation(stream, 'KP2V');\n\n    if (this.squirt) {\n      stream.writeFlag('Squirt');\n    }\n\n    stream.writeFloatAttrib('LifeSpan', this.lifeSpan);\n\n    if (!this.writeAnimation(stream, 'KP2E')) {\n      stream.writeFloatAttrib('static EmissionRate', this.emissionRate);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2W')) {\n      stream.writeFloatAttrib('static Width', this.width);\n    }\n\n    if (!this.writeAnimation(stream, 'KP2N')) {\n      stream.writeFloatAttrib('static Length', this.length);\n    }\n\n    if (this.filterMode === 0) {\n      stream.writeFlag('Blend');\n    } else if (this.filterMode === 1) {\n      stream.writeFlag('Additive');\n    } else if (this.filterMode === 2) {\n      stream.writeFlag('Modulate');\n    } else if (this.filterMode === 3) {\n      stream.writeFlag('Modulate2x'); // Does this exist in any model?\n    } else if (this.filterMode === 4) {\n      stream.writeFlag('AlphaKey');\n    }\n\n    stream.writeAttrib('Rows', this.rows);\n    stream.writeAttrib('Columns', this.columns);\n\n    if (this.headOrTail === 0) {\n      stream.writeFlag('Head');\n    } else if (this.headOrTail === 1) {\n      stream.writeFlag('Tail');\n    } else if (this.headOrTail === 2) {\n      stream.writeFlag('Both');\n    }\n\n    stream.writeFloatAttrib('TailLength', this.tailLength);\n    stream.writeFloatAttrib('Time', this.timeMiddle);\n\n    stream.startBlock('SegmentColor');\n    stream.writeColor('Color', this.segmentColors[0]);\n    stream.writeColor('Color', this.segmentColors[1]);\n    stream.writeColor('Color', this.segmentColors[2]);\n    stream.endBlockComma();\n\n    stream.writeArrayAttrib('Alpha', this.segmentAlphas);\n    stream.writeFloatArrayAttrib('ParticleScaling', this.segmentScaling);\n    stream.writeArrayAttrib('LifeSpanUVAnim', this.headIntervals[0]);\n    stream.writeArrayAttrib('DecayUVAnim', this.headIntervals[1]);\n    stream.writeArrayAttrib('TailUVAnim', this.tailIntervals[0]);\n    stream.writeArrayAttrib('TailDecayUVAnim', this.tailIntervals[1]);\n    stream.writeAttrib('TextureID', this.textureId);\n\n    if (this.replaceableId !== 0) {\n      stream.writeAttrib('ReplaceableId', this.replaceableId);\n    }\n\n    if (this.priorityPlane !== 0) {\n      stream.writeAttrib('PriorityPlane', this.priorityPlane);\n    }\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 175 + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A ribbon emitter.\n */\nexport default class RibbonEmitter extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x4000);\n\n    /** @member {number} */\n    this.heightAbove = 0;\n    /** @member {number} */\n    this.heightBelow = 0;\n    /** @member {number} */\n    this.alpha = 0;\n    /** @member {Float32Array} */\n    this.color = new Float32Array(3);\n    /** @member {number} */\n    this.lifeSpan = 0;\n    /** @member {number} */\n    this.textureSlot = 0;\n    /** @member {number} */\n    this.emissionRate = 0;\n    /** @member {number} */\n    this.rows = 0;\n    /** @member {number} */\n    this.columns = 0;\n    /** @member {number} */\n    this.materialId = 0;\n    /** @member {number} */\n    this.gravity = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    super.readMdx(stream);\n\n    this.heightAbove = stream.readFloat32();\n    this.heightBelow = stream.readFloat32();\n    this.alpha = stream.readFloat32();\n    stream.readFloat32Array(this.color);\n    this.lifeSpan = stream.readFloat32();\n    this.textureSlot = stream.readUint32();\n    this.emissionRate = stream.readUint32();\n    this.rows = stream.readUint32();\n    this.columns = stream.readUint32();\n    this.materialId = stream.readInt32();\n    this.gravity = stream.readFloat32();\n\n    this.readAnimations(stream, size - this.getByteLength());\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n\n    super.writeMdx(stream);\n\n    stream.writeFloat32(this.heightAbove);\n    stream.writeFloat32(this.heightBelow);\n    stream.writeFloat32(this.alpha);\n    stream.writeFloat32Array(this.color);\n    stream.writeFloat32(this.lifeSpan);\n    stream.writeUint32(this.textureSlot);\n    stream.writeUint32(this.emissionRate);\n    stream.writeUint32(this.rows);\n    stream.writeUint32(this.columns);\n    stream.writeInt32(this.materialId);\n    stream.writeFloat32(this.gravity);\n\n    this.writeNonGenericAnimationChunks(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'static HeightAbove') {\n        this.heightAbove = stream.readFloat();\n      } else if (token === 'HeightAbove') {\n        this.readAnimation(stream, 'KRHA');\n      } else if (token === 'static HeightBelow') {\n        this.heightBelow = stream.readFloat();\n      } else if (token === 'HeightBelow') {\n        this.readAnimation(stream, 'KRHB');\n      } else if (token === 'static Alpha') {\n        this.alpha = stream.readFloat();\n      } else if (token === 'Alpha') {\n        this.readAnimation(stream, 'KRAL');\n      } else if (token === 'static Color') {\n        stream.readColor(this.color);\n      } else if (token === 'Color') {\n        this.readAnimation(stream, 'KRCO');\n      } else if (token === 'static TextureSlot') {\n        this.textureSlot = stream.readInt();\n      } else if (token === 'TextureSlot') {\n        this.readAnimation(stream, 'KRTX');\n      } else if (token === 'Visibility') {\n        this.readAnimation(stream, 'KRVS');\n      } else if (token === 'EmissionRate') {\n        this.emissionRate = stream.readInt();\n      } else if (token === 'LifeSpan') {\n        this.lifeSpan = stream.readFloat();\n      } else if (token === 'Gravity') {\n        this.gravity = stream.readFloat();\n      } else if (token === 'Rows') {\n        this.rows = stream.readInt();\n      } else if (token === 'Columns') {\n        this.columns = stream.readInt();\n      } else if (token === 'MaterialID') {\n        this.materialId = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in RibbonEmitter: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('RibbonEmitter', this.name);\n    this.writeGenericHeader(stream);\n\n    if (!this.writeAnimation(stream, 'KRHA')) {\n      stream.writeFloatAttrib('static HeightAbove', this.heightAbove);\n    }\n\n    if (!this.writeAnimation(stream, 'KRHB')) {\n      stream.writeFloatAttrib('static HeightBelow', this.heightBelow);\n    }\n\n    if (!this.writeAnimation(stream, 'KRAL')) {\n      stream.writeFloatAttrib('static Alpha', this.alpha);\n    }\n\n    if (!this.writeAnimation(stream, 'KRCO')) {\n      stream.writeColor('static Color', this.color);\n    }\n\n    if (!this.writeAnimation(stream, 'KRTX')) {\n      stream.writeAttrib('static TextureSlot', this.textureSlot);\n    }\n\n    this.writeAnimation(stream, 'KPEV');\n\n    stream.writeAttrib('EmissionRate', this.emissionRate);\n    stream.writeFloatAttrib('LifeSpan', this.lifeSpan);\n\n    if (this.gravity !== 0) {\n      stream.writeFloatAttrib('Gravity', this.gravity);\n    }\n\n    stream.writeAttrib('Rows', this.rows);\n    stream.writeAttrib('Columns', this.columns);\n    stream.writeAttrib('MaterialID', this.materialId);\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 56 + super.getByteLength();\n  }\n}\n","import AnimatedObject from './animatedobject';\n\n/**\n * A camera.\n */\nexport default class Camera extends AnimatedObject {\n  /**\n   *\n   */\n  constructor() {\n    super();\n\n    /** @member {string} */\n    this.name = '';\n    /** @member {Float32Array} */\n    this.position = new Float32Array(3);\n    /** @member {number} */\n    this.fieldOfView = 0;\n    /** @member {number} */\n    this.farClippingPlane = 0;\n    /** @member {number} */\n    this.nearClippingPlane = 0;\n    /** @member {Float32Array} */\n    this.targetPosition = new Float32Array(3);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    let size = stream.readUint32();\n\n    this.name = stream.read(80);\n    stream.readFloat32Array(this.position);\n    this.fieldOfView = stream.readFloat32();\n    this.farClippingPlane = stream.readFloat32();\n    this.nearClippingPlane = stream.readFloat32();\n    stream.readFloat32Array(this.targetPosition);\n\n    this.readAnimations(stream, size - 120);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    stream.writeUint32(this.getByteLength());\n    stream.write(this.name);\n    stream.skip(80 - this.name.length);\n    stream.writeFloat32Array(this.position);\n    stream.writeFloat32(this.fieldOfView);\n    stream.writeFloat32(this.farClippingPlane);\n    stream.writeFloat32(this.nearClippingPlane);\n    stream.writeFloat32Array(this.targetPosition);\n\n    this.writeAnimations(stream);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    this.name = stream.read();\n\n    for (let token of stream.readBlock()) {\n      if (token === 'Position') {\n        stream.readFloatArray(this.position);\n      } else if (token === 'Translation') {\n        this.readAnimation(stream, 'KCTR');\n      } else if (token === 'Rotation') {\n        this.readAnimation(stream, 'KCRL');\n      } else if (token === 'FieldOfView') {\n        this.fieldOfView = stream.readFloat();\n      } else if (token === 'FarClip') {\n        this.farClippingPlane = stream.readFloat();\n      } else if (token === 'NearClip') {\n        this.nearClippingPlane = stream.readFloat();\n      } else if (token === 'Target') {\n        for (token of stream.readBlock()) {\n          if (token === 'Position') {\n            stream.readFloatArray(this.targetPosition);\n          } else if (token === 'Translation') {\n            this.readAnimation(stream, 'KTTR');\n          } else {\n            throw new Error(`Unknown token in Camera ${this.name}'s Target: \"${token}\"`);\n          }\n        }\n      } else {\n        throw new Error(`Unknown token in Camera ${this.name}: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('Camera', this.name);\n\n    stream.writeFloatArrayAttrib('Position', this.position);\n    this.writeAnimation(stream, 'KCTR');\n    this.writeAnimation(stream, 'KCRL');\n    stream.writeFloatAttrib('FieldOfView', this.fieldOfView);\n    stream.writeFloatAttrib('FarClip', this.farClippingPlane);\n    stream.writeFloatAttrib('NearClip', this.nearClippingPlane);\n\n    stream.startBlock('Target');\n    stream.writeFloatArrayAttrib('Position', this.targetPosition);\n    this.writeAnimation(stream, 'KTTR');\n    stream.endBlock();\n\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 120 + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An event object.\n */\nexport default class EventObject extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x400);\n\n    /** @member {number} */\n    this.globalSequenceId = -1;\n    /** @member {Uint32Array} */\n    this.tracks = new Uint32Array(1);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    super.readMdx(stream);\n\n    stream.skip(4); // KEVT\n\n    let count = stream.readUint32();\n\n    this.globalSequenceId = stream.readInt32();\n    this.tracks = stream.readUint32Array(count);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    super.writeMdx(stream);\n    stream.write('KEVT');\n    stream.writeUint32(this.tracks.length);\n    stream.writeInt32(this.globalSequenceId);\n    stream.writeUint32Array(this.tracks);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'EventTrack') {\n        this.tracks = stream.readIntArray(new Uint32Array(stream.readInt()));\n      } else {\n        throw new Error(`Unknown token in EventObject: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('EventObject', this.name);\n    this.writeGenericHeader(stream);\n\n    stream.startBlock('EventTrack', this.tracks.length);\n\n    for (let track of this.tracks) {\n      stream.writeFlag(track);\n    }\n\n    stream.endBlock();\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return 12 + this.tracks.byteLength + super.getByteLength();\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A collision shape.\n */\nexport default class CollisionShape extends GenericObject {\n  /**\n   *\n   */\n  constructor() {\n    super(0x2000);\n\n    /** @member {number} */\n    this.type = -1;\n    /** @member {Array<Float32Array>} */\n    this.vertices = [new Float32Array(3), new Float32Array(3)];\n    /** @member {number} */\n    this.boundsRadius = 0;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  readMdx(stream) {\n    super.readMdx(stream);\n\n    this.type = stream.readUint32();\n\n    stream.readFloat32Array(this.vertices[0]);\n\n    if (this.type !== 2) {\n      stream.readFloat32Array(this.vertices[1]);\n    }\n\n    if (this.type === 2 || this.type === 3) {\n      this.boundsRadius = stream.readFloat32();\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  writeMdx(stream) {\n    super.writeMdx(stream);\n\n    stream.writeUint32(this.type);\n    stream.writeFloat32Array(this.vertices[0]);\n\n    if (this.type !== 2) {\n      stream.writeFloat32Array(this.vertices[1]);\n    }\n\n    if (this.type === 2 || this.type === 3) {\n      stream.writeFloat32(this.boundsRadius);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  readMdl(stream) {\n    for (let token of super.readMdl(stream)) {\n      if (token === 'Plane') {\n        this.type = 0;\n      } else if (token === 'Box') {\n        this.type = 1;\n      } else if (token === 'Sphere') {\n        this.type = 2;\n      } else if (token === 'Cylinder') {\n        this.type = 3;\n      } else if (token === 'Vertices') {\n        let count = stream.readInt();\n\n        stream.read(); // {\n\n        stream.readFloatArray(this.vertices[0]);\n\n        if (count === 2) {\n          stream.readFloatArray(this.vertices[1]);\n        }\n\n        stream.read(); // }\n      } else if (token === 'BoundsRadius') {\n        this.boundsRadius = stream.readFloat();\n      } else {\n        throw new Error(`Unknown token in CollisionShape: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  writeMdl(stream) {\n    stream.startObjectBlock('CollisionShape', this.name);\n    this.writeGenericHeader(stream);\n\n    let type;\n    let vertices = 2;\n    let boundsRadius = false;\n\n    if (this.type === 0) {\n      type = 'Plane';\n    } else if (this.type === 1) {\n      type = 'Box';\n    } else if (this.type === 2) {\n      type = 'Sphere';\n      vertices = 1;\n      boundsRadius = true;\n    } else if (this.type === 3) {\n      type = 'Cylinder';\n      boundsRadius = true;\n    }\n\n    stream.writeFlag(type);\n    stream.startBlock('Vertices', vertices);\n    stream.writeFloatArray(this.vertices[0]);\n\n    if (vertices === 2) {\n      stream.writeFloatArray(this.vertices[1]);\n    }\n\n    stream.endBlock();\n\n    if (boundsRadius) {\n      stream.writeFloatAttrib('BoundsRadius', this.boundsRadius);\n    }\n\n    this.writeGenericAnimations(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 16 + super.getByteLength();\n\n    if (this.type !== 2) {\n      size += 12;\n    }\n\n    if (this.type === 2 || this.type === 3) {\n      size += 4;\n    }\n\n    return size;\n  }\n}\n","/**\n * An unknown chunk.\n */\nexport default class UnknownChunk {\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} size\n   * @param {string} tag\n   */\n  constructor(stream, size, tag) {\n    /** @member {Uint8Array} */\n    this.chunk = stream.readUint8Array(new Uint8Array(size));\n    /** @member {string} */\n    this.tag = tag;\n  }\n\n  /**\n   * @return {number}\n   */\n  getByteLength() {\n    return this.chunk.byteLength;\n  }\n}\n","import BinaryStream from '../../common/binarystream';\nimport TokenStream from '../../common/tokenstream';\nimport Extent from './extent';\nimport Sequence from './sequence';\nimport Material from './material';\nimport Texture from './texture';\nimport TextureAnimation from './textureanimation';\nimport Geoset from './geoset';\nimport GeosetAnimation from './geosetanimation';\nimport Bone from './bone';\nimport Light from './light';\nimport Helper from './helper';\nimport Attachment from './attachment';\nimport ParticleEmitter from './particleemitter';\nimport ParticleEmitter2 from './particleemitter2';\nimport RibbonEmitter from './ribbonemitter';\nimport Camera from './camera';\nimport EventObject from './eventobject';\nimport CollisionShape from './collisionshape';\nimport UnknownChunk from './unknownchunk';\n\n/**\n * A Warcraft 3 model.\n * Supports loading from and saving to both the binary MDX and text MDL file formats.\n */\nexport default class Model {\n  /**\n   * @param {?ArrayBuffer|string} buffer\n   */\n  constructor(buffer) {\n    /**\n     * Always 800 since Warcraft 3 released.\n     *\n     * @member {number}\n     */\n    this.version = 800;\n    /** @member {string} */\n    this.name = '';\n    /**\n     * To the best of my knowledge, this should always be left empty.\n     * This is probably a leftover from the Warcraft 3 beta.\n     *\n     * @member {string}\n     */\n    this.animationFile = '';\n    /** @member {Extent} */\n    this.extent = new Extent();\n    /** @member {number} */\n    this.blendTime = 0;\n    /** @member {Array<Sequence>} */\n    this.sequences = [];\n    /** @member {Array<number>} */\n    this.globalSequences = [];\n    /** @member {Array<Material>} */\n    this.materials = [];\n    /** @member {Array<Texture>} */\n    this.textures = [];\n    /** @member {Array<TextureAnimation>} */\n    this.textureAnimations = [];\n    /** @member {Array<Geoset>} */\n    this.geosets = [];\n    /** @member {Array<GeosetAnimation>} */\n    this.geosetAnimations = [];\n    /** @member {Array<Bone>} */\n    this.bones = [];\n    /** @member {Array<Light>} */\n    this.lights = [];\n    /** @member {Array<Helper>} */\n    this.helpers = [];\n    /** @member {Array<Attachment>} */\n    this.attachments = [];\n    /** @member {Array<Float32Array>} */\n    this.pivotPoints = [];\n    /** @member {Array<ParticleEmitter>} */\n    this.particleEmitters = [];\n    /** @member {Array<ParticleEmitter2>} */\n    this.particleEmitters2 = [];\n    /** @member {Array<RibbonEmitter>} */\n    this.ribbonEmitters = [];\n    /** @member {Array<Camera>} */\n    this.cameras = [];\n    /** @member {Array<EventObject>} */\n    this.eventObjects = [];\n    /** @member {Array<CollisionShape>} */\n    this.collisionShapes = [];\n    /**\n     * The MDX format is chunk based, and Warcraft 3 does not mind there being unknown chunks in there.\n     * Some 3rd party tools use this to attach metadata to models.\n     * When an unknown chunk is encountered, it will be added here.\n     * These chunks will be saved when saving as MDX.\n     *\n     * @member {Array<UnknownChunk}\n     */\n    this.unknownChunks = [];\n\n    if (buffer) {\n      this.load(buffer);\n    }\n  }\n\n  /**\n   * Load the model from MDX or MDL.\n   * The format is detected by the buffer type: ArrayBuffer for MDX, and string for MDL.\n   *\n   * @param {ArrayBuffer|string} buffer\n   */\n  load(buffer) {\n    if (buffer instanceof ArrayBuffer) {\n      this.loadMdx(buffer);\n    } else {\n      this.loadMdl(buffer);\n    }\n  }\n\n  /**\n   * Load the model from MDX.\n   *\n   * @param {ArrayBuffer} buffer\n   */\n  loadMdx(buffer) {\n    let stream = new BinaryStream(buffer);\n\n    if (stream.read(4) !== 'MDLX') {\n      throw new Error('WrongMagicNumber');\n    }\n\n    while (stream.remaining() > 0) {\n      let tag = stream.read(4);\n      let size = stream.readUint32();\n\n      if (tag === 'VERS') {\n        this.loadVersionChunk(stream);\n      } else if (tag === 'MODL') {\n        this.loadModelChunk(stream);\n      } else if (tag === 'SEQS') {\n        this.loadStaticObjects(this.sequences, Sequence, stream, size / 132);\n      } else if (tag === 'GLBS') {\n        this.loadGlobalSequenceChunk(stream, size);\n      } else if (tag === 'MTLS') {\n        this.loadDynamicObjects(this.materials, Material, stream, size);\n      } else if (tag === 'TEXS') {\n        this.loadStaticObjects(this.textures, Texture, stream, size / 268);\n      } else if (tag === 'TXAN') {\n        this.loadDynamicObjects(this.textureAnimations, TextureAnimation, stream, size);\n      } else if (tag === 'GEOS') {\n        this.loadDynamicObjects(this.geosets, Geoset, stream, size);\n      } else if (tag === 'GEOA') {\n        this.loadDynamicObjects(this.geosetAnimations, GeosetAnimation, stream, size);\n      } else if (tag === 'BONE') {\n        this.loadDynamicObjects(this.bones, Bone, stream, size);\n      } else if (tag === 'LITE') {\n        this.loadDynamicObjects(this.lights, Light, stream, size);\n      } else if (tag === 'HELP') {\n        this.loadDynamicObjects(this.helpers, Helper, stream, size);\n      } else if (tag === 'ATCH') {\n        this.loadDynamicObjects(this.attachments, Attachment, stream, size);\n      } else if (tag === 'PIVT') {\n        this.loadPivotPointChunk(stream, size);\n      } else if (tag === 'PREM') {\n        this.loadDynamicObjects(this.particleEmitters, ParticleEmitter, stream, size);\n      } else if (tag === 'PRE2') {\n        this.loadDynamicObjects(this.particleEmitters2, ParticleEmitter2, stream, size);\n      } else if (tag === 'RIBB') {\n        this.loadDynamicObjects(this.ribbonEmitters, RibbonEmitter, stream, size);\n      } else if (tag === 'CAMS') {\n        this.loadDynamicObjects(this.cameras, Camera, stream, size);\n      } else if (tag === 'EVTS') {\n        this.loadDynamicObjects(this.eventObjects, EventObject, stream, size);\n      } else if (tag === 'CLID') {\n        this.loadDynamicObjects(this.collisionShapes, CollisionShape, stream, size);\n      } else {\n        this.unknownChunks.push(new UnknownChunk(stream, size, tag));\n      }\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  loadVersionChunk(stream) {\n    this.version = stream.readUint32();\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  loadModelChunk(stream) {\n    this.name = stream.read(80);\n    this.animationFile = stream.read(260);\n    this.extent.readMdx(stream);\n    this.blendTime = stream.readUint32();\n  }\n\n  /**\n   * @param {Array<Sequence|Texture>} out\n   * @param {constructor} constructor\n   * @param {BinaryStream} stream\n   * @param {number} count\n   */\n  loadStaticObjects(out, constructor, stream, count) {\n    for (let i = 0; i < count; i++) {\n      let object = new constructor();\n\n      object.readMdx(stream);\n\n      out.push(object);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} size\n   */\n  loadGlobalSequenceChunk(stream, size) {\n    for (let i = 0, l = size / 4; i < l; i++) {\n      this.globalSequences.push(stream.readUint32());\n    }\n  }\n\n  /**\n   * @param {Array<Material|TextureAnimation|Geoset|GeosetAnimation|GenericObject|Camera>} out\n   * @param {constructor} constructor\n   * @param {BinaryStream} stream\n   * @param {number} size\n   */\n  loadDynamicObjects(out, constructor, stream, size) {\n    let totalSize = 0;\n\n    while (totalSize < size) {\n      let object = new constructor();\n\n      object.readMdx(stream);\n\n      totalSize += object.getByteLength();\n\n      out.push(object);\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {number} size\n   */\n  loadPivotPointChunk(stream, size) {\n    for (let i = 0, l = size / 12; i < l; i++) {\n      this.pivotPoints.push(stream.readFloat32Array(new Float32Array(3)));\n    }\n  }\n\n  /**\n   * Save the model as MDX.\n   *\n   * @return {ArrayBuffer}\n   */\n  saveMdx() {\n    let buffer = new ArrayBuffer(this.getByteLength());\n    let stream = new BinaryStream(buffer);\n\n    stream.write('MDLX');\n    this.saveVersionChunk(stream);\n    this.saveModelChunk(stream);\n    this.saveStaticObjectChunk(stream, 'SEQS', this.sequences, 132);\n    this.saveGlobalSequenceChunk(stream);\n    this.saveDynamicObjectChunk(stream, 'MTLS', this.materials);\n    this.saveStaticObjectChunk(stream, 'TEXS', this.textures, 268);\n    this.saveDynamicObjectChunk(stream, 'TXAN', this.textureAnimations);\n    this.saveDynamicObjectChunk(stream, 'GEOS', this.geosets);\n    this.saveDynamicObjectChunk(stream, 'GEOA', this.geosetAnimations);\n    this.saveDynamicObjectChunk(stream, 'BONE', this.bones);\n    this.saveDynamicObjectChunk(stream, 'LITE', this.lights);\n    this.saveDynamicObjectChunk(stream, 'HELP', this.helpers);\n    this.saveDynamicObjectChunk(stream, 'ATCH', this.attachments);\n    this.savePivotPointChunk(stream);\n    this.saveDynamicObjectChunk(stream, 'PREM', this.particleEmitters);\n    this.saveDynamicObjectChunk(stream, 'PRE2', this.particleEmitters2);\n    this.saveDynamicObjectChunk(stream, 'RIBB', this.ribbonEmitters);\n    this.saveDynamicObjectChunk(stream, 'CAMS', this.cameras);\n    this.saveDynamicObjectChunk(stream, 'EVTS', this.eventObjects);\n    this.saveDynamicObjectChunk(stream, 'CLID', this.collisionShapes);\n\n    return buffer;\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  saveVersionChunk(stream) {\n    stream.write('VERS');\n    stream.writeUint32(4);\n    stream.writeUint32(this.version);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  saveModelChunk(stream) {\n    stream.write('MODL');\n    stream.writeUint32(372);\n    stream.write(this.name);\n    stream.skip(80 - this.name.length);\n    stream.write(this.animationFile);\n    stream.skip(260 - this.animationFile.length);\n    this.extent.writeMdx(stream);\n    stream.writeUint32(this.blendTime);\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {string} name\n   * @param {Array<Sequence|Texture>} objects\n   * @param {number} size\n   */\n  saveStaticObjectChunk(stream, name, objects, size) {\n    if (objects.length) {\n      stream.write(name);\n      stream.writeUint32(objects.length * size);\n\n      for (let object of objects) {\n        object.writeMdx(stream);\n      }\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  saveGlobalSequenceChunk(stream) {\n    if (this.globalSequences.length) {\n      stream.write('GLBS');\n      stream.writeUint32(this.globalSequences.length * 4);\n\n      for (let globalSequence of this.globalSequences) {\n        stream.writeUint32(globalSequence);\n      }\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   * @param {string} name\n   * @param {Array<Material|TextureAnimation|Geoset|GeosetAnimation|GenericObject|Camera>} objects\n   */\n  saveDynamicObjectChunk(stream, name, objects) {\n    if (objects.length) {\n      stream.write(name);\n      stream.writeUint32(this.getObjectsByteLength(objects));\n\n      for (let object of objects) {\n        object.writeMdx(stream);\n      }\n    }\n  }\n\n  /**\n   * @param {BinaryStream} stream\n   */\n  savePivotPointChunk(stream) {\n    if (this.pivotPoints.length) {\n      stream.write('PIVT');\n      stream.writeUint32(this.pivotPoints.length * 12);\n\n      for (let pivotPoint of this.pivotPoints) {\n        stream.writeFloat32Array(pivotPoint);\n      }\n    }\n  }\n\n  /**\n   * Load the model from MDL.\n   *\n   * @param {string} buffer\n   */\n  loadMdl(buffer) {\n    let token;\n    let stream = new TokenStream(buffer);\n\n    while (token = stream.read()) {\n      if (token === 'Version') {\n        this.loadVersionBlock(stream);\n      } else if (token === 'Model') {\n        this.loadModelBlock(stream);\n      } else if (token === 'Sequences') {\n        this.loadNumberedObjectBlock(this.sequences, Sequence, 'Anim', stream);\n      } else if (token === 'GlobalSequences') {\n        this.loadGlobalSequenceBlock(stream);\n      } else if (token === 'Textures') {\n        this.loadNumberedObjectBlock(this.textures, Texture, 'Bitmap', stream);\n      } else if (token === 'Materials') {\n        this.loadNumberedObjectBlock(this.materials, Material, 'Material', stream);\n      } else if (token === 'TextureAnims') {\n        this.loadNumberedObjectBlock(this.textureAnimations, TextureAnimation, 'TVertexAnim', stream);\n      } else if (token === 'Geoset') {\n        this.loadObject(this.geosets, Geoset, stream);\n      } else if (token === 'GeosetAnim') {\n        this.loadObject(this.geosetAnimations, GeosetAnimation, stream);\n      } else if (token === 'Bone') {\n        this.loadObject(this.bones, Bone, stream);\n      } else if (token === 'Light') {\n        this.loadObject(this.lights, Light, stream);\n      } else if (token === 'Helper') {\n        this.loadObject(this.helpers, Helper, stream);\n      } else if (token === 'Attachment') {\n        this.loadObject(this.attachments, Attachment, stream);\n      } else if (token === 'PivotPoints') {\n        this.loadPivotPointBlock(stream);\n      } else if (token === 'ParticleEmitter') {\n        this.loadObject(this.particleEmitters, ParticleEmitter, stream);\n      } else if (token === 'ParticleEmitter2') {\n        this.loadObject(this.particleEmitters2, ParticleEmitter2, stream);\n      } else if (token === 'RibbonEmitter') {\n        this.loadObject(this.ribbonEmitters, RibbonEmitter, stream);\n      } else if (token === 'Camera') {\n        this.loadObject(this.cameras, Camera, stream);\n      } else if (token === 'EventObject') {\n        this.loadObject(this.eventObjects, EventObject, stream);\n      } else if (token === 'CollisionShape') {\n        this.loadObject(this.collisionShapes, CollisionShape, stream);\n      } else {\n        throw new Error(`Unsupported block: ${token}`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  loadVersionBlock(stream) {\n    for (let token of stream.readBlock()) {\n      if (token === 'FormatVersion') {\n        this.version = stream.readInt();\n      } else {\n        throw new Error(`Unknown token in Version: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  loadModelBlock(stream) {\n    this.name = stream.read();\n\n    for (let token of stream.readBlock()) {\n      if (token.startsWith('Num')) {\n        // Don't care about the number of things, the arrays will grow as they wish.\n        // This includes:\n        //      NumGeosets\n        //      NumGeosetAnims\n        //      NumHelpers\n        //      NumLights\n        //      NumBones\n        //      NumAttachments\n        //      NumParticleEmitters\n        //      NumParticleEmitters2\n        //      NumRibbonEmitters\n        //      NumEvents\n        stream.read();\n      } else if (token === 'BlendTime') {\n        this.blendTime = stream.readInt();\n      } else if (token === 'MinimumExtent') {\n        stream.readFloatArray(this.extent.min);\n      } else if (token === 'MaximumExtent') {\n        stream.readFloatArray(this.extent.max);\n      } else if (token === 'BoundsRadius') {\n        this.extent.boundsRadius = stream.readFloat();\n      } else {\n        throw new Error(`Unknown token in Model: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {Array<Sequence|Texture|Material|TextureAnimation>} out\n   * @param {constructor} constructor\n   * @param {string} name\n   * @param {TokenStream} stream\n   */\n  loadNumberedObjectBlock(out, constructor, name, stream) {\n    stream.read(); // Don't care about the number, the array will grow.\n\n    for (let token of stream.readBlock()) {\n      if (token === name) {\n        let object = new constructor();\n\n        object.readMdl(stream);\n\n        out.push(object);\n      } else {\n        throw new Error(`Unknown token in ${name}: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  loadGlobalSequenceBlock(stream) {\n    stream.read(); // Don't care about the number, the array will grow.\n\n    for (let token of stream.readBlock()) {\n      if (token === 'Duration') {\n        this.globalSequences.push(stream.readInt());\n      } else {\n        throw new Error(`Unknown token in GlobalSequences: \"${token}\"`);\n      }\n    }\n  }\n\n  /**\n   * @param {Array<Geoset|GeosetAnimation|GenericObject|Camera>} out\n   * @param {constructor} constructor\n   * @param {TokenStream} stream\n   */\n  loadObject(out, constructor, stream) {\n    let object = new constructor();\n\n    object.readMdl(stream);\n\n    out.push(object);\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  loadPivotPointBlock(stream) {\n    let count = stream.readInt();\n\n    stream.read(); // {\n\n    for (let i = 0; i < count; i++) {\n      this.pivotPoints.push(stream.readFloatArray(new Float32Array(3)));\n    }\n\n    stream.read(); // }\n  }\n\n  /**\n   * Save the model as MDL.\n   *\n   * @return {string}\n   */\n  saveMdl() {\n    let stream = new TokenStream();\n\n    this.saveVersionBlock(stream);\n    this.saveModelBlock(stream);\n    this.saveStaticObjectsBlock(stream, 'Sequences', this.sequences);\n    this.saveGlobalSequenceBlock(stream);\n    this.saveStaticObjectsBlock(stream, 'Textures', this.textures);\n    this.saveStaticObjectsBlock(stream, 'Materials', this.materials);\n    this.saveStaticObjectsBlock(stream, 'TextureAnims', this.textureAnimations);\n    this.saveObjects(stream, this.geosets);\n    this.saveObjects(stream, this.geosetAnimations);\n    this.saveObjects(stream, this.bones);\n    this.saveObjects(stream, this.lights);\n    this.saveObjects(stream, this.helpers);\n    this.saveObjects(stream, this.attachments);\n    this.savePivotPointBlock(stream);\n    this.saveObjects(stream, this.particleEmitters);\n    this.saveObjects(stream, this.particleEmitters2);\n    this.saveObjects(stream, this.ribbonEmitters);\n    this.saveObjects(stream, this.cameras);\n    this.saveObjects(stream, this.eventObjects);\n    this.saveObjects(stream, this.collisionShapes);\n\n    return stream.buffer;\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  saveVersionBlock(stream) {\n    stream.startBlock('Version');\n    stream.writeAttrib('FormatVersion', this.version);\n    stream.endBlock();\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  saveModelBlock(stream) {\n    stream.startObjectBlock('Model', this.name);\n    stream.writeAttrib('BlendTime', this.blendTime);\n    this.extent.writeMdl(stream);\n    stream.endBlock();\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {string} name\n   * @param {Array<Sequence|Texture|Material|TextureAnimation>} objects\n   */\n  saveStaticObjectsBlock(stream, name, objects) {\n    if (objects.length) {\n      stream.startBlock(name, objects.length);\n\n      for (let object of objects) {\n        object.writeMdl(stream);\n      }\n\n      stream.endBlock();\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  saveGlobalSequenceBlock(stream) {\n    if (this.globalSequences.length) {\n      stream.startBlock('GlobalSequences', this.globalSequences.length);\n\n      for (let globalSequence of this.globalSequences) {\n        stream.writeAttrib('Duration', globalSequence);\n      }\n\n      stream.endBlock();\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   * @param {Array<Geoset|GeosetAnimation|GenericObject|Camera>} objects\n   */\n  saveObjects(stream, objects) {\n    for (let object of objects) {\n      object.writeMdl(stream);\n    }\n  }\n\n  /**\n   * @param {TokenStream} stream\n   */\n  savePivotPointBlock(stream) {\n    if (this.pivotPoints.length) {\n      stream.startBlock('PivotPoints', this.pivotPoints.length);\n\n      for (let pivotPoint of this.pivotPoints) {\n        stream.writeFloatArray(pivotPoint);\n      }\n\n      stream.endBlock();\n    }\n  }\n\n  /**\n   * Calculate the size of the model as MDX.\n   *\n   * @return {number}\n   */\n  getByteLength() {\n    let size = 396;\n\n    size += this.getStaticObjectsChunkByteLength(this.sequences, 132);\n    size += this.getStaticObjectsChunkByteLength(this.globalSequences, 4);\n    size += this.getDynamicObjectsChunkByteLength(this.materials);\n    size += this.getStaticObjectsChunkByteLength(this.textures, 268);\n    size += this.getDynamicObjectsChunkByteLength(this.textureAnimations);\n    size += this.getDynamicObjectsChunkByteLength(this.geosets);\n    size += this.getDynamicObjectsChunkByteLength(this.geosetAnimations);\n    size += this.getDynamicObjectsChunkByteLength(this.bones);\n    size += this.getDynamicObjectsChunkByteLength(this.lights);\n    size += this.getDynamicObjectsChunkByteLength(this.helpers);\n    size += this.getDynamicObjectsChunkByteLength(this.attachments);\n    size += this.getStaticObjectsChunkByteLength(this.pivotPoints, 12);\n    size += this.getDynamicObjectsChunkByteLength(this.particleEmitters);\n    size += this.getDynamicObjectsChunkByteLength(this.particleEmitters2);\n    size += this.getDynamicObjectsChunkByteLength(this.ribbonEmitters);\n    size += this.getDynamicObjectsChunkByteLength(this.cameras);\n    size += this.getDynamicObjectsChunkByteLength(this.eventObjects);\n    size += this.getDynamicObjectsChunkByteLength(this.collisionShapes);\n    size += 8 * this.unknownChunks.length + this.getDynamicObjectsChunkByteLength(this.unknownChunks);\n\n    return size;\n  }\n\n  /**\n   * @param {Array<Material|TextureAnimation|Geoset|GeosetAnimation|GenericObject|Camera|UnknownChunk>} objects\n   * @return {number}\n   */\n  getObjectsByteLength(objects) {\n    let size = 0;\n\n    for (let object of objects) {\n      size += object.getByteLength();\n    }\n\n    return size;\n  }\n\n  /**\n   * @param {Array<Material|TextureAnimation|Geoset|GeosetAnimation|GenericObject|Camera|UnknownChunk>} objects\n   * @return {number}\n   */\n  getDynamicObjectsChunkByteLength(objects) {\n    if (objects.length) {\n      return 8 + this.getObjectsByteLength(objects);\n    }\n\n    return 0;\n  }\n\n  /**\n   * @param {Array<Sequence|number|Texture|Float32Array>} objects\n   * @param {number} size\n   * @return {number}\n   */\n  getStaticObjectsChunkByteLength(objects, size) {\n    if (objects.length) {\n      return 8 + objects.length * size;\n    }\n\n    return 0;\n  }\n}\n","import Model from './model';\n\nexport default {\n  Model,\n};\n","import ini from './ini';\nimport slk from './slk';\nimport w3x from './w3x';\nimport mdlx from './mdlx';\n\nexport default {\n  mdlx,\n  slk,\n  w3x,\n  ini,\n};\n","/**\n * Convert from degrees to radians.\n *\n * @param {number} degrees\n * @return {number} Radians.\n */\nexport function degToRad(degrees) {\n  return degrees * (Math.PI / 180);\n}\n\n/**\n * Convert from radians to degrees.\n *\n * @param {number} radians\n * @return {number} Degrees.\n */\nexport function radToDeg(radians) {\n  return radians * (180 / Math.PI);\n}\n\n/**\n * Gets a random number in the given range.\n *\n * @param {number} a\n * @param {number} b\n * @return {number} A random number in [a, b].\n */\nexport function randomInRange(a, b) {\n  return a + Math.random() * (b - a);\n}\n\n/**\n * Clamp a number in a range.\n *\n * @param {number} x\n * @param {number} minVal\n * @param {number} maxVal\n * @return {number} Clamped number.\n */\nexport function clamp(x, minVal, maxVal) {\n  return Math.min(Math.max(x, minVal), maxVal);\n}\n\n/**\n * Linear interpolation between to numbers.\n *\n * @param {number} a First number.\n * @param {number} b Second number.\n * @param {number} t Factor.\n * @return {number} Interpolated value.\n */\nexport function lerp(a, b, t) {\n  return a + t * (b - a);\n}\n\n/**\n * Hermite interpolation between to numbers.\n *\n * @param {number} a First number.\n * @param {number} b First control point.\n * @param {number} c Second control point.\n * @param {number} d Second number.\n * @param {number} t Factor.\n * @return {number} Interpolated value.\n */\nexport function hermite(a, b, c, d, t) {\n  let factorTimes2 = t * t;\n  let factor1 = factorTimes2 * (2 * t - 3) + 1;\n  let factor2 = factorTimes2 * (t - 2) + t;\n  let factor3 = factorTimes2 * (t - 1);\n  let factor4 = factorTimes2 * (3 - 2 * t);\n\n  return (a * factor1) + (b * factor2) + (c * factor3) + (d * factor4);\n}\n\n/**\n * Bezier interpolation between to numbers.\n *\n * @param {number} a First number.\n * @param {number} b First control point.\n * @param {number} c Second control point.\n * @param {number} d Second number.\n * @param {number} t Factor.\n * @return {number} Interpolated value.\n */\nexport function bezier(a, b, c, d, t) {\n  let invt = 1 - t;\n  let factorTimes2 = t * t;\n  let inverseFactorTimesTwo = invt * invt;\n  let factor1 = inverseFactorTimesTwo * invt;\n  let factor2 = 3 * t * inverseFactorTimesTwo;\n  let factor3 = 3 * factorTimes2 * invt;\n  let factor4 = factorTimes2 * t;\n\n  return (a * factor1) + (b * factor2) + (c * factor3) + (d * factor4);\n}\n\n/**\n * Copies the sign of one number onto another.\n *\n * @param {number} x Destination.\n * @param {number} y Source.\n * @return {number} Returns the destination with the source's sign.\n */\nexport function copysign(x, y) {\n  let signy = Math.sign(y);\n\n  if (signy === 0) {\n    return 0;\n  }\n\n  let signx = Math.sign(x);\n\n  if (signx !== signy) {\n    return -x;\n  }\n\n  return x;\n}\n\n/**\n * Gets the closest power of two bigger or equal to the given number.\n *\n * @param {number} x\n * @return {number} A power of two number.\n */\nexport function powerOfTwo(x) {\n  x--;\n  x |= x >> 1;\n  x |= x >> 2;\n  x |= x >> 4;\n  x |= x >> 8;\n  x |= x >> 16;\n  x++;\n\n  return x;\n}\n\n/**\n * Is this number a power of two?\n *\n * @param {number} x\n * @return {boolean}\n */\nexport function isPowerOfTwo(x) {\n  if (x === 0) {\n    return false;\n  }\n\n  return ((x & (x - 1)) === 0);\n}\n","import { powerOfTwo } from './math';\n\nlet canvas = document.createElement('canvas');\nlet ctx = canvas.getContext('2d', { willReadFrequently: true });\n\nlet canvas2 = document.createElement('canvas');\nlet ctx2 = canvas2.getContext('2d', { willReadFrequently: true });\n\n/**\n * @param {Blob} blob\n * @return {Promise<Image>}\n */\nexport function blobToImage(blob) {\n  return new Promise((resolve, reject) => {\n    let url = URL.createObjectURL(blob);\n    let image = new Image();\n\n    image.onload = () => {\n      canvas.width = image.width;\n      canvas.height = image.height;\n\n      ctx.drawImage(image, 0, 0);\n\n      resolve(image);\n    };\n\n    image.onerror = (e) => {\n      reject(e);\n    };\n\n    image.src = url;\n  });\n}\n\n/**\n * @param {Blob} blob\n * @return {Promise<ImageData>}\n */\nexport function blobToImageData(blob) {\n  return new Promise((resolve, reject) => {\n    let url = URL.createObjectURL(blob);\n    let image = new Image();\n\n    image.onload = () => {\n      URL.revokeObjectURL(url);\n\n      canvas.width = image.width;\n      canvas.height = image.height;\n\n      ctx.drawImage(image, 0, 0);\n\n      resolve(ctx.getImageData(0, 0, image.width, image.height));\n    };\n\n    image.onerror = (e) => {\n      reject(e);\n    };\n\n    image.src = url;\n  });\n}\n\n/**\n * @param {ImageData} imageData\n * @return {Promise<Blob>}\n */\nexport function imageDataToBlob(imageData) {\n  return new Promise((resolve, reject) => {\n    canvas.width = imageData.width;\n    canvas.height = imageData.height;\n\n    ctx.putImageData(imageData, 0, 0);\n\n    canvas.toBlob((blob) => {\n      resolve(blob);\n    });\n  });\n}\n\n/**\n * @param {ImageData} imageData\n * @return {string}\n */\nexport function imageDataToDataUrl(imageData) {\n  canvas.width = imageData.width;\n  canvas.height = imageData.height;\n\n  ctx.putImageData(imageData, 0, 0);\n\n  return canvas.toDataURL();\n}\n\n/**\n * @param {Image} image\n * @return {ImageData}\n */\nexport function imageToImageData(image) {\n  let width = image.width;\n  let height = image.height;\n\n  canvas.width = width;\n  canvas.height = height;\n\n\n  ctx.drawImage(image, 0, 0);\n\n  return ctx.getImageData(0, 0, width, height);\n}\n\n/**\n * @param {ImageData} imageData\n * @return {ImageData}\n */\nexport function scaleNPOT(imageData) {\n  let width = imageData.width;\n  let height = imageData.height;\n  let potWidth = powerOfTwo(width);\n  let potHeight = powerOfTwo(height);\n\n  if (width !== potWidth || height !== potHeight) {\n    return resizeImageData(imageData, potWidth, potHeight);\n  }\n\n  return imageData;\n}\n\n/**\n * @param {ImageData} data\n * @param {number} width\n * @param {number} height\n * @return {ImageData}\n */\nexport function resizeImageData(data, width, height) {\n  let srcWidth = data.width;\n  let srcHeight = data.height;\n\n  // ImageData\n  if (data instanceof ImageData) {\n    canvas.width = srcWidth;\n    canvas.height = srcHeight;\n\n    ctx.putImageData(data, 0, 0);\n\n    canvas2.width = width;\n    canvas2.height = height;\n\n    ctx2.drawImage(canvas, 0, 0, width, height);\n\n    return ctx2.getImageData(0, 0, width, height);\n    // Assumed to be Image\n  } else {\n    canvas.width = width;\n    canvas.height = height;\n\n    ctx.drawImage(data, 0, 0, width, height);\n\n    return ctx.getImageData(0, 0, width, height);\n  }\n}\n\n/**\n * Given an array of Image objects, constructs a texture atlas.\n * The dimensions of each tile are the dimensions of the first Image object (that is, all images are assumed to have the same size!).\n * The resulting texture atlas is always square, and power of two.\n *\n * @param {Array<ImageData>} src\n * @return {Object}\n */\nexport function createTextureAtlas(src) {\n  let width = src[0].width;\n  let height = src[0].height;\n  let texturesPerRow = powerOfTwo(Math.ceil(Math.sqrt(src.length)));\n  let rows = powerOfTwo(Math.ceil(src.length / texturesPerRow));\n  // let pixelsPerRow = texturesPerRow * width;\n\n  canvas.width = width * texturesPerRow;\n  canvas.height = height * rows;\n  // canvas.height = canvas.width;\n\n  for (let i = 0, l = src.length; i < l; i++) {\n    ctx.putImageData(src[i], (i % texturesPerRow) * width, Math.floor(i / texturesPerRow) * height);\n  }\n\n  return { imageData: ctx.getImageData(0, 0, canvas.width, canvas.height), columns: texturesPerRow, rows: rows };\n}\n","\n/**\n * Returns a promise that will resolve with the data from the given path.\n * The data type determines the returned object:\n *     \"image\" => Image\n *     \"text\" => string\n *     \"arrayBuffer\" => ArrayBuffer\n *     \"blob\" => Blob\n *\n * @param {string} path\n * @param {string} dataType\n * @return {Promise<Object>}\n */\nexport default async function fetchDataType(path, dataType) {\n  if (dataType === 'image') {\n    // Promise wrapper for an image load.\n    return new Promise((resolve) => {\n      let image = new Image();\n\n      image.onload = () => {\n        resolve({ok: true, data: image});\n      };\n\n      image.onerror = (e) => {\n        resolve({ok: false, error: 'ImageError', data: e});\n      };\n\n      image.src = path;\n    });\n  } else {\n    let response;\n\n    // Fetch.\n    try {\n      response = await fetch(path);\n    } catch (e) {\n      return {ok: false, error: 'NetworkError', data: e};\n    }\n\n    // Fetch went ok?\n    if (!response.ok) {\n      return {ok: false, error: 'HttpError', data: response};\n    }\n\n    let data;\n\n    // Try to get the requested data type.\n    try {\n      if (dataType === 'text') {\n        data = await response.text();\n      } else if (dataType === 'arrayBuffer') {\n        data = await response.arrayBuffer();\n      } else if (dataType === 'blob') {\n        data = await response.blob();\n      }\n    } catch (e) {\n      return {ok: false, error: 'DataError', data: e};\n    }\n\n    return {ok: true, data};\n  }\n}\n","/**\n * A very simple string hashing algorithm.\n *\n * @param {string} s A string to hash.\n * @return {number} The hash.\n */\nexport default function stringHash(s) {\n  let hash = 0;\n\n  for (let i = 0, l = s.length; i < l; i++) {\n    hash = hash * 31 + s.charCodeAt(i);\n    hash = hash & hash;\n  }\n\n  return hash;\n}\n","let lineNumberReg = /:(\\d+):/g;\n\n/**\n * A wrapper around a WebGL shader unit.\n */\nexport default class ShaderUnit {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {string} src\n   * @param {number} type\n   */\n  constructor(gl, src, type) {\n    let id = gl.createShader(type);\n\n    /** @member {boolean} */\n    this.ok = false;\n    /** @member {WebGLShader} */\n    this.webglResource = id;\n    /** @member {string} */\n    this.src = src;\n    /** @member {number} */\n    this.shaderType = type;\n\n    gl.shaderSource(id, src);\n    gl.compileShader(id);\n\n    if (gl.getShaderParameter(id, gl.COMPILE_STATUS)) {\n      this.ok = true;\n    } else {\n      let error = gl.getShaderInfoLog(id);\n      let lines = src.split('\\n');\n\n      console.error('Shader unit failed to compile!');\n      console.error(error);\n\n      let lineNumber = lineNumberReg.exec(error);\n\n      while (lineNumber) {\n        let integer = parseInt(lineNumber[1]);\n\n        console.error(integer + ': ' + lines[integer - 1]);\n\n        lineNumber = lineNumberReg.exec(error);\n      }\n    }\n  }\n}\n","/**\n * A wrapper around a WebGL shader program.\n */\nexport default class ShaderProgram {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {ShaderUnit} vertexShader\n   * @param {ShaderUnit} fragmentShader\n   */\n  constructor(gl, vertexShader, fragmentShader) {\n    let id = gl.createProgram();\n    let uniforms = {};\n    let attribs = {};\n\n    /** @member {boolean} */\n    this.ok = false;\n    /** @member {WebGLProgram} */\n    this.webglResource = id;\n    /** @member {Array<ShaderUnit>} */\n    this.shaders = [vertexShader, fragmentShader];\n    /** @member {Map<string, WebGLUniformLocation>} */\n    this.uniforms = uniforms;\n    /** @member {Map<string, number>} */\n    this.attribs = attribs;\n    /** @member {number} */\n    this.attribsCount = 0;\n\n    gl.attachShader(id, vertexShader.webglResource);\n    gl.attachShader(id, fragmentShader.webglResource);\n    gl.linkProgram(id);\n\n    if (gl.getProgramParameter(id, gl.LINK_STATUS)) {\n      for (let i = 0, l = gl.getProgramParameter(id, gl.ACTIVE_UNIFORMS); i < l; i++) {\n        let object = gl.getActiveUniform(id, i);\n\n        if (object.size === 1) {\n          uniforms[object.name] = gl.getUniformLocation(id, object.name);\n        } else {\n          let base = object.name.substr(0, object.name.length - 3);\n\n          for (let index = 0; index < object.size; index++) {\n            let name = base + '[' + index + ']';\n\n            uniforms[name] = gl.getUniformLocation(id, name);\n          }\n        }\n      }\n\n      for (let i = 0, l = gl.getProgramParameter(id, gl.ACTIVE_ATTRIBUTES); i < l; i++) {\n        let object = gl.getActiveAttrib(id, i);\n\n        this.attribsCount += object.size;\n\n        if (object.size === 1) {\n          attribs[object.name] = gl.getAttribLocation(id, object.name);\n        } else {\n          let base = object.name.substr(0, object.name.length - 3);\n\n          for (let index = 0; index < object.size; index++) {\n            let name = base + '[' + index + ']';\n\n            attribs[name] = gl.getAttribLocation(id, name);\n          }\n        }\n      }\n\n      this.ok = true;\n    } else {\n      console.error('Shader program failed to link!');\n      console.error(gl.getProgramInfoLog(id));\n    }\n  }\n}\n","import stringHash from '../../common/stringhash';\nimport ShaderUnit from './shader';\nimport ShaderProgram from './program';\n\n/**\n * SOME_Ext_Name -> someExtName\n *\n * @param {string} ext\n * @return {string}\n */\nfunction extensionToCamelCase(ext) {\n  let tokens = ext.split('_');\n  let result = tokens[1];\n\n  for (let i = 2, l = tokens.length; i < l; i++) {\n    result += tokens[i][0].toUpperCase() + tokens[i].substr(1);\n  }\n\n  return result;\n}\n\n/**\n * A small WebGL utility class.\n * Makes it easier to generate shaders, textures, etc.\n */\nexport default class WebGL {\n  /**\n   * @param {HTMLCanvasElement} canvas\n   * @param {?Object} options\n   */\n  constructor(canvas, options) {\n    let gl = canvas.getContext(\"webgl2\", options || {alpha: false, antialias: false});\n    this.webgl2 = true;\n\n    if (!gl) {\n      gl = canvas.getContext('webgl', options || {alpha: false, antialias: false});\n      this.webgl2 = false;\n    }\n\n    if (!gl) {\n      gl = canvas.getContext('experimental-webgl', options || {alpha: false, antialias: false});\n    }\n\n    if (!gl) {\n      throw new Error('WebGL: Failed to create a WebGL context!');\n    }\n\n    let extensions = {};\n    for (let extension of gl.getSupportedExtensions()) {\n      // Firefox keeps spamming errors about MOZ_ prefixed extension strings being deprecated.\n      if (!extension.startsWith('MOZ_')) {\n        extensions[extensionToCamelCase(extension)] = gl.getExtension(extension);\n      }\n    }\n\n    if (!gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS)) {\n      throw new Error('WebGL: No vertex shader texture support!');\n    }\n\n    if (!this.webgl2 && !extensions.textureFloat) {\n      throw new Error('WebGL: No floating point texture support!');\n    }\n\n    if (!this.webgl2 && !extensions.instancedArrays) {\n      throw new Error('WebGL: No instanced rendering support!');\n    } else if (this.webgl2) {\n      extensions.instancedArrays = {\n        VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE: gl.VERTEX_ATTRIB_ARRAY_DIVISOR,\n        drawArraysInstancedANGLE: gl.drawArraysInstanced.bind(gl),\n        drawElementsInstancedANGLE: gl.drawElementsInstanced.bind(gl),\n        vertexAttribDivisorANGLE: gl.vertexAttribDivisor.bind(gl),\n      };\n    }\n\n    if (!this.webgl2) {\n      const texImage2D = gl.texImage2D;\n      gl.RED = gl.ALPHA;\n      gl.RG = gl.LUMINANCE_ALPHA;\n      gl.texImage2D = function(target, level, internalformat, ...args) {\n        if (args.length > 3) {\n          internalformat = args[3];\n        } else {\n          internalformat = args[0];\n        }\n        return texImage2D.call(gl, target, level, internalformat, ...args);\n      };\n    }\n\n    //if (!this.webgl2 && !extensions.compressedTextureS3tc) {\n    //  console.warn('WebGL: No compressed textures support! This might reduce performance.');\n    //}\n\n    gl.extensions = extensions;\n\n    // The only initial setup required, the rest should be handled by the handlers\n    gl.depthFunc(gl.LEQUAL);\n    gl.enable(gl.DEPTH_TEST);\n\n    /** @member {WebGLRenderingContext} */\n    this.gl = gl;\n    /** @member {array} */\n    this.extensions = extensions;\n    /** @member {Map<number, ShaderUnit>} */\n    this.shaderUnits = new Map();\n    /** @member {Map<number, ShaderProgram>} */\n    this.shaderPrograms = new Map();\n    /** @member {?ShaderProgram} */\n    this.currentShaderProgram = null;\n    /** @member {string} */\n    this.floatPrecision = 'precision mediump float;\\n';\n    this.shaderDefines = '';\n    if (this.webgl2) {\n      this.shaderDefines += `#define COMP1D r\n`;\n    } else {\n      this.shaderDefines += `#define COMP1D a\n`;\n    }\n\n    // An empty 2x2 texture that is used automatically when binding an invalid texture\n    let imageData = new ImageData(2, 2);\n\n    // Alpha fully set.\n    for (let i = 0; i < 4; i++) {\n      imageData.data[i * 4 + 3] = 255;\n    }\n\n    let emptyTexture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, emptyTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n\n    /** @member {WebGLTexture} */\n    this.emptyTexture = emptyTexture;\n  }\n\n  /**\n   * Create a new shader unit. Uses caching.\n   *\n   * @param {string} src The shader source.\n   * @param {number} type The shader type.\n   * @return {ShaderUnit}\n   */\n  createShaderUnit(src, type) {\n    let hash = stringHash(src);\n    let shaderUnits = this.shaderUnits;\n\n    if (!shaderUnits.has(hash)) {\n      shaderUnits.set(hash, new ShaderUnit(this.gl, src, type));\n    }\n\n    return shaderUnits.get(hash);\n  }\n\n  /**\n   * Create a new shader program. Uses caching.\n   *\n   * @param {string} vertexSrc The vertex shader source.\n   * @param {string} fragmentSrc The fragment shader source.\n   * @return {ShaderProgram}\n   */\n  createShaderProgram(vertexSrc, fragmentSrc) {\n    let gl = this.gl;\n    let vertexShader = this.createShaderUnit(this.shaderDefines + vertexSrc, gl.VERTEX_SHADER);\n    let fragmentShader = this.createShaderUnit(this.floatPrecision + this.shaderDefines + fragmentSrc, gl.FRAGMENT_SHADER);\n    let shaderPrograms = this.shaderPrograms;\n\n    if (vertexShader.ok && fragmentShader.ok) {\n      let hash = stringHash(vertexSrc + fragmentSrc);\n\n      if (!shaderPrograms.has(hash)) {\n        shaderPrograms.set(hash, new ShaderProgram(gl, vertexShader, fragmentShader));\n      }\n\n      let shaderProgram = shaderPrograms.get(hash);\n\n      if (shaderProgram.ok) {\n        return shaderProgram;\n      }\n    }\n  }\n\n  /**\n   * Enables all vertex attribs between [start, end], including start and discluding end.\n   *\n   * @param {number} start\n   * @param {number} end\n   */\n  enableVertexAttribs(start, end) {\n    let gl = this.gl;\n\n    for (let i = start; i < end; i++) {\n      gl.enableVertexAttribArray(i);\n    }\n  }\n\n  /**\n   * Disables all vertex attribs between [start, end], including start and discluding end.\n   *\n   * @param {number} start\n   * @param {number} end\n   */\n  disableVertexAttribs(start, end) {\n    let gl = this.gl;\n\n    for (let i = start; i < end; i++) {\n      gl.disableVertexAttribArray(i);\n    }\n  }\n\n  /**\n   * Use a shader program.\n   *\n   * @param {ShaderProgram} shaderProgram The program.\n   */\n  useShaderProgram(shaderProgram) {\n    let currentShaderProgram = this.currentShaderProgram;\n\n    if (shaderProgram && shaderProgram.ok && shaderProgram !== currentShaderProgram) {\n      let oldAttribs = 0;\n      let newAttribs = shaderProgram.attribsCount;\n\n      if (currentShaderProgram) {\n        oldAttribs = currentShaderProgram.attribsCount;\n      }\n\n      this.gl.useProgram(shaderProgram.webglResource);\n\n      if (newAttribs > oldAttribs) {\n        this.enableVertexAttribs(oldAttribs, newAttribs);\n      } else if (newAttribs < oldAttribs) {\n        this.disableVertexAttribs(newAttribs, oldAttribs);\n      }\n\n      this.currentShaderProgram = shaderProgram;\n    }\n  }\n\n  /**\n   * Bind a texture.\n   * Note that if the given texture is invalid (null or not loaded) then a 2x2 black texture will be bound instead.\n   *\n   * @param {Texture} texture The texture to bind.\n   * @param {number} unit The texture unit to bind to.\n   */\n  bindTexture(texture, unit) {\n    let gl = this.gl;\n\n    gl.activeTexture(gl.TEXTURE0 + unit);\n\n    if (texture && texture.ok) {\n      gl.bindTexture(gl.TEXTURE_2D, texture.webglResource);\n    } else {\n      // Bind an empty texture in case an invalid one was given, to avoid WebGL errors.\n      gl.bindTexture(gl.TEXTURE_2D, this.emptyTexture);\n    }\n  }\n}\n","import EventEmitter from 'events';\n\n/**\n * This object is used to promise about future resource loads, in case they are not yet known.\n * It is needed to stop the viewer from preemtively calling whenAllLoaded.\n *\n * An example of this is MDX event objects.\n * First the SLK their data is contained in needs to be loaded, and only then can the actual objects be loaded.\n * Once the SLK loads, the viewer thinks it finished loading and calls whenAllLoaded, before starting to load the objects.\n * Adding a promise in this case acts as a barrier, which is removed by resolving the promise after the objects starts loading.\n *\n * Note that you can create a promise resource with viewer.promise(), which returns an already active promise.\n */\nexport default class PromiseResource extends EventEmitter {\n  /**\n   * Immitates a promise.\n   */\n  promise() {\n    this.emit('loadstart', this);\n  }\n\n  /**\n   * Immitates promise resolution.\n   */\n  resolve() {\n    this.emit('loadend', this);\n  }\n}\n","import {vec3, vec4, quat} from 'gl-matrix';\n\nlet VEC3_UNIT_X = vec3.fromValues(1, 0, 0);\nlet VEC3_UNIT_Y = vec3.fromValues(0, 1, 0);\nlet VEC3_UNIT_Z = vec3.fromValues(0, 0, 1);\nlet VEC3_ZERO = vec3.create();\nlet VEC3_ONE = vec3.fromValues(1, 1, 1);\nlet QUAT_ZERO = quat.fromValues(0, 0, 0, 0);\nlet QUAT_DEFAULT = quat.create();\n\nlet heap = vec4.create();\n\n/**\n * @param {vec3} out\n * @param {vec3} v\n * @param {mat4} inverseMatrix\n * @param {vec4} viewport\n * @return {vec3}\n */\nfunction unproject(out, v, inverseMatrix, viewport) {\n  let x = 2 * (v[0] - viewport[0]) / viewport[2] - 1;\n  let y = 1 - 2 * (v[1] - viewport[1]) / viewport[3];\n  let z = 2 * v[2] - 1;\n\n  vec4.set(heap, x, y, z, 1);\n  vec4.transformMat4(heap, heap, inverseMatrix);\n  vec3.set(out, heap[0] / heap[3], heap[1] / heap[3], heap[2] / heap[3]);\n\n  return out;\n}\n\n/**\n * Get the distance of a point from a plane.\n * dot(plane, vec4(point, 1))\n *\n * @param {vec4} plane\n * @param {vec3} point\n * @return {number}\n */\nfunction distanceToPlane(plane, point) {\n  return plane[0] * point[0] + plane[1] * point[1] + plane[2] * point[2] + plane[3];\n}\n\n/**\n * Normalize a plane. Note that this is not the same as normalizing a vec4.\n *\n * @param {vec4} out\n * @param {vec4} plane\n */\nfunction normalizePlane(out, plane) {\n  let len = vec3.len(plane);\n\n  out[0] = plane[0] / len;\n  out[1] = plane[1] / len;\n  out[2] = plane[2] / len;\n  out[3] = plane[3] / len;\n}\n\n/**\n * Unpacks a matrix's planes.\n *\n * @param {Array<vec4>} planes\n * @param {mat4} m\n */\nfunction unpackPlanes(planes, m) {\n  // eslint-disable-next-line one-var\n  let a00 = m[0], a01 = m[4], a02 = m[8], a03 = m[12],\n    a10 = m[1], a11 = m[5], a12 = m[9], a13 = m[13],\n    a20 = m[2], a21 = m[6], a22 = m[10], a23 = m[14],\n    a30 = m[3], a31 = m[7], a32 = m[11], a33 = m[15];\n  let plane;\n\n  // Left clipping plane\n  plane = planes[0];\n  plane[0] = a30 + a00;\n  plane[1] = a31 + a01;\n  plane[2] = a32 + a02;\n  plane[3] = a33 + a03;\n\n  // Right clipping plane\n  plane = planes[1];\n  plane[0] = a30 - a00;\n  plane[1] = a31 - a01;\n  plane[2] = a32 - a02;\n  plane[3] = a33 - a03;\n\n  // Top clipping plane\n  plane = planes[2];\n  plane[0] = a30 - a10;\n  plane[1] = a31 - a11;\n  plane[2] = a32 - a12;\n  plane[3] = a33 - a13;\n\n  // Bottom clipping plane\n  plane = planes[3];\n  plane[0] = a30 + a10;\n  plane[1] = a31 + a11;\n  plane[2] = a32 + a12;\n  plane[3] = a33 + a13;\n\n  // Near clipping plane\n  plane = planes[4];\n  plane[0] = a30 + a20;\n  plane[1] = a31 + a21;\n  plane[2] = a32 + a22;\n  plane[3] = a33 + a23;\n\n  // Far clipping plane\n  plane = planes[5];\n  plane[0] = a30 - a20;\n  plane[1] = a31 - a21;\n  plane[2] = a32 - a22;\n  plane[3] = a33 - a23;\n\n  normalizePlane(planes[0], planes[0]);\n  normalizePlane(planes[1], planes[1]);\n  normalizePlane(planes[2], planes[2]);\n  normalizePlane(planes[3], planes[3]);\n  normalizePlane(planes[4], planes[4]);\n  normalizePlane(planes[5], planes[5]);\n}\n\nlet vec3Heap = vec3.create();\n\n/**\n * @param {quat} q\n * @return {number}\n */\nfunction getRotationX(q) {\n  vec3.transformQuat(vec3Heap, VEC3_UNIT_Y, q);\n\n  return Math.atan2(vec3Heap[2], vec3Heap[1]);\n}\n\n/**\n * @param {quat} q\n * @return {number}\n */\nfunction getRotationY(q) {\n  vec3.transformQuat(vec3Heap, VEC3_UNIT_Z, q);\n\n  return Math.atan2(vec3Heap[0], vec3Heap[2]);\n}\n\n/**\n * @param {quat} q\n * @return {number}\n */\nfunction getRotationZ(q) {\n  vec3.transformQuat(vec3Heap, VEC3_UNIT_X, q);\n\n  return Math.atan2(vec3Heap[1], vec3Heap[0]);\n}\n\nexport {\n  VEC3_UNIT_X,\n  VEC3_UNIT_Y,\n  VEC3_UNIT_Z,\n  VEC3_ZERO,\n  VEC3_ONE,\n  QUAT_ZERO,\n  QUAT_DEFAULT,\n  unproject,\n  distanceToPlane,\n  normalizePlane,\n  unpackPlanes,\n  getRotationX,\n  getRotationY,\n  getRotationZ,\n};\n","import {vec3, vec4, quat, mat4} from 'gl-matrix';\nimport {unproject, distanceToPlane, unpackPlanes, VEC3_UNIT_Y, VEC3_UNIT_X, VEC3_UNIT_Z} from '../common/gl-matrix-addon';\n\nlet vectorHeap = vec3.create();\nlet vectorHeap2 = vec3.create();\nlet vectorHeap3 = vec3.create();\nlet quatHeap = quat.create();\nlet matHeap = mat4.create();\n\n/**\n * A camera.\n */\nexport default class Camera {\n  /**\n   *\n   */\n  constructor() {\n    // Rendered viewport.\n    this.rect = vec4.create();\n\n    // Perspective values.\n    this.isPerspective = true;\n    this.fov = 0;\n    this.aspect = 0;\n\n    // Orthogonal values.\n    this.isOrtho = false;\n    this.leftClipPlane = 0;\n    this.rightClipPlane = 0;\n    this.bottomClipPlane = 0;\n    this.topClipPlane = 0;\n\n    // Shared values.\n    this.nearClipPlane = 0;\n    this.farClipPlane = 0;\n\n    // World values.\n    this.location = vec3.create();\n    this.rotation = quat.create();\n\n    // Derived values.\n    this.inverseRotation = quat.create();\n    this.worldMatrix = mat4.create();\n    this.projectionMatrix = mat4.create();\n    this.worldProjectionMatrix = mat4.create();\n    this.inverseWorldMatrix = mat4.create();\n    this.inverseRotationMatrix = mat4.create();\n    this.inverseWorldProjectionMatrix = mat4.create();\n    this.directionX = vec3.create();\n    this.directionY = vec3.create();\n    this.directionZ = vec3.create();\n\n    // First four vectors are the corners of a 2x2 rectangle, the last three vectors are the unit axes\n    this.vectors = [vec3.fromValues(-1, -1, 0), vec3.fromValues(-1, 1, 0), vec3.fromValues(1, 1, 0), vec3.fromValues(1, -1, 0), vec3.fromValues(1, 0, 0), vec3.fromValues(0, 1, 0), vec3.fromValues(0, 0, 1)];\n\n    // First four vectors are the corners of a 2x2 rectangle billboarded to the camera, the last three vectors are the unit axes billboarded\n    this.billboardedVectors = [vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n\n    // Left, right, top, bottom, near, far\n    this.planes = [vec4.create(), vec4.create(), vec4.create(), vec4.create(), vec4.create(), vec4.create()];\n\n    this.dirty = true;\n  }\n\n  /**\n   * Set the camera to perspective projection mode.\n   *\n   * @param {number} fov\n   * @param {number} aspect\n   * @param {number} near\n   * @param {number} far\n   */\n  perspective(fov, aspect, near, far) {\n    this.isPerspective = true;\n    this.isOrtho = false;\n    this.fov = fov;\n    this.aspect = aspect;\n    this.nearClipPlane = near;\n    this.farClipPlane = far;\n\n    this.dirty = true;\n  }\n\n  /**\n   * Set the camera to orthogonal projection mode.\n   *\n   * @param {number} left\n   * @param {number} right\n   * @param {number} bottom\n   * @param {number} top\n   * @param {number} near\n   * @param {number} far\n   */\n  ortho(left, right, bottom, top, near, far) {\n    this.isPerspective = false;\n    this.isOrtho = true;\n    this.leftClipPlane = left;\n    this.rightClipPlane = right;\n    this.bottomClipPlane = bottom;\n    this.topClipPlane = top;\n    this.nearClipPlane = near;\n    this.farClipPlane = far;\n\n    this.dirty = true;\n  }\n\n  /**\n   * Set the camera's viewport.\n   *\n   * @param {vec4} viewport\n   */\n  viewport(viewport) {\n    vec4.copy(this.rect, viewport);\n\n    this.aspect = viewport[2] / viewport[3];\n\n    this.dirty = true;\n  }\n\n  /**\n   * Set the camera location in world coordinates.\n   *\n   * @param {vec3} location\n   */\n  setLocation(location) {\n    vec3.copy(this.location, location);\n\n    this.dirty = true;\n  }\n\n  /**\n   * Move the camera by the given offset in world coordinates.\n   *\n   * @param {vec3} offset\n   */\n  move(offset) {\n    vec3.add(this.location, this.location, offset);\n\n    this.dirty = true;\n  }\n\n  /**\n   * Set the camera rotation.\n   *\n   * @param {quat} rotation\n   */\n  setRotation(rotation) {\n    quat.copy(this.rotation, rotation);\n\n    this.dirty = true;\n  }\n\n  /**\n   * Rotate the camera by the given rotation.\n   *\n   * @param {quat} rotation\n   */\n  rotate(rotation) {\n    quat.mul(this.rotation, this.rotation, rotation);\n\n    this.dirty = true;\n  }\n\n  /**\n   * Set the camera rotation to the given horizontal and vertical angles.\n   *\n   * @param {number} horizontalAngle\n   * @param {number} verticalAngle\n   */\n  setRotationAngles(horizontalAngle, verticalAngle) {\n    quat.identity(this.rotation);\n\n    this.rotateAngles(horizontalAngle, verticalAngle);\n  }\n\n  /**\n   * Rotate around the given point.\n   * Changes both the camera location and rotation.\n   *\n   * @param {quat} rotation\n   * @param {vec3} point\n   */\n  rotateAround(rotation, point) {\n    this.rotate(rotation);\n\n    quat.conjugate(quatHeap, quatHeap);\n    vec3.sub(vectorHeap, this.location, point);\n    vec3.transformQuat(vectorHeap, vectorHeap, rotation);\n    vec3.add(this.location, vectorHeap, point);\n  }\n\n  /**\n   * Rotate around the given point.\n   * Changes both the camera location and rotation.\n   *\n   * @param {quat} rotation\n   * @param {vec3} point\n   */\n  setRotationAround(rotation, point, length) {\n    this.setRotation(rotation);\n\n    if (length == null) {\n      length = vec3.len(vec3.sub(vectorHeap, this.location, point));\n    }\n\n    quat.conjugate(quatHeap, quatHeap);\n    vec3.copy(vectorHeap, VEC3_UNIT_Z);\n    vec3.transformQuat(vectorHeap, vectorHeap, quatHeap);\n    vec3.scale(vectorHeap, vectorHeap, length);\n    vec3.add(this.location, vectorHeap, point);\n  }\n\n  /**\n   * Set the rotation around the given point.\n   * Changes both the camera location and rotation.\n   *\n   * @param {number} horizontalAngle\n   * @param {number} verticalAngle\n   * @param {vec3} point\n   */\n  setRotationAroundAngles(horizontalAngle, verticalAngle, point, length) {\n    quat.identity(quatHeap);\n    quat.rotateX(quatHeap, quatHeap, verticalAngle);\n    quat.rotateZ(quatHeap, quatHeap, horizontalAngle);\n\n    this.setRotationAround(quatHeap, point, length);\n  }\n\n  /**\n   * Face the given point. Changes only the camera's orientation.\n   *\n   * @param {vec3} point\n   * @param {vec3} worldUp\n   */\n  face(point, worldUp) {\n    mat4.lookAt(matHeap, this.location, point, worldUp);\n    mat4.getRotation(this.rotation, matHeap);\n\n    this.dirty = true;\n  }\n\n  /**\n   * Move to the given location, and look at the given target.\n   *\n   * @param {vec3} location\n   * @param {vec3} target\n   * @param {vec3} worldUp\n   */\n  moveToAndFace(location, target, worldUp) {\n    vec3.copy(this.location, location);\n    this.face(target, worldUp);\n  }\n\n  /**\n   * Reset the location and angles.\n   */\n  reset() {\n    vec3.set(this.location, 0, 0, 0);\n    quat.identity(this.rotation);\n\n    this.dirty = true;\n  }\n\n  /**\n   * Recalculate the camera's transformation.\n   */\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      let location = this.location;\n      let rotation = this.rotation;\n      let inverseRotation = this.inverseRotation;\n      let worldMatrix = this.worldMatrix;\n      let projectionMatrix = this.projectionMatrix;\n      let worldProjectionMatrix = this.worldProjectionMatrix;\n      let vectors = this.vectors;\n      let billboardedVectors = this.billboardedVectors;\n\n      // Projection matrix\n      // Camera space -> NDC space\n      if (this.isPerspective) {\n        mat4.perspective(projectionMatrix, this.fov, this.aspect, this.nearClipPlane, this.farClipPlane);\n      } else {\n        mat4.ortho(projectionMatrix, this.leftClipPlane, this.rightClipPlane, this.bottomClipPlane, this.topClipPlane, this.nearClipPlane, this.farClipPlane);\n      }\n\n      mat4.fromQuat(worldMatrix, rotation);\n      mat4.translate(worldMatrix, worldMatrix, vec3.negate(vectorHeap, location));\n\n      quat.conjugate(inverseRotation, rotation);\n\n      // World projection matrix\n      // World space -> NDC space\n      mat4.mul(worldProjectionMatrix, projectionMatrix, worldMatrix);\n\n      // Recaculate the camera's frusum planes\n      unpackPlanes(this.planes, worldProjectionMatrix);\n\n      // Inverse world matrix\n      // Camera space -> World space\n      mat4.invert(this.inverseWorldMatrix, worldMatrix);\n\n      vec3.transformQuat(this.directionX, VEC3_UNIT_X, inverseRotation);\n      vec3.transformQuat(this.directionY, VEC3_UNIT_Y, inverseRotation);\n      vec3.transformQuat(this.directionZ, VEC3_UNIT_Z, inverseRotation);\n\n      // Inverse world projection matrix\n      // NDC space -> World space\n      mat4.invert(this.inverseWorldProjectionMatrix, worldProjectionMatrix);\n\n      // Cache the billboarded vectors\n      for (let i = 0; i < 7; i++) {\n        vec3.transformQuat(billboardedVectors[i], vectors[i], inverseRotation);\n      }\n    }\n  }\n\n  /**\n   * Test it a sphere with the given center and radius intersects this frustum.\n   *\n   * @param {vec3} center\n   * @param {number} radius\n   * @return {boolean}\n   */\n  testSphere(center, radius) {\n    for (let plane of this.planes) {\n      if (distanceToPlane(plane, center) <= -radius) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Given a vector in camera space, return the vector transformed to world space.\n   *\n   * @param {vec3} out\n   * @param {vec3} v\n   * @return {vec3}\n   */\n  cameraToWorld(out, v) {\n    return vec3.transformMat4(out, v, this.inverseWorldMatrix);\n  }\n\n  /**\n   * Given a vector in world space, return the vector transformed to camera space.\n   *\n   * @param {vec3} out\n   * @param {vec3} v\n   * @return {vec3}\n   */\n  worldToCamera(out, v) {\n    // return vec3.transformQuat(out, v, this.inverseWorldRotation);\n    return vec3.transformMat4(out, v, this.worldMatrix);\n  }\n\n  /**\n   * Given a vector in world space, return the vector transformed to screen space.\n   *\n   * @param {vec2} out\n   * @param {vec3} v\n   * @return {vec2}\n   */\n  worldToScreen(out, v) {\n    let viewport = this.rect;\n\n    vec3.transformMat4(vectorHeap, v, this.worldProjectionMatrix);\n\n    out[0] = Math.round(((vectorHeap[0] + 1) / 2) * viewport[2]);\n    out[1] = Math.round(((1 - vectorHeap[1]) / 2) * viewport[3]);\n\n    return out;\n  }\n\n  /**\n   * Given a vector in screen space, return a ray from the near plane to the far plane.\n   *\n   * @param {Float32Array} out\n   * @param {vec2} v\n   * @return {Float32Array}\n   */\n  screenToWorldRay(out, v) {\n    let a = vectorHeap;\n    let b = vectorHeap2;\n    let c = vectorHeap3;\n    let x = v[0];\n    let y = v[1];\n    let inverseWorldProjectionMatrix = this.inverseWorldProjectionMatrix;\n    let viewport = this.rect;\n\n    // Intersection on the near-plane\n    unproject(a, vec3.set(c, x, y, 0), inverseWorldProjectionMatrix, viewport);\n\n    // Intersection on the far-plane\n    unproject(b, vec3.set(c, x, y, 1), inverseWorldProjectionMatrix, viewport);\n\n    out.set(a, 0);\n    out.set(b, 3);\n\n    return out;\n  }\n}\n","import EventEmitter from 'events';\nimport {vec3, quat, mat4} from 'gl-matrix';\nimport {VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT} from '../common/gl-matrix-addon';\n\n// Heap allocations needed for this module.\nlet locationHeap = vec3.create();\nlet rotationHeap = quat.create();\nlet scalingHeap = vec3.create();\n\n/**\n * A node mixin.\n * Used by SceneNode and EventNode.\n *\n * @param {class} superclass\n * @return {class}\n */\nlet nodeMixin = (superclass) => class extends superclass {\n  /**\n   *\n   */\n  constructor() {\n    super();\n\n    /** @member {vec3} */\n    this.pivot = vec3.create();\n    /** @member {vec3} */\n    this.localLocation = vec3.create();\n    /** @member {quat} */\n    this.localRotation = quat.create();\n    /** @member {vec3} */\n    this.localScale = vec3.fromValues(1, 1, 1);\n    /** @member {vec3} */\n    this.worldLocation = vec3.create();\n    /** @member {quat} */\n    this.worldRotation = quat.create();\n    /** @member {vec3} */\n    this.worldScale = vec3.create();\n    /** @member {vec3} */\n    this.inverseWorldLocation = vec3.create();\n    /** @member {vec4} */\n    this.inverseWorldRotation = quat.create();\n    /** @member {vec3} */\n    this.inverseWorldScale = vec3.create();\n    /** @member {mat4} */\n    this.localMatrix = mat4.create();\n    /** @member {mat4} */\n    this.worldMatrix = mat4.create();\n    /** @member {?SceneNode} */\n    this.parent = null;\n    /** @member {Array<SceneNode>} */\n    this.children = [];\n    /** @member {boolean} */\n    this.dontInheritTranslation = false;\n    /** @member {boolean} */\n    this.dontInheritRotation = false;\n    /** @member {boolean} */\n    this.dontInheritScaling = true;\n\n    this.visible = true;\n    this.wasDirty = false;\n    this.dirty = true;\n  }\n\n  /**\n   * Sets the node's pivot.\n   *\n   * @param {vec3} pivot The new pivot.\n   * @return {this}\n   */\n  setPivot(pivot) {\n    vec3.copy(this.pivot, pivot);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local location.\n   *\n   * @param {vec3} location The new location.\n   * @return {this}\n   */\n  setLocation(location) {\n    vec3.copy(this.localLocation, location);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local rotation.\n   *\n   * @param {quat} rotation The new rotation.\n   * @return {this}\n   */\n  setRotation(rotation) {\n    quat.copy(this.localRotation, rotation);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local scale.\n   *\n   * @param {vec3} varying The new scale.\n   * @return {this}\n   */\n  setScale(varying) {\n    vec3.copy(this.localScale, varying);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local scale uniformly.\n   *\n   * @param {number} uniform The new scale.\n   * @return {this}\n   */\n  setUniformScale(uniform) {\n    vec3.set(this.localScale, uniform, uniform, uniform);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Sets the node's local location, rotation, and scale.\n   *\n   * @param {vec3} location The new location.\n   * @param {quat} rotation The new rotation.\n   * @param {vec3} scale The new scale.\n   * @return {this}\n   */\n  setTransformation(location, rotation, scale) {\n    let localLocation = this.localLocation;\n    let localRotation = this.localRotation;\n    let localScale = this.localScale;\n\n    localLocation[0] = location[0];\n    localLocation[1] = location[1];\n    localLocation[2] = location[2];\n    // vec3.copy(this.localLocation, location);\n\n    localRotation[0] = rotation[0];\n    localRotation[1] = rotation[1];\n    localRotation[2] = rotation[2];\n    localRotation[3] = rotation[3];\n    // quat.copy(this.localRotation, rotation);\n\n    localScale[0] = scale[0];\n    localScale[1] = scale[1];\n    localScale[2] = scale[2];\n    // vec3.copy(this.localScale, scale);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Resets the node's local location, pivot, rotation, and scale, to the default values.\n   *\n   * @return {this}\n   */\n  resetTransformation() {\n    vec3.copy(this.pivot, VEC3_ZERO);\n    vec3.copy(this.localLocation, VEC3_ZERO);\n    quat.copy(this.localRotation, QUAT_DEFAULT);\n    vec3.copy(this.localScale, VEC3_ONE);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Moves the node's pivot.\n   *\n   * @param {vec3} offset The offset.\n   * @return {this}\n   */\n  movePivot(offset) {\n    vec3.add(this.pivot, this.pivot, offset);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Moves the node's local location.\n   *\n   * @param {vec3} offset The offset.\n   * @return {this}\n   */\n  move(offset) {\n    vec3.add(this.localLocation, this.localLocation, offset);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Rotates the node's local rotation in world space.\n   *\n   * @param {vec3} rotation The rotation.\n   * @return {this}\n   */\n  rotate(rotation) {\n    quat.mul(this.localRotation, this.localRotation, rotation);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Rotates the node's local rotation in local space.\n   *\n   * @param {vec3} rotation The rotation.\n   * @return {this}\n   */\n  rotateLocal(rotation) {\n    quat.mul(this.localRotation, rotation, this.localRotation);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Scales the node.\n   *\n   * @param {vec3} scale The scale.\n   * @return {this}\n   */\n  scale(scale) {\n    vec3.mul(this.localScale, this.localScale, scale);\n\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Scales the node uniformly.\n   *\n   * @param {number} scale The scale.\n   * @return {this}\n   */\n  uniformScale(scale) {\n    vec3.scale(this.localScale, this.localScale, scale);\n\n    this.dirty = true;\n\n    return this;\n  }\n  /*\n  orthoNormalize(vectors) {\n      for (let i = 0; i < vectors.length; i++) {\n          let accum = vec3.create(),\n              p = vec3.create();\n\n          for (let j = 0; j < i; j++) {\n              vec3.add(accum, accum, this.project(p, vectors[i], vectors[j]));\n          }\n\n          vec3.sub(vectors[i], vectors[i], accum);\n          vec3.normalize(vectors[i], vectors[i]);\n      }\n  }\n\n  project(out, u, v) {\n      let d = vec3.dot(u, v),\n          d_div = d / vec3.sqrLen(u);\n\n      return vec3.scale(out, v, d_div);\n  }\n\n  lookAt(target, upDirection) {\n      let lookAt = vec3.create();\n\n      vec3.sub(lookAt, target, this.worldLocation);\n\n      let forward = vec3.clone(lookAt);\n      let up = vec3.clone(upDirection);\n\n      this.orthoNormalize([forward, up]);\n\n      let right = vec3.create();\n      vec3.cross(right, forward, up);\n\n      // vec3.normalize(forward, forward);\n      // vec3.normalize(up, up);\n      // vec3.normalize(right, right);\n\n      quat.setAxes(this.localRotation, forward, right, up);\n      quat.conjugate(this.localRotation, this.localRotation);\n\n      this.recalculateTransformation();\n\n      return this;\n  }\n  //* /\n  /*\n  lookAt(target) {\n      let v1 = target,\n          v2 = this.worldLocation;\n\n      let angle = Math.atan2(v2[2], v2[0]) - Math.atan2(v1[2], v1[0]);\n\n      //console.log(Math.toDeg(angle))\n  },\n  */\n\n  /**\n   * Sets the node's parent.\n   *\n   * @param {Node=} parent The parent. NOTE: don't set parent to null manually, instead use setParent().\n   * @return {this}\n   */\n  setParent(parent) {\n    // If the node already had a parent, detach from it first.\n    if (this.parent) {\n      let children = this.parent.children;\n      let index = children.indexOf(this);\n\n      if (index !== -1) {\n        children.splice(index, 1);\n      }\n    }\n\n    this.parent = parent;\n\n    // If the new parent is na actual thing, add this node as a child.\n    if (parent) {\n      parent.children.push(this);\n    }\n\n    // this.recalculateTransformation();\n    this.dirty = true;\n\n    return this;\n  }\n\n  /**\n   * Recalculate this node's transformation data.\n   */\n  recalculateTransformation() {\n    let dirty = this.dirty;\n    let parent = this.parent;\n\n    // Need to update if this node is dirty, or if its parent was dirty.\n    this.wasDirty = this.dirty;\n\n    if (parent) {\n      dirty = dirty || parent.wasDirty;\n    }\n\n    this.wasDirty = dirty;\n\n    if (dirty) {\n      this.dirty = false;\n\n      let localMatrix = this.localMatrix;\n      let localLocation = this.localLocation;\n      let localRotation = this.localRotation;\n      let localScale = this.localScale;\n      let worldMatrix = this.worldMatrix;\n      let worldLocation = this.worldLocation;\n      let worldRotation = this.worldRotation;\n      let worldScale = this.worldScale;\n      let inverseWorldLocation = this.inverseWorldLocation;\n      let inverseWorldRotation = this.inverseWorldRotation;\n      let inverseWorldScale = this.inverseWorldScale;\n\n      if (parent) {\n        let computedLocation;\n        let computedScaling;\n\n        let parentPivot = parent.pivot;\n\n        computedLocation = locationHeap;\n\n        computedLocation[0] = localLocation[0] + parentPivot[0];\n        computedLocation[1] = localLocation[1] + parentPivot[1];\n        computedLocation[2] = localLocation[2] + parentPivot[2];\n        // vec3.add(computedLocation, localLocation, parentPivot);\n\n        // If this node shouldn't inherit the parent's rotation, rotate it by the inverse.\n        // if (this.dontInheritRotation) {\n        // mat4.rotateQ(worldMatrix, worldMatrix, parent.inverseWorldRotation);\n        // }\n\n        // If this node shouldn't inherit the parent's translation, translate it by the inverse.\n        // if (this.dontInheritTranslation) {\n        // mat4.translate(worldMatrix, worldMatrix, parent.inverseWorldLocation);\n        // }\n\n        if (this.dontInheritScaling) {\n          computedScaling = scalingHeap;\n\n          let parentInverseScale = parent.inverseWorldScale;\n          computedScaling[0] = parentInverseScale[0] * localScale[0];\n          computedScaling[1] = parentInverseScale[1] * localScale[1];\n          computedScaling[2] = parentInverseScale[2] * localScale[2];\n          // vec3.mul(computedScaling, parent.inverseWorldScale, localScale);\n\n          worldScale[0] = localScale[0];\n          worldScale[1] = localScale[1];\n          worldScale[2] = localScale[2];\n          // vec3.copy(worldScale, localScale);\n        } else {\n          computedScaling = localScale;\n\n          let parentScale = parent.worldScale;\n          worldScale[0] = parentScale[0] * localScale[0];\n          worldScale[1] = parentScale[1] * localScale[1];\n          worldScale[2] = parentScale[2] * localScale[2];\n          // vec3.mul(worldScale, parentScale, localScale);\n        }\n\n        mat4.fromRotationTranslationScale(localMatrix, localRotation, computedLocation, computedScaling);\n\n        mat4.mul(worldMatrix, parent.worldMatrix, localMatrix);\n\n        quat.mul(worldRotation, parent.worldRotation, localRotation);\n      } else {\n        // Local matrix\n        mat4.fromRotationTranslationScale(localMatrix, localRotation, localLocation, localScale);\n\n        // World matrix\n        worldMatrix[0] = localMatrix[0];\n        worldMatrix[1] = localMatrix[1];\n        worldMatrix[2] = localMatrix[2];\n        worldMatrix[3] = localMatrix[3];\n        worldMatrix[4] = localMatrix[4];\n        worldMatrix[5] = localMatrix[5];\n        worldMatrix[6] = localMatrix[6];\n        worldMatrix[7] = localMatrix[7];\n        worldMatrix[8] = localMatrix[8];\n        worldMatrix[9] = localMatrix[9];\n        worldMatrix[10] = localMatrix[10];\n        worldMatrix[11] = localMatrix[11];\n        worldMatrix[12] = localMatrix[12];\n        worldMatrix[13] = localMatrix[13];\n        worldMatrix[14] = localMatrix[14];\n        worldMatrix[15] = localMatrix[15];\n        // mat4.copy(worldMatrix, localMatrix);\n\n        // World rotation\n        worldRotation[0] = localRotation[0];\n        worldRotation[1] = localRotation[1];\n        worldRotation[2] = localRotation[2];\n        worldRotation[3] = localRotation[3];\n        // quat.copy(worldRotation, localRotation);\n\n        // World scale\n        worldScale[0] = localScale[0];\n        worldScale[1] = localScale[1];\n        worldScale[2] = localScale[2];\n        // vec3.copy(worldScale, localScale);\n      }\n\n      // Inverse world rotation\n      inverseWorldRotation[0] = -worldRotation[0];\n      inverseWorldRotation[1] = -worldRotation[1];\n      inverseWorldRotation[2] = -worldRotation[2];\n      inverseWorldRotation[3] = worldRotation[3];\n      // quat.conjugate(inverseWorldRotation, worldRotation);\n\n      // Inverse world scale\n      inverseWorldScale[0] = 1 / worldScale[0];\n      inverseWorldScale[1] = 1 / worldScale[1];\n      inverseWorldScale[2] = 1 / worldScale[2];\n      // vec3.inverse(this.inverseWorldScale, worldScale);\n\n      // World location\n      worldLocation[0] = worldMatrix[12];\n      worldLocation[1] = worldMatrix[13];\n      worldLocation[2] = worldMatrix[14];\n\n      // Inverse world location\n      inverseWorldLocation[0] = -worldLocation[0];\n      inverseWorldLocation[1] = -worldLocation[1];\n      inverseWorldLocation[2] = -worldLocation[2];\n      // vec3.negate(this.inverseWorldLocation, worldLocation);\n    }\n  }\n\n  /**\n   * Update this node.\n   * Also updates the object part of this node, if there is any (e.g. model instances).\n   * Continues the update hierarchy.\n   *\n   * @param {Scene} scene\n   */\n  update(scene) {\n    if (this.dirty || (this.parent && this.parent.wasDirty)) {\n      this.dirty = true; // In case this node isn't dirty, but the parent was.\n      this.wasDirty = true;\n      this.recalculateTransformation();\n    } else {\n      this.wasDirty = false;\n    }\n\n    this.updateObject(scene);\n\n    this.updateChildren(scene);\n  }\n\n  /**\n   * Update the object part of this node.\n   * Used by model instances.\n   *\n   * @param {Scene} scene\n   */\n  updateObject(scene) {\n\n  }\n\n  /**\n   * Update this node's children and continue the update hierarchy.\n   *\n   * @param {Scene} scene\n   */\n  updateChildren(scene) {\n    let children = this.children;\n\n    for (let i = 0, l = children.length; i < l; i++) {\n      children[i].update(scene);\n    }\n  }\n};\n\n/**\n * A scene node that can be moved, rotated, scaled, parented, etc.\n */\nexport class SceneNode extends nodeMixin(class {}) {}\n\n/**\n * A scene node that is also an event dispatcher.\n */\nexport class EventNode extends nodeMixin(EventEmitter) {}\n\n/**\n * A skeletal node used for skeletons.\n * Expected to be created with createSharedNodes() below.\n */\nexport class SkeletalNode {\n  /**\n   * @param {Array<Float32Array>} shared\n   */\n  constructor(shared) {\n    /** @member {vec3} */\n    this.pivot = shared[0];\n    /** @member {vec3} */\n    this.localLocation = shared[1];\n    /** @member {quat} */\n    this.localRotation = shared[2];\n    /** @member {vec3} */\n    this.localScale = shared[3];\n    /** @member {vec3} */\n    this.worldLocation = shared[4];\n    /** @member {quat} */\n    this.worldRotation = shared[5];\n    /** @member {vec3} */\n    this.worldScale = shared[6];\n    /** @member {vec3} */\n    this.inverseWorldLocation = shared[7];\n    /** @member {vec4} */\n    this.inverseWorldRotation = shared[8];\n    /** @member {vec3} */\n    this.inverseWorldScale = shared[9];\n    /** @member {mat4} */\n    this.localMatrix = shared[10];\n    /** @member {mat4} */\n    this.worldMatrix = shared[11];\n    /** @member {boolean} */\n    this.dontInheritTranslation = false;\n    /** @member {boolean} */\n    this.dontInheritRotation = false;\n    /** @member {boolean} */\n    this.dontInheritScaling = false;\n    /** @member {Array<SceneNode>} */\n    this.children = [];\n\n    this.visible = true;\n    this.wasDirty = false;\n\n    /**\n     * The object associated with this node, if there is any.\n     *\n     * @member {?}\n     */\n    this.object = null;\n\n    this.localRotation[3] = 1;\n\n    this.localScale.fill(1);\n\n    this.localMatrix[0] = 1;\n    this.localMatrix[5] = 1;\n    this.localMatrix[10] = 1;\n    this.localMatrix[15] = 1;\n\n    this.dirty = true;\n\n    this.billboarded = false;\n    this.billboardedX = false;\n    this.billboardedY = false;\n    this.billboardedZ = false;\n  }\n\n  /**\n   * Recalculate this skeletal node.\n   *\n   * @param {Scene} scene\n   */\n  recalculateTransformation(scene) {\n    let localMatrix = this.localMatrix;\n    let localRotation = this.localRotation;\n    let localScale = this.localScale;\n    let worldMatrix = this.worldMatrix;\n    let worldLocation = this.worldLocation;\n    let worldRotation = this.worldRotation;\n    let worldScale = this.worldScale;\n    let pivot = this.pivot;\n    let inverseWorldLocation = this.inverseWorldLocation;\n    let inverseWorldRotation = this.inverseWorldRotation;\n    let inverseWorldScale = this.inverseWorldScale;\n    let parent = this.parent;\n    let computedRotation;\n    let computedScaling;\n\n    if (this.dontInheritScaling) {\n      computedScaling = scalingHeap;\n\n      let parentInverseScale = parent.inverseWorldScale;\n      computedScaling[0] = parentInverseScale[0] * localScale[0];\n      computedScaling[1] = parentInverseScale[1] * localScale[1];\n      computedScaling[2] = parentInverseScale[2] * localScale[2];\n\n      worldScale[0] = localScale[0];\n      worldScale[1] = localScale[1];\n      worldScale[2] = localScale[2];\n    } else {\n      computedScaling = localScale;\n\n      let parentScale = parent.worldScale;\n      worldScale[0] = parentScale[0] * localScale[0];\n      worldScale[1] = parentScale[1] * localScale[1];\n      worldScale[2] = parentScale[2] * localScale[2];\n    }\n\n    if (this.billboarded) {\n      computedRotation = rotationHeap;\n\n      quat.copy(computedRotation, parent.inverseWorldRotation);\n      quat.mul(computedRotation, computedRotation, scene.camera.inverseRotation);\n\n      this.convertBasis(computedRotation);\n    } else {\n      computedRotation = localRotation;\n    }\n\n    mat4.fromRotationTranslationScaleOrigin(localMatrix, computedRotation, this.localLocation, computedScaling, pivot);\n\n    mat4.mul(worldMatrix, parent.worldMatrix, localMatrix);\n\n    quat.mul(worldRotation, parent.worldRotation, computedRotation);\n\n    // Inverse world rotation\n    inverseWorldRotation[0] = -worldRotation[0];\n    inverseWorldRotation[1] = -worldRotation[1];\n    inverseWorldRotation[2] = -worldRotation[2];\n    inverseWorldRotation[3] = worldRotation[3];\n\n    // Inverse world scale\n    inverseWorldScale[0] = 1 / worldScale[0];\n    inverseWorldScale[1] = 1 / worldScale[1];\n    inverseWorldScale[2] = 1 / worldScale[2];\n\n    // World location\n    // vec3.transformMat4(worldLocation, pivot, worldMatrix);\n    let x = pivot[0];\n    let y = pivot[1];\n    let z = pivot[2];\n    worldLocation[0] = worldMatrix[0] * x + worldMatrix[4] * y + worldMatrix[8] * z + worldMatrix[12];\n    worldLocation[1] = worldMatrix[1] * x + worldMatrix[5] * y + worldMatrix[9] * z + worldMatrix[13];\n    worldLocation[2] = worldMatrix[2] * x + worldMatrix[6] * y + worldMatrix[10] * z + worldMatrix[14];\n\n    // Inverse world location\n    inverseWorldLocation[0] = -worldLocation[0];\n    inverseWorldLocation[1] = -worldLocation[1];\n    inverseWorldLocation[2] = -worldLocation[2];\n  }\n\n  /**\n   * Update this skeletal node's children.\n   * Note that this does not update other skeletal nodes!\n   * It may be called by skeletal nodes to continue the update hierarchy.\n   *\n   * @param {Scene} scene\n   */\n  updateChildren(scene) {\n    let children = this.children;\n\n    for (let i = 0, l = children.length; i < l; i++) {\n      children[i].update(scene);\n    }\n  }\n\n  /**\n   * Allows inherited node classes to run extra transformations when billboarding.\n   * This is needed because the different model formats are in different vector spaces.\n   *\n   * @param {quat} rotation\n   */\n  convertBasis(rotation) {\n\n  }\n}\n\nconst NODE_SHARED_SIZE = 65;\n\n/**\n * Creates an array of skeletal nodes with shared memory.\n * The returned object contains the node array itself, the backing buffer, and all of the different shared arrays.\n *\n * @param {number} count\n * @param {function(new:SkeletalNode)=} Node\n * @return {Object}\n */\nexport function createSkeletalNodes(count, Node) {\n  let data = new Float32Array(count * NODE_SHARED_SIZE);\n  let nodes = [];\n  let offset = 0;\n  let count3 = count * 3;\n  let count4 = count * 4;\n  let count16 = count * 16;\n\n  // Allow to also create inherited nodes.\n  Node = Node || SkeletalNode;\n\n  let pivots = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let localLocations = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let localRotations = data.subarray(offset, offset + count4);\n  offset += count4;\n\n  let localScales = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let worldLocations = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let worldRotations = data.subarray(offset, offset + count4);\n  offset += count4;\n\n  let worldScales = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let inverseWorldLocations = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let invereseWorldRotations = data.subarray(offset, offset + count4);\n  offset += count4;\n\n  let inverseWorldScales = data.subarray(offset, offset + count3);\n  offset += count3;\n\n  let localMatrices = data.subarray(offset, offset + count16);\n  offset += count16;\n\n  let worldMatrices = data.subarray(offset, offset + count16);\n\n  for (let i = 0; i < count; i++) {\n    let i3 = i * 3;\n    let i33 = i3 + 3;\n    let i4 = i * 4;\n    let i44 = i4 + 4;\n    let i16 = i * 16;\n    let i1616 = i16 + 16;\n\n    nodes[i] = new Node([\n      pivots.subarray(i3, i33),\n      localLocations.subarray(i3, i33),\n      localRotations.subarray(i4, i44),\n      localScales.subarray(i3, i33),\n      worldLocations.subarray(i3, i33),\n      worldRotations.subarray(i4, i44),\n      worldScales.subarray(i3, i33),\n      inverseWorldLocations.subarray(i3, i33),\n      invereseWorldRotations.subarray(i4, i44),\n      inverseWorldScales.subarray(i3, i33),\n      localMatrices.subarray(i16, i1616),\n      worldMatrices.subarray(i16, i1616),\n    ]);\n  }\n\n  return {\n    data,\n    nodes,\n    pivots,\n    localLocations,\n    localRotations,\n    localScales,\n    worldLocations,\n    worldRotations,\n    worldScales,\n    inverseWorldLocations,\n    invereseWorldRotations,\n    inverseWorldScales,\n    localMatrices,\n    worldMatrices,\n  };\n}\n","import { vec3, quat } from 'gl-matrix';\nimport Camera from './camera';\nimport { SceneNode } from './node';\n\n// Heap allocations needed for this module.\nlet ndcHeap = new Float32Array(3);\n\n/**\n * A scene.\n *\n * Every scene has its own list of model instances, and its own camera and viewport.\n *\n * In addition, every scene may have its own AudioContext if enableAudio() is called.\n * If audo is enabled, the AudioContext's listener's location will be updated automatically.\n * Note that due to browser policies, this may be done only after user interaction with the web page.\n */\nexport default class Scene {\n  /**\n   * @param {ModelViewer} viewer\n   */\n  constructor(viewer) {\n    let canvas = viewer.canvas;\n\n    /** @member {ModelViewer.viewer.ModelViewer} */\n    this.viewer = viewer;\n    /** @member {ModelViewer.viewer.Camera} */\n    this.camera = new Camera();\n    /** @member {Array<ModelViewer.viewer.ModelInstance>} */\n    this.instances = [];\n    /** @member {Set<ModelViewer.viewer.ModelInstance>} */\n    this.instanceSet = new Set();\n    /** @member {Array<ModelViewer.viewer.ModelView>} */\n    this.modelViews = [];\n    /** @member {Set<ModelViewer.viewer.ModelView>} */\n    this.modelViewSet = new Set();\n    /** @member {ModelViewer.viewer.SceneNode} */\n    this.node = new SceneNode();\n    /** @member {boolean} */\n    this.rendered = true;\n\n    /** @member {number} */\n    this.renderedInstances = 0;\n    /** @member {number} */\n    this.renderedParticles = 0;\n    /** @member {number} */\n    this.renderedBuckets = 0;\n    /** @member {number} */\n    this.renderCalls = 0;\n\n    /** @member {boolean} */\n    this.audioEnabled = false;\n    /** @member {?AudioContext} */\n    this.audioContext = null;\n\n    this.node.recalculateTransformation(this);\n    this.node.wasDirty = false;\n\n    // Use the whole canvas, and standard perspective projection values.\n    this.camera.viewport([0, 0, canvas.width, canvas.height]);\n    this.camera.perspective(Math.PI / 4, canvas.width / canvas.height, 8, 10000);\n  }\n\n  //垂直俯瞰\n  configureOverheadPerspective(canvas, heightAboveScene = 100) {\n    // 设置相机视口\n    this.camera.viewport([0, 0, canvas.width, canvas.height]);\n\n    // 设置透视投影为垂直视角\n    const fovDegrees = 90;\n    this.camera.perspective(fovDegrees * (Math.PI / 180), canvas.width / canvas.height, 1, 10000); // 将角度转换为弧度\n\n    // 设置相机位置在场景上方\n    this.camera.setLocation([0, heightAboveScene, 0]);\n\n    // 设置相机朝向垂直向下\n    const rotation = quat.setAxisAngle(quat.create(), [0, 1, 0], Math.PI); // 使用quat库设置旋转180度朝下\n    this.camera.setRotation(rotation);\n  }\n\n  /**\n   * Creates an AudioContext if one wasn't created already, and resumes it if needed.\n   * The returned promise will resolve to whether it is actually running or not.\n   * It may stay in suspended state indefinitly until the client interact with the page, due to browser policies.\n   *\n   * @return {Promise}\n   */\n  async enableAudio() {\n    if (!this.audioContext) {\n      this.audioContext = new AudioContext();\n    }\n\n    if (this.audioContext.state !== 'suspended') {\n      await this.audioContext.resume();\n    }\n\n    this.audioEnabled = this.audioContext.state === 'running';\n\n    return this.audioEnabled;\n  }\n\n  /**\n   * Suspend the audio context.\n   */\n  disableAudio() {\n    if (this.audioContext) {\n      this.audioContext.suspend();\n    }\n\n    this.audioEnabled = false;\n  }\n\n  /**\n   * Sets the scene of the given instance.\n   * This is equivalent to instance.setScene(scene).\n   *\n   * @param {ModelViewer.viewer.ModelInstance} instance\n   * @return {boolean}\n   */\n  addInstance(instance) {\n    let instanceSet = this.instanceSet;\n\n    if (!instanceSet.has(instance)) {\n      instanceSet.add(instance);\n      this.instances.push(instance);\n\n      if (instance.scene) {\n        instance.scene.removeInstance(instance);\n      }\n\n      instance.modelView.sceneChanged(instance, this);\n      instance.scene = this;\n\n      if (!instance.parent) {\n        instance.setParent(this.node);\n      }\n\n      this.addView(instance.modelView);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Add a model view to this scene.\n   *\n   * @param {ModelView} modelView\n   */\n  addView(modelView) {\n    let modelViewSet = this.modelViewSet;\n\n    if (!modelViewSet.has(modelView)) {\n      modelViewSet.add(modelView);\n      this.modelViews.push(modelView);\n    }\n  }\n\n  /**\n   * Remove an instance from this scene.\n   *\n   * @param {ModelInstance} instance The instance to remove.\n   * @return {boolean}\n   */\n  removeInstance(instance) {\n    if (this.instanceSet.delete(instance)) {\n      let instances = this.instances;\n      instances.splice(instances.indexOf(instance), 1);\n\n      instance.modelView.sceneChanged(instance, null);\n      instance.scene = null;\n\n      if (instance.parent === this.node) {\n        instance.setParent(null);\n      }\n\n      this.removeView(instance.modelView);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Remove a model view from this scene.\n   *\n   * @param {ModelView} modelView\n   */\n  removeView(modelView) {\n    if (this.modelViewSet.delete(modelView)) {\n      let modelViews = this.modelViews;\n      modelViews.splice(modelViews.indexOf(modelView), 1);\n    }\n  }\n\n  /**\n   * Clear this scene.\n   */\n  clear() {\n    this.instances.length = 0;\n    this.instanceSet.clear();\n    this.modelViews.length = 0;\n    this.modelViewSet.clear();\n  }\n\n  /**\n   * Detach this scene from the viewer.\n   * Equivalent to viewer.removeScene(scene).\n   *\n   * @return {boolean}\n   */\n  detach() {\n    if (this.viewer) {\n      return this.viewer.removeScene(this);\n    }\n\n    return false;\n  }\n\n  /**\n   * Update this scene.\n   * This includes updating the scene's camera, the node hierarchy (model instances etc.), the model views, and the AudoContext's lisener's position if it exists.\n   */\n  update() {\n    if (this.rendered) {\n      // Update all of the nodes, instances, etc.\n      this.node.updateChildren(this);\n\n      this.renderedInstances = 0;\n      this.renderedParticles = 0;\n      this.renderedBuckets = 0;\n      this.renderCalls = 0;\n\n      // Update the rendering data\n      for (let modelView of this.modelViews) {\n        modelView.update(this);\n\n        this.renderedInstances += modelView.renderedInstances;\n        this.renderedParticles += modelView.renderedParticles;\n        this.renderedBuckets += modelView.renderedBuckets;\n        this.renderCalls += modelView.renderCalls;\n      }\n\n      if (this.audioContext) {\n        let [x, y, z] = this.camera.location;\n\n        this.audioContext.listener.setPosition(-x, -y, -z);\n      }\n\n      this.camera.update();\n    }\n  }\n\n  /**\n   * Tests if an instance is currently visible in this scene.\n   * If the model has a bounding sphere, it will be used. Otherwise checks only the location of the instance.\n   *\n   * @param {ModelInstance} instance\n   * @return {boolean}\n   */\n  isVisible(instance) {\n    let model = instance.model;\n    let bounds = model.bounds;\n\n    // If the model has a bounding sphere in it, do a sphere test.\n    // Otherwise do a point test.\n    if (bounds) {\n      let center = bounds.center;\n      let location = instance.worldLocation;\n\n      ndcHeap[0] = location[0] + center[0];\n      ndcHeap[1] = location[1] + center[1];\n      ndcHeap[2] = location[2] + center[2];\n\n      return this.camera.testSphere(ndcHeap, bounds.radius);\n    } else {\n      let worldProjectionMatrix = this.camera.worldProjectionMatrix;\n\n      // This test checks whether the instance's position is visible in NDC space. In other words, that it lies in [-1, 1] on all axes\n      vec3.transformMat4(ndcHeap, instance.worldLocation, worldProjectionMatrix);\n      if (ndcHeap[0] >= -1 && ndcHeap[0] <= 1 && ndcHeap[1] >= -1 && ndcHeap[1] <= 1 && ndcHeap[2] >= -1 && ndcHeap[2] <= 1) {\n        return true;\n      }\n\n      return false;\n    }\n  }\n\n  /**\n   * Render all opaque things in this scene.\n   * Automatically applies the camera's viewport.\n   */\n  renderOpaque() {\n    if (this.rendered) {\n      this.viewport();\n\n      for (let modelView of this.modelViews) {\n        modelView.renderOpaque(this);\n      }\n    }\n  }\n\n  /**\n   * Renders all translucent things in this scene.\n   * Automatically applies the camera's viewport.\n   */\n  renderTranslucent() {\n    if (this.rendered) {\n      this.viewport();\n\n      for (let modelView of this.modelViews) {\n        modelView.renderTranslucent(this);\n      }\n    }\n  }\n\n  /**\n   * Set the viewport to that of this scene's camera.\n   */\n  viewport() {\n    let viewport = this.camera.rect;\n\n    this.viewer.gl.viewport(viewport[0], viewport[1], viewport[2], viewport[3]);\n  }\n\n  /**\n   * Clear all of the emitted objects in this scene.\n   */\n  clearEmittedObjects() {\n    for (let instance of this.instances) {\n      instance.clearEmittedObjects();\n    }\n  }\n}\n","import EventEmitter from 'events';\n\n/**\n * A viewer resource.\n * Generally speaking resources are created via viewer.load().\n * Resources include models, textures, or any arbitrary file types that have handlers (e.g. INI).\n */\nexport default class Resource extends EventEmitter {\n  /**\n   * @param {Object} resourceData\n   */\n  constructor({ viewer, handler, extension, pathSolver, fetchUrl = '', path }) {\n    super();\n\n    /** @member {ModelViewer.viewer.ModelViewer} */\n    this.viewer = viewer;\n    /** @member {Handler} */\n    this.handler = handler || null;\n    /** @member {string} */\n    this.extension = extension || '';\n    /** @member {function(?)} */\n    this.pathSolver = pathSolver || null;\n    /** @member {string} */\n    this.fetchUrl = fetchUrl;\n    /** @member {boolean} */\n    this.ok = false;\n    /** @member {boolean} */\n    this.loadend = false;\n    /** @member {string} */\n    this.path = path;\n\n    // Ignore EventEmitter warnings.\n    // Mostly relevant when loading many models that reference the same texture / event object.\n    this.setMaxListeners(0);\n  }\n\n  /**\n   * Will be called when the data for this resource is ready.\n   * If it was loaded from memory, it will be called instantly.\n   * Otherwise it will be called when the server fetch finishes, assuming it succeeded.\n   *\n   * @param {string|ArrayBuffer|Image} src\n   */\n  loadData(src) {\n    const setLoaded = () => {\n      this.loadend = true;\n      this.ok = true;\n      this.lateLoad();\n\n      this.emit('load', this);\n      this.emit('loadend', this);\n    }\n\n    // In case the resource parsing/loading fails, e.g. if the source is not valid.\n    try {\n      let promise = this.load(src);\n      if (promise instanceof Promise) {\n        promise.then(setLoaded);\n      }\n      else {\n        setLoaded();\n      }\n\n    } catch (e) {\n      this.error('InvalidData', e);\n    }\n  }\n\n  /**\n   * @param {*} src\n   */\n  load(src) {\n\n  }\n\n  /**\n   * Remove this resource from its viewer's cache.\n   * Equivalent to viewer.unload(resource).\n   *\n   * @return {boolean}\n   */\n  detach() {\n    return this.viewer.unload(this);\n  }\n\n  /**\n   * This is used by models to finish loading their instances and model views, in case any are added before the model finished loaded.\n   */\n  lateLoad() {\n    // console.log('lateLoad', this.path || this);\n  }\n\n  /**\n   * Called when an error happens while loading the resource.\n   * This includes both fetching and parsing errors.\n   *\n   * @param {string} error\n   * @param {*} reason\n   */\n  error(error, reason) {\n    this.loadend = true;\n\n    console.info('[ResLoad] Failed on ', this.path, this.fetchUrl)\n    // this.emit('error', this, error, reason);\n    this.emit('loadend', this);\n  }\n\n  /**\n   * Similar to attaching an event listener to the 'loadend' event, but handles the case where the resource already loaded, and the callback should still be called.\n   *\n   * @return {Promise}\n   */\n  whenLoaded() {\n    return new Promise((resolve, reject) => {\n      if (this.loadend) {\n        resolve(this);\n      } else {\n        const timeoutId = setTimeout(() => {\n          reject(new Error('Load timeout'));\n        }, 20000); // 假设5秒后认为是超时  \n        this.once('loadend', () => {\n          clearTimeout(timeoutId);\n          resolve(this)\n        });\n      }\n    });\n  }\n  ready(thenAction) {\n    if (this.loadend) {\n      return thenAction(this);\n    } else {\n      this.once('loadend', () => {\n        thenAction(this);\n      });\n    }\n  }\n}\n","import Resource from './resource';\n\n/**\n * A texture.\n */\nexport default class Texture extends Resource {\n  /**\n   * @param {Object} resourceData\n   */\n  constructor(resourceData) {\n    super(resourceData);\n\n    /** @param {number} */\n    this.width = 0;\n    /** @param {number} */\n    this.height = 0;\n    /** @param {boolean} */\n    this.wrapS = false;\n    /** @param {boolean} */\n    this.wrapT = false;\n  }\n\n  /**\n   * Set the WebGL wrap and filter values.\n   *\n   * @param {number} wrapS Wrap on the S axis.\n   * @param {number} wrapT Wrap on the T axis.\n   * @param {number} magFilter Maginfying filter.\n   * @param {number} minFilter Minifying filter.\n   */\n  setParameters(wrapS, wrapT, magFilter, minFilter) {\n    const gl = this.viewer.gl;\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, magFilter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter);\n  }\n\n  /**\n   * @param {number} unit\n   */\n  bind(unit) {\n    let viewer = this.viewer;\n    let gl = this.viewer.gl;\n\n    viewer.webgl.bindTexture(this, unit);\n\n    if (this.wrapS) {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    }\n\n    if (this.wrapT) {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    }\n  }\n}\n","import { imageToImageData, scaleNPOT } from '../../../common/canvas';\nimport Texture from '../../texture';\n\n/**\n * A texture handler for image sources.\n */\nexport default class ImageTexture extends Texture {\n  /**\n   * @param {HTMLImageElement|HTMLVideoElement|HTMLCanvasElement|ImageData|WebGLTexture} src\n   */\n  load(src) {\n    // src can either be an Image, or an ArrayBuffer, depending on the way it was loaded\n    if (src instanceof HTMLImageElement || src instanceof HTMLVideoElement || src instanceof HTMLCanvasElement || src instanceof ImageData) {\n      let gl = this.viewer.gl;\n\n      if (!(src instanceof ImageData)) {\n        src = imageToImageData(src);\n      }\n\n      // Upscale to POT if the size is NPOT.\n      this.originalData = src;\n      src = scaleNPOT(src);\n\n      let id = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, id);\n      this.setParameters(gl.REPEAT, gl.REPEAT, gl.LINEAR, gl.LINEAR_MIPMAP_LINEAR);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, src);\n      gl.generateMipmap(gl.TEXTURE_2D);\n\n      this.imageData = src;\n      this.width = src.width; // Note: might not be the same as 'image.width' and 'image.height' due to NPOT upscaling.\n      this.height = src.height;\n      this.webglResource = id;\n    } else if (src instanceof WebGLTexture) {\n      this.webglResource = src;\n    }\n  }\n}\n","import ImageTexture from './texture';\n\nexport default {\n  extensions: [['.png', 'image'], ['.jpg', 'image'], ['.gif', 'image']],\n  Constructor: ImageTexture,\n};\n","import Resource from './resource';\n\n/**\n * A generic resource.\n */\nexport default class GenericResource extends Resource {\n  /**\n   * @param {Object} resourceData\n   */\n  constructor(resourceData) {\n    super(resourceData);\n\n    /** @member {*} */\n    this.data = null;\n  }\n\n  /**\n   * @param {*} data\n   */\n  load(data) {\n    this.data = data;\n  }\n}\n","//===================================================\n// Game Constants    \n//===================================================\nexport const /*boolean */           FALSE = false\nexport const /*boolean */           TRUE = true\nexport const /*integer */           JASS_MAX_ARRAY_SIZE = 8192\n\nexport const /*integer */           PLAYER_NEUTRAL_PASSIVE = [\"player.neutral\", \"PLAYER_NEUTRAL_PASSIVE\", 15];\nexport const /*integer */           PLAYER_NEUTRAL_AGGRESSIVE = [\"player.neutral\", \"PLAYER_NEUTRAL_AGGRESSIVE\", 12];\n\nexport const /* playercolor */          PLAYER_COLOR_RED = [\"playercolor\", \"PLAYER_COLOR_RED\", 0];\nexport const /* playercolor */          PLAYER_COLOR_BLUE = [\"playercolor\", \"PLAYER_COLOR_BLUE\", 1];\nexport const /* playercolor */          PLAYER_COLOR_CYAN = [\"playercolor\", \"PLAYER_COLOR_CYAN\", 2];\nexport const /* playercolor */          PLAYER_COLOR_PURPLE = [\"playercolor\", \"PLAYER_COLOR_PURPLE\", 3];\nexport const /* playercolor */          PLAYER_COLOR_YELLOW = [\"playercolor\", \"PLAYER_COLOR_YELLOW\", 4];\nexport const /* playercolor */          PLAYER_COLOR_ORANGE = [\"playercolor\", \"PLAYER_COLOR_ORANGE\", 5];\nexport const /* playercolor */          PLAYER_COLOR_GREEN = [\"playercolor\", \"PLAYER_COLOR_GREEN\", 6];\nexport const /* playercolor */          PLAYER_COLOR_PINK = [\"playercolor\", \"PLAYER_COLOR_PINK\", 7];\nexport const /* playercolor */          PLAYER_COLOR_LIGHT_GRAY = [\"playercolor\", \"PLAYER_COLOR_LIGHT_GRAY\", 8];\nexport const /* playercolor */          PLAYER_COLOR_LIGHT_BLUE = [\"playercolor\", \"PLAYER_COLOR_LIGHT_BLUE\", 9];\nexport const /* playercolor */          PLAYER_COLOR_AQUA = [\"playercolor\", \"PLAYER_COLOR_AQUA\", 10];\nexport const /* playercolor */          PLAYER_COLOR_BROWN = [\"playercolor\", \"PLAYER_COLOR_BROWN\", 11];\n\nexport const /* race */                 RACE_HUMAN = [\"race\", \"RACE_HUMAN\", 1];\nexport const /* race */                 RACE_ORC = [\"race\", \"RACE_ORC\", 2];\nexport const /* race */                 RACE_UNDEAD = [\"race\", \"RACE_UNDEAD\", 3];\nexport const /* race */                 RACE_NIGHTELF = [\"race\", \"RACE_NIGHTELF\", 4];\nexport const /* race */                 RACE_DEMON = [\"race\", \"RACE_DEMON\", 5];\nexport const /* race */                 RACE_OTHER = [\"race\", \"RACE_OTHER\", 7];\n\nexport const /* playergameresult */     PLAYER_GAME_RESULT_VICTORY = [\"playergameresult\", \"PLAYER_GAME_RESULT_VICTORY\", 0];\nexport const /* playergameresult */     PLAYER_GAME_RESULT_DEFEAT = [\"playergameresult\", \"PLAYER_GAME_RESULT_DEFEAT\", 1];\nexport const /* playergameresult */     PLAYER_GAME_RESULT_TIE = [\"playergameresult\", \"PLAYER_GAME_RESULT_TIE\", 2];\nexport const /* playergameresult */     PLAYER_GAME_RESULT_NEUTRAL = [\"playergameresult\", \"PLAYER_GAME_RESULT_NEUTRAL\", 3];\n\nexport const /* alliancetype */         ALLIANCE_PASSIVE = [\"alliancetype\", \"ALLIANCE_PASSIVE\", 0];\nexport const /* alliancetype */         ALLIANCE_HELP_REQUEST = [\"alliancetype\", \"ALLIANCE_HELP_REQUEST\", 1];\nexport const /* alliancetype */         ALLIANCE_HELP_RESPONSE = [\"alliancetype\", \"ALLIANCE_HELP_RESPONSE\", 2];\nexport const /* alliancetype */         ALLIANCE_SHARED_XP = [\"alliancetype\", \"ALLIANCE_SHARED_XP\", 3];\nexport const /* alliancetype */         ALLIANCE_SHARED_SPELLS = [\"alliancetype\", \"ALLIANCE_SHARED_SPELLS\", 4];\nexport const /* alliancetype */         ALLIANCE_SHARED_VISION = [\"alliancetype\", \"ALLIANCE_SHARED_VISION\", 5];\nexport const /* alliancetype */         ALLIANCE_SHARED_CONTROL = [\"alliancetype\", \"ALLIANCE_SHARED_CONTROL\", 6];\nexport const /* alliancetype */         ALLIANCE_SHARED_ADVANCED_CONTROL = [\"alliancetype\", \"ALLIANCE_SHARED_ADVANCED_CONTROL\", 7];\nexport const /* alliancetype */         ALLIANCE_RESCUABLE = [\"alliancetype\", \"ALLIANCE_RESCUABLE\", 8];\nexport const /* alliancetype */         ALLIANCE_SHARED_VISION_FORCED = [\"alliancetype\", \"ALLIANCE_SHARED_VISION_FORCED\", 9];\n\nexport const /* version */              VERSION_REIGN_OF_CHAOS = [\"version\", \"VERSION_REIGN_OF_CHAOS\", 0];\nexport const /* version */              VERSION_FROZEN_THRONE = [\"version\", \"VERSION_FROZEN_THRONE\", 1];\n\nexport const /* attacktype */           ATTACK_TYPE_NORMAL = [\"attacktype\", \"ATTACK_TYPE_NORMAL\", 0];\nexport const /* attacktype */           ATTACK_TYPE_MELEE = [\"attacktype\", \"ATTACK_TYPE_MELEE\", 1];\nexport const /* attacktype */           ATTACK_TYPE_PIERCE = [\"attacktype\", \"ATTACK_TYPE_PIERCE\", 2];\nexport const /* attacktype */           ATTACK_TYPE_SIEGE = [\"attacktype\", \"ATTACK_TYPE_SIEGE\", 3];\nexport const /* attacktype */           ATTACK_TYPE_MAGIC = [\"attacktype\", \"ATTACK_TYPE_MAGIC\", 4];\nexport const /* attacktype */           ATTACK_TYPE_CHAOS = [\"attacktype\", \"ATTACK_TYPE_CHAOS\", 5];\nexport const /* attacktype */           ATTACK_TYPE_HERO = [\"attacktype\", \"ATTACK_TYPE_HERO\", 6];\n\nexport const /* damagetype */           DAMAGE_TYPE_UNKNOWN = [\"damagetype\", \"DAMAGE_TYPE_UNKNOWN\", 0];\nexport const /* damagetype */           DAMAGE_TYPE_NORMAL = [\"damagetype\", \"DAMAGE_TYPE_NORMAL\", 4];\nexport const /* damagetype */           DAMAGE_TYPE_ENHANCED = [\"damagetype\", \"DAMAGE_TYPE_ENHANCED\", 5];\nexport const /* damagetype */           DAMAGE_TYPE_FIRE = [\"damagetype\", \"DAMAGE_TYPE_FIRE\", 8];\nexport const /* damagetype */           DAMAGE_TYPE_COLD = [\"damagetype\", \"DAMAGE_TYPE_COLD\", 9];\nexport const /* damagetype */           DAMAGE_TYPE_LIGHTNING = [\"damagetype\", \"DAMAGE_TYPE_LIGHTNING\", 10];\nexport const /* damagetype */           DAMAGE_TYPE_POISON = [\"damagetype\", \"DAMAGE_TYPE_POISON\", 11];\nexport const /* damagetype */           DAMAGE_TYPE_DISEASE = [\"damagetype\", \"DAMAGE_TYPE_DISEASE\", 12];\nexport const /* damagetype */           DAMAGE_TYPE_DIVINE = [\"damagetype\", \"DAMAGE_TYPE_DIVINE\", 13];\nexport const /* damagetype */           DAMAGE_TYPE_MAGIC = [\"damagetype\", \"DAMAGE_TYPE_MAGIC\", 14];\nexport const /* damagetype */           DAMAGE_TYPE_SONIC = [\"damagetype\", \"DAMAGE_TYPE_SONIC\", 15];\nexport const /* damagetype */           DAMAGE_TYPE_ACID = [\"damagetype\", \"DAMAGE_TYPE_ACID\", 16];\nexport const /* damagetype */           DAMAGE_TYPE_FORCE = [\"damagetype\", \"DAMAGE_TYPE_FORCE\", 17];\nexport const /* damagetype */           DAMAGE_TYPE_DEATH = [\"damagetype\", \"DAMAGE_TYPE_DEATH\", 18];\nexport const /* damagetype */           DAMAGE_TYPE_MIND = [\"damagetype\", \"DAMAGE_TYPE_MIND\", 19];\nexport const /* damagetype */           DAMAGE_TYPE_PLANT = [\"damagetype\", \"DAMAGE_TYPE_PLANT\", 20];\nexport const /* damagetype */           DAMAGE_TYPE_DEFENSIVE = [\"damagetype\", \"DAMAGE_TYPE_DEFENSIVE\", 21];\nexport const /* damagetype */           DAMAGE_TYPE_DEMOLITION = [\"damagetype\", \"DAMAGE_TYPE_DEMOLITION\", 22];\nexport const /* damagetype */           DAMAGE_TYPE_SLOW_POISON = [\"damagetype\", \"DAMAGE_TYPE_SLOW_POISON\", 23];\nexport const /* damagetype */           DAMAGE_TYPE_SPIRIT_LINK = [\"damagetype\", \"DAMAGE_TYPE_SPIRIT_LINK\", 24];\nexport const /* damagetype */           DAMAGE_TYPE_SHADOW_STRIKE = [\"damagetype\", \"DAMAGE_TYPE_SHADOW_STRIKE\", 25];\nexport const /* damagetype */           DAMAGE_TYPE_UNIVERSAL = [\"damagetype\", \"DAMAGE_TYPE_UNIVERSAL\", 26];\n\nexport const /* weapontype */           WEAPON_TYPE_WHOKNOWS = [\"weapontype\", \"WEAPON_TYPE_WHOKNOWS\", 0];\nexport const /* weapontype */           WEAPON_TYPE_METAL_LIGHT_CHOP = [\"weapontype\", \"WEAPON_TYPE_METAL_LIGHT_CHOP\", 1];\nexport const /* weapontype */           WEAPON_TYPE_METAL_MEDIUM_CHOP = [\"weapontype\", \"WEAPON_TYPE_METAL_MEDIUM_CHOP\", 2];\nexport const /* weapontype */           WEAPON_TYPE_METAL_HEAVY_CHOP = [\"weapontype\", \"WEAPON_TYPE_METAL_HEAVY_CHOP\", 3];\nexport const /* weapontype */           WEAPON_TYPE_METAL_LIGHT_SLICE = [\"weapontype\", \"WEAPON_TYPE_METAL_LIGHT_SLICE\", 4];\nexport const /* weapontype */           WEAPON_TYPE_METAL_MEDIUM_SLICE = [\"weapontype\", \"WEAPON_TYPE_METAL_MEDIUM_SLICE\", 5];\nexport const /* weapontype */           WEAPON_TYPE_METAL_HEAVY_SLICE = [\"weapontype\", \"WEAPON_TYPE_METAL_HEAVY_SLICE\", 6];\nexport const /* weapontype */           WEAPON_TYPE_METAL_MEDIUM_BASH = [\"weapontype\", \"WEAPON_TYPE_METAL_MEDIUM_BASH\", 7];\nexport const /* weapontype */           WEAPON_TYPE_METAL_HEAVY_BASH = [\"weapontype\", \"WEAPON_TYPE_METAL_HEAVY_BASH\", 8];\nexport const /* weapontype */           WEAPON_TYPE_METAL_MEDIUM_STAB = [\"weapontype\", \"WEAPON_TYPE_METAL_MEDIUM_STAB\", 9];\nexport const /* weapontype */           WEAPON_TYPE_METAL_HEAVY_STAB = [\"weapontype\", \"WEAPON_TYPE_METAL_HEAVY_STAB\", 10];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_LIGHT_SLICE = [\"weapontype\", \"WEAPON_TYPE_WOOD_LIGHT_SLICE\", 11];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_MEDIUM_SLICE = [\"weapontype\", \"WEAPON_TYPE_WOOD_MEDIUM_SLICE\", 12];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_HEAVY_SLICE = [\"weapontype\", \"WEAPON_TYPE_WOOD_HEAVY_SLICE\", 13];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_LIGHT_BASH = [\"weapontype\", \"WEAPON_TYPE_WOOD_LIGHT_BASH\", 14];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_MEDIUM_BASH = [\"weapontype\", \"WEAPON_TYPE_WOOD_MEDIUM_BASH\", 15];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_HEAVY_BASH = [\"weapontype\", \"WEAPON_TYPE_WOOD_HEAVY_BASH\", 16];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_LIGHT_STAB = [\"weapontype\", \"WEAPON_TYPE_WOOD_LIGHT_STAB\", 17];\nexport const /* weapontype */           WEAPON_TYPE_WOOD_MEDIUM_STAB = [\"weapontype\", \"WEAPON_TYPE_WOOD_MEDIUM_STAB\", 18];\nexport const /* weapontype */           WEAPON_TYPE_CLAW_LIGHT_SLICE = [\"weapontype\", \"WEAPON_TYPE_CLAW_LIGHT_SLICE\", 19];\nexport const /* weapontype */           WEAPON_TYPE_CLAW_MEDIUM_SLICE = [\"weapontype\", \"WEAPON_TYPE_CLAW_MEDIUM_SLICE\", 20];\nexport const /* weapontype */           WEAPON_TYPE_CLAW_HEAVY_SLICE = [\"weapontype\", \"WEAPON_TYPE_CLAW_HEAVY_SLICE\", 21];\nexport const /* weapontype */           WEAPON_TYPE_AXE_MEDIUM_CHOP = [\"weapontype\", \"WEAPON_TYPE_AXE_MEDIUM_CHOP\", 22];\nexport const /* weapontype */           WEAPON_TYPE_ROCK_HEAVY_BASH = [\"weapontype\", \"WEAPON_TYPE_ROCK_HEAVY_BASH\", 23];\n\nexport const /* pathingtype */          PATHING_TYPE_ANY = [\"pathingtype\", \"PATHING_TYPE_ANY\", 0];\nexport const /* pathingtype */          PATHING_TYPE_WALKABILITY = [\"pathingtype\", \"PATHING_TYPE_WALKABILITY\", 1];\nexport const /* pathingtype */          PATHING_TYPE_FLYABILITY = [\"pathingtype\", \"PATHING_TYPE_FLYABILITY\", 2];\nexport const /* pathingtype */          PATHING_TYPE_BUILDABILITY = [\"pathingtype\", \"PATHING_TYPE_BUILDABILITY\", 3];\nexport const /* pathingtype */          PATHING_TYPE_PEONHARVESTPATHING = [\"pathingtype\", \"PATHING_TYPE_PEONHARVESTPATHING\", 4];\nexport const /* pathingtype */          PATHING_TYPE_BLIGHTPATHING = [\"pathingtype\", \"PATHING_TYPE_BLIGHTPATHING\", 5];\nexport const /* pathingtype */          PATHING_TYPE_FLOATABILITY = [\"pathingtype\", \"PATHING_TYPE_FLOATABILITY\", 6];\nexport const /* pathingtype */          PATHING_TYPE_AMPHIBIOUSPATHING = [\"pathingtype\", \"PATHING_TYPE_AMPHIBIOUSPATHING\", 7];\n\nexport const /* mousebuttontype */    MOUSE_BUTTON_TYPE_LEFT = [\"mousebuttontype\", \"MOUSE_BUTTON_TYPE_LEFT\", 1]; // mousebuttontype\nexport const /* mousebuttontype */    MOUSE_BUTTON_TYPE_MIDDLE = [\"mousebuttontype\", \"MOUSE_BUTTON_TYPE_MIDDLE\", 2]; // mousebuttontype\nexport const /* mousebuttontype */    MOUSE_BUTTON_TYPE_RIGHT = [\"mousebuttontype\", \"MOUSE_BUTTON_TYPE_RIGHT\", 3]; // mousebuttontype\n\n//===================================================\n// Map Setup Constants    \n//===================================================\n\nexport const /* racepreference */       RACE_PREF_HUMAN = [\"racepreference\", \"RACE_PREF_HUMAN\", 1];\nexport const /* racepreference */       RACE_PREF_ORC = [\"racepreference\", \"RACE_PREF_ORC\", 2];\nexport const /* racepreference */       RACE_PREF_NIGHTELF = [\"racepreference\", \"RACE_PREF_NIGHTELF\", 4];\nexport const /* racepreference */       RACE_PREF_UNDEAD = [\"racepreference\", \"RACE_PREF_UNDEAD\", 8];\nexport const /* racepreference */       RACE_PREF_DEMON = [\"racepreference\", \"RACE_PREF_DEMON\", 16];\nexport const /* racepreference */       RACE_PREF_RANDOM = [\"racepreference\", \"RACE_PREF_RANDOM\", 32];\nexport const /* racepreference */       RACE_PREF_USER_SELECTABLE = [\"racepreference\", \"RACE_PREF_USER_SELECTABLE\", 64];\n\nexport const /* mapcontrol */           MAP_CONTROL_USER = [\"mapcontrol\", \"MAP_CONTROL_USER\", 0];\nexport const /* mapcontrol */           MAP_CONTROL_COMPUTER = [\"mapcontrol\", \"MAP_CONTROL_COMPUTER\", 1];\nexport const /* mapcontrol */           MAP_CONTROL_RESCUABLE = [\"mapcontrol\", \"MAP_CONTROL_RESCUABLE\", 2];\nexport const /* mapcontrol */           MAP_CONTROL_NEUTRAL = [\"mapcontrol\", \"MAP_CONTROL_NEUTRAL\", 3];\nexport const /* mapcontrol */           MAP_CONTROL_CREEP = [\"mapcontrol\", \"MAP_CONTROL_CREEP\", 4];\nexport const /* mapcontrol */           MAP_CONTROL_NONE = [\"mapcontrol\", \"MAP_CONTROL_NONE\", 5];\n\nexport const /* gametype */             GAME_TYPE_MELEE = [\"gametype\", \"GAME_TYPE_MELEE\", 1];\nexport const /* gametype */             GAME_TYPE_FFA = [\"gametype\", \"GAME_TYPE_FFA\", 2];\nexport const /* gametype */             GAME_TYPE_USE_MAP_SETTINGS = [\"gametype\", \"GAME_TYPE_USE_MAP_SETTINGS\", 4];\nexport const /* gametype */             GAME_TYPE_BLIZ = [\"gametype\", \"GAME_TYPE_BLIZ\", 8];\nexport const /* gametype */             GAME_TYPE_ONE_ON_ONE = [\"gametype\", \"GAME_TYPE_ONE_ON_ONE\", 16];\nexport const /* gametype */             GAME_TYPE_TWO_TEAM_PLAY = [\"gametype\", \"GAME_TYPE_TWO_TEAM_PLAY\", 32];\nexport const /* gametype */             GAME_TYPE_THREE_TEAM_PLAY = [\"gametype\", \"GAME_TYPE_THREE_TEAM_PLAY\", 64];\nexport const /* gametype */             GAME_TYPE_FOUR_TEAM_PLAY = [\"gametype\", \"GAME_TYPE_FOUR_TEAM_PLAY\", 128];\n\nexport const /* mapflag */              MAP_FOG_HIDE_TERRAIN = [\"mapflag\", \"MAP_FOG_HIDE_TERRAIN\", 1];\nexport const /* mapflag */              MAP_FOG_MAP_EXPLORED = [\"mapflag\", \"MAP_FOG_MAP_EXPLORED\", 2];\nexport const /* mapflag */              MAP_FOG_ALWAYS_VISIBLE = [\"mapflag\", \"MAP_FOG_ALWAYS_VISIBLE\", 4];\n\nexport const /* mapflag */              MAP_USE_HANDICAPS = [\"mapflag\", \"MAP_USE_HANDICAPS\", 8];\nexport const /* mapflag */              MAP_OBSERVERS = [\"mapflag\", \"MAP_OBSERVERS\", 16];\nexport const /* mapflag */              MAP_OBSERVERS_ON_DEATH = [\"mapflag\", \"MAP_OBSERVERS_ON_DEATH\", 32];\n\nexport const /* mapflag */              MAP_FIXED_COLORS = [\"mapflag\", \"MAP_FIXED_COLORS\", 128];\n\nexport const /* mapflag */              MAP_LOCK_RESOURCE_TRADING = [\"mapflag\", \"MAP_LOCK_RESOURCE_TRADING\", 256];\nexport const /* mapflag */              MAP_RESOURCE_TRADING_ALLIES_ONLY = [\"mapflag\", \"MAP_RESOURCE_TRADING_ALLIES_ONLY\", 512];\n\nexport const /* mapflag */              MAP_LOCK_ALLIANCE_CHANGES = [\"mapflag\", \"MAP_LOCK_ALLIANCE_CHANGES\", 1024];\nexport const /* mapflag */              MAP_ALLIANCE_CHANGES_HIDDEN = [\"mapflag\", \"MAP_ALLIANCE_CHANGES_HIDDEN\", 2048];\n\nexport const /* mapflag */              MAP_CHEATS = [\"mapflag\", \"MAP_CHEATS\", 4096];\nexport const /* mapflag */              MAP_CHEATS_HIDDEN = [\"mapflag\", \"MAP_CHEATS_HIDDEN\", 8192];\n\nexport const /* mapflag */              MAP_LOCK_SPEED = [\"mapflag\", \"MAP_LOCK_SPEED\", 8192 * 2];\nexport const /* mapflag */              MAP_LOCK_RANDOM_SEED = [\"mapflag\", \"MAP_LOCK_RANDOM_SEED\", 8192 * 4];\nexport const /* mapflag */              MAP_SHARED_ADVANCED_CONTROL = [\"mapflag\", \"MAP_SHARED_ADVANCED_CONTROL\", 8192 * 8];\nexport const /* mapflag */              MAP_RANDOM_HERO = [\"mapflag\", \"MAP_RANDOM_HERO\", 8192 * 16];\nexport const /* mapflag */              MAP_RANDOM_RACES = [\"mapflag\", \"MAP_RANDOM_RACES\", 8192 * 32];\nexport const /* mapflag */              MAP_RELOADED = [\"mapflag\", \"MAP_RELOADED\", 8192 * 64];\n\nexport const /* placement */            MAP_PLACEMENT_RANDOM = [\"placement\", \"MAP_PLACEMENT_RANDOM\", 0];   // random among all slots\nexport const /* placement */            MAP_PLACEMENT_FIXED = [\"placement\", \"MAP_PLACEMENT_FIXED\", 1];   // player 0 in start loc 0...\nexport const /* placement */            MAP_PLACEMENT_USE_MAP_SETTINGS = [\"placement\", \"MAP_PLACEMENT_USE_MAP_SETTINGS\", 2];   // whatever was specified by the script\nexport const /* placement */            MAP_PLACEMENT_TEAMS_TOGETHER = [\"placement\", \"MAP_PLACEMENT_TEAMS_TOGETHER\", 3];   // random with allies next to each other    \n\nexport const /* startlocprio */         MAP_LOC_PRIO_LOW = [\"startlocprio\", \"MAP_LOC_PRIO_LOW\", 0];\nexport const /* startlocprio */         MAP_LOC_PRIO_HIGH = [\"startlocprio\", \"MAP_LOC_PRIO_HIGH\", 1];\nexport const /* startlocprio */         MAP_LOC_PRIO_NOT = [\"startlocprio\", \"MAP_LOC_PRIO_NOT\", 2];\n\nexport const /* mapdensity */           MAP_DENSITY_NONE = [\"mapdensity\", \"MAP_DENSITY_NONE\", 0];\nexport const /* mapdensity */           MAP_DENSITY_LIGHT = [\"mapdensity\", \"MAP_DENSITY_LIGHT\", 1];\nexport const /* mapdensity */           MAP_DENSITY_MEDIUM = [\"mapdensity\", \"MAP_DENSITY_MEDIUM\", 2];\nexport const /* mapdensity */           MAP_DENSITY_HEAVY = [\"mapdensity\", \"MAP_DENSITY_HEAVY\", 3];\n\nexport const /* gamedifficulty */       MAP_DIFFICULTY_EASY = [\"gamedifficulty\", \"MAP_DIFFICULTY_EASY\", 0];\nexport const /* gamedifficulty */       MAP_DIFFICULTY_NORMAL = [\"gamedifficulty\", \"MAP_DIFFICULTY_NORMAL\", 1];\nexport const /* gamedifficulty */       MAP_DIFFICULTY_HARD = [\"gamedifficulty\", \"MAP_DIFFICULTY_HARD\", 2];\nexport const /* gamedifficulty */       MAP_DIFFICULTY_INSANE = [\"gamedifficulty\", \"MAP_DIFFICULTY_INSANE\", 3];\n\nexport const /* gamespeed */            MAP_SPEED_SLOWEST = [\"gamespeed\", \"MAP_SPEED_SLOWEST\", 0];\nexport const /* gamespeed */            MAP_SPEED_SLOW = [\"gamespeed\", \"MAP_SPEED_SLOW\", 1];\nexport const /* gamespeed */            MAP_SPEED_NORMAL = [\"gamespeed\", \"MAP_SPEED_NORMAL\", 2];\nexport const /* gamespeed */            MAP_SPEED_FAST = [\"gamespeed\", \"MAP_SPEED_FAST\", 3];\nexport const /* gamespeed */            MAP_SPEED_FASTEST = [\"gamespeed\", \"MAP_SPEED_FASTEST\", 4];\n\nexport const /* playerslotstate */      PLAYER_SLOT_STATE_EMPTY = [\"playerslotstate\", \"PLAYER_SLOT_STATE_EMPTY\", 0];\nexport const /* playerslotstate */      PLAYER_SLOT_STATE_PLAYING = [\"playerslotstate\", \"PLAYER_SLOT_STATE_PLAYING\", 1];\nexport const /* playerslotstate */      PLAYER_SLOT_STATE_LEFT = [\"playerslotstate\", \"PLAYER_SLOT_STATE_LEFT\", 2];\n\n//===================================================\n// Sound Constants\n//===================================================\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_UNITMOVEMENT = [\"volumegroup\", \"SOUND_VOLUMEGROUP_UNITMOVEMENT\", 0];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_UNITSOUNDS = [\"volumegroup\", \"SOUND_VOLUMEGROUP_UNITSOUNDS\", 1];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_COMBAT = [\"volumegroup\", \"SOUND_VOLUMEGROUP_COMBAT\", 2];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_SPELLS = [\"volumegroup\", \"SOUND_VOLUMEGROUP_SPELLS\", 3];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_UI = [\"volumegroup\", \"SOUND_VOLUMEGROUP_UI\", 4];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_MUSIC = [\"volumegroup\", \"SOUND_VOLUMEGROUP_MUSIC\", 5];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_AMBIENTSOUNDS = [\"volumegroup\", \"SOUND_VOLUMEGROUP_AMBIENTSOUNDS\", 6];\nexport const /* volumegroup */          SOUND_VOLUMEGROUP_FIRE = [\"volumegroup\", \"SOUND_VOLUMEGROUP_FIRE\", 7];\n\n\n//===================================================\n// Game, Player, and Unit States\n//\n// For use with TriggerRegister<X>StateEvent\n//\n//===================================================\n\nexport const /* igamestate */   GAME_STATE_DIVINE_INTERVENTION = [\"igamestate\", \"GAME_STATE_DIVINE_INTERVENTION\", 0];\nexport const /* igamestate */   GAME_STATE_DISCONNECTED = [\"igamestate\", \"GAME_STATE_DISCONNECTED\", 1];\nexport const /* fgamestate */   GAME_STATE_TIME_OF_DAY = [\"fgamestate\", \"GAME_STATE_TIME_OF_DAY\", 2];\n\nexport const /* playerstate */   PLAYER_STATE_GAME_RESULT = [\"playerstate\", \"PLAYER_STATE_GAME_RESULT\", 0];\n\n// current resource levels\n//\nexport const /* playerstate */   PLAYER_STATE_RESOURCE_GOLD = [\"playerstate\", \"PLAYER_STATE_RESOURCE_GOLD\", 1];\nexport const /* playerstate */   PLAYER_STATE_RESOURCE_LUMBER = [\"playerstate\", \"PLAYER_STATE_RESOURCE_LUMBER\", 2];\nexport const /* playerstate */   PLAYER_STATE_RESOURCE_HERO_TOKENS = [\"playerstate\", \"PLAYER_STATE_RESOURCE_HERO_TOKENS\", 3];\nexport const /* playerstate */   PLAYER_STATE_RESOURCE_FOOD_CAP = [\"playerstate\", \"PLAYER_STATE_RESOURCE_FOOD_CAP\", 4];\nexport const /* playerstate */   PLAYER_STATE_RESOURCE_FOOD_USED = [\"playerstate\", \"PLAYER_STATE_RESOURCE_FOOD_USED\", 5];\nexport const /* playerstate */   PLAYER_STATE_FOOD_CAP_CEILING = [\"playerstate\", \"PLAYER_STATE_FOOD_CAP_CEILING\", 6];\n\nexport const /* playerstate */   PLAYER_STATE_GIVES_BOUNTY = [\"playerstate\", \"PLAYER_STATE_GIVES_BOUNTY\", 7];\nexport const /* playerstate */   PLAYER_STATE_ALLIED_VICTORY = [\"playerstate\", \"PLAYER_STATE_ALLIED_VICTORY\", 8];\nexport const /* playerstate */   PLAYER_STATE_PLACED = [\"playerstate\", \"PLAYER_STATE_PLACED\", 9];\nexport const /* playerstate */   PLAYER_STATE_OBSERVER_ON_DEATH = [\"playerstate\", \"PLAYER_STATE_OBSERVER_ON_DEATH\", 10];\nexport const /* playerstate */   PLAYER_STATE_OBSERVER = [\"playerstate\", \"PLAYER_STATE_OBSERVER\", 11];\nexport const /* playerstate */   PLAYER_STATE_UNFOLLOWABLE = [\"playerstate\", \"PLAYER_STATE_UNFOLLOWABLE\", 12];\n\n// taxation rate for each resource\n//\nexport const /* playerstate */   PLAYER_STATE_GOLD_UPKEEP_RATE = [\"playerstate\", \"PLAYER_STATE_GOLD_UPKEEP_RATE\", 13];\nexport const /* playerstate */   PLAYER_STATE_LUMBER_UPKEEP_RATE = [\"playerstate\", \"PLAYER_STATE_LUMBER_UPKEEP_RATE\", 14];\n\n// cumulative resources collected by the player during the mission\n//\nexport const /* playerstate */   PLAYER_STATE_GOLD_GATHERED = [\"playerstate\", \"PLAYER_STATE_GOLD_GATHERED\", 15];\nexport const /* playerstate */   PLAYER_STATE_LUMBER_GATHERED = [\"playerstate\", \"PLAYER_STATE_LUMBER_GATHERED\", 16];\n\nexport const /* playerstate */   PLAYER_STATE_NO_CREEP_SLEEP = [\"playerstate\", \"PLAYER_STATE_NO_CREEP_SLEEP\", 25];\n\nexport const /* unitstate */   UNIT_STATE_LIFE = [\"unitstate\", \"UNIT_STATE_LIFE\", 0];\nexport const /* unitstate */   UNIT_STATE_MAX_LIFE = [\"unitstate\", \"UNIT_STATE_MAX_LIFE\", 1];\nexport const /* unitstate */   UNIT_STATE_MANA = [\"unitstate\", \"UNIT_STATE_MANA\", 2];\nexport const /* unitstate */   UNIT_STATE_MAX_MANA = [\"unitstate\", \"UNIT_STATE_MAX_MANA\", 3];\n\nexport const /* aidifficulty */   AI_DIFFICULTY_NEWBIE = [\"aidifficulty\", \"AI_DIFFICULTY_NEWBIE\", 0];\nexport const /* aidifficulty */   AI_DIFFICULTY_NORMAL = [\"aidifficulty\", \"AI_DIFFICULTY_NORMAL\", 1];\nexport const /* aidifficulty */   AI_DIFFICULTY_INSANE = [\"aidifficulty\", \"AI_DIFFICULTY_INSANE\", 2];\n\n// player score values\nexport const /* playerscore */   PLAYER_SCORE_UNITS_TRAINED = [\"playerscore\", \"PLAYER_SCORE_UNITS_TRAINED\", 0];\nexport const /* playerscore */   PLAYER_SCORE_UNITS_KILLED = [\"playerscore\", \"PLAYER_SCORE_UNITS_KILLED\", 1];\nexport const /* playerscore */   PLAYER_SCORE_STRUCT_BUILT = [\"playerscore\", \"PLAYER_SCORE_STRUCT_BUILT\", 2];\nexport const /* playerscore */   PLAYER_SCORE_STRUCT_RAZED = [\"playerscore\", \"PLAYER_SCORE_STRUCT_RAZED\", 3];\nexport const /* playerscore */   PLAYER_SCORE_TECH_PERCENT = [\"playerscore\", \"PLAYER_SCORE_TECH_PERCENT\", 4];\nexport const /* playerscore */   PLAYER_SCORE_FOOD_MAXPROD = [\"playerscore\", \"PLAYER_SCORE_FOOD_MAXPROD\", 5];\nexport const /* playerscore */   PLAYER_SCORE_FOOD_MAXUSED = [\"playerscore\", \"PLAYER_SCORE_FOOD_MAXUSED\", 6];\nexport const /* playerscore */   PLAYER_SCORE_HEROES_KILLED = [\"playerscore\", \"PLAYER_SCORE_HEROES_KILLED\", 7];\nexport const /* playerscore */   PLAYER_SCORE_ITEMS_GAINED = [\"playerscore\", \"PLAYER_SCORE_ITEMS_GAINED\", 8];\nexport const /* playerscore */   PLAYER_SCORE_MERCS_HIRED = [\"playerscore\", \"PLAYER_SCORE_MERCS_HIRED\", 9];\nexport const /* playerscore */   PLAYER_SCORE_GOLD_MINED_TOTAL = [\"playerscore\", \"PLAYER_SCORE_GOLD_MINED_TOTAL\", 10];\nexport const /* playerscore */   PLAYER_SCORE_GOLD_MINED_UPKEEP = [\"playerscore\", \"PLAYER_SCORE_GOLD_MINED_UPKEEP\", 11];\nexport const /* playerscore */   PLAYER_SCORE_GOLD_LOST_UPKEEP = [\"playerscore\", \"PLAYER_SCORE_GOLD_LOST_UPKEEP\", 12];\nexport const /* playerscore */   PLAYER_SCORE_GOLD_LOST_TAX = [\"playerscore\", \"PLAYER_SCORE_GOLD_LOST_TAX\", 13];\nexport const /* playerscore */   PLAYER_SCORE_GOLD_GIVEN = [\"playerscore\", \"PLAYER_SCORE_GOLD_GIVEN\", 14];\nexport const /* playerscore */   PLAYER_SCORE_GOLD_RECEIVED = [\"playerscore\", \"PLAYER_SCORE_GOLD_RECEIVED\", 15];\nexport const /* playerscore */   PLAYER_SCORE_LUMBER_TOTAL = [\"playerscore\", \"PLAYER_SCORE_LUMBER_TOTAL\", 16];\nexport const /* playerscore */   PLAYER_SCORE_LUMBER_LOST_UPKEEP = [\"playerscore\", \"PLAYER_SCORE_LUMBER_LOST_UPKEEP\", 17];\nexport const /* playerscore */   PLAYER_SCORE_LUMBER_LOST_TAX = [\"playerscore\", \"PLAYER_SCORE_LUMBER_LOST_TAX\", 18];\nexport const /* playerscore */   PLAYER_SCORE_LUMBER_GIVEN = [\"playerscore\", \"PLAYER_SCORE_LUMBER_GIVEN\", 19];\nexport const /* playerscore */   PLAYER_SCORE_LUMBER_RECEIVED = [\"playerscore\", \"PLAYER_SCORE_LUMBER_RECEIVED\", 20];\nexport const /* playerscore */   PLAYER_SCORE_UNIT_TOTAL = [\"playerscore\", \"PLAYER_SCORE_UNIT_TOTAL\", 21];\nexport const /* playerscore */   PLAYER_SCORE_HERO_TOTAL = [\"playerscore\", \"PLAYER_SCORE_HERO_TOTAL\", 22];\nexport const /* playerscore */   PLAYER_SCORE_RESOURCE_TOTAL = [\"playerscore\", \"PLAYER_SCORE_RESOURCE_TOTAL\", 23];\nexport const /* playerscore */   PLAYER_SCORE_TOTAL = [\"playerscore\", \"PLAYER_SCORE_TOTAL\", 24];\n\n//===================================================\n// Game, Player and Unit Events\n//\n//  When an event causes a trigger to fire these\n//  values allow the action code to determine which\n//  event was dispatched and therefore which set of\n//  native functions should be used to get information\n//  about the event.\n//\n// Do NOT change the order or value of these constants\n// without insuring that the JASS_GAME_EVENTS_WAR3 enum\n// is changed to match.\n//\n//===================================================\n\n//===================================================\n// For use with TriggerRegisterGameEvent    \n//===================================================    \n\nexport const /* gameevent */   EVENT_GAME_VICTORY = [\"gameevent\", \"EVENT_GAME_VICTORY\", 0];\nexport const /* gameevent */   EVENT_GAME_END_LEVEL = [\"gameevent\", \"EVENT_GAME_END_LEVEL\", 1];\n\nexport const /* gameevent */   EVENT_GAME_VARIABLE_LIMIT = [\"gameevent\", \"EVENT_GAME_VARIABLE_LIMIT\", 2];\nexport const /* gameevent */   EVENT_GAME_STATE_LIMIT = [\"gameevent\", \"EVENT_GAME_STATE_LIMIT\", 3];\n\nexport const /* gameevent */   EVENT_GAME_TIMER_EXPIRED = [\"gameevent\", \"EVENT_GAME_TIMER_EXPIRED\", 4];\n\nexport const /* gameevent */   EVENT_GAME_ENTER_REGION = [\"gameevent\", \"EVENT_GAME_ENTER_REGION\", 5];\nexport const /* gameevent */   EVENT_GAME_LEAVE_REGION = [\"gameevent\", \"EVENT_GAME_LEAVE_REGION\", 6];\n\nexport const /* gameevent */   EVENT_GAME_TRACKABLE_HIT = [\"gameevent\", \"EVENT_GAME_TRACKABLE_HIT\", 7];\nexport const /* gameevent */   EVENT_GAME_TRACKABLE_TRACK = [\"gameevent\", \"EVENT_GAME_TRACKABLE_TRACK\", 8];\n\nexport const /* gameevent */   EVENT_GAME_SHOW_SKILL = [\"gameevent\", \"EVENT_GAME_SHOW_SKILL\", 9];\nexport const /* gameevent */   EVENT_GAME_BUILD_SUBMENU = [\"gameevent\", \"EVENT_GAME_BUILD_SUBMENU\", 10];\n\n//===================================================\n// For use with TriggerRegisterPlayerEvent\n//===================================================\nexport const /* playerevent */   EVENT_PLAYER_STATE_LIMIT = [\"playerevent\", \"EVENT_PLAYER_STATE_LIMIT\", 11];\nexport const /* playerevent */   EVENT_PLAYER_ALLIANCE_CHANGED = [\"playerevent\", \"EVENT_PLAYER_ALLIANCE_CHANGED\", 12];\n\nexport const /* playerevent */   EVENT_PLAYER_DEFEAT = [\"playerevent\", \"EVENT_PLAYER_DEFEAT\", 13];\nexport const /* playerevent */   EVENT_PLAYER_VICTORY = [\"playerevent\", \"EVENT_PLAYER_VICTORY\", 14];\nexport const /* playerevent */   EVENT_PLAYER_LEAVE = [\"playerevent\", \"EVENT_PLAYER_LEAVE\", 15];\nexport const /* playerevent */   EVENT_PLAYER_CHAT = [\"playerevent\", \"EVENT_PLAYER_CHAT\", 16];\nexport const /* playerevent */   EVENT_PLAYER_END_CINEMATIC = [\"playerevent\", \"EVENT_PLAYER_END_CINEMATIC\", 17];\n\n//===================================================\n// For use with TriggerRegisterPlayerUnitEvent\n//===================================================\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_ATTACKED = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_ATTACKED\", 18];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_RESCUED = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_RESCUED\", 19];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_DEATH = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_DEATH\", 20];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_DECAY = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_DECAY\", 21];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_DETECTED = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_DETECTED\", 22];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_HIDDEN = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_HIDDEN\", 23];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_SELECTED = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SELECTED\", 24];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_DESELECTED = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_DESELECTED\", 25];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_CONSTRUCT_START = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_CONSTRUCT_START\", 26];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_CONSTRUCT_CANCEL = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_CONSTRUCT_CANCEL\", 27];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_CONSTRUCT_FINISH = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_CONSTRUCT_FINISH\", 28];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_UPGRADE_START = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_UPGRADE_START\", 29];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_UPGRADE_CANCEL = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_UPGRADE_CANCEL\", 30];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_UPGRADE_FINISH = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_UPGRADE_FINISH\", 31];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_TRAIN_START = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_TRAIN_START\", 32];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_TRAIN_CANCEL = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_TRAIN_CANCEL\", 33];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_TRAIN_FINISH = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_TRAIN_FINISH\", 34];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_RESEARCH_START = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_RESEARCH_START\", 35];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_RESEARCH_CANCEL = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_RESEARCH_CANCEL\", 36];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_RESEARCH_FINISH = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_RESEARCH_FINISH\", 37];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_ISSUED_ORDER = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_ISSUED_ORDER\", 38];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER\", 39];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER\", 40];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_ISSUED_UNIT_ORDER = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_ISSUED_UNIT_ORDER\", 40];    // for compat\n\nexport const /* playerunitevent */   EVENT_PLAYER_HERO_LEVEL = [\"playerunitevent\", \"EVENT_PLAYER_HERO_LEVEL\", 41];\nexport const /* playerunitevent */   EVENT_PLAYER_HERO_SKILL = [\"playerunitevent\", \"EVENT_PLAYER_HERO_SKILL\", 42];\n\nexport const /* playerunitevent */   EVENT_PLAYER_HERO_REVIVABLE = [\"playerunitevent\", \"EVENT_PLAYER_HERO_REVIVABLE\", 43];\n\nexport const /* playerunitevent */   EVENT_PLAYER_HERO_REVIVE_START = [\"playerunitevent\", \"EVENT_PLAYER_HERO_REVIVE_START\", 44];\nexport const /* playerunitevent */   EVENT_PLAYER_HERO_REVIVE_CANCEL = [\"playerunitevent\", \"EVENT_PLAYER_HERO_REVIVE_CANCEL\", 45];\nexport const /* playerunitevent */   EVENT_PLAYER_HERO_REVIVE_FINISH = [\"playerunitevent\", \"EVENT_PLAYER_HERO_REVIVE_FINISH\", 46];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_SUMMON = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SUMMON\", 47];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_DROP_ITEM = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_DROP_ITEM\", 48];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_PICKUP_ITEM = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_PICKUP_ITEM\", 49];\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_USE_ITEM = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_USE_ITEM\", 50];\n\nexport const /* playerunitevent */   EVENT_PLAYER_UNIT_LOADED = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_LOADED\", 51];\n\n//===================================================\n// For use with TriggerRegisterUnitEvent\n//===================================================\n\nexport const /* unitevent */   EVENT_UNIT_DAMAGED = [\"unitevent\", \"EVENT_UNIT_DAMAGED\", 52];\nexport const /* unitevent */   EVENT_UNIT_DEATH = [\"unitevent\", \"EVENT_UNIT_DEATH\", 53];\nexport const /* unitevent */   EVENT_UNIT_DECAY = [\"unitevent\", \"EVENT_UNIT_DECAY\", 54];\nexport const /* unitevent */   EVENT_UNIT_DETECTED = [\"unitevent\", \"EVENT_UNIT_DETECTED\", 55];\nexport const /* unitevent */   EVENT_UNIT_HIDDEN = [\"unitevent\", \"EVENT_UNIT_HIDDEN\", 56];\nexport const /* unitevent */   EVENT_UNIT_SELECTED = [\"unitevent\", \"EVENT_UNIT_SELECTED\", 57];\nexport const /* unitevent */   EVENT_UNIT_DESELECTED = [\"unitevent\", \"EVENT_UNIT_DESELECTED\", 58];\n\nexport const /* unitevent */   EVENT_UNIT_STATE_LIMIT = [\"unitevent\", \"EVENT_UNIT_STATE_LIMIT\", 59];\n\n// Events which may have a filter for the \"other unit\"              \n//                                                                  \nexport const /* unitevent */   EVENT_UNIT_ACQUIRED_TARGET = [\"unitevent\", \"EVENT_UNIT_ACQUIRED_TARGET\", 60];\nexport const /* unitevent */   EVENT_UNIT_TARGET_IN_RANGE = [\"unitevent\", \"EVENT_UNIT_TARGET_IN_RANGE\", 61];\nexport const /* unitevent */   EVENT_UNIT_ATTACKED = [\"unitevent\", \"EVENT_UNIT_ATTACKED\", 62];\nexport const /* unitevent */   EVENT_UNIT_RESCUED = [\"unitevent\", \"EVENT_UNIT_RESCUED\", 63];\n\nexport const /* unitevent */   EVENT_UNIT_CONSTRUCT_CANCEL = [\"unitevent\", \"EVENT_UNIT_CONSTRUCT_CANCEL\", 64];\nexport const /* unitevent */   EVENT_UNIT_CONSTRUCT_FINISH = [\"unitevent\", \"EVENT_UNIT_CONSTRUCT_FINISH\", 65];\n\nexport const /* unitevent */   EVENT_UNIT_UPGRADE_START = [\"unitevent\", \"EVENT_UNIT_UPGRADE_START\", 66];\nexport const /* unitevent */   EVENT_UNIT_UPGRADE_CANCEL = [\"unitevent\", \"EVENT_UNIT_UPGRADE_CANCEL\", 67];\nexport const /* unitevent */   EVENT_UNIT_UPGRADE_FINISH = [\"unitevent\", \"EVENT_UNIT_UPGRADE_FINISH\", 68];\n\n// Events which involve the specified unit performing               \n// training of other units                                          \n//                                                                  \nexport const /* unitevent */   EVENT_UNIT_TRAIN_START = [\"unitevent\", \"EVENT_UNIT_TRAIN_START\", 69];\nexport const /* unitevent */   EVENT_UNIT_TRAIN_CANCEL = [\"unitevent\", \"EVENT_UNIT_TRAIN_CANCEL\", 70];\nexport const /* unitevent */   EVENT_UNIT_TRAIN_FINISH = [\"unitevent\", \"EVENT_UNIT_TRAIN_FINISH\", 71];\n\nexport const /* unitevent */   EVENT_UNIT_RESEARCH_START = [\"unitevent\", \"EVENT_UNIT_RESEARCH_START\", 72];\nexport const /* unitevent */   EVENT_UNIT_RESEARCH_CANCEL = [\"unitevent\", \"EVENT_UNIT_RESEARCH_CANCEL\", 73];\nexport const /* unitevent */   EVENT_UNIT_RESEARCH_FINISH = [\"unitevent\", \"EVENT_UNIT_RESEARCH_FINISH\", 74];\n\nexport const /* unitevent */   EVENT_UNIT_ISSUED_ORDER = [\"unitevent\", \"EVENT_UNIT_ISSUED_ORDER\", 75];\nexport const /* unitevent */   EVENT_UNIT_ISSUED_POINT_ORDER = [\"unitevent\", \"EVENT_UNIT_ISSUED_POINT_ORDER\", 76];\nexport const /* unitevent */   EVENT_UNIT_ISSUED_TARGET_ORDER = [\"unitevent\", \"EVENT_UNIT_ISSUED_TARGET_ORDER\", 77];\n\nexport const /* unitevent */   EVENT_UNIT_HERO_LEVEL = [\"unitevent\", \"EVENT_UNIT_HERO_LEVEL\", 78];\nexport const /* unitevent */   EVENT_UNIT_HERO_SKILL = [\"unitevent\", \"EVENT_UNIT_HERO_SKILL\", 79];\n\nexport const /* unitevent */   EVENT_UNIT_HERO_REVIVABLE = [\"unitevent\", \"EVENT_UNIT_HERO_REVIVABLE\", 80];\nexport const /* unitevent */   EVENT_UNIT_HERO_REVIVE_START = [\"unitevent\", \"EVENT_UNIT_HERO_REVIVE_START\", 81];\nexport const /* unitevent */   EVENT_UNIT_HERO_REVIVE_CANCEL = [\"unitevent\", \"EVENT_UNIT_HERO_REVIVE_CANCEL\", 82];\nexport const /* unitevent */   EVENT_UNIT_HERO_REVIVE_FINISH = [\"unitevent\", \"EVENT_UNIT_HERO_REVIVE_FINISH\", 83];\n\nexport const /* unitevent */   EVENT_UNIT_SUMMON = [\"unitevent\", \"EVENT_UNIT_SUMMON\", 84];\n\nexport const /* unitevent */   EVENT_UNIT_DROP_ITEM = [\"unitevent\", \"EVENT_UNIT_DROP_ITEM\", 85];\nexport const /* unitevent */   EVENT_UNIT_PICKUP_ITEM = [\"unitevent\", \"EVENT_UNIT_PICKUP_ITEM\", 86];\nexport const /* unitevent */   EVENT_UNIT_USE_ITEM = [\"unitevent\", \"EVENT_UNIT_USE_ITEM\", 87];\n\nexport const /* unitevent */   EVENT_UNIT_LOADED = [\"unitevent\", \"EVENT_UNIT_LOADED\", 88];\n\nexport const /* widgetevent */   EVENT_WIDGET_DEATH = [\"widgetevent\", \"EVENT_WIDGET_DEATH\", 89];\n\nexport const /* dialogevent */   EVENT_DIALOG_BUTTON_CLICK = [\"dialogevent\", \"EVENT_DIALOG_BUTTON_CLICK\", 90];\nexport const /* dialogevent */   EVENT_DIALOG_CLICK = [\"dialogevent\", \"EVENT_DIALOG_CLICK\", 91];\n\n//===================================================\n// Frozen Throne Expansion Events\n// Need to be added here to preserve compat\n//===================================================\n\n//===================================================\n// For use with TriggerRegisterGameEvent    \n//===================================================    \n\nexport const /* gameevent */            EVENT_GAME_LOADED = [\"gameevent\", \"EVENT_GAME_LOADED\", 256];\nexport const /* gameevent */            EVENT_GAME_TOURNAMENT_FINISH_SOON = [\"gameevent\", \"EVENT_GAME_TOURNAMENT_FINISH_SOON\", 257];\nexport const /* gameevent */            EVENT_GAME_TOURNAMENT_FINISH_NOW = [\"gameevent\", \"EVENT_GAME_TOURNAMENT_FINISH_NOW\", 258];\nexport const /* gameevent */            EVENT_GAME_SAVE = [\"gameevent\", \"EVENT_GAME_SAVE\", 259];\n\n//===================================================\n// For use with TriggerRegisterPlayerEvent\n//===================================================\n\nexport const /* playerevent */          EVENT_PLAYER_ARROW_LEFT_DOWN = [\"playerevent\", \"EVENT_PLAYER_ARROW_LEFT_DOWN\", 261];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_LEFT_UP = [\"playerevent\", \"EVENT_PLAYER_ARROW_LEFT_UP\", 262];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_RIGHT_DOWN = [\"playerevent\", \"EVENT_PLAYER_ARROW_RIGHT_DOWN\", 263];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_RIGHT_UP = [\"playerevent\", \"EVENT_PLAYER_ARROW_RIGHT_UP\", 264];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_DOWN_DOWN = [\"playerevent\", \"EVENT_PLAYER_ARROW_DOWN_DOWN\", 265];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_DOWN_UP = [\"playerevent\", \"EVENT_PLAYER_ARROW_DOWN_UP\", 266];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_UP_DOWN = [\"playerevent\", \"EVENT_PLAYER_ARROW_UP_DOWN\", 267];\nexport const /* playerevent */          EVENT_PLAYER_ARROW_UP_UP = [\"playerevent\", \"EVENT_PLAYER_ARROW_UP_UP\", 268];\n\n//===================================================\n// For use with TriggerRegisterPlayerUnitEvent\n//===================================================\n\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SELL = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SELL\", 269];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_CHANGE_OWNER = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_CHANGE_OWNER\", 270];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SELL_ITEM = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SELL_ITEM\", 271];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SPELL_CHANNEL = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SPELL_CHANNEL\", 272];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SPELL_CAST = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SPELL_CAST\", 273];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SPELL_EFFECT = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SPELL_EFFECT\", 274];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SPELL_FINISH = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SPELL_FINISH\", 275];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_SPELL_ENDCAST = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_SPELL_ENDCAST\", 276];\nexport const /* playerunitevent */      EVENT_PLAYER_UNIT_PAWN_ITEM = [\"playerunitevent\", \"EVENT_PLAYER_UNIT_PAWN_ITEM\", 277];\n\n//===================================================\n// For use with TriggerRegisterUnitEvent\n//===================================================\n\nexport const /* unitevent */            EVENT_UNIT_SELL = [\"unitevent\", \"EVENT_UNIT_SELL\", 286];\nexport const /* unitevent */            EVENT_UNIT_CHANGE_OWNER = [\"unitevent\", \"EVENT_UNIT_CHANGE_OWNER\", 287];\nexport const /* unitevent */            EVENT_UNIT_SELL_ITEM = [\"unitevent\", \"EVENT_UNIT_SELL_ITEM\", 288];\nexport const /* unitevent */            EVENT_UNIT_SPELL_CHANNEL = [\"unitevent\", \"EVENT_UNIT_SPELL_CHANNEL\", 289];\nexport const /* unitevent */            EVENT_UNIT_SPELL_CAST = [\"unitevent\", \"EVENT_UNIT_SPELL_CAST\", 290];\nexport const /* unitevent */            EVENT_UNIT_SPELL_EFFECT = [\"unitevent\", \"EVENT_UNIT_SPELL_EFFECT\", 291];\nexport const /* unitevent */            EVENT_UNIT_SPELL_FINISH = [\"unitevent\", \"EVENT_UNIT_SPELL_FINISH\", 292];\nexport const /* unitevent */            EVENT_UNIT_SPELL_ENDCAST = [\"unitevent\", \"EVENT_UNIT_SPELL_ENDCAST\", 293];\nexport const /* unitevent */            EVENT_UNIT_PAWN_ITEM = [\"unitevent\", \"EVENT_UNIT_PAWN_ITEM\", 294];\n\n//===================================================\n// Limit Event API constants    \n// variable, player state, game state, and unit state events\n// ( do NOT change the order of these... )\n//===================================================\nexport const /* limitop */   LESS_THAN = [\"limitop\", \"LESS_THAN\", 0];\nexport const /* limitop */   LESS_THAN_OR_EQUAL = [\"limitop\", \"LESS_THAN_OR_EQUAL\", 1];\nexport const /* limitop */   EQUAL = [\"limitop\", \"EQUAL\", 2];\nexport const /* limitop */   GREATER_THAN_OR_EQUAL = [\"limitop\", \"GREATER_THAN_OR_EQUAL\", 3];\nexport const /* limitop */   GREATER_THAN = [\"limitop\", \"GREATER_THAN\", 4];\nexport const /* limitop */   NOT_EQUAL = [\"limitop\", \"NOT_EQUAL\", 5];\n\n//===================================================\n// Unit Type Constants for use with IsUnitType()\n//===================================================\n\nexport const /* unittype */   UNIT_TYPE_HERO = [\"unittype\", \"UNIT_TYPE_HERO\", 0];\nexport const /* unittype */   UNIT_TYPE_DEAD = [\"unittype\", \"UNIT_TYPE_DEAD\", 1];\nexport const /* unittype */   UNIT_TYPE_STRUCTURE = [\"unittype\", \"UNIT_TYPE_STRUCTURE\", 2];\n\nexport const /* unittype */   UNIT_TYPE_FLYING = [\"unittype\", \"UNIT_TYPE_FLYING\", 3];\nexport const /* unittype */   UNIT_TYPE_GROUND = [\"unittype\", \"UNIT_TYPE_GROUND\", 4];\n\nexport const /* unittype */   UNIT_TYPE_ATTACKS_FLYING = [\"unittype\", \"UNIT_TYPE_ATTACKS_FLYING\", 5];\nexport const /* unittype */   UNIT_TYPE_ATTACKS_GROUND = [\"unittype\", \"UNIT_TYPE_ATTACKS_GROUND\", 6];\n\nexport const /* unittype */   UNIT_TYPE_MELEE_ATTACKER = [\"unittype\", \"UNIT_TYPE_MELEE_ATTACKER\", 7];\nexport const /* unittype */   UNIT_TYPE_RANGED_ATTACKER = [\"unittype\", \"UNIT_TYPE_RANGED_ATTACKER\", 8];\n\nexport const /* unittype */   UNIT_TYPE_GIANT = [\"unittype\", \"UNIT_TYPE_GIANT\", 9];\nexport const /* unittype */   UNIT_TYPE_SUMMONED = [\"unittype\", \"UNIT_TYPE_SUMMONED\", 10];\nexport const /* unittype */   UNIT_TYPE_STUNNED = [\"unittype\", \"UNIT_TYPE_STUNNED\", 11];\nexport const /* unittype */   UNIT_TYPE_PLAGUED = [\"unittype\", \"UNIT_TYPE_PLAGUED\", 12];\nexport const /* unittype */   UNIT_TYPE_SNARED = [\"unittype\", \"UNIT_TYPE_SNARED\", 13];\n\nexport const /* unittype */   UNIT_TYPE_UNDEAD = [\"unittype\", \"UNIT_TYPE_UNDEAD\", 14];\nexport const /* unittype */   UNIT_TYPE_MECHANICAL = [\"unittype\", \"UNIT_TYPE_MECHANICAL\", 15];\nexport const /* unittype */   UNIT_TYPE_PEON = [\"unittype\", \"UNIT_TYPE_PEON\", 16];\nexport const /* unittype */   UNIT_TYPE_SAPPER = [\"unittype\", \"UNIT_TYPE_SAPPER\", 17];\nexport const /* unittype */   UNIT_TYPE_TOWNHALL = [\"unittype\", \"UNIT_TYPE_TOWNHALL\", 18];\nexport const /* unittype */   UNIT_TYPE_ANCIENT = [\"unittype\", \"UNIT_TYPE_ANCIENT\", 19];\n\nexport const /* unittype */   UNIT_TYPE_TAUREN = [\"unittype\", \"UNIT_TYPE_TAUREN\", 20];\nexport const /* unittype */   UNIT_TYPE_POISONED = [\"unittype\", \"UNIT_TYPE_POISONED\", 21];\nexport const /* unittype */   UNIT_TYPE_POLYMORPHED = [\"unittype\", \"UNIT_TYPE_POLYMORPHED\", 22];\nexport const /* unittype */   UNIT_TYPE_SLEEPING = [\"unittype\", \"UNIT_TYPE_SLEEPING\", 23];\nexport const /* unittype */   UNIT_TYPE_RESISTANT = [\"unittype\", \"UNIT_TYPE_RESISTANT\", 24];\nexport const /* unittype */   UNIT_TYPE_ETHEREAL = [\"unittype\", \"UNIT_TYPE_ETHEREAL\", 25];\nexport const /* unittype */   UNIT_TYPE_MAGIC_IMMUNE = [\"unittype\", \"UNIT_TYPE_MAGIC_IMMUNE\", 26];\n\n//===================================================\n// Unit Type Constants for use with ChooseRandomItemEx()\n//===================================================\n\nexport const /* itemtype */   ITEM_TYPE_PERMANENT = [\"itemtype\", \"ITEM_TYPE_PERMANENT\", 0];\nexport const /* itemtype */   ITEM_TYPE_CHARGED = [\"itemtype\", \"ITEM_TYPE_CHARGED\", 1];\nexport const /* itemtype */   ITEM_TYPE_POWERUP = [\"itemtype\", \"ITEM_TYPE_POWERUP\", 2];\nexport const /* itemtype */   ITEM_TYPE_ARTIFACT = [\"itemtype\", \"ITEM_TYPE_ARTIFACT\", 3];\nexport const /* itemtype */   ITEM_TYPE_PURCHASABLE = [\"itemtype\", \"ITEM_TYPE_PURCHASABLE\", 4];\nexport const /* itemtype */   ITEM_TYPE_CAMPAIGN = [\"itemtype\", \"ITEM_TYPE_CAMPAIGN\", 5];\nexport const /* itemtype */   ITEM_TYPE_MISCELLANEOUS = [\"itemtype\", \"ITEM_TYPE_MISCELLANEOUS\", 6];\nexport const /* itemtype */   ITEM_TYPE_UNKNOWN = [\"itemtype\", \"ITEM_TYPE_UNKNOWN\", 7];\nexport const /* itemtype */   ITEM_TYPE_ANY = [\"itemtype\", \"ITEM_TYPE_ANY\", 8];\n\n// Deprecated, should use ITEM_TYPE_POWERUP\nexport const /* itemtype */   ITEM_TYPE_TOME = [\"itemtype\", \"ITEM_TYPE_TOME\", 2];\n\n//===================================================\n// Animatable Camera Fields\n//===================================================\n\nexport const /* camerafield */   CAMERA_FIELD_TARGET_DISTANCE = [\"camerafield\", \"CAMERA_FIELD_TARGET_DISTANCE\", 0];\nexport const /* camerafield */   CAMERA_FIELD_FARZ = [\"camerafield\", \"CAMERA_FIELD_FARZ\", 1];\nexport const /* camerafield */   CAMERA_FIELD_ANGLE_OF_ATTACK = [\"camerafield\", \"CAMERA_FIELD_ANGLE_OF_ATTACK\", 2];\nexport const /* camerafield */   CAMERA_FIELD_FIELD_OF_VIEW = [\"camerafield\", \"CAMERA_FIELD_FIELD_OF_VIEW\", 3];\nexport const /* camerafield */   CAMERA_FIELD_ROLL = [\"camerafield\", \"CAMERA_FIELD_ROLL\", 4];\nexport const /* camerafield */   CAMERA_FIELD_ROTATION = [\"camerafield\", \"CAMERA_FIELD_ROTATION\", 5];\nexport const /* camerafield */   CAMERA_FIELD_ZOFFSET = [\"camerafield\", \"CAMERA_FIELD_ZOFFSET\", 6];\n\nexport const /* blendmode */     BLEND_MODE_NONE = [\"blendmode\", \"BLEND_MODE_NONE\", 0];\nexport const /* blendmode */     BLEND_MODE_DONT_CARE = [\"blendmode\", \"BLEND_MODE_DONT_CARE\", 0];\nexport const /* blendmode */     BLEND_MODE_KEYALPHA = [\"blendmode\", \"BLEND_MODE_KEYALPHA\", 1];\nexport const /* blendmode */     BLEND_MODE_BLEND = [\"blendmode\", \"BLEND_MODE_BLEND\", 2];\nexport const /* blendmode */     BLEND_MODE_ADDITIVE = [\"blendmode\", \"BLEND_MODE_ADDITIVE\", 3];\nexport const /* blendmode */     BLEND_MODE_MODULATE = [\"blendmode\", \"BLEND_MODE_MODULATE\", 4];\nexport const /* blendmode */     BLEND_MODE_MODULATE_2X = [\"blendmode\", \"BLEND_MODE_MODULATE_2X\", 5];\n\nexport const /* raritycontrol */    RARITY_FREQUENT = [\"raritycontrol\", \"RARITY_FREQUENT\", 0];\nexport const /* raritycontrol */    RARITY_RARE = [\"raritycontrol\", \"RARITY_RARE\", 1];\n\nexport const /* texmapflags */      TEXMAP_FLAG_NONE = [\"texmapflags\", \"TEXMAP_FLAG_NONE\", 0];\nexport const /* texmapflags */      TEXMAP_FLAG_WRAP_U = [\"texmapflags\", \"TEXMAP_FLAG_WRAP_U\", 1];\nexport const /* texmapflags */      TEXMAP_FLAG_WRAP_V = [\"texmapflags\", \"TEXMAP_FLAG_WRAP_V\", 2];\nexport const /* texmapflags */      TEXMAP_FLAG_WRAP_UV = [\"texmapflags\", \"TEXMAP_FLAG_WRAP_UV\", 3];\n\nexport const /* fogstate */         FOG_OF_WAR_MASKED = [\"fogstate\", \"FOG_OF_WAR_MASKED\", 1];\nexport const /* fogstate */         FOG_OF_WAR_FOGGED = [\"fogstate\", \"FOG_OF_WAR_FOGGED\", 2];\nexport const /* fogstate */         FOG_OF_WAR_VISIBLE = [\"fogstate\", \"FOG_OF_WAR_VISIBLE\", 4];\n\n//===================================================\n// Camera Margin constants for use with GetCameraMargin\n//===================================================\n\nexport const /*integer */       CAMERA_MARGIN_LEFT = [\"camera.margin\", \"CAMERA_MARGIN_LEFT\", 0];\nexport const /*integer */       CAMERA_MARGIN_RIGHT = [\"camera.margin\", \"CAMERA_MARGIN_RIGHT\", 1];\nexport const /*integer */       CAMERA_MARGIN_TOP = [\"camera.margin\", \"CAMERA_MARGIN_TOP\", 2];\nexport const /*integer */       CAMERA_MARGIN_BOTTOM =  [\"camera.margin\", \"CAMERA_MARGIN_BOTTOM\", 3];\n\n//===================================================\n// Effect API constants\n//===================================================\n\nexport const /* effecttype */       EFFECT_TYPE_EFFECT = [\"effecttype\", \"EFFECT_TYPE_EFFECT\", 0];\nexport const /* effecttype */       EFFECT_TYPE_TARGET = [\"effecttype\", \"EFFECT_TYPE_TARGET\", 1];\nexport const /* effecttype */       EFFECT_TYPE_CASTER = [\"effecttype\", \"EFFECT_TYPE_CASTER\", 2];\nexport const /* effecttype */       EFFECT_TYPE_SPECIAL = [\"effecttype\", \"EFFECT_TYPE_SPECIAL\", 3];\nexport const /* effecttype */       EFFECT_TYPE_AREA_EFFECT = [\"effecttype\", \"EFFECT_TYPE_AREA_EFFECT\", 4];\nexport const /* effecttype */       EFFECT_TYPE_MISSILE = [\"effecttype\", \"EFFECT_TYPE_MISSILE\", 5];\nexport const /* effecttype */       EFFECT_TYPE_LIGHTNING = [\"effecttype\", \"EFFECT_TYPE_LIGHTNING\", 6];\n\nexport const /* soundtype */        SOUND_TYPE_EFFECT = [\"soundtype\", \"SOUND_TYPE_EFFECT\", 0];\nexport const /* soundtype */        SOUND_TYPE_EFFECT_LOOPED = [\"soundtype\", \"SOUND_TYPE_EFFECT_LOOPED\", 1];\n\n///\n/// common.j\n///\n\nexport const gameTypes = [\n    \"playercolor\",\n    \"race\",\n    \"playergameresult\",\n    \"alliancetype\",\n    \"version\",\n    \"attacktype\",\n    \"damagetype\",\n    \"weapontype\",\n    \"pathingtype\",\n    \"racepreference\",\n    \"racepref\",\n    \"mapcontrol\",\n    \"gametype\",\n    \"mapflag\",\n    \"placement\",\n    \"startlocprio\",\n    \"mapdensity\",\n    \"gamedifficulty\",\n    \"gamespeed\",\n    \"playerslotstate\",\n    \"volumegroup\",\n    \"igamestate\",\n    \"fgamestate\",\n    \"playerstate\",\n    \"unitstate\",\n    \"aidifficulty\",\n    \"playerscore\",\n    \"gameevent\",\n    \"playerevent\",\n    \"playerunitevent\",\n    \"unitevent\",\n    \"widgetevent\",\n    \"dialogevent\",\n    \"limitop\",\n    \"unittype\",\n    \"itemtype\",\n    \"camerafield\",\n    \"blendmode\",\n    \"raritycontrol\",\n    \"texmapflags\",\n    \"fogstate\",\n    \"effecttype\",\n    \"soundtype\",\n    \"mousebuttontype\"\n];\n","class handler {\n    get(target, prop, receiver) {\n        // console.log('AccessProxiedMember', \"GET\", target.constructor.name, prop)\n        return Reflect.get(target, prop, receiver);\n    }\n    set(target, prop, value, receiver) {\n        if (target[prop] === undefined && this.allowSetProp) {\n            console.log('AccessProxiedMember', \"DEFINE\", target.constructor.name, prop)\n            Object.defineProperty(target, prop, {\n                value: value,\n                writable: true,\n                enumerable: true,\n            })\n        }\n        const success = Reflect.set(target, prop, value, receiver);\n        return success;\n    }\n};\nconst h = new handler();\nexport const createProxied = function (ctor) {\n    return new Proxy(new ctor(), h);\n};\nexport const asProxied = function (obj) {\n    return new Proxy(obj, h);\n};","/* eslint-disable */\nimport { PLAYER_NEUTRAL_PASSIVE, PLAYER_NEUTRAL_AGGRESSIVE, GAME_TYPE_MELEE, VERSION_FROZEN_THRONE, PLAYER_SLOT_STATE_EMPTY, GAME_TYPE_USE_MAP_SETTINGS, GAME_TYPE_ONE_ON_ONE } from \"./gameConstants\";\nimport { asProxied, createProxied } from \"./proxy\";\nexport class proxiable {\n    asProxied() {\n        return asProxied(this);\n    }\n}\n\nexport class ArrayList {\n    d = [];\n    constructor(n = 0, transform = (x) => x) {\n        this.d = new Array(n);\n        this.transform = transform;\n    }\n    fill(ctor) {\n        this.d.fill(this.transform(new ctor()));\n    }\n    getAt(index, factory) {\n        if (index instanceof Array) {\n            // enums: [enumType,enumName,enumInt]\n            let i = index[2];\n            if (this.d[i] == undefined) {\n                this.d[i] = this.transform(factory(i));\n            }\n            let item = this.d[i];\n            item[index[0]] = index[1];\n            return item;\n        }\n        else {\n            if (this.d[index] == undefined) {\n                this.d[index] = this.transform(factory(index));\n            }\n            return this.d[index];\n        }\n    }\n    get(index) {\n        if (index instanceof Array) {\n            // enums: [enumType,enumName,enumInt]\n            let i = index[2];\n            let item = this.d[i];\n            item[index[0]] = index[1];\n            return item;\n        }\n        else\n            return this.d[index];\n    }\n    put(index, v) {\n        this.d[index] = this.transform(v);\n        return v;\n    }\n    remove(item) {\n        let index = this.d.indexOf(item);\n        if (index != -1)\n            this.d.splice(index, 1);\n        else\n            console.log('E:removing none exist item', item);\n    }\n    add(item) {\n        this.d.push(this.transform(item));\n    }\n    contains(item) {\n        return this.d.includes(item);\n    }\n    has(item) {\n        return this.d.includes(item);\n    }\n    set(index, item) {\n        this.d[index] = this.transform(item);\n    }\n    clear() {\n        this.d.length = 0;\n    }\n    forEach(fn) {\n        this.d.forEach((x, i) => fn(x, i, this.d));\n    }\n    filter(fn) {\n        return this.d.filter((x, i) => fn(x, i, this.d));\n    }\n    replace(d = []) {\n        this.d = this.transform(d);\n    }\n    any(fn) {\n        for (let i = 0; i < this.d.length; i++) {\n            const element = this.d[i];\n            if (fn(element, i, this.d)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    size() {\n        return this.d.length;\n    }\n}\nclass timer {\n    handle = 0;\n    periodic = false;\n    timeout = -1;\n    handlerFunc;\n    timerExpire = false;\n    triggers = new ArrayList();\n    callT = 0;\n    beginT = 0;\n    resumeDelay = 0;\n    start(timeoutSeconds, periodic, handlerFunc) {\n        if (this.handle && this.periodic)\n            throw new Error('Timer already started');\n        this.callT = performance.now();\n        this.beginT = performance.now();\n        this.periodic = periodic;\n        this.timeout = timeoutSeconds * 1000;\n        this.handlerFunc = handlerFunc;\n        console.log('timer start:', this);\n        this.handle = setTimeout(() => this.handler(), this.timeout);\n    }\n    async handler() {\n        this.callT = performance.now();\n        if (this.handlerFunc) {\n            console.log('timer callback:', this.handlerFunc);\n            let p = this.handlerFunc?.call(null);\n            if (p instanceof Promise) {\n                await p;\n            }\n        }\n        this.triggers.forEach(x => x.execute());\n        if (this.periodic) {\n            this.handle = setTimeout(() => this.handler(), this.timeout);\n        }\n    }\n    listenExpire(trigger) {\n        this.triggers.add(trigger);\n    }\n    destroy() {\n        console.log('timer destroy:', this);\n        if (this.periodic) {\n            clearInterval(this.handle);\n        }\n        else\n            clearTimeout(this.handle);\n        this.handle = 0;\n    }\n    getElapsed() {\n        return performance.now() - this.callT;\n    }\n    pause() {\n        clearTimeout(this.handle);\n        this.handle = 0;\n        let elapsed = performance.now() - this.callT;\n        let remaining = this.timeout - elapsed;\n        this.resumeDelay = remaining;\n    }\n    resume() {\n        this.handle = setTimeout(this.handler, this.resumeDelay);\n    }\n}\nconst timers = new ArrayList();\nconst timerListen = (timeout, periodic, trigger) => {\n    let t = new timer(timeout, periodic, trigger.execute);\n    timers.add(t);\n    return t;\n}\nclass gameState {\n\n}\n// class jassHandle {\n//     stateRef;\n//     constructor(gameState) {\n//         this.stateRef = gameState;\n//     }\n// }\nclass group {\n\n}\nclass unit {\n\n}\nclass team { }\nclass startLocation {\n\n}\nclass force {\n    players = new ArrayList();\n}\nclass timerExpireEvent {\n    timer;\n    constructor(timer) {\n        this.timer = timer;\n    }\n    evaluate(stateRef) {\n        return this.timer.timerExpire;\n    }\n}\nlet logcall = (fn) => {\n\n}\nclass trigger {\n    gameStateEvents = new ArrayList();\n    gameEvents = new ArrayList();\n    unitEvents = new ArrayList();\n    playerUnitEvents = new ArrayList();\n    timerExpireEvents = new ArrayList();\n    VariableEvents = new ArrayList();\n    actions = new ArrayList();\n    evaluate(stateRef) {\n        if (0 == this.gameStateEvents.size()\n            + this.unitEvents.size()\n            + this.playerUnitEvents.size()\n            + this.timerExpireEvents.size()\n            + this.gameEvents.size()\n        ) {\n            return true;\n        }\n        return this.gameStateEvents.any(x => x.evaluate(stateRef))\n            || this.unitEvents.any(x => x.evaluate(stateRef))\n            || this.playerUnitEvents.any(x => x.evaluate(stateRef))\n            || this.playerUnitEvents.any(x => x.evaluate(stateRef));\n    }\n    execute() {\n        console.log('trigger execute actions', this.actions)\n        this.actions.forEach(x => x());\n    }\n}\nclass player {\n    constructor(i = -1) {\n        this.index = i;\n    }\n    index = -1;\n    startLoc\n    color = -1;\n    racePerf;\n    raceSelectable;\n    contoller;\n    slotState = PLAYER_SLOT_STATE_EMPTY\n    TechResearched = new ArrayList();\n    TechMaxAllowed = new Map();\n    AlliancePlayers = new ArrayList();\n    Structures = new ArrayList();\n    TypedUnits = new ArrayList();\n    Units = new ArrayList();\n}\n\n\nclass unitEvent {\n    whichTrigger;\n    whichUnit\n    whichUnitEvent\n    constructor(whichTrigger, whichUnit, whichUnitEvent) {\n        this.whichUnit = whichUnit;\n        this.whichUnitEvent = whichUnitEvent;\n        this.whichTrigger = whichTrigger;\n    }\n    evaluate(state) {\n        debugger;\n        return false;\n    }\n}\nclass playerUnitEvent {\n    whichTrigger;\n    whichPlayer;\n    whichPlayerUnitEvent;\n    filter\n    constructor(whichTrigger, whichPlayer, whichPlayerUnitEvent, filter) {\n        this.whichPlayer = whichPlayer;\n        this.whichPlayerUnitEvent = whichPlayerUnitEvent;\n        this.filter = filter;\n        this.whichTrigger = whichTrigger;\n    }\n    evaluate(state) {\n        debugger;\n        return false;\n    }\n}\nclass eventFilter {\n    whichState;\n    opcode;\n    limitval;\n    constructor(whichState, opcode, limitval) {\n        this.whichState = whichState;\n        this.opcode = opcode;\n        this.limitval = limitval;\n    }\n    evaluate(state) {\n        debugger;\n        // 这里是一个简单的示例，假设我们比较游戏状态中的currentValue和limitval  \n        let opcode = 'x';\n        let whichState = 'y';\n        switch (opcode) {\n            case 'EQ':\n                return state[whichState] === this.limitval;\n            // case limitop.GT:  \n            //     return state.currentValue > this.limitval;  \n            // case limitop.LT:  \n            //     return state.currentValue < this.limitval;  \n            // // ... 处理其他操作符  \n            default:\n                return false; // 或者抛出一个错误，取决于你的设计  \n        }\n    }\n}\nconst proxiedList = {}\nclass propWatcher {\n    constructor(target) {\n        this.watchTarget = target;\n    }\n    listeners = new ArrayList();\n    set(target, prop, value, reciver) {\n        if (target[prop] && target[prop] != value) {\n            Reflect.set(target, prop, value, reciver);\n            let relatedListeners = this.listeners.filter(x => x.whichPropName == prop);\n            relatedListeners.forEach(x => x.filter({ prop, value }) && x.execute());\n        }\n        return true;\n    }\n    get(target, prop, receiver) {\n        if (prop == 'eventListeners') {\n            return this.listeners;\n        }\n        return Reflect.get(target, prop, receiver);\n    }\n}\n\nconst asEventAgent = (obj) => {\n    return new Proxy(obj, new propWatcher(obj));\n}\n\nconst listenEvent = (whichListenTarget, whichPropName, trigger, filter) => {\n    if (!whichListenTarget || !whichListenTarget.eventListeners) {\n        debugger;\n        console.error(\"invalid listenTarget\", whichListenTarget);\n    }\n    whichListenTarget.eventListeners.add({\n        filter: filter || (() => true),\n        execute: trigger.execute,\n        whichPropName\n    })\n}\nexport class jassNativeFunctions {\n    app;\n    players = new ArrayList(24, asEventAgent);\n    startLocations = new ArrayList(24);\n    gameState = asEventAgent({\n        compute(key, v) {\n            if (this[key] === undefined) {\n                this[key] = v\n            }\n            return this[key];\n        },\n        set(k, v) {\n            return this[k] = v;\n        },\n        getNumber(k) {\n            return this[k] || 0;\n        }\n    });\n    logCalls = new ArrayList()\n    triggerDatariggerData;\n    constructor(app) {\n        this.app = app;\n        this.triggerData = app.triggerData;\n        this.gameState[\"startLocations\"] = new ArrayList(10);\n        logcall = (fn) => {\n            this.logCalls.add(fn.name);\n        };\n        this.gameUI = {\n            frameDefs: new ArrayList(),\n            loadedFdfs: new ArrayList()\n        };\n    }\n\n    /* native_decl */\n    // OrderId(orderIdString:string){\n    //   console.log(\"[------decl-only------]\",\"OrderId\",arguments)\n    // }\n    /* native_decl */\n    // OrderId2String(orderId:number){\n    //   console.log(\"[------decl-only------]\",\"OrderId2String\",arguments)\n    // }\n    /* native_decl */\n    // UnitId(unitIdString:string){\n    //   console.log(\"[------decl-only------]\",\"UnitId\",arguments)\n    // }\n    /* native_decl */\n    // UnitId2String(unitId:number){\n    //   console.log(\"[------decl-only------]\",\"UnitId2String\",arguments)\n    // }\n    /* native_decl */\n    // AbilityId(abilityIdString:string){\n    //   console.log(\"[------decl-only------]\",\"AbilityId\",arguments)\n    // }\n    /* native_decl */\n    // AbilityId2String(abilityId:number){\n    //   console.log(\"[------decl-only------]\",\"AbilityId2String\",arguments)\n    // }\n    /* native_decl */\n    // GetObjectName(objectId:number){\n    //   console.log(\"[------decl-only------]\",\"GetObjectName\",arguments)\n    // }\n    /* native_decl */\n    // GetBJMaxPlayers(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetBJMaxPlayers\",arguments)\n    // }\n    /* native_decl */\n    // GetBJPlayerNeutralVictim(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetBJPlayerNeutralVictim\",arguments)\n    // }\n    /* native_decl */\n    // GetBJPlayerNeutralExtra(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetBJPlayerNeutralExtra\",arguments)\n    // }\n    /* native_decl */\n    // GetBJMaxPlayerSlots(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetBJMaxPlayerSlots\",arguments)\n    // }\n    /* native_decl */\n    // GetPlayerNeutralPassive(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetPlayerNeutralPassive\",arguments)\n    // }\n    /* native_decl */\n    // GetPlayerNeutralAggressive(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetPlayerNeutralAggressive\",arguments)\n    // }\n    /* native_decl */\n    // Deg2Rad(degrees:number){\n    //   console.log(\"[------decl-only------]\",\"Deg2Rad\",arguments)\n    // }\n    /* native_decl */\n    // Rad2Deg(radians:number){\n    //   console.log(\"[------decl-only------]\",\"Rad2Deg\",arguments)\n    // }\n    /* native_decl */\n    // Sin(radians:number){\n    //   console.log(\"[------decl-only------]\",\"Sin\",arguments)\n    // }\n    /* native_decl */\n    // Cos(radians:number){\n    //   console.log(\"[------decl-only------]\",\"Cos\",arguments)\n    // }\n    /* native_decl */\n    // Tan(radians:number){\n    //   console.log(\"[------decl-only------]\",\"Tan\",arguments)\n    // }\n    /* native_decl */\n    // Asin(y:number){\n    //   console.log(\"[------decl-only------]\",\"Asin\",arguments)\n    // }\n    /* native_decl */\n    // Acos(x:number){\n    //   console.log(\"[------decl-only------]\",\"Acos\",arguments)\n    // }\n    /* native_decl */\n    // Atan(x:number){\n    //   console.log(\"[------decl-only------]\",\"Atan\",arguments)\n    // }\n    /* native_decl */\n    // Atan2(y:number, x:number){\n    //   console.log(\"[------decl-only------]\",\"Atan2\",arguments)\n    // }\n    /* native_decl */\n    // SquareRoot(x:number){\n    //   console.log(\"[------decl-only------]\",\"SquareRoot\",arguments)\n    // }\n    /* native_decl */\n    // Pow(x:number, power:number){\n    //   console.log(\"[------decl-only------]\",\"Pow\",arguments)\n    // }\n    /* native_decl */\n    // I2R(i:number){\n    //   console.log(\"[------decl-only------]\",\"I2R\",arguments)\n    // }\n    /* native_decl */\n    // R2I(r:number){\n    //   console.log(\"[------decl-only------]\",\"R2I\",arguments)\n    // }\n    /* native_decl */\n    // I2S(i:number){\n    //   console.log(\"[------decl-only------]\",\"I2S\",arguments)\n    // }\n    /* native_decl */\n    // R2S(r:number){\n    //   console.log(\"[------decl-only------]\",\"R2S\",arguments)\n    // }\n    /* native_decl */\n    // R2SW(r:number, width:number, precision:number){\n    //   console.log(\"[------decl-only------]\",\"R2SW\",arguments)\n    // }\n    /* native_decl */\n    // S2I(s:string){\n    //   console.log(\"[------decl-only------]\",\"S2I\",arguments)\n    // }\n    /* native_decl */\n    // S2R(s:string){\n    //   console.log(\"[------decl-only------]\",\"S2R\",arguments)\n    // }\n    /* native_decl */\n    // GetHandleId(h:handle){\n    //   console.log(\"[------decl-only------]\",\"GetHandleId\",arguments)\n    // }\n    /* native_decl */\n    // SubString(source:string, start:number, end:number){\n    //   console.log(\"[------decl-only------]\",\"SubString\",arguments)\n    // }\n    /* native_decl */\n    // StringLength(s:string){\n    //   console.log(\"[------decl-only------]\",\"StringLength\",arguments)\n    // }\n    /* native_decl */\n    // StringCase(source:string, upper:boolean){\n    //   console.log(\"[------decl-only------]\",\"StringCase\",arguments)\n    // }\n    /* native_decl */\n    // StringHash(s:string){\n    //   console.log(\"[------decl-only------]\",\"StringHash\",arguments)\n    // }\n    /* native_decl */\n    // GetLocalizedString(source:string){\n    //   console.log(\"[------decl-only------]\",\"GetLocalizedString\",arguments)\n    // }\n    /* native_decl */\n    // GetLocalizedHotkey(source:string){\n    //   console.log(\"[------decl-only------]\",\"GetLocalizedHotkey\",arguments)\n    // }\n    /* native_decl */\n    // SetMapName(name:string){\n    //   console.log(\"[------decl-only------]\",\"SetMapName\",arguments)\n    // }\n    /* native_decl */\n    // SetMapDescription(description:string){\n    //   console.log(\"[------decl-only------]\",\"SetMapDescription\",arguments)\n    // }\n    /* native_decl */\n    // SetTeams(teamcount:number){\n    //   console.log(\"[------decl-only------]\",\"SetTeams\",arguments)\n    // }\n    /* native_decl */\n    // SetPlayers(playercount:number){\n    //   console.log(\"[------decl-only------]\",\"SetPlayers\",arguments)\n    // }\n    /* native_decl */\n    DefineStartLocation(whichStartLoc, x, y) {\n        whichStartLoc.startLoc = [x, y];\n    }\n    /* native_decl */\n    DefineStartLocationLoc(whichStartLoc, whichLocation) {\n        whichStartLoc.startLoc = whichLocation;\n    }\n    /* native_decl */\n    SetStartLocPrioCount(whichStartLoc, prioSlotCount) {\n        return this.startLocations.get(whichStartLoc).priority = new Array(prioSlotCount);\n    }\n    /* native_decl */\n    SetStartLocPrio(whichStartLoc, prioSlotIndex, otherStartLocIndex, priority) {\n        this.startLocations.get(whichStartLoc).priority[prioSlotIndex] = {\n            otherStartLocIndex,\n            priority\n        }\n    }\n    /* native_decl */\n    GetStartLocPrioSlot(whichStartLoc, prioSlotIndex) {\n        return this.startLocations.get(whichStartLoc).priority[prioSlotIndex]\n    }\n    /* native_decl */\n    GetStartLocPrio(whichStartLoc, prioSlotIndex) {\n        return whichStartLoc.priority[prioSlotIndex];\n    }\n    /* native_decl */\n    SetGameTypeSupported(whichGameType, value) {\n        this.GameTypeSupported[whichGameType[1]] = value;\n    }\n    GameTypeSupported = {};\n    /* native_decl */\n    SetMapFlag(whichMapFlag, value) {\n        console.log(\"[------decl-only------]\", \"SetMapFlag\", arguments)\n    }\n    /* native_decl */\n    SetGamePlacement(whichPlacementType) {\n        this.GamePlacement = whichPlacementType;\n    }\n    /* native_decl */\n    SetGameSpeed(whichspeed) {\n        this.GameSpeed = whichspeed;\n    }\n    /* native_decl */\n    SetGameDifficulty(whichdifficulty) {\n        this.GameDifficulty = whichdifficulty;\n    }\n    /* native_decl */\n    // SetResourceDensity(whichdensity:mapdensity){\n    //   console.log(\"[------decl-only------]\",\"SetResourceDensity\",arguments)\n    // }\n    /* native_decl */\n    // SetCreatureDensity(whichdensity:mapdensity){\n    //   console.log(\"[------decl-only------]\",\"SetCreatureDensity\",arguments)\n    // }\n    /* native_decl */\n    GetTeams(/*void*/) {\n        console.log(\"[------decl-only------]\", \"GetTeams\", arguments)\n    }\n    /* native_decl */\n    GetPlayers(/*void*/) {\n        console.log(\"[------decl-only------]\", \"GetPlayers\", arguments)\n    }\n    /* native_decl */\n    IsGameTypeSupported(whichGameType) {\n        console.log(\"[------decl-only------]\", \"IsGameTypeSupported\", arguments)\n    }\n    /* native_decl */\n    GetGameTypeSelected(/*void*/) {\n        return this.GameTypeSelected;\n    }\n    GameTypeSelected = GAME_TYPE_ONE_ON_ONE;\n    /* native_decl */\n    IsMapFlagSet(whichMapFlag) {\n        console.log(\"[------decl-only------]\", \"IsMapFlagSet\", arguments)\n    }\n    /* native_decl */\n    GetGamePlacement(/*void*/) {\n        return this.GamePlacement;\n    }\n    GamePlacement = 0;\n    /* native_decl */\n    GetGameSpeed(/*void*/) {\n        return this.GameSpeed;\n    }\n    GameSpeed = 0;\n    /* native_decl */\n    GetGameDifficulty(/*void*/) {\n        return this.GameDifficulty;\n    }\n    GameDifficulty = 0;\n    /* native_decl */\n    GetResourceDensity(/*void*/) {\n        return this.ResourceDensity;\n    }\n    ResourceDensity = 0;\n    /* native_decl */\n    GetCreatureDensity(/*void*/) {\n        return this.CreatureDensity;\n    }\n    CreatureDensity = 0;\n    /* native_decl */\n    GetStartLocationX(whichStartLocation) {\n        return this.startLocations.get(whichStartLocation)[0];\n    }\n    /* native_decl */\n    GetStartLocationY(whichStartLocation) {\n        return this.startLocations.get(whichStartLocation)[1];\n    }\n    /* native_decl */\n    GetStartLocationLoc(whichStartLocation) {\n        return this.startLocations.get(whichStartLocation);\n    }\n    /* native_decl */\n    SetPlayerTeam(whichPlayer, whichTeam) {\n        whichPlayer.team = whichPlayer;\n    }\n    /* native_decl */\n    SetPlayerStartLocation(whichPlayer, startLocIndex) {\n        let location = this.startLocations.get(startLocIndex);\n        whichPlayer.startLoc = location;\n    }\n    /* native_decl */\n    ForcePlayerStartLocation(whichPlayer, startLocIndex) {\n        // todo: same as SetPlayerStartLocation?\n        let location = this.startLocations.get(startLocIndex);\n        whichPlayer.startLoc = location;\n    }\n    /* native_decl */\n    SetPlayerColor(whichPlayer, color) {\n        whichPlayer.color = color;\n    }\n    /* native_decl */\n    SetPlayerAlliance(sourcePlayer, otherPlayer, whichAllianceSetting, value) {\n        let setting = sourcePlayer[whichAllianceSetting[1]] || (sourcePlayer[whichAllianceSetting[1]] = []);\n        setting[otherPlayer.index] = value;\n    }\n    /* native_decl */\n    SetPlayerTaxRate(sourcePlayer, otherPlayer, whichResource, rate) {\n        console.log(\"[------decl-only------]\", \"SetPlayerTaxRate\", arguments)\n    }\n    /* native_decl */\n    // SetPlayerRacePreference(whichPlayer:player, whichRacePreference:racepreference){\n    //   console.log(\"[------decl-only------]\",\"SetPlayerRacePreference\",arguments)\n    // }\n    /* native_decl */\n    // SetPlayerRaceSelectable(whichPlayer:player, value:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetPlayerRaceSelectable\",arguments)\n    // }\n    /* native_decl */\n    SetPlayerController(whichPlayer, controlType) {\n        whichPlayer.contoller = controlType;\n    }\n    /* native_decl */\n    SetPlayerName(whichPlayer, name) {\n        whichPlayer.name = name;\n    }\n    /* native_decl */\n    // SetPlayerOnScoreScreen(whichPlayer:player, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetPlayerOnScoreScreen\",arguments)\n    // }\n    /* native_decl */\n    GetPlayerTeam(whichPlayer) {\n        return whichPlayer.team;\n    }\n    /* native_decl */\n    GetPlayerStartLocation(whichPlayer) {\n        return whichPlayer.startLoc;\n    }\n    /* native_decl */\n    GetPlayerColor(whichPlayer) {\n        return whichPlayer.color;\n    }\n    /* native_decl */\n    GetPlayerSelectable(whichPlayer) {\n        return whichPlayer.Selectable || false;\n    }\n    /* native_decl */\n    GetPlayerController(whichPlayer) {\n        return whichPlayer.contoller;\n    }\n    /* native_decl */\n    GetPlayerSlotState(whichPlayer) {\n        return whichPlayer.slotState;\n    }\n    /* native_decl */\n    // GetPlayerTaxRate(sourcePlayer:player, otherPlayer:player, whichResource:playerstate){\n    //   console.log(\"[------decl-only------]\",\"GetPlayerTaxRate\",arguments)\n    // }\n    /* native_decl */\n    // IsPlayerRacePrefSet(whichPlayer:player, pref:racepreference){\n    //   console.log(\"[------decl-only------]\",\"IsPlayerRacePrefSet\",arguments)\n    // }\n    /* native_decl */\n    // GetPlayerName(whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"GetPlayerName\",arguments)\n    // }\n    /* native_decl */\n    // CreateTimer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateTimer\",arguments)\n    // }\n    /* native_decl */\n    DestroyTimer(whichTimer) {\n        whichTimer.destroy();\n    }\n    /* native_decl */\n    TimerStart(whichTimer, timeout, periodic, handlerFunc) {\n        whichTimer.start(timeout, periodic, handlerFunc);\n    }\n    /* native_decl */\n    TimerGetElapsed(whichTimer) {\n        return whichTimer.getElapsed();\n    }\n    /* native_decl */\n    // TimerGetRemaining(whichTimer:timer){\n    //   console.log(\"[------decl-only------]\",\"TimerGetRemaining\",arguments)\n    // }\n    /* native_decl */\n    TimerGetTimeout(whichTimer) {\n        return whichTimer.timeout;\n    }\n    /* native_decl */\n    PauseTimer(whichTimer) {\n        whichTimer.pause();\n    }\n    /* native_decl */\n    ResumeTimer(whichTimer) {\n        whichTimer.resume();\n    }\n    /* native_decl */\n    // GetExpiredTimer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetExpiredTimer\",arguments)\n    // }\n    /* native_decl */\n    // CreateGroup(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateGroup\",arguments)\n    // }\n    /* native_decl */\n    // DestroyGroup(whichGroup:group){\n    //   console.log(\"[------decl-only------]\",\"DestroyGroup\",arguments)\n    // }\n    /* native_decl */\n    // GroupAddUnit(whichGroup:group, whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GroupAddUnit\",arguments)\n    // }\n    /* native_decl */\n    // GroupRemoveUnit(whichGroup:group, whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GroupRemoveUnit\",arguments)\n    // }\n    /* native_decl */\n    // GroupClear(whichGroup:group){\n    //   console.log(\"[------decl-only------]\",\"GroupClear\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsOfType(whichGroup:group, unitname:string, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsOfType\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsOfPlayer(whichGroup:group, whichPlayer:player, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsOfPlayer\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsOfTypeCounted(whichGroup:group, unitname:string, filter:boolexpr, countLimit:number){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsOfTypeCounted\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsInRect(whichGroup:group, r:rect, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsInRect\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsInRectCounted(whichGroup:group, r:rect, filter:boolexpr, countLimit:number){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsInRectCounted\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsInRange(whichGroup:group, x:number, y:number, radius:number, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsInRange\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsInRangeOfLoc(whichGroup:group, whichLocation:location, radius:number, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsInRangeOfLoc\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsInRangeCounted(whichGroup:group, x:number, y:number, radius:number, filter:boolexpr, countLimit:number){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsInRangeCounted\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsInRangeOfLocCounted(whichGroup:group, whichLocation:location, radius:number, filter:boolexpr, countLimit:number){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsInRangeOfLocCounted\",arguments)\n    // }\n    /* native_decl */\n    // GroupEnumUnitsSelected(whichGroup:group, whichPlayer:player, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"GroupEnumUnitsSelected\",arguments)\n    // }\n    /* native_decl */\n    // GroupImmediateOrder(whichGroup:group, order:string){\n    //   console.log(\"[------decl-only------]\",\"GroupImmediateOrder\",arguments)\n    // }\n    /* native_decl */\n    // GroupImmediateOrderById(whichGroup:group, order:number){\n    //   console.log(\"[------decl-only------]\",\"GroupImmediateOrderById\",arguments)\n    // }\n    /* native_decl */\n    // GroupPointOrder(whichGroup:group, order:string, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"GroupPointOrder\",arguments)\n    // }\n    /* native_decl */\n    // GroupPointOrderLoc(whichGroup:group, order:string, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"GroupPointOrderLoc\",arguments)\n    // }\n    /* native_decl */\n    // GroupPointOrderById(whichGroup:group, order:number, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"GroupPointOrderById\",arguments)\n    // }\n    /* native_decl */\n    // GroupPointOrderByIdLoc(whichGroup:group, order:number, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"GroupPointOrderByIdLoc\",arguments)\n    // }\n    /* native_decl */\n    // GroupTargetOrder(whichGroup:group, order:string, targetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"GroupTargetOrder\",arguments)\n    // }\n    /* native_decl */\n    // GroupTargetOrderById(whichGroup:group, order:number, targetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"GroupTargetOrderById\",arguments)\n    // }\n    /* native_decl */\n    // ForGroup(whichGroup:group, callback:code){\n    //   console.log(\"[------decl-only------]\",\"ForGroup\",arguments)\n    // }\n    /* native_decl */\n    // FirstOfGroup(whichGroup:group){\n    //   console.log(\"[------decl-only------]\",\"FirstOfGroup\",arguments)\n    // }\n    /* native_decl */\n    CreateForce(/*void*/) {\n        return createProxied(force);\n    }\n    /* native_decl */\n    DestroyForce(whichForce) {\n        // do nothing here, \n        // will disposed by js engine if no any reference\n    }\n    /* native_decl */\n    ForceAddPlayer(whichForce, whichPlayer) {\n        whichForce.players.add(whichPlayer)\n    }\n    /* native_decl */\n    ForceRemovePlayer(whichForce, whichPlayer) {\n        whichForce.players.remove(whichPlayer);\n    }\n    /* native_decl */\n    ForceClear(whichForce) {\n        whichForce.players.clear();\n    }\n    /* native_decl */\n    // 填充玩家到force\n    ForceEnumPlayers(whichForce, filter) {\n        if (filter == null) {\n            whichForce.players.replace(this.players.d);\n        }\n        else {\n            whichForce.players.replace(this.players.filter(x => filter.func()));\n        }\n    }\n    /* native_decl */\n    ForceEnumPlayersCounted(whichForce, filter, countLimit) {\n        debugger;\n        //todo 好像需要用到iterator\n        let players = this.players.filter(filter.func);\n        if (players.length > countLimit) {\n            players.length = countLimit;\n        }\n        whichForce.players.replace(players);\n    }\n    /* native_decl */\n    ForceEnumAllies(whichForce, whichPlayer, filter) {\n        debugger;\n        let allies = [];\n        let players = whichPlayer.AlliancePlayers.filter(x => filter.func())\n        whichForce.AlliancePlayers.replace(players);\n    }\n    /* native_decl */\n    ForceEnumEnemies(whichForce, whichPlayer, filter) {\n        debugger;\n    }\n    /* native_decl */\n    ForForce(whichForce, callback) {\n        whichForce.players.forEach(x => callback(x));\n    }\n    /* native_decl */\n    Rect(minx, miny, maxx, maxy) {\n        return {\n            minx,\n            miny,\n            maxx,\n            maxy\n        }\n    }\n    /* native_decl */\n    // RectFromLoc(min:location, max:location){\n    //   console.log(\"[------decl-only------]\",\"RectFromLoc\",arguments)\n    // }\n    /* native_decl */\n    // RemoveRect(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"RemoveRect\",arguments)\n    // }\n    /* native_decl */\n    // SetRect(whichRect:rect, minx:number, miny:number, maxx:number, maxy:number){\n    //   console.log(\"[------decl-only------]\",\"SetRect\",arguments)\n    // }\n    /* native_decl */\n    // SetRectFromLoc(whichRect:rect, min:location, max:location){\n    //   console.log(\"[------decl-only------]\",\"SetRectFromLoc\",arguments)\n    // }\n    /* native_decl */\n    // MoveRectTo(whichRect:rect, newCenterX:number, newCenterY:number){\n    //   console.log(\"[------decl-only------]\",\"MoveRectTo\",arguments)\n    // }\n    /* native_decl */\n    // MoveRectToLoc(whichRect:rect, newCenterLoc:location){\n    //   console.log(\"[------decl-only------]\",\"MoveRectToLoc\",arguments)\n    // }\n    /* native_decl */\n    // GetRectCenterX(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"GetRectCenterX\",arguments)\n    // }\n    /* native_decl */\n    // GetRectCenterY(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"GetRectCenterY\",arguments)\n    // }\n    /* native_decl */\n    // GetRectMinX(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"GetRectMinX\",arguments)\n    // }\n    /* native_decl */\n    // GetRectMinY(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"GetRectMinY\",arguments)\n    // }\n    /* native_decl */\n    // GetRectMaxX(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"GetRectMaxX\",arguments)\n    // }\n    /* native_decl */\n    // GetRectMaxY(whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"GetRectMaxY\",arguments)\n    // }\n    /* native_decl */\n    // CreateRegion(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateRegion\",arguments)\n    // }\n    /* native_decl */\n    // RemoveRegion(whichRegion:region){\n    //   console.log(\"[------decl-only------]\",\"RemoveRegion\",arguments)\n    // }\n    /* native_decl */\n    // RegionAddRect(whichRegion:region, r:rect){\n    //   console.log(\"[------decl-only------]\",\"RegionAddRect\",arguments)\n    // }\n    /* native_decl */\n    // RegionClearRect(whichRegion:region, r:rect){\n    //   console.log(\"[------decl-only------]\",\"RegionClearRect\",arguments)\n    // }\n    /* native_decl */\n    // RegionAddCell(whichRegion:region, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"RegionAddCell\",arguments)\n    // }\n    /* native_decl */\n    // RegionAddCellAtLoc(whichRegion:region, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"RegionAddCellAtLoc\",arguments)\n    // }\n    /* native_decl */\n    // RegionClearCell(whichRegion:region, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"RegionClearCell\",arguments)\n    // }\n    /* native_decl */\n    // RegionClearCellAtLoc(whichRegion:region, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"RegionClearCellAtLoc\",arguments)\n    // }\n    /* native_decl */\n    // Location(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"Location\",arguments)\n    // }\n    /* native_decl */\n    // RemoveLocation(whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"RemoveLocation\",arguments)\n    // }\n    /* native_decl */\n    // MoveLocation(whichLocation:location, newX:number, newY:number){\n    //   console.log(\"[------decl-only------]\",\"MoveLocation\",arguments)\n    // }\n    /* native_decl */\n    // GetLocationX(whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"GetLocationX\",arguments)\n    // }\n    /* native_decl */\n    // GetLocationY(whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"GetLocationY\",arguments)\n    // }\n    /* native_decl */\n    // GetLocationZ(whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"GetLocationZ\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInRegion(whichRegion:region, whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInRegion\",arguments)\n    // }\n    /* native_decl */\n    // IsPointInRegion(whichRegion:region, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IsPointInRegion\",arguments)\n    // }\n    /* native_decl */\n    // IsLocationInRegion(whichRegion:region, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"IsLocationInRegion\",arguments)\n    // }\n    /* native_decl */\n    // GetWorldBounds(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetWorldBounds\",arguments)\n    // }\n    /* native_decl */\n    CreateTrigger(/*void*/) {\n        return new trigger();\n    }\n    /* native_decl */\n    DestroyTrigger(whichTrigger) {\n        whichTrigger.distroy();\n    }\n    /* native_decl */\n    ResetTrigger(whichTrigger) {\n        whichTrigger.reset();\n    }\n    /* native_decl */\n    EnableTrigger(whichTrigger) {\n        whichTrigger.enabled = true;\n    }\n    /* native_decl */\n    DisableTrigger(whichTrigger) {\n        whichTrigger.enabled = false;\n    }\n    /* native_decl */\n    IsTriggerEnabled(whichTrigger) {\n        return whichTrigger.enabled;\n    }\n    /* native_decl */\n    // TriggerWaitOnSleeps(whichTrigger:trigger, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"TriggerWaitOnSleeps\",arguments)\n    // }\n    /* native_decl */\n    // IsTriggerWaitOnSleeps(whichTrigger:trigger){\n    //   console.log(\"[------decl-only------]\",\"IsTriggerWaitOnSleeps\",arguments)\n    // }\n    /* native_decl */\n    GetFilterUnit(/*void*/) {\n        return this.FilterUnitIterator.current;\n    }\n    /* native_decl */\n    GetEnumUnit(/*void*/) {\n        return this.EnumUnitIterator.current;\n    }\n    /* native_decl */\n    // GetFilterDestructable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetFilterDestructable\",arguments)\n    // }\n    /* native_decl */\n    // GetEnumDestructable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEnumDestructable\",arguments)\n    // }\n    /* native_decl */\n    GetFilterItem(/*void*/) {\n        return this.FilterItemIterator.current;\n    }\n    /* native_decl */\n    GetEnumItem(/*void*/) {\n        return this.EnumItemIterator.current;\n    }\n    /* native_decl */\n    GetFilterPlayer(/*void*/) {\n        return this.FilterPlayerIterator.current;\n    }\n    /* native_decl */\n    GetEnumPlayer(/*void*/) {\n        return this.EnumPlayerIterator.current;\n    }\n    /* native_decl */\n    // GetTriggeringTrigger(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggeringTrigger\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggerEventId(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerEventId\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggerEvalCount(whichTrigger:trigger){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerEvalCount\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggerExecCount(whichTrigger:trigger){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerExecCount\",arguments)\n    // }\n    /* native_decl */\n    // ExecuteFunc(funcName:string){\n    //   console.log(\"[------decl-only------]\",\"ExecuteFunc\",arguments)\n    // }\n    /* native_decl */\n    And(operandA, operandB) {\n        return operandA() && operandB();\n    }\n    /* native_decl */\n    Or(operandA, operandB) {\n        return operandA() || operandB();\n    }\n    /* native_decl */\n    Not(operand) {\n        return !operand();\n    }\n    /* native_decl */\n    // Condition(func:code){\n    //   console.log(\"[------decl-only------]\",\"Condition\",arguments)\n    // }\n    /* native_decl */\n    // DestroyCondition(c:conditionfunc){\n    //   console.log(\"[------decl-only------]\",\"DestroyCondition\",arguments)\n    // }\n    /* native_decl */\n    Filter(func) {\n        return func;\n    }\n    /* native_decl */\n    DestroyFilter(f) {\n    }\n    /* native_decl */\n    DestroyBoolExpr(e) {\n    }\n    /* native_decl */\n    TriggerRegisterVariableEvent(whichTrigger, varName, opcode, limitval) {\n        let filter = new eventFilter(varName, opcode, limitval);\n        listenEvent(this.runtime, varName, (p) => filter.evaluate(p))\n        whichTrigger.VariableEvents.add(new {\n            varName, opcode, limitval\n        })\n    }\n    /* native_decl */\n    TriggerRegisterTimerEvent(whichTrigger, timeout, periodic) {\n        let t = timerListen(timeout, periodic, whichTrigger);\n        whichTrigger.TimerEvents.add({\n            timeout,\n            periodic,\n            timer: t\n        });\n    }\n    /* native_decl */\n    TriggerRegisterTimerExpireEvent(whichTrigger, t) {\n        t.listenExpire(whichTrigger);\n        whichTrigger.timerExpireEvents.add(new timerExpireEvent(t));\n    }\n    /* native_decl */\n    TriggerRegisterGameStateEvent(whichTrigger, whichState, opcode, limitval) {\n        let filter = new eventFilter(whichState, opcode, limitval);\n        listenEvent(this.gameState, whichState, whichTrigger, (p) => filter.evaluate(p));\n        whichTrigger.gameStateEvents.add(new eventFilter(whichState, opcode, limitval));\n    }\n    /* native_decl */\n    // TriggerRegisterDialogEvent(whichTrigger:trigger, whichDialog:dialog){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterDialogEvent\",arguments)\n    // }\n    /* native_decl */\n    TriggerRegisterDialogButtonEvent(whichTrigger, whichButton) {\n        listenEvent(this.dialog, whichButton, whichTrigger);\n    }\n    /* native_decl */\n    // GetEventGameState(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventGameState\",arguments)\n    // }\n    /* native_decl */\n    TriggerRegisterGameEvent(whichTrigger, whichGameEvent) {\n        listenEvent(this.gameState, whichGameEvent, whichTrigger);\n        whichTrigger.gameEvents.add(whichGameEvent);\n    }\n    /* native_decl */\n    // GetWinningPlayer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetWinningPlayer\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterEnterRegion(whichTrigger:trigger, whichRegion:region, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterEnterRegion\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggeringRegion(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggeringRegion\",arguments)\n    // }\n    /* native_decl */\n    // GetEnteringUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEnteringUnit\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterLeaveRegion(whichTrigger:trigger, whichRegion:region, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterLeaveRegion\",arguments)\n    // }\n    /* native_decl */\n    // GetLeavingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLeavingUnit\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterTrackableHitEvent(whichTrigger:trigger, t:trackable){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterTrackableHitEvent\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterTrackableTrackEvent(whichTrigger:trigger, t:trackable){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterTrackableTrackEvent\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggeringTrackable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggeringTrackable\",arguments)\n    // }\n    /* native_decl */\n    // GetClickedButton(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetClickedButton\",arguments)\n    // }\n    /* native_decl */\n    // GetClickedDialog(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetClickedDialog\",arguments)\n    // }\n    /* native_decl */\n    // GetTournamentFinishSoonTimeRemaining(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTournamentFinishSoonTimeRemaining\",arguments)\n    // }\n    /* native_decl */\n    // GetTournamentFinishNowRule(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTournamentFinishNowRule\",arguments)\n    // }\n    /* native_decl */\n    // GetTournamentFinishNowPlayer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTournamentFinishNowPlayer\",arguments)\n    // }\n    /* native_decl */\n    // GetTournamentScore(whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"GetTournamentScore\",arguments)\n    // }\n    /* native_decl */\n    // GetSaveBasicFilename(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSaveBasicFilename\",arguments)\n    // }\n    /* native_decl */\n    TriggerRegisterPlayerEvent(whichTrigger, whichPlayer, whichPlayerEvent) {\n        listenEvent(whichPlayer, whichPlayerEvent, whichTrigger)\n    }\n    /* native_decl */\n    // GetTriggerPlayer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerPlayer\",arguments)\n    // }\n\n    /* native_decl */\n    TriggerRegisterPlayerUnitEvent(whichTrigger, whichPlayer, whichPlayerUnitEvent, filter) {\n        listenEvent(whichPlayer, whichPlayerUnitEvent, whichTrigger, filter);\n        whichTrigger.playerUnitEvents.add(new playerUnitEvent(whichTrigger, whichPlayer, whichPlayerUnitEvent, filter));\n    }\n    /* native_decl */\n    // GetLevelingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLevelingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetLearningUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLearningUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetLearnedSkill(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLearnedSkill\",arguments)\n    // }\n    /* native_decl */\n    // GetLearnedSkillLevel(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLearnedSkillLevel\",arguments)\n    // }\n    /* native_decl */\n    // GetRevivableUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetRevivableUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetRevivingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetRevivingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetAttacker(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetAttacker\",arguments)\n    // }\n    /* native_decl */\n    // GetRescuer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetRescuer\",arguments)\n    // }\n    /* native_decl */\n    // GetDyingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetDyingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetKillingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetKillingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetDecayingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetDecayingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetConstructingStructure(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetConstructingStructure\",arguments)\n    // }\n    /* native_decl */\n    // GetCancelledStructure(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCancelledStructure\",arguments)\n    // }\n    /* native_decl */\n    // GetConstructedStructure(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetConstructedStructure\",arguments)\n    // }\n    /* native_decl */\n    // GetResearchingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetResearchingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetResearched(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetResearched\",arguments)\n    // }\n    /* native_decl */\n    // GetTrainedUnitType(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTrainedUnitType\",arguments)\n    // }\n    /* native_decl */\n    // GetTrainedUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTrainedUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetDetectedUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetDetectedUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSummoningUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSummoningUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSummonedUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSummonedUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetTransportUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTransportUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetLoadedUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLoadedUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSellingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSellingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSoldUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSoldUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetBuyingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetBuyingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSoldItem(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSoldItem\",arguments)\n    // }\n    /* native_decl */\n    // GetChangingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetChangingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetChangingUnitPrevOwner(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetChangingUnitPrevOwner\",arguments)\n    // }\n    /* native_decl */\n    // GetManipulatingUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetManipulatingUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetManipulatedItem(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetManipulatedItem\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderedUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderedUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetIssuedOrderId(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetIssuedOrderId\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderPointX(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderPointX\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderPointY(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderPointY\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderPointLoc(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderPointLoc\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderTarget(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderTarget\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderTargetDestructable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderTargetDestructable\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderTargetItem(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderTargetItem\",arguments)\n    // }\n    /* native_decl */\n    // GetOrderTargetUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetOrderTargetUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellAbilityUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellAbilityUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellAbilityId(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellAbilityId\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellAbility(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellAbility\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellTargetLoc(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellTargetLoc\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellTargetX(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellTargetX\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellTargetY(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellTargetY\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellTargetDestructable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellTargetDestructable\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellTargetItem(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellTargetItem\",arguments)\n    // }\n    /* native_decl */\n    // GetSpellTargetUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetSpellTargetUnit\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterPlayerAllianceChange(whichTrigger:trigger, whichPlayer:player, whichAlliance:alliancetype){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterPlayerAllianceChange\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterPlayerStateEvent(whichTrigger:trigger, whichPlayer:player, whichState:playerstate, opcode:limitop, limitval:number){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterPlayerStateEvent\",arguments)\n    // }\n    /* native_decl */\n    // GetEventPlayerState(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventPlayerState\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterPlayerChatEvent(whichTrigger:trigger, whichPlayer:player, chatMessageToDetect:string, exactMatchOnly:boolean){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterPlayerChatEvent\",arguments)\n    // }\n    /* native_decl */\n    // GetEventPlayerChatString(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventPlayerChatString\",arguments)\n    // }\n    /* native_decl */\n    // GetEventPlayerChatStringMatched(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventPlayerChatStringMatched\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterDeathEvent(whichTrigger:trigger, whichWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterDeathEvent\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggerUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerUnit\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterUnitStateEvent(whichTrigger:trigger, whichUnit:unit, whichState:unitstate, opcode:limitop, limitval:number){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterUnitStateEvent\",arguments)\n    // }\n    /* native_decl */\n    // GetEventUnitState(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventUnitState\",arguments)\n    // }\n    /* native_decl */\n    TriggerRegisterUnitEvent(whichTrigger, whichUnit, whichEvent) {\n        listenEvent(whichUnit, whichEvent, whichTrigger)\n        whichTrigger.unitEvents.add(new unitEvent(whichTrigger, whichUnit, whichEvent))\n    }\n    /* native_decl */\n    // GetEventDamage(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventDamage\",arguments)\n    // }\n    /* native_decl */\n    // GetEventDamageSource(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventDamageSource\",arguments)\n    // }\n    /* native_decl */\n    // GetEventDetectingPlayer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventDetectingPlayer\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterFilterUnitEvent(whichTrigger:trigger, whichUnit:unit, whichEvent:unitevent, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterFilterUnitEvent\",arguments)\n    // }\n    /* native_decl */\n    // GetEventTargetUnit(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetEventTargetUnit\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRegisterUnitInRange(whichTrigger:trigger, whichUnit:unit, range:number, filter:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"TriggerRegisterUnitInRange\",arguments)\n    // }\n    /* native_decl */\n    // TriggerAddCondition(whichTrigger:trigger, condition:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"TriggerAddCondition\",arguments)\n    // }\n    /* native_decl */\n    // TriggerRemoveCondition(whichTrigger:trigger, whichCondition:triggercondition){\n    //   console.log(\"[------decl-only------]\",\"TriggerRemoveCondition\",arguments)\n    // }\n    /* native_decl */\n    // TriggerClearConditions(whichTrigger:trigger){\n    //   console.log(\"[------decl-only------]\",\"TriggerClearConditions\",arguments)\n    // }\n    /* native_decl */\n    TriggerAddAction(whichTrigger, actionFunc) {\n        whichTrigger.actions.add(actionFunc);\n    }\n    /* native_decl */\n    TriggerRemoveAction(whichTrigger, whichAction) {\n        whichTrigger.actions.remove(whichAction);\n    }\n    /* native_decl */\n    TriggerClearActions(whichTrigger) {\n        whichTrigger.actions.clear();\n    }\n    /* native_decl */\n    // TriggerSleepAction(timeout:number){\n    //   console.log(\"[------decl-only------]\",\"TriggerSleepAction\",arguments)\n    // }\n    /* native_decl */\n    // TriggerWaitForSound(s:sound, offset:number){\n    //   console.log(\"[------decl-only------]\",\"TriggerWaitForSound\",arguments)\n    // }\n    /* native_decl */\n    TriggerEvaluate(whichTrigger) {\n        logcall(this.TriggerEvaluate);\n        return whichTrigger.evaluate(this.gameState)\n    }\n    /* native_decl */\n    TriggerExecute(whichTrigger) {\n        logcall(this.TriggerExecute);\n        return whichTrigger.execute();\n    }\n    /* native_decl */\n    // TriggerExecuteWait(whichTrigger:trigger){\n    //   console.log(\"[------decl-only------]\",\"TriggerExecuteWait\",arguments)\n    // }\n    /* native_decl */\n    // TriggerSyncStart(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"TriggerSyncStart\",arguments)\n    // }\n    /* native_decl */\n    // TriggerSyncReady(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"TriggerSyncReady\",arguments)\n    // }\n    /* native_decl */\n    // GetWidgetLife(whichWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"GetWidgetLife\",arguments)\n    // }\n    /* native_decl */\n    // SetWidgetLife(whichWidget:widget, newLife:number){\n    //   console.log(\"[------decl-only------]\",\"SetWidgetLife\",arguments)\n    // }\n    /* native_decl */\n    // GetWidgetX(whichWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"GetWidgetX\",arguments)\n    // }\n    /* native_decl */\n    // GetWidgetY(whichWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"GetWidgetY\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggerWidget(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerWidget\",arguments)\n    // }\n    /* native_decl */\n    // CreateDestructable(objectid:number, x:number, y:number, face:number, scale:number, variation:number){\n    //   console.log(\"[------decl-only------]\",\"CreateDestructable\",arguments)\n    // }\n    /* native_decl */\n    // CreateDestructableZ(objectid:number, x:number, y:number, z:number, face:number, scale:number, variation:number){\n    //   console.log(\"[------decl-only------]\",\"CreateDestructableZ\",arguments)\n    // }\n    /* native_decl */\n    // CreateDeadDestructable(objectid:number, x:number, y:number, face:number, scale:number, variation:number){\n    //   console.log(\"[------decl-only------]\",\"CreateDeadDestructable\",arguments)\n    // }\n    /* native_decl */\n    // CreateDeadDestructableZ(objectid:number, x:number, y:number, z:number, face:number, scale:number, variation:number){\n    //   console.log(\"[------decl-only------]\",\"CreateDeadDestructableZ\",arguments)\n    // }\n    /* native_decl */\n    // RemoveDestructable(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"RemoveDestructable\",arguments)\n    // }\n    /* native_decl */\n    // KillDestructable(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"KillDestructable\",arguments)\n    // }\n    /* native_decl */\n    // SetDestructableInvulnerable(d:destructable, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetDestructableInvulnerable\",arguments)\n    // }\n    /* native_decl */\n    // IsDestructableInvulnerable(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"IsDestructableInvulnerable\",arguments)\n    // }\n    /* native_decl */\n    // EnumDestructablesInRect(r:rect, filter:boolexpr, actionFunc:code){\n    //   console.log(\"[------decl-only------]\",\"EnumDestructablesInRect\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableTypeId(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableTypeId\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableX(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableX\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableY(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableY\",arguments)\n    // }\n    /* native_decl */\n    // SetDestructableLife(d:destructable, life:number){\n    //   console.log(\"[------decl-only------]\",\"SetDestructableLife\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableLife(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableLife\",arguments)\n    // }\n    /* native_decl */\n    // SetDestructableMaxLife(d:destructable, max:number){\n    //   console.log(\"[------decl-only------]\",\"SetDestructableMaxLife\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableMaxLife(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableMaxLife\",arguments)\n    // }\n    /* native_decl */\n    // DestructableRestoreLife(d:destructable, life:number, birth:boolean){\n    //   console.log(\"[------decl-only------]\",\"DestructableRestoreLife\",arguments)\n    // }\n    /* native_decl */\n    // QueueDestructableAnimation(d:destructable, whichAnimation:string){\n    //   console.log(\"[------decl-only------]\",\"QueueDestructableAnimation\",arguments)\n    // }\n    /* native_decl */\n    // SetDestructableAnimation(d:destructable, whichAnimation:string){\n    //   console.log(\"[------decl-only------]\",\"SetDestructableAnimation\",arguments)\n    // }\n    /* native_decl */\n    // SetDestructableAnimationSpeed(d:destructable, speedFactor:number){\n    //   console.log(\"[------decl-only------]\",\"SetDestructableAnimationSpeed\",arguments)\n    // }\n    /* native_decl */\n    // ShowDestructable(d:destructable, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"ShowDestructable\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableOccluderHeight(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableOccluderHeight\",arguments)\n    // }\n    /* native_decl */\n    // SetDestructableOccluderHeight(d:destructable, height:number){\n    //   console.log(\"[------decl-only------]\",\"SetDestructableOccluderHeight\",arguments)\n    // }\n    /* native_decl */\n    // GetDestructableName(d:destructable){\n    //   console.log(\"[------decl-only------]\",\"GetDestructableName\",arguments)\n    // }\n    /* native_decl */\n    // GetTriggerDestructable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTriggerDestructable\",arguments)\n    // }\n    /* native_decl */\n    // CreateItem(itemid:number, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"CreateItem\",arguments)\n    // }\n    /* native_decl */\n    // RemoveItem(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"RemoveItem\",arguments)\n    // }\n    /* native_decl */\n    // GetItemPlayer(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemPlayer\",arguments)\n    // }\n    /* native_decl */\n    // GetItemTypeId(i:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemTypeId\",arguments)\n    // }\n    /* native_decl */\n    // GetItemX(i:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemX\",arguments)\n    // }\n    /* native_decl */\n    // GetItemY(i:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemY\",arguments)\n    // }\n    /* native_decl */\n    // SetItemPosition(i:item, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"SetItemPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetItemDropOnDeath(whichItem:item, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetItemDropOnDeath\",arguments)\n    // }\n    /* native_decl */\n    // SetItemDroppable(i:item, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetItemDroppable\",arguments)\n    // }\n    /* native_decl */\n    // SetItemPawnable(i:item, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetItemPawnable\",arguments)\n    // }\n    /* native_decl */\n    // SetItemPlayer(whichItem:item, whichPlayer:player, changeColor:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetItemPlayer\",arguments)\n    // }\n    /* native_decl */\n    // SetItemInvulnerable(whichItem:item, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetItemInvulnerable\",arguments)\n    // }\n    /* native_decl */\n    // IsItemInvulnerable(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"IsItemInvulnerable\",arguments)\n    // }\n    /* native_decl */\n    // SetItemVisible(whichItem:item, show:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetItemVisible\",arguments)\n    // }\n    /* native_decl */\n    // IsItemVisible(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"IsItemVisible\",arguments)\n    // }\n    /* native_decl */\n    // IsItemOwned(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"IsItemOwned\",arguments)\n    // }\n    /* native_decl */\n    // IsItemPowerup(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"IsItemPowerup\",arguments)\n    // }\n    /* native_decl */\n    // IsItemSellable(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"IsItemSellable\",arguments)\n    // }\n    /* native_decl */\n    // IsItemPawnable(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"IsItemPawnable\",arguments)\n    // }\n    /* native_decl */\n    // IsItemIdPowerup(itemId:number){\n    //   console.log(\"[------decl-only------]\",\"IsItemIdPowerup\",arguments)\n    // }\n    /* native_decl */\n    // IsItemIdSellable(itemId:number){\n    //   console.log(\"[------decl-only------]\",\"IsItemIdSellable\",arguments)\n    // }\n    /* native_decl */\n    // IsItemIdPawnable(itemId:number){\n    //   console.log(\"[------decl-only------]\",\"IsItemIdPawnable\",arguments)\n    // }\n    /* native_decl */\n    // EnumItemsInRect(r:rect, filter:boolexpr, actionFunc:code){\n    //   console.log(\"[------decl-only------]\",\"EnumItemsInRect\",arguments)\n    // }\n    /* native_decl */\n    // GetItemLevel(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemLevel\",arguments)\n    // }\n    /* native_decl */\n    // GetItemType(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemType\",arguments)\n    // }\n    /* native_decl */\n    // SetItemDropID(whichItem:item, unitId:number){\n    //   console.log(\"[------decl-only------]\",\"SetItemDropID\",arguments)\n    // }\n    /* native_decl */\n    // GetItemName(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemName\",arguments)\n    // }\n    /* native_decl */\n    // GetItemCharges(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemCharges\",arguments)\n    // }\n    /* native_decl */\n    // SetItemCharges(whichItem:item, charges:number){\n    //   console.log(\"[------decl-only------]\",\"SetItemCharges\",arguments)\n    // }\n    /* native_decl */\n    // GetItemUserData(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"GetItemUserData\",arguments)\n    // }\n    /* native_decl */\n    // SetItemUserData(whichItem:item, data:number){\n    //   console.log(\"[------decl-only------]\",\"SetItemUserData\",arguments)\n    // }\n    /* native_decl */\n    async CreateUnit(player, unitid, x, y, face) {\n        let h = await this.app.createUnit(unitid, x, y, face);\n        return asEventAgent({\n            type: 'unit',\n            creationArgs: [player, unitid, x, y, face],\n            instance: h\n        });\n    }\n    /* native_decl */\n    // CreateUnitByName(whichPlayer:player, unitname:string, x:number, y:number, face:number){\n    //   console.log(\"[------decl-only------]\",\"CreateUnitByName\",arguments)\n    // }\n    /* native_decl */\n    // CreateUnitAtLoc(id:player, unitid:number, whichLocation:location, face:number){\n    //   console.log(\"[------decl-only------]\",\"CreateUnitAtLoc\",arguments)\n    // }\n    /* native_decl */\n    // CreateUnitAtLocByName(id:player, unitname:string, whichLocation:location, face:number){\n    //   console.log(\"[------decl-only------]\",\"CreateUnitAtLocByName\",arguments)\n    // }\n    /* native_decl */\n    // CreateCorpse(whichPlayer:player, unitid:number, x:number, y:number, face:number){\n    //   console.log(\"[------decl-only------]\",\"CreateCorpse\",arguments)\n    // }\n    /* native_decl */\n    // KillUnit(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"KillUnit\",arguments)\n    // }\n    /* native_decl */\n    // RemoveUnit(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"RemoveUnit\",arguments)\n    // }\n    /* native_decl */\n    // ShowUnit(whichUnit:unit, show:boolean){\n    //   console.log(\"[------decl-only------]\",\"ShowUnit\",arguments)\n    // }\n    /* native_decl */\n    SetUnitState(whichUnit, whichUnitState, newVal) {\n        whichUnit[whichUnitState[1]] = newVal;\n    }\n    /* native_decl */\n    // SetUnitX(whichUnit:unit, newX:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitX\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitY(whichUnit:unit, newY:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitY\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitPosition(whichUnit:unit, newX:number, newY:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitPositionLoc(whichUnit:unit, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"SetUnitPositionLoc\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitFacing(whichUnit:unit, facingAngle:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitFacing\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitFacingTimed(whichUnit:unit, facingAngle:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitFacingTimed\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitMoveSpeed(whichUnit:unit, newSpeed:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitMoveSpeed\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitFlyHeight(whichUnit:unit, newHeight:number, rate:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitFlyHeight\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitTurnSpeed(whichUnit:unit, newTurnSpeed:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitTurnSpeed\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitPropWindow(whichUnit:unit, newPropWindowAngle:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitPropWindow\",arguments)\n    // }\n    /* native_decl */\n    SetUnitAcquireRange(whichUnit, newAcquireRange) {\n        whichUnit['AcquireRange'] = newAcquireRange;\n    }\n    /* native_decl */\n    SetUnitCreepGuard(whichUnit, creepGuard) {\n        whichUnit['CreepGuard'] = creepGuard;\n    }\n    /* native_decl */\n    GetUnitAcquireRange(whichUnit) {\n        return whichUnit['AcquireRange']\n    }\n    /* native_decl */\n    GetUnitTurnSpeed(whichUnit) {\n        return whichUnit['TurnSpeed']\n    }\n    /* native_decl */\n    GetUnitPropWindow(whichUnit) {\n        return whichUnit['PropWindow']\n    }\n    /* native_decl */\n    GetUnitFlyHeight(whichUnit) {\n        return whichUnit['FlyHeight']\n    }\n    /* native_decl */\n    GetUnitDefaultAcquireRange(whichUnit) {\n        return whichUnit['DefaultAcquireRange']\n    }\n    /* native_decl */\n    GetUnitDefaultTurnSpeed(whichUnit) {\n        return whichUnit['DefaultTurnSpeed']\n    }\n    /* native_decl */\n    GetUnitDefaultPropWindow(whichUnit) {\n        return whichUnit['DefaultPropWindow']\n    }\n    /* native_decl */\n    GetUnitDefaultFlyHeight(whichUnit) {\n        return whichUnit['DefaultFlyHeight']\n    }\n    /* native_decl */\n    SetUnitOwner(whichUnit, whichPlayer, changeColor) {\n        whichUnit['Owner'] = whichPlayer;\n        if (changeColor) {\n            whichUnit['color'] = whichPlayer.color;\n        }\n    }\n    /* native_decl */\n    SetUnitColor(whichUnit, whichColor) {\n        whichUnit['color'] = whichColor;\n    }\n    /* native_decl */\n    SetUnitScale(whichUnit, scaleX, scaleY, scaleZ) {\n        whichUnit['Scale'] = [scaleX, scaleY, scaleZ];\n    }\n    /* native_decl */\n    SetUnitTimeScale(whichUnit, timeScale) {\n        whichUnit['TimeScale'] = timeScale;\n    }\n    /* native_decl */\n    SetUnitBlendTime(whichUnit, blendTime) {\n        whichUnit['BlendTime'] = blendTime;\n    }\n    /* native_decl */\n    SetUnitVertexColor(whichUnit, red, green, blue, alpha) {\n        whichUnit['VertexColor'] = [red, green, blue, alpha];\n    }\n    /* native_decl */\n    QueueUnitAnimation(whichUnit, whichAnimation) {\n        console.log(\"[------decl-only------]\", \"QueueUnitAnimation\", arguments)\n    }\n    /* native_decl */\n    SetUnitAnimation(whichUnit, whichAnimation) {\n        console.log(\"[------decl-only------]\", \"SetUnitAnimation\", arguments)\n    }\n    /* native_decl */\n    SetUnitAnimationByIndex(whichUnit, whichAnimation) {\n        console.log(\"[------decl-only------]\", \"SetUnitAnimationByIndex\", arguments)\n    }\n    /* native_decl */\n    SetUnitAnimationWithRarity(whichUnit, whichAnimation, rarity) {\n        console.log(\"[------decl-only------]\", \"SetUnitAnimationWithRarity\", arguments)\n    }\n    /* native_decl */\n    AddUnitAnimationProperties(whichUnit, animProperties, add) {\n        console.log(\"[------decl-only------]\", \"AddUnitAnimationProperties\", arguments)\n    }\n    /* native_decl */\n    SetUnitLookAt(whichUnit, whichBone, lookAtTarget, offsetX, offsetY, offsetZ) {\n        console.log(\"[------decl-only------]\", \"SetUnitLookAt\", arguments)\n        debugger;\n    }\n    /* native_decl */\n    ResetUnitLookAt(whichUnit) {\n        console.log(\"[------decl-only------]\", \"ResetUnitLookAt\", arguments)\n        debugger;\n    }\n    /* native_decl */\n    // SetUnitRescuable(whichUnit:unit, byWhichPlayer:player, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUnitRescuable\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitRescueRange(whichUnit:unit, range:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitRescueRange\",arguments)\n    // }\n    /* native_decl */\n    // SetHeroStr(whichHero:unit, newStr:number, permanent:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetHeroStr\",arguments)\n    // }\n    /* native_decl */\n    // SetHeroAgi(whichHero:unit, newAgi:number, permanent:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetHeroAgi\",arguments)\n    // }\n    /* native_decl */\n    // SetHeroInt(whichHero:unit, newInt:number, permanent:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetHeroInt\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroStr(whichHero:unit, includeBonuses:boolean){\n    //   console.log(\"[------decl-only------]\",\"GetHeroStr\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroAgi(whichHero:unit, includeBonuses:boolean){\n    //   console.log(\"[------decl-only------]\",\"GetHeroAgi\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroInt(whichHero:unit, includeBonuses:boolean){\n    //   console.log(\"[------decl-only------]\",\"GetHeroInt\",arguments)\n    // }\n    /* native_decl */\n    // UnitStripHeroLevel(whichHero:unit, howManyLevels:number){\n    //   console.log(\"[------decl-only------]\",\"UnitStripHeroLevel\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroXP(whichHero:unit){\n    //   console.log(\"[------decl-only------]\",\"GetHeroXP\",arguments)\n    // }\n    /* native_decl */\n    // SetHeroXP(whichHero:unit, newXpVal:number, showEyeCandy:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetHeroXP\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroSkillPoints(whichHero:unit){\n    //   console.log(\"[------decl-only------]\",\"GetHeroSkillPoints\",arguments)\n    // }\n    /* native_decl */\n    // UnitModifySkillPoints(whichHero:unit, skillPointDelta:number){\n    //   console.log(\"[------decl-only------]\",\"UnitModifySkillPoints\",arguments)\n    // }\n    /* native_decl */\n    // AddHeroXP(whichHero:unit, xpToAdd:number, showEyeCandy:boolean){\n    //   console.log(\"[------decl-only------]\",\"AddHeroXP\",arguments)\n    // }\n    /* native_decl */\n    // SetHeroLevel(whichHero:unit, level:number, showEyeCandy:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetHeroLevel\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroLevel(whichHero:unit){\n    //   console.log(\"[------decl-only------]\",\"GetHeroLevel\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitLevel(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitLevel\",arguments)\n    // }\n    /* native_decl */\n    // GetHeroProperName(whichHero:unit){\n    //   console.log(\"[------decl-only------]\",\"GetHeroProperName\",arguments)\n    // }\n    /* native_decl */\n    // SuspendHeroXP(whichHero:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SuspendHeroXP\",arguments)\n    // }\n    /* native_decl */\n    // IsSuspendedXP(whichHero:unit){\n    //   console.log(\"[------decl-only------]\",\"IsSuspendedXP\",arguments)\n    // }\n    /* native_decl */\n    // SelectHeroSkill(whichHero:unit, abilcode:number){\n    //   console.log(\"[------decl-only------]\",\"SelectHeroSkill\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitAbilityLevel(whichUnit:unit, abilcode:number){\n    //   console.log(\"[------decl-only------]\",\"GetUnitAbilityLevel\",arguments)\n    // }\n    /* native_decl */\n    // DecUnitAbilityLevel(whichUnit:unit, abilcode:number){\n    //   console.log(\"[------decl-only------]\",\"DecUnitAbilityLevel\",arguments)\n    // }\n    /* native_decl */\n    // IncUnitAbilityLevel(whichUnit:unit, abilcode:number){\n    //   console.log(\"[------decl-only------]\",\"IncUnitAbilityLevel\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitAbilityLevel(whichUnit:unit, abilcode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitAbilityLevel\",arguments)\n    // }\n    /* native_decl */\n    // ReviveHero(whichHero:unit, x:number, y:number, doEyecandy:boolean){\n    //   console.log(\"[------decl-only------]\",\"ReviveHero\",arguments)\n    // }\n    /* native_decl */\n    // ReviveHeroLoc(whichHero:unit, loc:location, doEyecandy:boolean){\n    //   console.log(\"[------decl-only------]\",\"ReviveHeroLoc\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitExploded(whichUnit:unit, exploded:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUnitExploded\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitInvulnerable(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUnitInvulnerable\",arguments)\n    // }\n    /* native_decl */\n    // PauseUnit(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"PauseUnit\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitPaused(whichHero:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnitPaused\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitPathing(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUnitPathing\",arguments)\n    // }\n    /* native_decl */\n    // ClearSelection(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ClearSelection\",arguments)\n    // }\n    /* native_decl */\n    // SelectUnit(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SelectUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitPointValue(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitPointValue\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitPointValueByType(unitType:number){\n    //   console.log(\"[------decl-only------]\",\"GetUnitPointValueByType\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddItem(whichUnit:unit, whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"UnitAddItem\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddItemById(whichUnit:unit, itemId:number){\n    //   console.log(\"[------decl-only------]\",\"UnitAddItemById\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddItemToSlotById(whichUnit:unit, itemId:number, itemSlot:number){\n    //   console.log(\"[------decl-only------]\",\"UnitAddItemToSlotById\",arguments)\n    // }\n    /* native_decl */\n    // UnitRemoveItem(whichUnit:unit, whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"UnitRemoveItem\",arguments)\n    // }\n    /* native_decl */\n    // UnitRemoveItemFromSlot(whichUnit:unit, itemSlot:number){\n    //   console.log(\"[------decl-only------]\",\"UnitRemoveItemFromSlot\",arguments)\n    // }\n    /* native_decl */\n    // UnitHasItem(whichUnit:unit, whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"UnitHasItem\",arguments)\n    // }\n    /* native_decl */\n    // UnitItemInSlot(whichUnit:unit, itemSlot:number){\n    //   console.log(\"[------decl-only------]\",\"UnitItemInSlot\",arguments)\n    // }\n    /* native_decl */\n    // UnitInventorySize(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitInventorySize\",arguments)\n    // }\n    /* native_decl */\n    // UnitDropItemPoint(whichUnit:unit, whichItem:item, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"UnitDropItemPoint\",arguments)\n    // }\n    /* native_decl */\n    // UnitDropItemSlot(whichUnit:unit, whichItem:item, slot:number){\n    //   console.log(\"[------decl-only------]\",\"UnitDropItemSlot\",arguments)\n    // }\n    /* native_decl */\n    // UnitDropItemTarget(whichUnit:unit, whichItem:item, target:widget){\n    //   console.log(\"[------decl-only------]\",\"UnitDropItemTarget\",arguments)\n    // }\n    /* native_decl */\n    // UnitUseItem(whichUnit:unit, whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"UnitUseItem\",arguments)\n    // }\n    /* native_decl */\n    // UnitUseItemPoint(whichUnit:unit, whichItem:item, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"UnitUseItemPoint\",arguments)\n    // }\n    /* native_decl */\n    // UnitUseItemTarget(whichUnit:unit, whichItem:item, target:widget){\n    //   console.log(\"[------decl-only------]\",\"UnitUseItemTarget\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitX(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitX\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitY(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitY\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitLoc(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitLoc\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitFacing(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitFacing\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitMoveSpeed(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitMoveSpeed\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitDefaultMoveSpeed(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitDefaultMoveSpeed\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitState(whichUnit:unit, whichUnitState:unitstate){\n    //   console.log(\"[------decl-only------]\",\"GetUnitState\",arguments)\n    // }\n    /* native_decl */\n    // GetOwningPlayer(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetOwningPlayer\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitTypeId(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitTypeId\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitRace(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitRace\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitName(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitName\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitFoodUsed(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitFoodUsed\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitFoodMade(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitFoodMade\",arguments)\n    // }\n    /* native_decl */\n    // GetFoodMade(unitId:number){\n    //   console.log(\"[------decl-only------]\",\"GetFoodMade\",arguments)\n    // }\n    /* native_decl */\n    // GetFoodUsed(unitId:number){\n    //   console.log(\"[------decl-only------]\",\"GetFoodUsed\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitUseFood(whichUnit:unit, useFood:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUnitUseFood\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitRallyPoint(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitRallyPoint\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitRallyUnit(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitRallyUnit\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitRallyDestructable(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitRallyDestructable\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInGroup(whichUnit:unit, whichGroup:group){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInGroup\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInForce(whichUnit:unit, whichForce:force){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInForce\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitOwnedByPlayer(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitOwnedByPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitAlly(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitAlly\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitEnemy(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitEnemy\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitVisible(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitVisible\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitDetected(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitDetected\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInvisible(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInvisible\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitFogged(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitFogged\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitMasked(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitMasked\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitSelected(whichUnit:unit, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsUnitSelected\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitRace(whichUnit:unit, whichRace:race){\n    //   console.log(\"[------decl-only------]\",\"IsUnitRace\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitType(whichUnit:unit, whichUnitType:unittype){\n    //   console.log(\"[------decl-only------]\",\"IsUnitType\",arguments)\n    // }\n    /* native_decl */\n    // IsUnit(whichUnit:unit, whichSpecifiedUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnit\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInRange(whichUnit:unit, otherUnit:unit, distance:number){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInRange\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInRangeXY(whichUnit:unit, x:number, y:number, distance:number){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInRangeXY\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInRangeLoc(whichUnit:unit, whichLocation:location, distance:number){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInRangeLoc\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitHidden(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnitHidden\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitIllusion(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnitIllusion\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitInTransport(whichUnit:unit, whichTransport:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnitInTransport\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitLoaded(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"IsUnitLoaded\",arguments)\n    // }\n    /* native_decl */\n    // IsHeroUnitId(unitId:number){\n    //   console.log(\"[------decl-only------]\",\"IsHeroUnitId\",arguments)\n    // }\n    /* native_decl */\n    // IsUnitIdType(unitId:number, whichUnitType:unittype){\n    //   console.log(\"[------decl-only------]\",\"IsUnitIdType\",arguments)\n    // }\n    /* native_decl */\n    // UnitShareVision(whichUnit:unit, whichPlayer:player, share:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitShareVision\",arguments)\n    // }\n    /* native_decl */\n    // UnitSuspendDecay(whichUnit:unit, suspend:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitSuspendDecay\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddType(whichUnit:unit, whichUnitType:unittype){\n    //   console.log(\"[------decl-only------]\",\"UnitAddType\",arguments)\n    // }\n    /* native_decl */\n    // UnitRemoveType(whichUnit:unit, whichUnitType:unittype){\n    //   console.log(\"[------decl-only------]\",\"UnitRemoveType\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddAbility(whichUnit:unit, abilityId:number){\n    //   console.log(\"[------decl-only------]\",\"UnitAddAbility\",arguments)\n    // }\n    /* native_decl */\n    // UnitRemoveAbility(whichUnit:unit, abilityId:number){\n    //   console.log(\"[------decl-only------]\",\"UnitRemoveAbility\",arguments)\n    // }\n    /* native_decl */\n    // UnitMakeAbilityPermanent(whichUnit:unit, permanent:boolean, abilityId:number){\n    //   console.log(\"[------decl-only------]\",\"UnitMakeAbilityPermanent\",arguments)\n    // }\n    /* native_decl */\n    // UnitRemoveBuffs(whichUnit:unit, removePositive:boolean, removeNegative:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitRemoveBuffs\",arguments)\n    // }\n    /* native_decl */\n    // UnitRemoveBuffsEx(whichUnit:unit, removePositive:boolean, removeNegative:boolean, magic:boolean, physical:boolean, timedLife:boolean, aura:boolean, autoDispel:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitRemoveBuffsEx\",arguments)\n    // }\n    /* native_decl */\n    // UnitHasBuffsEx(whichUnit:unit, removePositive:boolean, removeNegative:boolean, magic:boolean, physical:boolean, timedLife:boolean, aura:boolean, autoDispel:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitHasBuffsEx\",arguments)\n    // }\n    /* native_decl */\n    // UnitCountBuffsEx(whichUnit:unit, removePositive:boolean, removeNegative:boolean, magic:boolean, physical:boolean, timedLife:boolean, aura:boolean, autoDispel:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitCountBuffsEx\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddSleep(whichUnit:unit, add:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitAddSleep\",arguments)\n    // }\n    /* native_decl */\n    // UnitCanSleep(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitCanSleep\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddSleepPerm(whichUnit:unit, add:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitAddSleepPerm\",arguments)\n    // }\n    /* native_decl */\n    // UnitCanSleepPerm(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitCanSleepPerm\",arguments)\n    // }\n    /* native_decl */\n    // UnitIsSleeping(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitIsSleeping\",arguments)\n    // }\n    /* native_decl */\n    // UnitWakeUp(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitWakeUp\",arguments)\n    // }\n    /* native_decl */\n    // UnitApplyTimedLife(whichUnit:unit, buffId:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"UnitApplyTimedLife\",arguments)\n    // }\n    /* native_decl */\n    // UnitIgnoreAlarm(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitIgnoreAlarm\",arguments)\n    // }\n    /* native_decl */\n    // UnitIgnoreAlarmToggled(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitIgnoreAlarmToggled\",arguments)\n    // }\n    /* native_decl */\n    // UnitResetCooldown(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"UnitResetCooldown\",arguments)\n    // }\n    /* native_decl */\n    // UnitSetConstructionProgress(whichUnit:unit, constructionPercentage:number){\n    //   console.log(\"[------decl-only------]\",\"UnitSetConstructionProgress\",arguments)\n    // }\n    /* native_decl */\n    // UnitSetUpgradeProgress(whichUnit:unit, upgradePercentage:number){\n    //   console.log(\"[------decl-only------]\",\"UnitSetUpgradeProgress\",arguments)\n    // }\n    /* native_decl */\n    // UnitPauseTimedLife(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitPauseTimedLife\",arguments)\n    // }\n    /* native_decl */\n    // UnitSetUsesAltIcon(whichUnit:unit, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"UnitSetUsesAltIcon\",arguments)\n    // }\n    /* native_decl */\n    // UnitDamagePoint(whichUnit:unit, delay:number, radius:number, x:number, y:number, amount:number, attack:boolean, ranged:boolean, attackType:attacktype, damageType:damagetype, weaponType:weapontype){\n    //   console.log(\"[------decl-only------]\",\"UnitDamagePoint\",arguments)\n    // }\n    /* native_decl */\n    // UnitDamageTarget(whichUnit:unit, target:widget, amount:number, attack:boolean, ranged:boolean, attackType:attacktype, damageType:damagetype, weaponType:weapontype){\n    //   console.log(\"[------decl-only------]\",\"UnitDamageTarget\",arguments)\n    // }\n    /* native_decl */\n    // IssueImmediateOrder(whichUnit:unit, order:string){\n    //   console.log(\"[------decl-only------]\",\"IssueImmediateOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueImmediateOrderById(whichUnit:unit, order:number){\n    //   console.log(\"[------decl-only------]\",\"IssueImmediateOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssuePointOrder(whichUnit:unit, order:string, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IssuePointOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssuePointOrderLoc(whichUnit:unit, order:string, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"IssuePointOrderLoc\",arguments)\n    // }\n    /* native_decl */\n    // IssuePointOrderById(whichUnit:unit, order:number, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IssuePointOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssuePointOrderByIdLoc(whichUnit:unit, order:number, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"IssuePointOrderByIdLoc\",arguments)\n    // }\n    /* native_decl */\n    // IssueTargetOrder(whichUnit:unit, order:string, targetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueTargetOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueTargetOrderById(whichUnit:unit, order:number, targetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueTargetOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssueInstantPointOrder(whichUnit:unit, order:string, x:number, y:number, instantTargetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueInstantPointOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueInstantPointOrderById(whichUnit:unit, order:number, x:number, y:number, instantTargetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueInstantPointOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssueInstantTargetOrder(whichUnit:unit, order:string, targetWidget:widget, instantTargetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueInstantTargetOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueInstantTargetOrderById(whichUnit:unit, order:number, targetWidget:widget, instantTargetWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueInstantTargetOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssueBuildOrder(whichPeon:unit, unitToBuild:string, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IssueBuildOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueBuildOrderById(whichPeon:unit, unitId:number, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IssueBuildOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssueNeutralImmediateOrder(forWhichPlayer:player, neutralStructure:unit, unitToBuild:string){\n    //   console.log(\"[------decl-only------]\",\"IssueNeutralImmediateOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueNeutralImmediateOrderById(forWhichPlayer:player, neutralStructure:unit, unitId:number){\n    //   console.log(\"[------decl-only------]\",\"IssueNeutralImmediateOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssueNeutralPointOrder(forWhichPlayer:player, neutralStructure:unit, unitToBuild:string, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IssueNeutralPointOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueNeutralPointOrderById(forWhichPlayer:player, neutralStructure:unit, unitId:number, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IssueNeutralPointOrderById\",arguments)\n    // }\n    /* native_decl */\n    // IssueNeutralTargetOrder(forWhichPlayer:player, neutralStructure:unit, unitToBuild:string, target:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueNeutralTargetOrder\",arguments)\n    // }\n    /* native_decl */\n    // IssueNeutralTargetOrderById(forWhichPlayer:player, neutralStructure:unit, unitId:number, target:widget){\n    //   console.log(\"[------decl-only------]\",\"IssueNeutralTargetOrderById\",arguments)\n    // }\n    /* native_decl */\n    // GetUnitCurrentOrder(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetUnitCurrentOrder\",arguments)\n    // }\n    /* native_decl */\n    SetResourceAmount(whichUnit, amount) {\n        whichUnit['ResourceAmount'] = amount;\n    }\n    /* native_decl */\n    // AddResourceAmount(whichUnit:unit, amount:number){\n    //   console.log(\"[------decl-only------]\",\"AddResourceAmount\",arguments)\n    // }\n    /* native_decl */\n    // GetResourceAmount(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"GetResourceAmount\",arguments)\n    // }\n    /* native_decl */\n    // WaygateGetDestinationX(waygate:unit){\n    //   console.log(\"[------decl-only------]\",\"WaygateGetDestinationX\",arguments)\n    // }\n    /* native_decl */\n    // WaygateGetDestinationY(waygate:unit){\n    //   console.log(\"[------decl-only------]\",\"WaygateGetDestinationY\",arguments)\n    // }\n    /* native_decl */\n    // WaygateSetDestination(waygate:unit, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"WaygateSetDestination\",arguments)\n    // }\n    /* native_decl */\n    // WaygateActivate(waygate:unit, activate:boolean){\n    //   console.log(\"[------decl-only------]\",\"WaygateActivate\",arguments)\n    // }\n    /* native_decl */\n    // WaygateIsActive(waygate:unit){\n    //   console.log(\"[------decl-only------]\",\"WaygateIsActive\",arguments)\n    // }\n    /* native_decl */\n    AddItemToAllStock(itemId, currentStock, stockMax) {\n        this.NbShops.forEach(x => x.items.set(itemId, { currentStock, stockMax }));\n    }\n    /* native_decl */\n    AddItemToStock(whichUnit, itemId, currentStock, stockMax) {\n        whichUnit.units.set(itemId, { currentStock, stockMax })\n    }\n    /* native_decl */\n    AddUnitToAllStock(unitId, currentStock, stockMax) {\n        this.NbShops.forEach(x => x.units.set(unitId, { currentStock, stockMax }));\n    }\n    /* native_decl */\n    AddUnitToStock(whichUnit, unitId, currentStock, stockMax) {\n        whichUnit.units.set(unitId, { currentStock, stockMax })\n    }\n    /* native_decl */\n    RemoveItemFromAllStock(itemId) {\n        this.NbShops.forEach(x => x.items.remove(itemId));\n    }\n    /* native_decl */\n    RemoveItemFromStock(whichUnit, itemId) {\n        whichUnit.items.remove(itemId);\n    }\n    /* native_decl */\n    RemoveUnitFromAllStock(unitId) {\n        this.NbShops.forEach(x => x.units.remove(unitId));\n    }\n    /* native_decl */\n    RemoveUnitFromStock(whichUnit, unitId) {\n        whichUnit.units.remove(unitId);\n    }\n    /* 初始化中立商店建筑物（Neutral Buildings）物品槽位 */\n    SetAllItemTypeSlots(slots) {\n        this.NbShops.forEach(x => x.items = new ArrayList(slots));\n    }\n    /* 初始化中立商店建筑物（Neutral Buildings）单位槽位 */\n    SetAllUnitTypeSlots(slots) {\n        this.NbShops.forEach(x => x.units = new ArrayList(slots));\n    }\n    NbShops = new ArrayList();\n    /* native_decl */\n    SetItemTypeSlots(whichUnit, slots) {\n        whichUnit.items = new ArrayList(slots);\n    }\n    /* native_decl */\n    SetUnitTypeSlots(whichUnit, slots) {\n        whichUnit.units = new ArrayList(slots);\n    }\n    /* native_decl */\n    GetUnitUserData(whichUnit) {\n        return whichUnit.data;\n    }\n    /* native_decl */\n    SetUnitUserData(whichUnit, data) {\n        whichUnit.data = data;\n    }\n    /* native_decl */\n    // Player(number:number){\n    //   console.log(\"[------decl-only------]\",\"Player\",arguments)\n    // }\n    /* native_decl */\n    // GetLocalPlayer(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetLocalPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsPlayerAlly(whichPlayer:player, otherPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsPlayerAlly\",arguments)\n    // }\n    /* native_decl */\n    // IsPlayerEnemy(whichPlayer:player, otherPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsPlayerEnemy\",arguments)\n    // }\n    /* native_decl */\n    // IsPlayerInForce(whichPlayer:player, whichForce:force){\n    //   console.log(\"[------decl-only------]\",\"IsPlayerInForce\",arguments)\n    // }\n    /* native_decl */\n    // IsPlayerObserver(whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsPlayerObserver\",arguments)\n    // }\n    /* native_decl */\n    // IsVisibleToPlayer(x:number, y:number, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsVisibleToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsLocationVisibleToPlayer(whichLocation:location, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsLocationVisibleToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsFoggedToPlayer(x:number, y:number, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsFoggedToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsLocationFoggedToPlayer(whichLocation:location, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsLocationFoggedToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsMaskedToPlayer(x:number, y:number, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsMaskedToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // IsLocationMaskedToPlayer(whichLocation:location, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"IsLocationMaskedToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // GetPlayerRace(whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"GetPlayerRace\",arguments)\n    // }\n    /* native_decl */\n    // GetPlayerId(whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"GetPlayerId\",arguments)\n    // }\n    /* native_decl */\n    GetPlayerUnitCount(whichPlayer, includeIncomplete) {\n        return whichPlayer.Units.size();\n    }\n    /* native_decl */\n    GetPlayerTypedUnitCount(whichPlayer, unitName, includeIncomplete, includeUpgrades) {\n        return whichPlayer.TypedUnits.filter(x => x.unitName == unitName).length;\n    }\n    /* 建造的数量 */\n    GetPlayerStructureCount(whichPlayer, includeIncomplete) {\n        return whichPlayer.Structures.size();\n    }\n    /* native_decl */\n    GetPlayerState(whichPlayer, whichPlayerState) {\n        return whichPlayer[whichPlayerState[1]];\n    }\n    /* native_decl */\n    GetPlayerScore(whichPlayer, whichPlayerScore) {\n        return whichPlayer[whichPlayerScore[1]];\n    }\n    /* native_decl */\n    GetPlayerAlliance(sourcePlayer, otherPlayer, whichAllianceSetting) {\n        return sourcePlayer.AlliancePlayers.any(x => x.player == otherPlayer && x.type == whichAllianceSetting[1]);\n    }\n    /* native_decl */\n    GetPlayerHandicap(whichPlayer) {\n        return whichPlayer['Handicap'];\n    }\n    /* native_decl */\n    GetPlayerHandicapXP(whichPlayer) {\n        return whichPlayer['HandicapXP'];\n    }\n    /* native_decl */\n    SetPlayerHandicap(whichPlayer, handicap) {\n        whichPlayer['Handicap'] = handicap;//number\n    }\n    /* native_decl */\n    SetPlayerHandicapXP(whichPlayer, handicap) {\n        whichPlayer['HandicapXP'] = handicap;//number\n    }\n    /* native_decl */\n    SetPlayerTechMaxAllowed(whichPlayer, techid, maximum) {\n        whichPlayer.TechMaxAllowed[techid] = maximum;\n    }\n    /* native_decl */\n    GetPlayerTechMaxAllowed(whichPlayer, techid) {\n        return whichPlayer.TechMaxAllowed[techid] || 10;\n    }\n    /* native_decl */\n    AddPlayerTechResearched(whichPlayer, techid, levels) {\n        whichPlayer.TechResearched.getAt(techid, i => new Map()).set('levels', levels);\n    }\n    /* native_decl */\n    SetPlayerTechResearched(whichPlayer, techid, setToLevel) {\n        whichPlayer.TechResearched.get(techid).set('levels', setToLevel);\n    }\n    /* native_decl */\n    GetPlayerTechResearched(whichPlayer, techid, specificonly) {\n        return whichPlayer['TechResearched'].get(techid);\n    }\n    /* native_decl */\n    GetPlayerTechCount(whichPlayer, techid, specificonly) {\n        return whichPlayer['TechResearched'].get(techid).entries.length;\n    }\n    /* native_decl */\n    // SetPlayerUnitsOwner(whichPlayer:player, newOwner:number){\n    //   console.log(\"[------decl-only------]\",\"SetPlayerUnitsOwner\",arguments)\n    // }\n    /* native_decl */\n    // CripplePlayer(whichPlayer:player, toWhichPlayers:force, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"CripplePlayer\",arguments)\n    // }\n    /* native_decl */\n    // SetPlayerAbilityAvailable(whichPlayer:player, abilid:number, avail:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetPlayerAbilityAvailable\",arguments)\n    // }\n    /* native_decl */\n    SetPlayerState(whichPlayer, whichPlayerState, value) {\n        whichPlayer[whichPlayerState[1]] = value;\n    }\n    /* native_decl */\n    // RemovePlayer(whichPlayer:player, gameResult:playergameresult){\n    //   console.log(\"[------decl-only------]\",\"RemovePlayer\",arguments)\n    // }\n    /* native_decl */\n    // CachePlayerHeroData(whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"CachePlayerHeroData\",arguments)\n    // }\n    /* native_decl */\n    // SetFogStateRect(forWhichPlayer:player, whichState:fogstate, where:rect, useSharedVision:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetFogStateRect\",arguments)\n    // }\n    /* native_decl */\n    // SetFogStateRadius(forWhichPlayer:player, whichState:fogstate, centerx:number, centerY:number, radius:number, useSharedVision:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetFogStateRadius\",arguments)\n    // }\n    /* native_decl */\n    // SetFogStateRadiusLoc(forWhichPlayer:player, whichState:fogstate, center:location, radius:number, useSharedVision:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetFogStateRadiusLoc\",arguments)\n    // }\n    /* native_decl */\n    // FogMaskEnable(enable:boolean){\n    //   console.log(\"[------decl-only------]\",\"FogMaskEnable\",arguments)\n    // }\n    /* native_decl */\n    IsFogMaskEnabled(/*void*/) {\n        return this.fogMaskEnabled;\n    }\n    fogMaskEnabled = false;\n    /* native_decl */\n    // FogEnable(enable:boolean){\n    //   console.log(\"[------decl-only------]\",\"FogEnable\",arguments)\n    // }\n    /* native_decl */\n    IsFogEnabled(/*void*/) {\n        return this.fogEnabled;\n    }\n    fogMaskEnabled = false;\n    /* native_decl */\n    // CreateFogModifierRect(forWhichPlayer:player, whichState:fogstate, where:rect, useSharedVision:boolean, afterUnits:boolean){\n    //   console.log(\"[------decl-only------]\",\"CreateFogModifierRect\",arguments)\n    // }\n    /* native_decl */\n    // CreateFogModifierRadius(forWhichPlayer:player, whichState:fogstate, centerx:number, centerY:number, radius:number, useSharedVision:boolean, afterUnits:boolean){\n    //   console.log(\"[------decl-only------]\",\"CreateFogModifierRadius\",arguments)\n    // }\n    /* native_decl */\n    // CreateFogModifierRadiusLoc(forWhichPlayer:player, whichState:fogstate, center:location, radius:number, useSharedVision:boolean, afterUnits:boolean){\n    //   console.log(\"[------decl-only------]\",\"CreateFogModifierRadiusLoc\",arguments)\n    // }\n    /* native_decl */\n    // DestroyFogModifier(whichFogModifier:fogmodifier){\n    //   console.log(\"[------decl-only------]\",\"DestroyFogModifier\",arguments)\n    // }\n    /* native_decl */\n    // FogModifierStart(whichFogModifier:fogmodifier){\n    //   console.log(\"[------decl-only------]\",\"FogModifierStart\",arguments)\n    // }\n    /* native_decl */\n    // FogModifierStop(whichFogModifier:fogmodifier){\n    //   console.log(\"[------decl-only------]\",\"FogModifierStop\",arguments)\n    // }\n    /* native_decl */\n    VersionGet(/*void*/) {\n        console.log('Use version', 'VERSION_FROZEN_THRONE')\n        return VERSION_FROZEN_THRONE;\n    }\n    /* native_decl */\n    // VersionCompatible(whichVersion:version){\n    //   console.log(\"[------decl-only------]\",\"VersionCompatible\",arguments)\n    // }\n    /* native_decl */\n    // VersionSupported(whichVersion:version){\n    //   console.log(\"[------decl-only------]\",\"VersionSupported\",arguments)\n    // }\n    /* native_decl */\n    // EndGame(doScoreScreen:boolean){\n    //   console.log(\"[------decl-only------]\",\"EndGame\",arguments)\n    // }\n    /* native_decl */\n    // ChangeLevel(newLevel:string, doScoreScreen:boolean){\n    //   console.log(\"[------decl-only------]\",\"ChangeLevel\",arguments)\n    // }\n    /* native_decl */\n    // RestartGame(doScoreScreen:boolean){\n    //   console.log(\"[------decl-only------]\",\"RestartGame\",arguments)\n    // }\n    /* native_decl */\n    // ReloadGame(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ReloadGame\",arguments)\n    // }\n    /* native_decl */\n    // SetCampaignMenuRace(r:race){\n    //   console.log(\"[------decl-only------]\",\"SetCampaignMenuRace\",arguments)\n    // }\n    /* native_decl */\n    // SetCampaignMenuRaceEx(campaignIndex:number){\n    //   console.log(\"[------decl-only------]\",\"SetCampaignMenuRaceEx\",arguments)\n    // }\n    /* native_decl */\n    // ForceCampaignSelectScreen(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ForceCampaignSelectScreen\",arguments)\n    // }\n    /* native_decl */\n    // LoadGame(saveFileName:string, doScoreScreen:boolean){\n    //   console.log(\"[------decl-only------]\",\"LoadGame\",arguments)\n    // }\n    /* native_decl */\n    // SaveGame(saveFileName:string){\n    //   console.log(\"[------decl-only------]\",\"SaveGame\",arguments)\n    // }\n    /* native_decl */\n    // RenameSaveDirectory(sourceDirName:string, destDirName:string){\n    //   console.log(\"[------decl-only------]\",\"RenameSaveDirectory\",arguments)\n    // }\n    /* native_decl */\n    // RemoveSaveDirectory(sourceDirName:string){\n    //   console.log(\"[------decl-only------]\",\"RemoveSaveDirectory\",arguments)\n    // }\n    /* native_decl */\n    // CopySaveGame(sourceSaveName:string, destSaveName:string){\n    //   console.log(\"[------decl-only------]\",\"CopySaveGame\",arguments)\n    // }\n    /* native_decl */\n    // SaveGameExists(saveName:string){\n    //   console.log(\"[------decl-only------]\",\"SaveGameExists\",arguments)\n    // }\n    /* native_decl */\n    // SyncSelections(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"SyncSelections\",arguments)\n    // }\n    /* native_decl */\n    SetFloatGameState(whichFloatGameState, value) {\n        this.gameState.set(whichFloatGameState[1], value);\n    }\n    /* native_decl */\n    GetFloatGameState(whichFloatGameState) {\n        return this.gameState.getNumber(whichFloatGameState[1]);\n    }\n    /* native_decl */\n    SetIntegerGameState(whichIntegerGameState, value) {\n        this.gameState.set(whichIntegerGameState[1], value);\n    }\n    /* native_decl */\n    GetIntegerGameState(whichIntegerGameState) {\n        return this.gameState.getNumber(whichIntegerGameState[1]);\n    }\n    /* native_decl */\n    // SetTutorialCleared(cleared:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetTutorialCleared\",arguments)\n    // }\n    /* native_decl */\n    // SetMissionAvailable(campaignNumber:number, missionNumber:number, available:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetMissionAvailable\",arguments)\n    // }\n    /* native_decl */\n    // SetCampaignAvailable(campaignNumber:number, available:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetCampaignAvailable\",arguments)\n    // }\n    /* native_decl */\n    // SetOpCinematicAvailable(campaignNumber:number, available:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetOpCinematicAvailable\",arguments)\n    // }\n    /* native_decl */\n    // SetEdCinematicAvailable(campaignNumber:number, available:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetEdCinematicAvailable\",arguments)\n    // }\n    /* native_decl */\n    // GetDefaultDifficulty(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetDefaultDifficulty\",arguments)\n    // }\n    /* native_decl */\n    // SetDefaultDifficulty(g:gamedifficulty){\n    //   console.log(\"[------decl-only------]\",\"SetDefaultDifficulty\",arguments)\n    // }\n    /* native_decl */\n    // SetCustomCampaignButtonVisible(whichButton:number, visible:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetCustomCampaignButtonVisible\",arguments)\n    // }\n    /* native_decl */\n    // GetCustomCampaignButtonVisible(whichButton:number){\n    //   console.log(\"[------decl-only------]\",\"GetCustomCampaignButtonVisible\",arguments)\n    // }\n    /* native_decl */\n    // DoNotSaveReplay(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"DoNotSaveReplay\",arguments)\n    // }\n    /* native_decl */\n    // DialogCreate(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"DialogCreate\",arguments)\n    // }\n    /* native_decl */\n    // DialogDestroy(whichDialog:dialog){\n    //   console.log(\"[------decl-only------]\",\"DialogDestroy\",arguments)\n    // }\n    /* native_decl */\n    // DialogClear(whichDialog:dialog){\n    //   console.log(\"[------decl-only------]\",\"DialogClear\",arguments)\n    // }\n    /* native_decl */\n    // DialogSetMessage(whichDialog:dialog, messageText:string){\n    //   console.log(\"[------decl-only------]\",\"DialogSetMessage\",arguments)\n    // }\n    /* native_decl */\n    // DialogAddButton(whichDialog:dialog, buttonText:string, hotkey:number){\n    //   console.log(\"[------decl-only------]\",\"DialogAddButton\",arguments)\n    // }\n    /* native_decl */\n    // DialogAddQuitButton(whichDialog:dialog, doScoreScreen:boolean, buttonText:string, hotkey:number){\n    //   console.log(\"[------decl-only------]\",\"DialogAddQuitButton\",arguments)\n    // }\n    /* native_decl */\n    // DialogDisplay(whichPlayer:player, whichDialog:dialog, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"DialogDisplay\",arguments)\n    // }\n    /* native_decl */\n    // ReloadGameCachesFromDisk(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ReloadGameCachesFromDisk\",arguments)\n    // }\n    /* native_decl */\n    // InitGameCache(campaignFile:string){\n    //   console.log(\"[------decl-only------]\",\"InitGameCache\",arguments)\n    // }\n    /* native_decl */\n    // SaveGameCache(whichCache:gamecache){\n    //   console.log(\"[------decl-only------]\",\"SaveGameCache\",arguments)\n    // }\n    /* native_decl */\n    // StoreInteger(cache:gamecache, missionKey:string, key:string, value:number){\n    //   console.log(\"[------decl-only------]\",\"StoreInteger\",arguments)\n    // }\n    /* native_decl */\n    // StoreReal(cache:gamecache, missionKey:string, key:string, value:number){\n    //   console.log(\"[------decl-only------]\",\"StoreReal\",arguments)\n    // }\n    /* native_decl */\n    // StoreBoolean(cache:gamecache, missionKey:string, key:string, value:boolean){\n    //   console.log(\"[------decl-only------]\",\"StoreBoolean\",arguments)\n    // }\n    /* native_decl */\n    // StoreUnit(cache:gamecache, missionKey:string, key:string, whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"StoreUnit\",arguments)\n    // }\n    /* native_decl */\n    // StoreString(cache:gamecache, missionKey:string, key:string, value:string){\n    //   console.log(\"[------decl-only------]\",\"StoreString\",arguments)\n    // }\n    /* native_decl */\n    // SyncStoredInteger(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"SyncStoredInteger\",arguments)\n    // }\n    /* native_decl */\n    // SyncStoredReal(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"SyncStoredReal\",arguments)\n    // }\n    /* native_decl */\n    // SyncStoredBoolean(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"SyncStoredBoolean\",arguments)\n    // }\n    /* native_decl */\n    // SyncStoredUnit(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"SyncStoredUnit\",arguments)\n    // }\n    /* native_decl */\n    // SyncStoredString(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"SyncStoredString\",arguments)\n    // }\n    /* native_decl */\n    // HaveStoredInteger(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"HaveStoredInteger\",arguments)\n    // }\n    /* native_decl */\n    // HaveStoredReal(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"HaveStoredReal\",arguments)\n    // }\n    /* native_decl */\n    // HaveStoredBoolean(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"HaveStoredBoolean\",arguments)\n    // }\n    /* native_decl */\n    // HaveStoredUnit(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"HaveStoredUnit\",arguments)\n    // }\n    /* native_decl */\n    // HaveStoredString(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"HaveStoredString\",arguments)\n    // }\n    /* native_decl */\n    // FlushGameCache(cache:gamecache){\n    //   console.log(\"[------decl-only------]\",\"FlushGameCache\",arguments)\n    // }\n    /* native_decl */\n    // FlushStoredMission(cache:gamecache, missionKey:string){\n    //   console.log(\"[------decl-only------]\",\"FlushStoredMission\",arguments)\n    // }\n    /* native_decl */\n    // FlushStoredInteger(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"FlushStoredInteger\",arguments)\n    // }\n    /* native_decl */\n    // FlushStoredReal(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"FlushStoredReal\",arguments)\n    // }\n    /* native_decl */\n    // FlushStoredBoolean(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"FlushStoredBoolean\",arguments)\n    // }\n    /* native_decl */\n    // FlushStoredUnit(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"FlushStoredUnit\",arguments)\n    // }\n    /* native_decl */\n    // FlushStoredString(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"FlushStoredString\",arguments)\n    // }\n    /* native_decl */\n    // GetStoredInteger(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"GetStoredInteger\",arguments)\n    // }\n    /* native_decl */\n    // GetStoredReal(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"GetStoredReal\",arguments)\n    // }\n    /* native_decl */\n    // GetStoredBoolean(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"GetStoredBoolean\",arguments)\n    // }\n    /* native_decl */\n    // GetStoredString(cache:gamecache, missionKey:string, key:string){\n    //   console.log(\"[------decl-only------]\",\"GetStoredString\",arguments)\n    // }\n    /* native_decl */\n    // RestoreUnit(cache:gamecache, missionKey:string, key:string, forWhichPlayer:player, x:number, y:number, facing:number){\n    //   console.log(\"[------decl-only------]\",\"RestoreUnit\",arguments)\n    // }\n    /* native_decl */\n    // InitHashtable(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"InitHashtable\",arguments)\n    // }\n    /* native_decl */\n    // SaveInteger(table:hashtable, parentKey:number, childKey:number, value:number){\n    //   console.log(\"[------decl-only------]\",\"SaveInteger\",arguments)\n    // }\n    /* native_decl */\n    // SaveReal(table:hashtable, parentKey:number, childKey:number, value:number){\n    //   console.log(\"[------decl-only------]\",\"SaveReal\",arguments)\n    // }\n    /* native_decl */\n    // SaveBoolean(table:hashtable, parentKey:number, childKey:number, value:boolean){\n    //   console.log(\"[------decl-only------]\",\"SaveBoolean\",arguments)\n    // }\n    /* native_decl */\n    // SaveStr(table:hashtable, parentKey:number, childKey:number, value:string){\n    //   console.log(\"[------decl-only------]\",\"SaveStr\",arguments)\n    // }\n    /* native_decl */\n    // SavePlayerHandle(table:hashtable, parentKey:number, childKey:number, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"SavePlayerHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveWidgetHandle(table:hashtable, parentKey:number, childKey:number, whichWidget:widget){\n    //   console.log(\"[------decl-only------]\",\"SaveWidgetHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveDestructableHandle(table:hashtable, parentKey:number, childKey:number, whichDestructable:destructable){\n    //   console.log(\"[------decl-only------]\",\"SaveDestructableHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveItemHandle(table:hashtable, parentKey:number, childKey:number, whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"SaveItemHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveUnitHandle(table:hashtable, parentKey:number, childKey:number, whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"SaveUnitHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveAbilityHandle(table:hashtable, parentKey:number, childKey:number, whichAbility:ability){\n    //   console.log(\"[------decl-only------]\",\"SaveAbilityHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTimerHandle(table:hashtable, parentKey:number, childKey:number, whichTimer:timer){\n    //   console.log(\"[------decl-only------]\",\"SaveTimerHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTriggerHandle(table:hashtable, parentKey:number, childKey:number, whichTrigger:trigger){\n    //   console.log(\"[------decl-only------]\",\"SaveTriggerHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTriggerConditionHandle(table:hashtable, parentKey:number, childKey:number, whichTriggercondition:triggercondition){\n    //   console.log(\"[------decl-only------]\",\"SaveTriggerConditionHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTriggerActionHandle(table:hashtable, parentKey:number, childKey:number, whichTriggeraction:triggeraction){\n    //   console.log(\"[------decl-only------]\",\"SaveTriggerActionHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTriggerEventHandle(table:hashtable, parentKey:number, childKey:number, whichEvent:event){\n    //   console.log(\"[------decl-only------]\",\"SaveTriggerEventHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveForceHandle(table:hashtable, parentKey:number, childKey:number, whichForce:force){\n    //   console.log(\"[------decl-only------]\",\"SaveForceHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveGroupHandle(table:hashtable, parentKey:number, childKey:number, whichGroup:group){\n    //   console.log(\"[------decl-only------]\",\"SaveGroupHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveLocationHandle(table:hashtable, parentKey:number, childKey:number, whichLocation:location){\n    //   console.log(\"[------decl-only------]\",\"SaveLocationHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveRectHandle(table:hashtable, parentKey:number, childKey:number, whichRect:rect){\n    //   console.log(\"[------decl-only------]\",\"SaveRectHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveBooleanExprHandle(table:hashtable, parentKey:number, childKey:number, whichBoolexpr:boolexpr){\n    //   console.log(\"[------decl-only------]\",\"SaveBooleanExprHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveSoundHandle(table:hashtable, parentKey:number, childKey:number, whichSound:sound){\n    //   console.log(\"[------decl-only------]\",\"SaveSoundHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveEffectHandle(table:hashtable, parentKey:number, childKey:number, whichEffect:effect){\n    //   console.log(\"[------decl-only------]\",\"SaveEffectHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveUnitPoolHandle(table:hashtable, parentKey:number, childKey:number, whichUnitpool:unitpool){\n    //   console.log(\"[------decl-only------]\",\"SaveUnitPoolHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveItemPoolHandle(table:hashtable, parentKey:number, childKey:number, whichItempool:itempool){\n    //   console.log(\"[------decl-only------]\",\"SaveItemPoolHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveQuestHandle(table:hashtable, parentKey:number, childKey:number, whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"SaveQuestHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveQuestItemHandle(table:hashtable, parentKey:number, childKey:number, whichQuestitem:questitem){\n    //   console.log(\"[------decl-only------]\",\"SaveQuestItemHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveDefeatConditionHandle(table:hashtable, parentKey:number, childKey:number, whichDefeatcondition:defeatcondition){\n    //   console.log(\"[------decl-only------]\",\"SaveDefeatConditionHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTimerDialogHandle(table:hashtable, parentKey:number, childKey:number, whichTimerdialog:timerdialog){\n    //   console.log(\"[------decl-only------]\",\"SaveTimerDialogHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveLeaderboardHandle(table:hashtable, parentKey:number, childKey:number, whichLeaderboard:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"SaveLeaderboardHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveMultiboardHandle(table:hashtable, parentKey:number, childKey:number, whichMultiboard:multiboard){\n    //   console.log(\"[------decl-only------]\",\"SaveMultiboardHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveMultiboardItemHandle(table:hashtable, parentKey:number, childKey:number, whichMultiboarditem:multiboarditem){\n    //   console.log(\"[------decl-only------]\",\"SaveMultiboardItemHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTrackableHandle(table:hashtable, parentKey:number, childKey:number, whichTrackable:trackable){\n    //   console.log(\"[------decl-only------]\",\"SaveTrackableHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveDialogHandle(table:hashtable, parentKey:number, childKey:number, whichDialog:dialog){\n    //   console.log(\"[------decl-only------]\",\"SaveDialogHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveButtonHandle(table:hashtable, parentKey:number, childKey:number, whichButton:button){\n    //   console.log(\"[------decl-only------]\",\"SaveButtonHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveTextTagHandle(table:hashtable, parentKey:number, childKey:number, whichTexttag:texttag){\n    //   console.log(\"[------decl-only------]\",\"SaveTextTagHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveLightningHandle(table:hashtable, parentKey:number, childKey:number, whichLightning:lightning){\n    //   console.log(\"[------decl-only------]\",\"SaveLightningHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveImageHandle(table:hashtable, parentKey:number, childKey:number, whichImage:image){\n    //   console.log(\"[------decl-only------]\",\"SaveImageHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveUbersplatHandle(table:hashtable, parentKey:number, childKey:number, whichUbersplat:ubersplat){\n    //   console.log(\"[------decl-only------]\",\"SaveUbersplatHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveRegionHandle(table:hashtable, parentKey:number, childKey:number, whichRegion:region){\n    //   console.log(\"[------decl-only------]\",\"SaveRegionHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveFogStateHandle(table:hashtable, parentKey:number, childKey:number, whichFogState:fogstate){\n    //   console.log(\"[------decl-only------]\",\"SaveFogStateHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveFogModifierHandle(table:hashtable, parentKey:number, childKey:number, whichFogModifier:fogmodifier){\n    //   console.log(\"[------decl-only------]\",\"SaveFogModifierHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveAgentHandle(table:hashtable, parentKey:number, childKey:number, whichAgent:agent){\n    //   console.log(\"[------decl-only------]\",\"SaveAgentHandle\",arguments)\n    // }\n    /* native_decl */\n    // SaveHashtableHandle(table:hashtable, parentKey:number, childKey:number, whichHashtable:hashtable){\n    //   console.log(\"[------decl-only------]\",\"SaveHashtableHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadInteger(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadInteger\",arguments)\n    // }\n    /* native_decl */\n    // LoadReal(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadReal\",arguments)\n    // }\n    /* native_decl */\n    // LoadBoolean(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadBoolean\",arguments)\n    // }\n    /* native_decl */\n    // LoadStr(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadStr\",arguments)\n    // }\n    /* native_decl */\n    // LoadPlayerHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadPlayerHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadWidgetHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadWidgetHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadDestructableHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadDestructableHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadItemHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadItemHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadUnitHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadUnitHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadAbilityHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadAbilityHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTimerHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTimerHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTriggerHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTriggerHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTriggerConditionHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTriggerConditionHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTriggerActionHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTriggerActionHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTriggerEventHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTriggerEventHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadForceHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadForceHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadGroupHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadGroupHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadLocationHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadLocationHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadRectHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadRectHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadBooleanExprHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadBooleanExprHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadSoundHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadSoundHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadEffectHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadEffectHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadUnitPoolHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadUnitPoolHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadItemPoolHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadItemPoolHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadQuestHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadQuestHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadQuestItemHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadQuestItemHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadDefeatConditionHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadDefeatConditionHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTimerDialogHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTimerDialogHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadLeaderboardHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadLeaderboardHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadMultiboardHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadMultiboardHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadMultiboardItemHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadMultiboardItemHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTrackableHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTrackableHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadDialogHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadDialogHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadButtonHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadButtonHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadTextTagHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadTextTagHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadLightningHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadLightningHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadImageHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadImageHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadUbersplatHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadUbersplatHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadRegionHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadRegionHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadFogStateHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadFogStateHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadFogModifierHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadFogModifierHandle\",arguments)\n    // }\n    /* native_decl */\n    // LoadHashtableHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"LoadHashtableHandle\",arguments)\n    // }\n    /* native_decl */\n    // HaveSavedInteger(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"HaveSavedInteger\",arguments)\n    // }\n    /* native_decl */\n    // HaveSavedReal(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"HaveSavedReal\",arguments)\n    // }\n    /* native_decl */\n    // HaveSavedBoolean(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"HaveSavedBoolean\",arguments)\n    // }\n    /* native_decl */\n    // HaveSavedString(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"HaveSavedString\",arguments)\n    // }\n    /* native_decl */\n    // HaveSavedHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"HaveSavedHandle\",arguments)\n    // }\n    /* native_decl */\n    // RemoveSavedInteger(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"RemoveSavedInteger\",arguments)\n    // }\n    /* native_decl */\n    // RemoveSavedReal(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"RemoveSavedReal\",arguments)\n    // }\n    /* native_decl */\n    // RemoveSavedBoolean(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"RemoveSavedBoolean\",arguments)\n    // }\n    /* native_decl */\n    // RemoveSavedString(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"RemoveSavedString\",arguments)\n    // }\n    /* native_decl */\n    // RemoveSavedHandle(table:hashtable, parentKey:number, childKey:number){\n    //   console.log(\"[------decl-only------]\",\"RemoveSavedHandle\",arguments)\n    // }\n    /* native_decl */\n    // FlushParentHashtable(table:hashtable){\n    //   console.log(\"[------decl-only------]\",\"FlushParentHashtable\",arguments)\n    // }\n    /* native_decl */\n    // FlushChildHashtable(table:hashtable, parentKey:number){\n    //   console.log(\"[------decl-only------]\",\"FlushChildHashtable\",arguments)\n    // }\n    /* native_decl */\n    // GetRandomInt(lowBound:number, highBound:number){\n    //   console.log(\"[------decl-only------]\",\"GetRandomInt\",arguments)\n    // }\n    /* native_decl */\n    // GetRandomReal(lowBound:number, highBound:number){\n    //   console.log(\"[------decl-only------]\",\"GetRandomReal\",arguments)\n    // }\n    /* native_decl */\n    // CreateUnitPool(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateUnitPool\",arguments)\n    // }\n    /* native_decl */\n    // DestroyUnitPool(whichPool:unitpool){\n    //   console.log(\"[------decl-only------]\",\"DestroyUnitPool\",arguments)\n    // }\n    /* native_decl */\n    // UnitPoolAddUnitType(whichPool:unitpool, unitId:number, weight:number){\n    //   console.log(\"[------decl-only------]\",\"UnitPoolAddUnitType\",arguments)\n    // }\n    /* native_decl */\n    // UnitPoolRemoveUnitType(whichPool:unitpool, unitId:number){\n    //   console.log(\"[------decl-only------]\",\"UnitPoolRemoveUnitType\",arguments)\n    // }\n    /* native_decl */\n    // PlaceRandomUnit(whichPool:unitpool, forWhichPlayer:player, x:number, y:number, facing:number){\n    //   console.log(\"[------decl-only------]\",\"PlaceRandomUnit\",arguments)\n    // }\n    /* native_decl */\n    // CreateItemPool(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateItemPool\",arguments)\n    // }\n    /* native_decl */\n    // DestroyItemPool(whichItemPool:itempool){\n    //   console.log(\"[------decl-only------]\",\"DestroyItemPool\",arguments)\n    // }\n    /* native_decl */\n    // ItemPoolAddItemType(whichItemPool:itempool, itemId:number, weight:number){\n    //   console.log(\"[------decl-only------]\",\"ItemPoolAddItemType\",arguments)\n    // }\n    /* native_decl */\n    // ItemPoolRemoveItemType(whichItemPool:itempool, itemId:number){\n    //   console.log(\"[------decl-only------]\",\"ItemPoolRemoveItemType\",arguments)\n    // }\n    /* native_decl */\n    // PlaceRandomItem(whichItemPool:itempool, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"PlaceRandomItem\",arguments)\n    // }\n    /* native_decl */\n    // ChooseRandomCreep(level:number){\n    //   console.log(\"[------decl-only------]\",\"ChooseRandomCreep\",arguments)\n    // }\n    /* native_decl */\n    // ChooseRandomNPBuilding(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ChooseRandomNPBuilding\",arguments)\n    // }\n    /* native_decl */\n    // ChooseRandomItem(level:number){\n    //   console.log(\"[------decl-only------]\",\"ChooseRandomItem\",arguments)\n    // }\n    /* native_decl */\n    // ChooseRandomItemEx(whichType:itemtype, level:number){\n    //   console.log(\"[------decl-only------]\",\"ChooseRandomItemEx\",arguments)\n    // }\n    /* native_decl */\n    // SetRandomSeed(seed:number){\n    //   console.log(\"[------decl-only------]\",\"SetRandomSeed\",arguments)\n    // }\n    /* native_decl */\n    // SetTerrainFog(a:number, b:number, c:number, d:number, e:number){\n    //   console.log(\"[------decl-only------]\",\"SetTerrainFog\",arguments)\n    // }\n    /* native_decl */\n    // ResetTerrainFog(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ResetTerrainFog\",arguments)\n    // }\n    /* native_decl */\n    // SetUnitFog(a:number, b:number, c:number, d:number, e:number){\n    //   console.log(\"[------decl-only------]\",\"SetUnitFog\",arguments)\n    // }\n    /* native_decl */\n    SetTerrainFogEx(style, zstart, zend, density, red, green, blue) {\n        this.gameState['terrainFogEx'] = {\n            style,\n            zstart,\n            zend,\n            density,\n            red,\n            green,\n            blue\n        }\n    }\n    /* native_decl */\n    // DisplayTextToPlayer(toPlayer:player, x:number, y:number, message:string){\n    //   console.log(\"[------decl-only------]\",\"DisplayTextToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // DisplayTimedTextToPlayer(toPlayer:player, x:number, y:number, duration:number, message:string){\n    //   console.log(\"[------decl-only------]\",\"DisplayTimedTextToPlayer\",arguments)\n    // }\n    /* native_decl */\n    // DisplayTimedTextFromPlayer(toPlayer:player, x:number, y:number, duration:number, message:string){\n    //   console.log(\"[------decl-only------]\",\"DisplayTimedTextFromPlayer\",arguments)\n    // }\n    /* native_decl */\n    // ClearTextMessages(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ClearTextMessages\",arguments)\n    // }\n    /* native_decl */\n    SetDayNightModels(terrainDNCFile, unitDNCFile) {\n        // 没有效果\n        // this.app.map.loadDayNightModels(terrainDNCFile, unitDNCFile);\n    }\n    /* native_decl */\n    // SetSkyModel(skyModelFile:string){\n    //   console.log(\"[------decl-only------]\",\"SetSkyModel\",arguments)\n    // }\n    /* native_decl */\n    // EnableUserControl(b:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableUserControl\",arguments)\n    // }\n    /* native_decl */\n    // EnableUserUI(b:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableUserUI\",arguments)\n    // }\n    /* native_decl */\n    // SuspendTimeOfDay(b:boolean){\n    //   console.log(\"[------decl-only------]\",\"SuspendTimeOfDay\",arguments)\n    // }\n    /* native_decl */\n    // SetTimeOfDayScale(r:number){\n    //   console.log(\"[------decl-only------]\",\"SetTimeOfDayScale\",arguments)\n    // }\n    /* native_decl */\n    // GetTimeOfDayScale(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetTimeOfDayScale\",arguments)\n    // }\n    /* native_decl */\n    // ShowInterface(flag:boolean, fadeDuration:number){\n    //   console.log(\"[------decl-only------]\",\"ShowInterface\",arguments)\n    // }\n    /* native_decl */\n    // PauseGame(flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"PauseGame\",arguments)\n    // }\n    /* native_decl */\n    // UnitAddIndicator(whichUnit:unit, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"UnitAddIndicator\",arguments)\n    // }\n    /* native_decl */\n    // AddIndicator(whichWidget:widget, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"AddIndicator\",arguments)\n    // }\n    /* native_decl */\n    // PingMinimap(x:number, y:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"PingMinimap\",arguments)\n    // }\n    /* native_decl */\n    // PingMinimapEx(x:number, y:number, duration:number, red:number, green:number, blue:number, extraEffects:boolean){\n    //   console.log(\"[------decl-only------]\",\"PingMinimapEx\",arguments)\n    // }\n    /* native_decl */\n    // EnableOcclusion(flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableOcclusion\",arguments)\n    // }\n    /* native_decl */\n    // SetIntroShotText(introText:string){\n    //   console.log(\"[------decl-only------]\",\"SetIntroShotText\",arguments)\n    // }\n    /* native_decl */\n    // SetIntroShotModel(introModelPath:string){\n    //   console.log(\"[------decl-only------]\",\"SetIntroShotModel\",arguments)\n    // }\n    /* native_decl */\n    // EnableWorldFogBoundary(b:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableWorldFogBoundary\",arguments)\n    // }\n    /* native_decl */\n    // PlayModelCinematic(modelName:string){\n    //   console.log(\"[------decl-only------]\",\"PlayModelCinematic\",arguments)\n    // }\n    /* native_decl */\n    // PlayCinematic(movieName:string){\n    //   console.log(\"[------decl-only------]\",\"PlayCinematic\",arguments)\n    // }\n    /* native_decl */\n    // ForceUIKey(key:string){\n    //   console.log(\"[------decl-only------]\",\"ForceUIKey\",arguments)\n    // }\n    /* native_decl */\n    // ForceUICancel(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ForceUICancel\",arguments)\n    // }\n    /* native_decl */\n    // DisplayLoadDialog(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"DisplayLoadDialog\",arguments)\n    // }\n    /* native_decl */\n    // SetAltMinimapIcon(iconPath:string){\n    //   console.log(\"[------decl-only------]\",\"SetAltMinimapIcon\",arguments)\n    // }\n    /* native_decl */\n    // DisableRestartMission(flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"DisableRestartMission\",arguments)\n    // }\n    /* native_decl */\n    // CreateTextTag(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateTextTag\",arguments)\n    // }\n    /* native_decl */\n    // DestroyTextTag(t:texttag){\n    //   console.log(\"[------decl-only------]\",\"DestroyTextTag\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagText(t:texttag, s:string, height:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagText\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagPos(t:texttag, x:number, y:number, heightOffset:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagPos\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagPosUnit(t:texttag, whichUnit:unit, heightOffset:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagPosUnit\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagColor(t:texttag, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagColor\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagVelocity(t:texttag, xvel:number, yvel:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagVelocity\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagVisibility(t:texttag, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagVisibility\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagSuspended(t:texttag, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagSuspended\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagPermanent(t:texttag, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagPermanent\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagAge(t:texttag, age:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagAge\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagLifespan(t:texttag, lifespan:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagLifespan\",arguments)\n    // }\n    /* native_decl */\n    // SetTextTagFadepoint(t:texttag, fadepoint:number){\n    //   console.log(\"[------decl-only------]\",\"SetTextTagFadepoint\",arguments)\n    // }\n    /* native_decl */\n    // SetReservedLocalHeroButtons(reserved:number){\n    //   console.log(\"[------decl-only------]\",\"SetReservedLocalHeroButtons\",arguments)\n    // }\n    /* native_decl */\n    // GetAllyColorFilterState(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetAllyColorFilterState\",arguments)\n    // }\n    /* native_decl */\n    // SetAllyColorFilterState(state:number){\n    //   console.log(\"[------decl-only------]\",\"SetAllyColorFilterState\",arguments)\n    // }\n    /* native_decl */\n    // GetCreepCampFilterState(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCreepCampFilterState\",arguments)\n    // }\n    /* native_decl */\n    // SetCreepCampFilterState(state:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetCreepCampFilterState\",arguments)\n    // }\n    /* native_decl */\n    // EnableMinimapFilterButtons(enableAlly:boolean, enableCreep:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableMinimapFilterButtons\",arguments)\n    // }\n    /* native_decl */\n    // EnableDragSelect(state:boolean, ui:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableDragSelect\",arguments)\n    // }\n    /* native_decl */\n    // EnablePreSelect(state:boolean, ui:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnablePreSelect\",arguments)\n    // }\n    /* native_decl */\n    // EnableSelect(state:boolean, ui:boolean){\n    //   console.log(\"[------decl-only------]\",\"EnableSelect\",arguments)\n    // }\n    /* native_decl */\n    // CreateTrackable(trackableModelPath:string, x:number, y:number, facing:number){\n    //   console.log(\"[------decl-only------]\",\"CreateTrackable\",arguments)\n    // }\n    /* native_decl */\n    // CreateQuest(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateQuest\",arguments)\n    // }\n    /* native_decl */\n    // DestroyQuest(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"DestroyQuest\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetTitle(whichQuest:quest, title:string){\n    //   console.log(\"[------decl-only------]\",\"QuestSetTitle\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetDescription(whichQuest:quest, description:string){\n    //   console.log(\"[------decl-only------]\",\"QuestSetDescription\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetIconPath(whichQuest:quest, iconPath:string){\n    //   console.log(\"[------decl-only------]\",\"QuestSetIconPath\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetRequired(whichQuest:quest, required:boolean){\n    //   console.log(\"[------decl-only------]\",\"QuestSetRequired\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetCompleted(whichQuest:quest, completed:boolean){\n    //   console.log(\"[------decl-only------]\",\"QuestSetCompleted\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetDiscovered(whichQuest:quest, discovered:boolean){\n    //   console.log(\"[------decl-only------]\",\"QuestSetDiscovered\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetFailed(whichQuest:quest, failed:boolean){\n    //   console.log(\"[------decl-only------]\",\"QuestSetFailed\",arguments)\n    // }\n    /* native_decl */\n    // QuestSetEnabled(whichQuest:quest, enabled:boolean){\n    //   console.log(\"[------decl-only------]\",\"QuestSetEnabled\",arguments)\n    // }\n    /* native_decl */\n    // IsQuestRequired(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"IsQuestRequired\",arguments)\n    // }\n    /* native_decl */\n    // IsQuestCompleted(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"IsQuestCompleted\",arguments)\n    // }\n    /* native_decl */\n    // IsQuestDiscovered(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"IsQuestDiscovered\",arguments)\n    // }\n    /* native_decl */\n    // IsQuestFailed(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"IsQuestFailed\",arguments)\n    // }\n    /* native_decl */\n    // IsQuestEnabled(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"IsQuestEnabled\",arguments)\n    // }\n    /* native_decl */\n    // QuestCreateItem(whichQuest:quest){\n    //   console.log(\"[------decl-only------]\",\"QuestCreateItem\",arguments)\n    // }\n    /* native_decl */\n    // QuestItemSetDescription(whichQuestItem:questitem, description:string){\n    //   console.log(\"[------decl-only------]\",\"QuestItemSetDescription\",arguments)\n    // }\n    /* native_decl */\n    // QuestItemSetCompleted(whichQuestItem:questitem, completed:boolean){\n    //   console.log(\"[------decl-only------]\",\"QuestItemSetCompleted\",arguments)\n    // }\n    /* native_decl */\n    // IsQuestItemCompleted(whichQuestItem:questitem){\n    //   console.log(\"[------decl-only------]\",\"IsQuestItemCompleted\",arguments)\n    // }\n    /* native_decl */\n    // CreateDefeatCondition(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateDefeatCondition\",arguments)\n    // }\n    /* native_decl */\n    // DestroyDefeatCondition(whichCondition:defeatcondition){\n    //   console.log(\"[------decl-only------]\",\"DestroyDefeatCondition\",arguments)\n    // }\n    /* native_decl */\n    // DefeatConditionSetDescription(whichCondition:defeatcondition, description:string){\n    //   console.log(\"[------decl-only------]\",\"DefeatConditionSetDescription\",arguments)\n    // }\n    /* native_decl */\n    // FlashQuestDialogButton(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"FlashQuestDialogButton\",arguments)\n    // }\n    /* native_decl */\n    // ForceQuestDialogUpdate(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ForceQuestDialogUpdate\",arguments)\n    // }\n    /* native_decl */\n    CreateTimerDialog(t) {\n        let d = {\n            type: 'timerdialog',\n            creationArgs: [...arguments],\n            execute: () => {\n                alert('timerDialog');\n            }\n        }\n        if (t) {\n            t.listenExpire(d)\n        }\n        return d;\n    }\n    /* native_decl */\n    DestroyTimerDialog(whichDialog) {\n        // do nothing.\n    }\n    /* native_decl */\n    TimerDialogSetTitle(whichDialog, title) {\n        whichDialog.title = title;\n    }\n    /* native_decl */\n    TimerDialogSetTitleColor(whichDialog, red, green, blue, alpha) {\n        whichDialog.titleColor = [red, green, blue, alpha, 'rgba']\n    }\n    /* native_decl */\n    TimerDialogSetTimeColor(whichDialog, red, green, blue, alpha) {\n        whichDialog.timeColor = [red, green, blue, alpha, 'rgba']\n    }\n    /* native_decl */\n    TimerDialogSetSpeed(whichDialog, speedMultFactor) {\n        whichDialog.speedMultFactor = speedMultFactor;\n    }\n    /* native_decl */\n    TimerDialogDisplay(whichDialog, display) {\n        this.app.showTimerDialog(whichDialog, display);\n    }\n    /* native_decl */\n    IsTimerDialogDisplayed(whichDialog) {\n        return whichDialog.displayed;\n    }\n    /* native_decl */\n    TimerDialogSetRealTimeRemaining(whichDialog, timeRemaining) {\n        whichDialog.timeRemaining = timeRemaining;\n    }\n    /* native_decl */\n    // CreateLeaderboard(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateLeaderboard\",arguments)\n    // }\n    /* native_decl */\n    // DestroyLeaderboard(lb:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"DestroyLeaderboard\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardDisplay(lb:leaderboard, show:boolean){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardDisplay\",arguments)\n    // }\n    /* native_decl */\n    // IsLeaderboardDisplayed(lb:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"IsLeaderboardDisplayed\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardGetItemCount(lb:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardGetItemCount\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetSizeByItemCount(lb:leaderboard, count:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetSizeByItemCount\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardAddItem(lb:leaderboard, label:string, value:number, p:player){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardAddItem\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardRemoveItem(lb:leaderboard, index:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardRemoveItem\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardRemovePlayerItem(lb:leaderboard, p:player){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardRemovePlayerItem\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardClear(lb:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardClear\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSortItemsByValue(lb:leaderboard, ascending:boolean){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSortItemsByValue\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSortItemsByPlayer(lb:leaderboard, ascending:boolean){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSortItemsByPlayer\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSortItemsByLabel(lb:leaderboard, ascending:boolean){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSortItemsByLabel\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardHasPlayerItem(lb:leaderboard, p:player){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardHasPlayerItem\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardGetPlayerIndex(lb:leaderboard, p:player){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardGetPlayerIndex\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetLabel(lb:leaderboard, label:string){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetLabel\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardGetLabelText(lb:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardGetLabelText\",arguments)\n    // }\n    /* native_decl */\n    // PlayerSetLeaderboard(toPlayer:player, lb:leaderboard){\n    //   console.log(\"[------decl-only------]\",\"PlayerSetLeaderboard\",arguments)\n    // }\n    /* native_decl */\n    // PlayerGetLeaderboard(toPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"PlayerGetLeaderboard\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetLabelColor(lb:leaderboard, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetLabelColor\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetValueColor(lb:leaderboard, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetValueColor\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetStyle(lb:leaderboard, showLabel:boolean, showNames:boolean, showValues:boolean, showIcons:boolean){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetStyle\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetItemValue(lb:leaderboard, whichItem:number, val:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetItemValue\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetItemLabel(lb:leaderboard, whichItem:number, val:string){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetItemLabel\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetItemStyle(lb:leaderboard, whichItem:number, showLabel:boolean, showValue:boolean, showIcon:boolean){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetItemStyle\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetItemLabelColor(lb:leaderboard, whichItem:number, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetItemLabelColor\",arguments)\n    // }\n    /* native_decl */\n    // LeaderboardSetItemValueColor(lb:leaderboard, whichItem:number, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"LeaderboardSetItemValueColor\",arguments)\n    // }\n    /* native_decl */\n    // CreateMultiboard(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateMultiboard\",arguments)\n    // }\n    /* native_decl */\n    // DestroyMultiboard(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"DestroyMultiboard\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardDisplay(lb:multiboard, show:boolean){\n    //   console.log(\"[------decl-only------]\",\"MultiboardDisplay\",arguments)\n    // }\n    /* native_decl */\n    // IsMultiboardDisplayed(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"IsMultiboardDisplayed\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardMinimize(lb:multiboard, minimize:boolean){\n    //   console.log(\"[------decl-only------]\",\"MultiboardMinimize\",arguments)\n    // }\n    /* native_decl */\n    // IsMultiboardMinimized(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"IsMultiboardMinimized\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardClear(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"MultiboardClear\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetTitleText(lb:multiboard, label:string){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetTitleText\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardGetTitleText(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"MultiboardGetTitleText\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetTitleTextColor(lb:multiboard, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetTitleTextColor\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardGetRowCount(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"MultiboardGetRowCount\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardGetColumnCount(lb:multiboard){\n    //   console.log(\"[------decl-only------]\",\"MultiboardGetColumnCount\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetColumnCount(lb:multiboard, count:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetColumnCount\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetRowCount(lb:multiboard, count:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetRowCount\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemsStyle(lb:multiboard, showValues:boolean, showIcons:boolean){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemsStyle\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemsValue(lb:multiboard, value:string){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemsValue\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemsValueColor(lb:multiboard, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemsValueColor\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemsWidth(lb:multiboard, width:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemsWidth\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemsIcon(lb:multiboard, iconPath:string){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemsIcon\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardGetItem(lb:multiboard, row:number, column:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardGetItem\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardReleaseItem(mbi:multiboarditem){\n    //   console.log(\"[------decl-only------]\",\"MultiboardReleaseItem\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemStyle(mbi:multiboarditem, showValue:boolean, showIcon:boolean){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemStyle\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemValue(mbi:multiboarditem, val:string){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemValue\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemValueColor(mbi:multiboarditem, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemValueColor\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemWidth(mbi:multiboarditem, width:number){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemWidth\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSetItemIcon(mbi:multiboarditem, iconFileName:string){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSetItemIcon\",arguments)\n    // }\n    /* native_decl */\n    // MultiboardSuppressDisplay(flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"MultiboardSuppressDisplay\",arguments)\n    // }\n    /* native_decl */\n    // SetCameraPosition(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"SetCameraPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetCameraQuickPosition(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"SetCameraQuickPosition\",arguments)\n    // }\n    /* native_decl */\n    SetCameraBounds(x1, y1, x2, y2, x3, y3, x4, y4) {\n        this.gameState['cameraBounds'] = {\n            x1, y1,\n            x2, y2,\n            x3, y3,\n            x4, y4\n        }\n    }\n    /* native_decl */\n    // StopCamera(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"StopCamera\",arguments)\n    // }\n    /* native_decl */\n    // ResetToGameCamera(duration:number){\n    //   console.log(\"[------decl-only------]\",\"ResetToGameCamera\",arguments)\n    // }\n    /* native_decl */\n    // PanCameraTo(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"PanCameraTo\",arguments)\n    // }\n    /* native_decl */\n    // PanCameraToTimed(x:number, y:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"PanCameraToTimed\",arguments)\n    // }\n    /* native_decl */\n    // PanCameraToWithZ(x:number, y:number, zOffsetDest:number){\n    //   console.log(\"[------decl-only------]\",\"PanCameraToWithZ\",arguments)\n    // }\n    /* native_decl */\n    // PanCameraToTimedWithZ(x:number, y:number, zOffsetDest:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"PanCameraToTimedWithZ\",arguments)\n    // }\n    /* native_decl */\n    // SetCinematicCamera(cameraModelFile:string){\n    //   console.log(\"[------decl-only------]\",\"SetCinematicCamera\",arguments)\n    // }\n    /* native_decl */\n    // SetCameraRotateMode(x:number, y:number, radiansToSweep:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"SetCameraRotateMode\",arguments)\n    // }\n    /* native_decl */\n    // SetCameraField(whichField:camerafield, value:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"SetCameraField\",arguments)\n    // }\n    /* native_decl */\n    // AdjustCameraField(whichField:camerafield, offset:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"AdjustCameraField\",arguments)\n    // }\n    /* native_decl */\n    // SetCameraTargetController(whichUnit:unit, xoffset:number, yoffset:number, inheritOrientation:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetCameraTargetController\",arguments)\n    // }\n    /* native_decl */\n    // SetCameraOrientController(whichUnit:unit, xoffset:number, yoffset:number){\n    //   console.log(\"[------decl-only------]\",\"SetCameraOrientController\",arguments)\n    // }\n    /* native_decl */\n    // CreateCameraSetup(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"CreateCameraSetup\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupSetField(whichSetup:camerasetup, whichField:camerafield, value:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupSetField\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupGetField(whichSetup:camerasetup, whichField:camerafield){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupGetField\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupSetDestPosition(whichSetup:camerasetup, x:number, y:number, duration:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupSetDestPosition\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupGetDestPositionLoc(whichSetup:camerasetup){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupGetDestPositionLoc\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupGetDestPositionX(whichSetup:camerasetup){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupGetDestPositionX\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupGetDestPositionY(whichSetup:camerasetup){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupGetDestPositionY\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupApply(whichSetup:camerasetup, doPan:boolean, panTimed:boolean){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupApply\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupApplyWithZ(whichSetup:camerasetup, zDestOffset:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupApplyWithZ\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupApplyForceDuration(whichSetup:camerasetup, doPan:boolean, forceDuration:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupApplyForceDuration\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetupApplyForceDurationWithZ(whichSetup:camerasetup, zDestOffset:number, forceDuration:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetupApplyForceDurationWithZ\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetTargetNoise(mag:number, velocity:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetTargetNoise\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetSourceNoise(mag:number, velocity:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetSourceNoise\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetTargetNoiseEx(mag:number, velocity:number, vertOnly:boolean){\n    //   console.log(\"[------decl-only------]\",\"CameraSetTargetNoiseEx\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetSourceNoiseEx(mag:number, velocity:number, vertOnly:boolean){\n    //   console.log(\"[------decl-only------]\",\"CameraSetSourceNoiseEx\",arguments)\n    // }\n    /* native_decl */\n    // CameraSetSmoothingFactor(factor:number){\n    //   console.log(\"[------decl-only------]\",\"CameraSetSmoothingFactor\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterTexture(filename:string){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterTexture\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterBlendMode(whichMode:blendmode){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterBlendMode\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterTexMapFlags(whichFlags:texmapflags){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterTexMapFlags\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterStartUV(minu:number, minv:number, maxu:number, maxv:number){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterStartUV\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterEndUV(minu:number, minv:number, maxu:number, maxv:number){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterEndUV\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterStartColor(red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterStartColor\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterEndColor(red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterEndColor\",arguments)\n    // }\n    /* native_decl */\n    // SetCineFilterDuration(duration:number){\n    //   console.log(\"[------decl-only------]\",\"SetCineFilterDuration\",arguments)\n    // }\n    /* native_decl */\n    // DisplayCineFilter(flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"DisplayCineFilter\",arguments)\n    // }\n    /* native_decl */\n    // IsCineFilterDisplayed(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"IsCineFilterDisplayed\",arguments)\n    // }\n    /* native_decl */\n    // SetCinematicScene(portraitUnitId:number, color:playercolor, speakerTitle:string, text:string, sceneDuration:number, voiceoverDuration:number){\n    //   console.log(\"[------decl-only------]\",\"SetCinematicScene\",arguments)\n    // }\n    /* native_decl */\n    // EndCinematicScene(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"EndCinematicScene\",arguments)\n    // }\n    /* native_decl */\n    // ForceCinematicSubtitles(flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"ForceCinematicSubtitles\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraMargin(whichMargin:number){\n    //   console.log(\"[------decl-only------]\",\"GetCameraMargin\",arguments)\n    // }\n    /* native_decl */\n    GetCameraBoundMinX(/*void*/) {\n        return this.app.camera.rect[0];\n    }\n    /* native_decl */\n    GetCameraBoundMinY(/*void*/) {\n        return this.app.camera.rect[1];\n    }\n    /* native_decl */\n    GetCameraBoundMaxX(/*void*/) {\n        return this.app.camera.rect[2];\n    }\n    /* native_decl */\n    GetCameraBoundMaxY(/*void*/) {\n        return this.app.camera.rect[3];\n    }\n    /* native_decl */\n    // GetCameraField(whichField:camerafield){\n    //   console.log(\"[------decl-only------]\",\"GetCameraField\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraTargetPositionX(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraTargetPositionX\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraTargetPositionY(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraTargetPositionY\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraTargetPositionZ(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraTargetPositionZ\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraTargetPositionLoc(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraTargetPositionLoc\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraEyePositionX(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraEyePositionX\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraEyePositionY(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraEyePositionY\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraEyePositionZ(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraEyePositionZ\",arguments)\n    // }\n    /* native_decl */\n    // GetCameraEyePositionLoc(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"GetCameraEyePositionLoc\",arguments)\n    // }\n    /* native_decl */\n    NewSoundEnvironment(environmentName) {\n        this.gameState['soundEnv'] = {\n            environmentName\n        }\n    }\n    /* native_decl */\n    CreateSound(fileName, looping, is3D, stopwhenoutofrange, fadeInRate, fadeOutRate, eaxSetting) {\n        return {\n            fileName,\n            looping,\n            is3D,\n            stopwhenoutofrange,\n            fadeInRate,\n            fadeOutRate,\n            eaxSetting\n        }\n    }\n    /* native_decl */\n    // CreateSoundFilenameWithLabel(fileName:string, looping:boolean, is3D:boolean, stopwhenoutofrange:boolean, fadeInRate:number, fadeOutRate:number, SLKEntryName:string){\n    //   console.log(\"[------decl-only------]\",\"CreateSoundFilenameWithLabel\",arguments)\n    // }\n    /* native_decl */\n    CreateSoundFromLabel(soundLabel, looping, is3D, stopwhenoutofrange, fadeInRate, fadeOutRate) {\n        return {\n            soundLabel\n        };\n    }\n    /* native_decl */\n    CreateMIDISound(soundLabel, fadeInRate, fadeOutRate) {\n        this.midiSound['soundLabel'] = {\n            soundLabel,\n            fadeInRate,\n            fadeOutRate\n        }\n    }\n    midiSound = {\n\n    }\n    /* native_decl */\n    // SetSoundParamsFromLabel(soundHandle:sound, soundLabel:string){\n    //   console.log(\"[------decl-only------]\",\"SetSoundParamsFromLabel\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundDistanceCutoff(soundHandle:sound, cutoff:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundDistanceCutoff\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundChannel(soundHandle:sound, channel:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundChannel\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundVolume(soundHandle:sound, volume:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundVolume\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundPitch(soundHandle:sound, pitch:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundPitch\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundPlayPosition(soundHandle:sound, millisecs:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundPlayPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundDistances(soundHandle:sound, minDist:number, maxDist:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundDistances\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundConeAngles(soundHandle:sound, inside:number, outside:number, outsideVolume:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundConeAngles\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundConeOrientation(soundHandle:sound, x:number, y:number, z:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundConeOrientation\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundPosition(soundHandle:sound, x:number, y:number, z:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundVelocity(soundHandle:sound, x:number, y:number, z:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundVelocity\",arguments)\n    // }\n    /* native_decl */\n    // AttachSoundToUnit(soundHandle:sound, whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"AttachSoundToUnit\",arguments)\n    // }\n    /* native_decl */\n    // StartSound(soundHandle:sound){\n    //   console.log(\"[------decl-only------]\",\"StartSound\",arguments)\n    // }\n    /* native_decl */\n    // StopSound(soundHandle:sound, killWhenDone:boolean, fadeOut:boolean){\n    //   console.log(\"[------decl-only------]\",\"StopSound\",arguments)\n    // }\n    /* native_decl */\n    // KillSoundWhenDone(soundHandle:sound){\n    //   console.log(\"[------decl-only------]\",\"KillSoundWhenDone\",arguments)\n    // }\n    /* native_decl */\n    SetMapMusic(musicName, random, index) {\n        console.log(\"[------decl-only------]\", \"SetMapMusic\", arguments)\n    }\n    /* native_decl */\n    // ClearMapMusic(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ClearMapMusic\",arguments)\n    // }\n    /* native_decl */\n    // PlayMusic(musicName:string){\n    //   console.log(\"[------decl-only------]\",\"PlayMusic\",arguments)\n    // }\n    /* native_decl */\n    // PlayMusicEx(musicName:string, frommsecs:number, fadeinmsecs:number){\n    //   console.log(\"[------decl-only------]\",\"PlayMusicEx\",arguments)\n    // }\n    /* native_decl */\n    // StopMusic(fadeOut:boolean){\n    //   console.log(\"[------decl-only------]\",\"StopMusic\",arguments)\n    // }\n    /* native_decl */\n    // ResumeMusic(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"ResumeMusic\",arguments)\n    // }\n    /* native_decl */\n    // PlayThematicMusic(musicFileName:string){\n    //   console.log(\"[------decl-only------]\",\"PlayThematicMusic\",arguments)\n    // }\n    /* native_decl */\n    // PlayThematicMusicEx(musicFileName:string, frommsecs:number){\n    //   console.log(\"[------decl-only------]\",\"PlayThematicMusicEx\",arguments)\n    // }\n    /* native_decl */\n    // EndThematicMusic(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"EndThematicMusic\",arguments)\n    // }\n    /* native_decl */\n    // SetMusicVolume(volume:number){\n    //   console.log(\"[------decl-only------]\",\"SetMusicVolume\",arguments)\n    // }\n    /* native_decl */\n    // SetMusicPlayPosition(millisecs:number){\n    //   console.log(\"[------decl-only------]\",\"SetMusicPlayPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetThematicMusicPlayPosition(millisecs:number){\n    //   console.log(\"[------decl-only------]\",\"SetThematicMusicPlayPosition\",arguments)\n    // }\n    /* native_decl */\n    // SetSoundDuration(soundHandle:sound, duration:number){\n    //   console.log(\"[------decl-only------]\",\"SetSoundDuration\",arguments)\n    // }\n    /* native_decl */\n    // GetSoundDuration(soundHandle:sound){\n    //   console.log(\"[------decl-only------]\",\"GetSoundDuration\",arguments)\n    // }\n    /* native_decl */\n    // GetSoundFileDuration(musicFileName:string){\n    //   console.log(\"[------decl-only------]\",\"GetSoundFileDuration\",arguments)\n    // }\n    /* native_decl */\n    // VolumeGroupSetVolume(vgroup:volumegroup, scale:number){\n    //   console.log(\"[------decl-only------]\",\"VolumeGroupSetVolume\",arguments)\n    // }\n    /* native_decl */\n    // VolumeGroupReset(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"VolumeGroupReset\",arguments)\n    // }\n    /* native_decl */\n    // GetSoundIsPlaying(soundHandle:sound){\n    //   console.log(\"[------decl-only------]\",\"GetSoundIsPlaying\",arguments)\n    // }\n    /* native_decl */\n    // GetSoundIsLoading(soundHandle:sound){\n    //   console.log(\"[------decl-only------]\",\"GetSoundIsLoading\",arguments)\n    // }\n    /* native_decl */\n    // RegisterStackedSound(soundHandle:sound, byPosition:boolean, rectwidth:number, rectheight:number){\n    //   console.log(\"[------decl-only------]\",\"RegisterStackedSound\",arguments)\n    // }\n    /* native_decl */\n    // UnregisterStackedSound(soundHandle:sound, byPosition:boolean, rectwidth:number, rectheight:number){\n    //   console.log(\"[------decl-only------]\",\"UnregisterStackedSound\",arguments)\n    // }\n    /* native_decl */\n    AddWeatherEffect(where, effectID) {\n        return {\n            where,\n            effectID\n        }\n    }\n    /* native_decl */\n    // RemoveWeatherEffect(whichEffect:weathereffect){\n    //   console.log(\"[------decl-only------]\",\"RemoveWeatherEffect\",arguments)\n    // }\n    /* native_decl */\n    EnableWeatherEffect(whichEffect, enable) {\n        whichEffect.enabled = true;\n    }\n    /* native_decl */\n    // TerrainDeformCrater(x:number, y:number, radius:number, depth:number, duration:number, permanent:boolean){\n    //   console.log(\"[------decl-only------]\",\"TerrainDeformCrater\",arguments)\n    // }\n    /* native_decl */\n    // TerrainDeformRipple(x:number, y:number, radius:number, depth:number, duration:number, count:number, spaceWaves:number, timeWaves:number, radiusStartPct:number, limitNeg:boolean){\n    //   console.log(\"[------decl-only------]\",\"TerrainDeformRipple\",arguments)\n    // }\n    /* native_decl */\n    // TerrainDeformWave(x:number, y:number, dirX:number, dirY:number, distance:number, speed:number, radius:number, depth:number, trailTime:number, count:number){\n    //   console.log(\"[------decl-only------]\",\"TerrainDeformWave\",arguments)\n    // }\n    /* native_decl */\n    // TerrainDeformRandom(x:number, y:number, radius:number, minDelta:number, maxDelta:number, duration:number, updateInterval:number){\n    //   console.log(\"[------decl-only------]\",\"TerrainDeformRandom\",arguments)\n    // }\n    /* native_decl */\n    // TerrainDeformStop(deformation:terraindeformation, duration:number){\n    //   console.log(\"[------decl-only------]\",\"TerrainDeformStop\",arguments)\n    // }\n    /* native_decl */\n    // TerrainDeformStopAll(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"TerrainDeformStopAll\",arguments)\n    // }\n    /* native_decl */\n    // AddSpecialEffect(modelName:string, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"AddSpecialEffect\",arguments)\n    // }\n    /* native_decl */\n    // AddSpecialEffectLoc(modelName:string, where:location){\n    //   console.log(\"[------decl-only------]\",\"AddSpecialEffectLoc\",arguments)\n    // }\n    /* native_decl */\n    // AddSpecialEffectTarget(modelName:string, targetWidget:widget, attachPointName:string){\n    //   console.log(\"[------decl-only------]\",\"AddSpecialEffectTarget\",arguments)\n    // }\n    /* native_decl */\n    // DestroyEffect(whichEffect:effect){\n    //   console.log(\"[------decl-only------]\",\"DestroyEffect\",arguments)\n    // }\n    /* native_decl */\n    // AddSpellEffect(abilityString:string, t:effecttype, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"AddSpellEffect\",arguments)\n    // }\n    /* native_decl */\n    // AddSpellEffectLoc(abilityString:string, t:effecttype, where:location){\n    //   console.log(\"[------decl-only------]\",\"AddSpellEffectLoc\",arguments)\n    // }\n    /* native_decl */\n    // AddSpellEffectById(abilityId:number, t:effecttype, x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"AddSpellEffectById\",arguments)\n    // }\n    /* native_decl */\n    // AddSpellEffectByIdLoc(abilityId:number, t:effecttype, where:location){\n    //   console.log(\"[------decl-only------]\",\"AddSpellEffectByIdLoc\",arguments)\n    // }\n    /* native_decl */\n    // AddSpellEffectTarget(modelName:string, t:effecttype, targetWidget:widget, attachPoint:string){\n    //   console.log(\"[------decl-only------]\",\"AddSpellEffectTarget\",arguments)\n    // }\n    /* native_decl */\n    // AddSpellEffectTargetById(abilityId:number, t:effecttype, targetWidget:widget, attachPoint:string){\n    //   console.log(\"[------decl-only------]\",\"AddSpellEffectTargetById\",arguments)\n    // }\n    /* native_decl */\n    // AddLightning(codeName:string, checkVisibility:boolean, x1:number, y1:number, x2:number, y2:number){\n    //   console.log(\"[------decl-only------]\",\"AddLightning\",arguments)\n    // }\n    /* native_decl */\n    // AddLightningEx(codeName:string, checkVisibility:boolean, x1:number, y1:number, z1:number, x2:number, y2:number, z2:number){\n    //   console.log(\"[------decl-only------]\",\"AddLightningEx\",arguments)\n    // }\n    /* native_decl */\n    // DestroyLightning(whichBolt:lightning){\n    //   console.log(\"[------decl-only------]\",\"DestroyLightning\",arguments)\n    // }\n    /* native_decl */\n    // MoveLightning(whichBolt:lightning, checkVisibility:boolean, x1:number, y1:number, x2:number, y2:number){\n    //   console.log(\"[------decl-only------]\",\"MoveLightning\",arguments)\n    // }\n    /* native_decl */\n    // MoveLightningEx(whichBolt:lightning, checkVisibility:boolean, x1:number, y1:number, z1:number, x2:number, y2:number, z2:number){\n    //   console.log(\"[------decl-only------]\",\"MoveLightningEx\",arguments)\n    // }\n    /* native_decl */\n    // GetLightningColorA(whichBolt:lightning){\n    //   console.log(\"[------decl-only------]\",\"GetLightningColorA\",arguments)\n    // }\n    /* native_decl */\n    // GetLightningColorR(whichBolt:lightning){\n    //   console.log(\"[------decl-only------]\",\"GetLightningColorR\",arguments)\n    // }\n    /* native_decl */\n    // GetLightningColorG(whichBolt:lightning){\n    //   console.log(\"[------decl-only------]\",\"GetLightningColorG\",arguments)\n    // }\n    /* native_decl */\n    // GetLightningColorB(whichBolt:lightning){\n    //   console.log(\"[------decl-only------]\",\"GetLightningColorB\",arguments)\n    // }\n    /* native_decl */\n    // SetLightningColor(whichBolt:lightning, r:number, g:number, b:number, a:number){\n    //   console.log(\"[------decl-only------]\",\"SetLightningColor\",arguments)\n    // }\n    /* native_decl */\n    // GetAbilityEffect(abilityString:string, t:effecttype, index:number){\n    //   console.log(\"[------decl-only------]\",\"GetAbilityEffect\",arguments)\n    // }\n    /* native_decl */\n    // GetAbilityEffectById(abilityId:number, t:effecttype, index:number){\n    //   console.log(\"[------decl-only------]\",\"GetAbilityEffectById\",arguments)\n    // }\n    /* native_decl */\n    // GetAbilitySound(abilityString:string, t:soundtype){\n    //   console.log(\"[------decl-only------]\",\"GetAbilitySound\",arguments)\n    // }\n    /* native_decl */\n    // GetAbilitySoundById(abilityId:number, t:soundtype){\n    //   console.log(\"[------decl-only------]\",\"GetAbilitySoundById\",arguments)\n    // }\n    /* native_decl */\n    // GetTerrainCliffLevel(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"GetTerrainCliffLevel\",arguments)\n    // }\n    /* native_decl */\n    // SetWaterBaseColor(red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"SetWaterBaseColor\",arguments)\n    // }\n    /* native_decl */\n    // SetWaterDeforms(val:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetWaterDeforms\",arguments)\n    // }\n    /* native_decl */\n    // GetTerrainType(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"GetTerrainType\",arguments)\n    // }\n    /* native_decl */\n    // GetTerrainVariance(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"GetTerrainVariance\",arguments)\n    // }\n    /* native_decl */\n    // SetTerrainType(x:number, y:number, terrainType:number, variation:number, area:number, shape:number){\n    //   console.log(\"[------decl-only------]\",\"SetTerrainType\",arguments)\n    // }\n    /* native_decl */\n    // IsTerrainPathable(x:number, y:number, t:pathingtype){\n    //   console.log(\"[------decl-only------]\",\"IsTerrainPathable\",arguments)\n    // }\n    /* native_decl */\n    // SetTerrainPathable(x:number, y:number, t:pathingtype, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetTerrainPathable\",arguments)\n    // }\n    /* native_decl */\n    // CreateImage(file:string, sizeX:number, sizeY:number, sizeZ:number, posX:number, posY:number, posZ:number, originX:number, originY:number, originZ:number, imageType:number){\n    //   console.log(\"[------decl-only------]\",\"CreateImage\",arguments)\n    // }\n    /* native_decl */\n    // DestroyImage(whichImage:image){\n    //   console.log(\"[------decl-only------]\",\"DestroyImage\",arguments)\n    // }\n    /* native_decl */\n    // ShowImage(whichImage:image, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"ShowImage\",arguments)\n    // }\n    /* native_decl */\n    // SetImageConstantHeight(whichImage:image, flag:boolean, height:number){\n    //   console.log(\"[------decl-only------]\",\"SetImageConstantHeight\",arguments)\n    // }\n    /* native_decl */\n    // SetImagePosition(whichImage:image, x:number, y:number, z:number){\n    //   console.log(\"[------decl-only------]\",\"SetImagePosition\",arguments)\n    // }\n    /* native_decl */\n    // SetImageColor(whichImage:image, red:number, green:number, blue:number, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"SetImageColor\",arguments)\n    // }\n    /* native_decl */\n    // SetImageRender(whichImage:image, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetImageRender\",arguments)\n    // }\n    /* native_decl */\n    // SetImageRenderAlways(whichImage:image, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetImageRenderAlways\",arguments)\n    // }\n    /* native_decl */\n    // SetImageAboveWater(whichImage:image, flag:boolean, useWaterAlpha:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetImageAboveWater\",arguments)\n    // }\n    /* native_decl */\n    // SetImageType(whichImage:image, imageType:number){\n    //   console.log(\"[------decl-only------]\",\"SetImageType\",arguments)\n    // }\n    /* native_decl */\n    // CreateUbersplat(x:number, y:number, name:string, red:number, green:number, blue:number, alpha:number, forcePaused:boolean, noBirthTime:boolean){\n    //   console.log(\"[------decl-only------]\",\"CreateUbersplat\",arguments)\n    // }\n    /* native_decl */\n    // DestroyUbersplat(whichSplat:ubersplat){\n    //   console.log(\"[------decl-only------]\",\"DestroyUbersplat\",arguments)\n    // }\n    /* native_decl */\n    // ResetUbersplat(whichSplat:ubersplat){\n    //   console.log(\"[------decl-only------]\",\"ResetUbersplat\",arguments)\n    // }\n    /* native_decl */\n    // FinishUbersplat(whichSplat:ubersplat){\n    //   console.log(\"[------decl-only------]\",\"FinishUbersplat\",arguments)\n    // }\n    /* native_decl */\n    // ShowUbersplat(whichSplat:ubersplat, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"ShowUbersplat\",arguments)\n    // }\n    /* native_decl */\n    // SetUbersplatRender(whichSplat:ubersplat, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUbersplatRender\",arguments)\n    // }\n    /* native_decl */\n    // SetUbersplatRenderAlways(whichSplat:ubersplat, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetUbersplatRenderAlways\",arguments)\n    // }\n    /* native_decl */\n    // SetBlight(whichPlayer:player, x:number, y:number, radius:number, addBlight:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetBlight\",arguments)\n    // }\n    /* native_decl */\n    // SetBlightRect(whichPlayer:player, r:rect, addBlight:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetBlightRect\",arguments)\n    // }\n    /* native_decl */\n    // SetBlightPoint(whichPlayer:player, x:number, y:number, addBlight:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetBlightPoint\",arguments)\n    // }\n    /* native_decl */\n    // SetBlightLoc(whichPlayer:player, whichLocation:location, radius:number, addBlight:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetBlightLoc\",arguments)\n    // }\n    /* native_decl */\n    // CreateBlightedGoldmine(id:player, x:number, y:number, face:number){\n    //   console.log(\"[------decl-only------]\",\"CreateBlightedGoldmine\",arguments)\n    // }\n    /* native_decl */\n    // IsPointBlighted(x:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"IsPointBlighted\",arguments)\n    // }\n    /* native_decl */\n    // SetDoodadAnimation(x:number, y:number, radius:number, doodadID:number, nearestOnly:boolean, animName:string, animRandom:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetDoodadAnimation\",arguments)\n    // }\n    /* native_decl */\n    // SetDoodadAnimationRect(r:rect, doodadID:number, animName:string, animRandom:boolean){\n    //   console.log(\"[------decl-only------]\",\"SetDoodadAnimationRect\",arguments)\n    // }\n    /* native_decl */\n    // StartMeleeAI(num:player, script:string){\n    //   console.log(\"[------decl-only------]\",\"StartMeleeAI\",arguments)\n    // }\n    /* native_decl */\n    // StartCampaignAI(num:player, script:string){\n    //   console.log(\"[------decl-only------]\",\"StartCampaignAI\",arguments)\n    // }\n    /* native_decl */\n    // CommandAI(num:player, command:number, data:number){\n    //   console.log(\"[------decl-only------]\",\"CommandAI\",arguments)\n    // }\n    /* native_decl */\n    // PauseCompAI(p:player, pause:boolean){\n    //   console.log(\"[------decl-only------]\",\"PauseCompAI\",arguments)\n    // }\n    /* native_decl */\n    // GetAIDifficulty(num:player){\n    //   console.log(\"[------decl-only------]\",\"GetAIDifficulty\",arguments)\n    // }\n    /* native_decl */\n    // RemoveGuardPosition(hUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"RemoveGuardPosition\",arguments)\n    // }\n    /* native_decl */\n    // RecycleGuardPosition(hUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"RecycleGuardPosition\",arguments)\n    // }\n    /* native_decl */\n    // RemoveAllGuardPositions(num:player){\n    //   console.log(\"[------decl-only------]\",\"RemoveAllGuardPositions\",arguments)\n    // }\n    /* native_decl */\n    // Cheat(cheatStr:string){\n    //   console.log(\"[------decl-only------]\",\"Cheat\",arguments)\n    // }\n    /* native_decl */\n    // IsNoVictoryCheat(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"IsNoVictoryCheat\",arguments)\n    // }\n    /* native_decl */\n    // IsNoDefeatCheat(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"IsNoDefeatCheat\",arguments)\n    // }\n    /* native_decl */\n    // Preload(filename:string){\n    //   console.log(\"[------decl-only------]\",\"Preload\",arguments)\n    // }\n    /* native_decl */\n    // PreloadEnd(timeout:number){\n    //   console.log(\"[------decl-only------]\",\"PreloadEnd\",arguments)\n    // }\n    /* native_decl */\n    // PreloadStart(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"PreloadStart\",arguments)\n    // }\n    /* native_decl */\n    // PreloadRefresh(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"PreloadRefresh\",arguments)\n    // }\n    /* native_decl */\n    // PreloadEndEx(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"PreloadEndEx\",arguments)\n    // }\n    /* native_decl */\n    // PreloadGenClear(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"PreloadGenClear\",arguments)\n    // }\n    /* native_decl */\n    // PreloadGenStart(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"PreloadGenStart\",arguments)\n    // }\n    /* native_decl */\n    // PreloadGenEnd(filename:string){\n    //   console.log(\"[------decl-only------]\",\"PreloadGenEnd\",arguments)\n    // }\n    /* native_decl */\n    Preloader(filename) {\n        console.log(\"[------decl-only------]\", \"Preloader\", arguments)\n        // let d = await this.app.loadBaseFile(filename, 'text');\n        // let code = d?.data;\n        // if (code)\n        //     await this.app.vm.load(<string>code, filename);\n    }\n    /* native_decl */\n    // AutomationTestStart(testName:string){\n    //   console.log(\"[------decl-only------]\",\"AutomationTestStart\",arguments)\n    // }\n    /* native_decl */\n    // AutomationTestEnd(testName:string){\n    //   console.log(\"[------decl-only------]\",\"AutomationTestEnd\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetTriggerPlayerMouseX(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"BlzGetTriggerPlayerMouseX\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetTriggerPlayerMouseY(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"BlzGetTriggerPlayerMouseY\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetTriggerPlayerMousePosition(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"BlzGetTriggerPlayerMousePosition\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetTriggerPlayerMouseButton(/*void*/){\n    //   console.log(\"[------decl-only------]\",\"BlzGetTriggerPlayerMouseButton\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityTooltip(abilCode:number, tooltip:string, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityActivatedTooltip(abilCode:number, tooltip:string, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityActivatedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityExtendedTooltip(abilCode:number, ExtendedTooltip:string, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityActivatedExtendedTooltip(abilCode:number, ExtendedTooltip:string, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityActivatedExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityResearchTooltip(abilCode:number, researchTooltip:string, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityResearchTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityResearchExtendedTooltip(abilCode:number, researchExtendedTooltip:string, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityResearchExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityTooltip(abilCode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityActivatedTooltip(abilCode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityActivatedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityExtendedTooltip(abilCode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityActivatedExtendedTooltip(abilCode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityActivatedExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityResearchTooltip(abilCode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityResearchTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityResearchExtendedTooltip(abilCode:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityResearchExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityIcon(abilCode:number, iconPath:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityIcon\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityIcon(abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityIcon\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityActivatedIcon(abilCode:number, iconPath:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityActivatedIcon\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityActivatedIcon(abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityActivatedIcon\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityPosX(abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityPosX\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityPosY(abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityPosY\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityPosX(abilCode:number, x:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityPosX\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityPosY(abilCode:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityPosY\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityActivatedPosX(abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityActivatedPosX\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityActivatedPosY(abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityActivatedPosY\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityActivatedPosX(abilCode:number, x:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityActivatedPosX\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetAbilityActivatedPosY(abilCode:number, y:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetAbilityActivatedPosY\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitMaxHP(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitMaxHP\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitMaxHP(whichUnit:unit, hp:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitMaxHP\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitMaxMana(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitMaxMana\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitMaxMana(whichUnit:unit, mana:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitMaxMana\",arguments)\n    // }\n    /* native_decl */\n    // BlzDeleteHeroAbility(whichUnit:unit, abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzDeleteHeroAbility\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetItemName(whichItem:item, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetItemName\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetItemDescription(whichItem:item, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetItemDescription\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetItemDescription(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"BlzGetItemDescription\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetItemTooltip(whichItem:item, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetItemTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetItemTooltip(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"BlzGetItemTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetItemExtendedTooltip(whichItem:item, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetItemExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetItemExtendedTooltip(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"BlzGetItemExtendedTooltip\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetItemIconPath(whichItem:item, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetItemIconPath\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetItemIconPath(whichItem:item){\n    //   console.log(\"[------decl-only------]\",\"BlzGetItemIconPath\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitName(whichUnit:unit, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitName\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetHeroProperName(whichUnit:unit, name:string){\n    //   console.log(\"[------decl-only------]\",\"BlzSetHeroProperName\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitBaseDamage(whichUnit:unit, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitBaseDamage\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitBaseDamage(whichUnit:unit, baseDamage:number, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitBaseDamage\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitDiceNumber(whichUnit:unit, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitDiceNumber\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitDiceNumber(whichUnit:unit, diceNumber:number, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitDiceNumber\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitDiceSides(whichUnit:unit, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitDiceSides\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitDiceSides(whichUnit:unit, diceSides:number, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitDiceSides\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitAttackCooldown(whichUnit:unit, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitAttackCooldown\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitAttackCooldown(whichUnit:unit, cooldown:number, weaponIndex:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitAttackCooldown\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectColorByPlayer(whichEffect:effect, whichPlayer:player){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectColorByPlayer\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectColor(whichEffect:effect, r:number, g:number, b:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectColor\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectAlpha(whichEffect:effect, alpha:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectAlpha\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectScale(whichEffect:effect, scale:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectScale\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectPosition(whichEffect:effect, x:number, y:number, z:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectPosition\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectHeight(whichEffect:effect, height:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectHeight\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectTimeScale(whichEffect:effect, timeScale:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectTimeScale\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectTime(whichEffect:effect, time:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectTime\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectOrientation(whichEffect:effect, yaw:number, pitch:number, roll:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectOrientation\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectYaw(whichEffect:effect, yaw:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectYaw\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectPitch(whichEffect:effect, pitch:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectPitch\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectRoll(whichEffect:effect, roll:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectRoll\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectX(whichEffect:effect, x:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectX\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectY(whichEffect:effect, y:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectY\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectZ(whichEffect:effect, z:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectZ\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetSpecialEffectPositionLoc(whichEffect:effect, loc:location){\n    //   console.log(\"[------decl-only------]\",\"BlzSetSpecialEffectPositionLoc\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetLocalSpecialEffectX(whichEffect:effect){\n    //   console.log(\"[------decl-only------]\",\"BlzGetLocalSpecialEffectX\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetLocalSpecialEffectY(whichEffect:effect){\n    //   console.log(\"[------decl-only------]\",\"BlzGetLocalSpecialEffectY\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetLocalSpecialEffectZ(whichEffect:effect){\n    //   console.log(\"[------decl-only------]\",\"BlzGetLocalSpecialEffectZ\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitArmor(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitArmor\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitArmor(whichUnit:unit, armorAmount:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitArmor\",arguments)\n    // }\n    /* native_decl */\n    // BlzUnitHideAbility(whichUnit:unit, abilId:number, flag:boolean){\n    //   console.log(\"[------decl-only------]\",\"BlzUnitHideAbility\",arguments)\n    // }\n    /* native_decl */\n    // BlzUnitDisableAbility(whichUnit:unit, abilId:number, flag:boolean, hideUI:boolean){\n    //   console.log(\"[------decl-only------]\",\"BlzUnitDisableAbility\",arguments)\n    // }\n    /* native_decl */\n    // BlzUnitCancelTimedLife(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzUnitCancelTimedLife\",arguments)\n    // }\n    /* native_decl */\n    // BlzIsUnitSelectable(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzIsUnitSelectable\",arguments)\n    // }\n    /* native_decl */\n    // BlzIsUnitInvulnerable(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzIsUnitInvulnerable\",arguments)\n    // }\n    /* native_decl */\n    // BlzUnitInterruptAttack(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzUnitInterruptAttack\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitCollisionSize(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitCollisionSize\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityManaCost(abilId:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityManaCost\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetAbilityCooldown(abilId:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetAbilityCooldown\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitAbilityCooldown(whichUnit:unit, abilId:number, level:number, cooldown:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitAbilityCooldown\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitAbilityCooldown(whichUnit:unit, abilId:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitAbilityCooldown\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitAbilityCooldownRemaining(whichUnit:unit, abilId:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitAbilityCooldownRemaining\",arguments)\n    // }\n    /* native_decl */\n    // BlzEndUnitAbilityCooldown(whichUnit:unit, abilCode:number){\n    //   console.log(\"[------decl-only------]\",\"BlzEndUnitAbilityCooldown\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetUnitAbilityManaCost(whichUnit:unit, abilId:number, level:number){\n    //   console.log(\"[------decl-only------]\",\"BlzGetUnitAbilityManaCost\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetUnitAbilityManaCost(whichUnit:unit, abilId:number, level:number, manaCost:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetUnitAbilityManaCost\",arguments)\n    // }\n    /* native_decl */\n    // BlzGetLocalUnitZ(whichUnit:unit){\n    //   console.log(\"[------decl-only------]\",\"BlzGetLocalUnitZ\",arguments)\n    // }\n    /* native_decl */\n    // BlzDecPlayerTechResearched(whichPlayer:player, techid:number, levels:number){\n    //   console.log(\"[------decl-only------]\",\"BlzDecPlayerTechResearched\",arguments)\n    // }\n    /* native_decl */\n    // BlzSetEventDamage(damage:number){\n    //   console.log(\"[------decl-only------]\",\"BlzSetEventDamage\",arguments)\n    // }\n    GetPlayerId(whichPlayer) {\n        return whichPlayer.index;\n    }\n    SetPlayerController(whichPlayer, v) {\n        whichPlayer.contoller = v[1];\n    }\n    SetPlayerRaceSelectable(whichPlayer, v) {\n        whichPlayer.raceSelectable = v;\n    }\n\n    SetPlayerRacePreference(whichPlayer, v) {\n        whichPlayer.racePerf = v[1];\n    }\n    SetPlayerColor(whichPlayer, whichColor) {\n        whichPlayer.color = whichColor;\n    }\n    SetPlayerStartLocation(whichPlayer, whichStartLoc) {\n        whichPlayer.startLoc = this.startLocations.get(whichStartLoc);\n    }\n    Player(n) {\n        return this.players.getAt(n, (i) => new player(i));\n    }\n    DefineStartLocation(whichStartLoc, x, y) {\n        this.startLocations.set(whichStartLoc, { x, y });\n    }\n    SetGamePlacement(d) {\n        this.gamePlacement = d[1];\n    }\n    GetCameraMargin(d) {\n        return this.app.cameraBounds;\n    }\n    SetTeams(n) {\n        this.teams = new ArrayList(n, asEventAgent);\n    }\n    SetPlayers(n) {\n        this.players = new ArrayList(n, asEventAgent);\n    }\n    CreateTimer() {\n        return new timer();\n    }\n    CreateGroup() {\n        return new group();\n    }\n    SetMapName(str) {\n        this.mapName = this.app.map?.wts?.getString(str);\n    }\n    SetMapDescription(str) {\n        this.mapDescription = this.app.map?.wts?.getString(str);\n    }\n    GetPlayerNeutralPassive() {\n        return PLAYER_NEUTRAL_PASSIVE;\n    }\n    GetPlayerNeutralAggressive() {\n        return PLAYER_NEUTRAL_AGGRESSIVE;\n    }\n    GetBJPlayerNeutralVictim() {\n        return 1;\n    }\n    GetBJPlayerNeutralExtra() {\n        return 1;\n    }\n    GetBJMaxPlayers() {\n        return 24;\n    }\n    GetBJMaxPlayerSlots() {\n        return 24;\n    }\n}\n","// ===================================================\n// Custom UI API constants\n// ===================================================\n\nconst OFT = 'originframetype';\nlet id = 1000;\nexport const ORIGIN_FRAME_GAME_UI: originframetype = { originframetypeId: 0, handleId: id++, code: 'ORIGIN_FRAME_GAME_UI' }\nexport const ORIGIN_FRAME_COMMAND_BUTTON: originframetype = { originframetypeId: 1, handleId: id++, code: 'ORIGIN_FRAME_COMMAND_BUTTON' }\nexport const ORIGIN_FRAME_HERO_BAR: originframetype = { originframetypeId: 2, handleId: id++, code: 'ORIGIN_FRAME_HERO_BAR' }\nexport const ORIGIN_FRAME_HERO_BUTTON: originframetype = { originframetypeId: 3, handleId: id++, code: 'ORIGIN_FRAME_HERO_BUTTON' }\nexport const ORIGIN_FRAME_HERO_HP_BAR: originframetype = { originframetypeId: 4, handleId: id++, code: 'ORIGIN_FRAME_HERO_HP_BAR' }\nexport const ORIGIN_FRAME_HERO_MANA_BAR: originframetype = { originframetypeId: 5, handleId: id++, code: 'ORIGIN_FRAME_HERO_MANA_BAR' }\nexport const ORIGIN_FRAME_HERO_BUTTON_INDICATOR: originframetype = { originframetypeId: 6, handleId: id++, code: 'ORIGIN_FRAME_HERO_BUTTON_INDICATOR' }\nexport const ORIGIN_FRAME_ITEM_BUTTON: originframetype = { originframetypeId: 7, handleId: id++, code: 'ORIGIN_FRAME_ITEM_BUTTON' }\nexport const ORIGIN_FRAME_MINIMAP: originframetype = { originframetypeId: 8, handleId: id++, code: 'ORIGIN_FRAME_MINIMAP' }\nexport const ORIGIN_FRAME_MINIMAP_BUTTON: originframetype = { originframetypeId: 9, handleId: id++, code: 'ORIGIN_FRAME_MINIMAP_BUTTON' }\nexport const ORIGIN_FRAME_SYSTEM_BUTTON: originframetype = { originframetypeId: 10, handleId: id++, code: 'ORIGIN_FRAME_SYSTEM_BUTTON' }\nexport const ORIGIN_FRAME_TOOLTIP: originframetype = { originframetypeId: 11, handleId: id++, code: 'ORIGIN_FRAME_TOOLTIP' }\nexport const ORIGIN_FRAME_UBERTOOLTIP: originframetype = { originframetypeId: 12, handleId: id++, code: 'ORIGIN_FRAME_UBERTOOLTIP' }\nexport const ORIGIN_FRAME_CHAT_MSG: originframetype = { originframetypeId: 13, handleId: id++, code: 'ORIGIN_FRAME_CHAT_MSG' }\nexport const ORIGIN_FRAME_UNIT_MSG: originframetype = { originframetypeId: 14, handleId: id++, code: 'ORIGIN_FRAME_UNIT_MSG' }\nexport const ORIGIN_FRAME_TOP_MSG: originframetype = { originframetypeId: 15, handleId: id++, code: 'ORIGIN_FRAME_TOP_MSG' }\nexport const ORIGIN_FRAME_PORTRAIT: originframetype = { originframetypeId: 16, handleId: id++, code: 'ORIGIN_FRAME_PORTRAIT' }\nexport const ORIGIN_FRAME_WORLD_FRAME: originframetype = { originframetypeId: 17, handleId: id++, code: 'ORIGIN_FRAME_WORLD_FRAME' }\nexport const ORIGIN_FRAME_SIMPLE_UI_PARENT: originframetype = { originframetypeId: 18, handleId: id++, code: 'ORIGIN_FRAME_SIMPLE_UI_PARENT' }\nexport const ORIGIN_FRAME_PORTRAIT_HP_TEXT: originframetype = { originframetypeId: 19, handleId: id++, code: 'ORIGIN_FRAME_PORTRAIT_HP_TEXT' }\nexport const ORIGIN_FRAME_PORTRAIT_MANA_TEXT: originframetype = { originframetypeId: 20, handleId: id++, code: 'ORIGIN_FRAME_PORTRAIT_MANA_TEXT' }\nexport const ORIGIN_FRAME_UNIT_PANEL_BUFF_BAR: originframetype = { originframetypeId: 21, handleId: id++, code: 'ORIGIN_FRAME_UNIT_PANEL_BUFF_BAR' }\nexport const ORIGIN_FRAME_UNIT_PANEL_BUFF_BAR_LABEL: originframetype = { originframetypeId: 22, handleId: id++, code: 'ORIGIN_FRAME_UNIT_PANEL_BUFF_BAR' }\n\nconst FPT = 'framepointtype';\nexport const FRAMEPOINT_TOPLEFT: framepointtype = { framepointtypeId: 0, handleId: id++, code: 'FRAMEPOINT_TOPLEFT' }\nexport const FRAMEPOINT_TOP: framepointtype = { framepointtypeId: 1, handleId: id++, code: 'FRAMEPOINT_TOP' }\nexport const FRAMEPOINT_TOPRIGHT: framepointtype = { framepointtypeId: 2, handleId: id++, code: 'FRAMEPOINT_TOPRIGHT' }\nexport const FRAMEPOINT_LEFT: framepointtype = { framepointtypeId: 3, handleId: id++, code: 'FRAMEPOINT_LEFT' }\nexport const FRAMEPOINT_CENTER: framepointtype = { framepointtypeId: 4, handleId: id++, code: 'FRAMEPOINT_CENTER' }\nexport const FRAMEPOINT_RIGHT: framepointtype = { framepointtypeId: 5, handleId: id++, code: 'FRAMEPOINT_RIGHT' }\nexport const FRAMEPOINT_BOTTOMLEFT: framepointtype = { framepointtypeId: 6, handleId: id++, code: 'FRAMEPOINT_BOTTOMLEFT' }\nexport const FRAMEPOINT_BOTTOM: framepointtype = { framepointtypeId: 7, handleId: id++, code: 'FRAMEPOINT_BOTTOM' }\nexport const FRAMEPOINT_BOTTOMRIGHT: framepointtype = { framepointtypeId: 8, handleId: id++, code: 'FRAMEPOINT_BOTTOMRIGHT' }\n\nconst TAT = 'textaligintype';\nexport const TEXT_JUSTIFY_TOP: textaligintype = { textaligintypeId: 0, handleId: id++, code: 'TEXT_JUSTIFY_TOP' }\nexport const TEXT_JUSTIFY_MIDDLE: textaligintype = { textaligintypeId: 1, handleId: id++, code: 'TEXT_JUSTIFY_MIDDLE' }\nexport const TEXT_JUSTIFY_BOTTOM: textaligintype = { textaligintypeId: 2, handleId: id++, code: 'TEXT_JUSTIFY_BOTTOM' }\nexport const TEXT_JUSTIFY_LEFT: textaligintype = { textaligintypeId: 3, handleId: id++, code: 'TEXT_JUSTIFY_LEFT' }\nexport const TEXT_JUSTIFY_CENTER: textaligintype = { textaligintypeId: 4, handleId: id++, code: 'TEXT_JUSTIFY_CENTER' }\nexport const TEXT_JUSTIFY_RIGHT: textaligintype = { textaligintypeId: 5, handleId: id++, code: 'TEXT_JUSTIFY_RIGHT' }\n\nconst FET = 'frameeventtype';\nexport const FRAMEEVENT_CONTROL_CLICK: frameeventtype = { frameeventtypeId: 1, handleId: id++, code: 'FRAMEEVENT_CONTROL_CLICK' }\nexport const FRAMEEVENT_MOUSE_ENTER: frameeventtype = { frameeventtypeId: 2, handleId: id++, code: 'FRAMEEVENT_MOUSE_ENTER' }\nexport const FRAMEEVENT_MOUSE_LEAVE: frameeventtype = { frameeventtypeId: 3, handleId: id++, code: 'FRAMEEVENT_MOUSE_LEAVE' }\nexport const FRAMEEVENT_MOUSE_UP: frameeventtype = { frameeventtypeId: 4, handleId: id++, code: 'FRAMEEVENT_MOUSE_UP' }\nexport const FRAMEEVENT_MOUSE_DOWN: frameeventtype = { frameeventtypeId: 5, handleId: id++, code: 'FRAMEEVENT_MOUSE_DOWN' }\nexport const FRAMEEVENT_MOUSE_WHEEL: frameeventtype = { frameeventtypeId: 6, handleId: id++, code: 'FRAMEEVENT_MOUSE_WHEEL' }\nexport const FRAMEEVENT_CHECKBOX_CHECKED: frameeventtype = { frameeventtypeId: 7, handleId: id++, code: 'FRAMEEVENT_CHECKBOX_CHECKED' }\nexport const FRAMEEVENT_CHECKBOX_UNCHECKED: frameeventtype = { frameeventtypeId: 8, handleId: id++, code: 'FRAMEEVENT_CHECKBOX_UNCHECKED' }\nexport const FRAMEEVENT_EDITBOX_TEXT_CHANGED: frameeventtype = { frameeventtypeId: 9, handleId: id++, code: 'FRAMEEVENT_EDITBOX_TEXT_CHANGED' }\nexport const FRAMEEVENT_POPUPMENU_ITEM_CHANGED: frameeventtype = { frameeventtypeId: 10, handleId: id++, code: 'FRAMEEVENT_POPUPMENU_ITEM_CHANGED' }\nexport const FRAMEEVENT_MOUSE_DOUBLECLICK: frameeventtype = { frameeventtypeId: 11, handleId: id++, code: 'FRAMEEVENT_MOUSE_DOUBLECLICK' }\nexport const FRAMEEVENT_SPRITE_ANIM_UPDATE: frameeventtype = { frameeventtypeId: 12, handleId: id++, code: 'FRAMEEVENT_SPRITE_ANIM_UPDATE' }\nexport const FRAMEEVENT_SLIDER_VALUE_CHANGED: frameeventtype = { frameeventtypeId: 13, handleId: id++, code: 'FRAMEEVENT_SLIDER_VALUE_CHANGED' }\nexport const FRAMEEVENT_DIALOG_CANCEL: frameeventtype = { frameeventtypeId: 14, handleId: id++, code: 'FRAMEEVENT_DIALOG_CANCEL' }\nexport const FRAMEEVENT_DIALOG_ACCEPT: frameeventtype = { frameeventtypeId: 15, handleId: id++, code: 'FRAMEEVENT_DIALOG_ACCEPT' }\nexport const FRAMEEVENT_EDITBOX_ENTER: frameeventtype = { frameeventtypeId: 16, handleId: id++, code: 'FRAMEEVENT_EDITBOX_ENTER' }\n\nexport type RelativeFrameSide = {\n  relative: framehandle;\n  relativeSide:\n  | \"topleft\"\n  | \"top\"\n  | \"topright\"\n  | \"left\"\n  | \"center\"\n  | \"right\"\n  | \"bottomleft\"\n  | \"bottom\"\n  | \"bottomright\";\n  xOffset: number;\n  yOffset: number;\n};\nexport type FrameSide = number | undefined | RelativeFrameSide;\nexport interface handle {\n  handleId: number,\n  code?: string;\n  // onRemove: (\n  //   callback: (handle: handle) => void,\n  //   // deno-lint-ignore ban-types\n  //   reference?: object,\n  // ) => void;\n  // remove: () => void;\n  // clearRemoveHook: (\n  //   callback: (handle: handle) => void,\n  //   // deno-lint-ignore ban-types\n  //   reference?: object,\n  // ) => void;\n  // // deno-lint-ignore ban-types\n  // clearRemoveHookByReference: (reference: object) => void;\n}\nexport interface textaligintype extends handle {\n  textaligintypeId: number;\n}\nexport interface originframetype extends handle {\n  originframetypeId: number;\n}\nexport interface framepointtype extends handle {\n  framepointtypeId: number;\n}\nexport interface textaligntype extends handle {\n  textaligntypeId: number;\n}\nexport interface frameeventtype extends handle {\n  frameeventtypeId: number;\n}\nexport interface oskeytype extends handle {\n  oskeytypeId: number;\n}\nexport interface abilityintegerfield extends handle {\n  abilityintegerfieldId: number;\n}\nexport interface abilityrealfield extends handle {\n  abilityrealfieldId: number;\n}\nexport interface abilitybooleanfield extends handle {\n  abilitybooleanfieldId: number;\n}\nexport interface abilitystringfield extends handle {\n  abilitystringfieldId: number;\n}\nexport interface abilityintegerlevelfield extends handle {\n  abilityintegerlevelfieldId: number;\n}\nexport interface abilityreallevelfield extends handle {\n  abilityreallevelfieldId: number;\n}\nexport interface abilitybooleanlevelfield extends handle {\n  abilitybooleanlevelfieldId: number;\n}\nexport interface abilitystringlevelfield extends handle {\n  abilitystringlevelfieldId: number;\n}\nexport interface abilityintegerlevelarrayfield extends handle {\n  abilityintegerlevelarrayfieldId: number;\n}\nexport interface abilityreallevelarrayfield extends handle {\n  abilityreallevelarrayfieldId: number;\n}\nexport interface abilitybooleanlevelarrayfield extends handle {\n  abilitybooleanlevelarrayfieldId: number;\n}\nexport interface abilitystringlevelarrayfield extends handle {\n  abilitystringlevelarrayfieldId: number;\n}\nexport interface unitintegerfield extends handle {\n  unitintegerfieldId: number;\n}\nexport interface unitrealfield extends handle {\n  unitrealfieldId: number;\n}\nexport interface unitbooleanfield extends handle {\n  unitbooleanfieldId: number;\n}\nexport interface unitstringfield extends handle {\n  unitstringfieldId: number;\n}\nexport interface unitweaponintegerfield extends handle {\n  unitweaponintegerfieldId: number;\n}\nexport interface unitweaponrealfield extends handle {\n  unitweaponrealfieldId: number;\n}\nexport interface unitweaponbooleanfield extends handle {\n  unitweaponbooleanfieldId: number;\n}\nexport interface unitweaponstringfield extends handle {\n  unitweaponstringfieldId: number;\n}\nexport interface itemintegerfield extends handle {\n  itemintegerfieldId: number;\n}\nexport interface itemrealfield extends handle {\n  itemrealfieldId: number;\n}\nexport interface itembooleanfield extends handle {\n  itembooleanfieldId: number;\n}\nexport interface itemstringfield extends handle {\n  itemstringfieldId: number;\n}\nexport interface movetype extends handle {\n  movetypeId: number;\n}\nexport interface targetflag extends handle {\n  targetflagId: number;\n}\nexport interface armortype extends handle {\n  armortypeId: number;\n}\nexport interface heroattribute extends handle {\n  heroattributeId: number;\n}\nexport interface defensetype extends handle {\n  defensetypeId: number;\n}\nexport interface regentype extends handle {\n  regentypeId: number;\n}\nexport interface unitcategory extends handle {\n  unitcategoryId: number;\n}\nexport interface pathingflag extends handle {\n  pathingflagId: number;\n}\nexport interface agent extends handle {\n  agentId: number;\n}\nexport interface event extends agent {\n  eventId: number | handle;\n  type: eventid | frameeventtype;\n  player?: player;\n  region?: region;\n  trackable?: trackable;\n  filter?: boolexpr;\n  button?: button;\n  dialog?: dialog;\n  gamestate?: gamestate;\n  limitop?: limitop;\n  limitval?: number;\n}\nexport interface player extends agent {\n  alliances: Map<player, Map<alliancetype, boolean>>;\n  color: playercolor;\n  controller: mapcontrol;\n  name: string;\n  onScoreScreen: boolean;\n  playerId: number;\n  racePreference: racepreference;\n  raceSelectable: boolean;\n  slotState: playerslotstate;\n  startLocation: number;\n  taxRates: Map<player, Map<playerstate, number>>;\n  team: number;\n  onChat: (message: string) => void;\n  addChatListener: (\n    callback: (message: string) => void,\n    // deno-lint-ignore no-explicit-any\n    reference: any,\n  ) => void;\n}\nexport interface widget extends agent {\n  widgetId: number;\n  x: number;\n  y: number;\n  life: number;\n}\nexport interface unit extends widget {\n  // data: import(\"w3xdata\").UnitSpec;\n  facing: number;\n  owner: player;\n  type: number;\n  unitId: number;\n}\nexport interface destructable extends widget {\n  destructableId: number;\n}\nexport interface item extends widget {\n  itemId: number;\n}\nexport interface ability extends agent {\n  abilityId: number;\n}\nexport interface buff extends ability {\n  buffId: number;\n}\nexport interface force extends agent {\n  forceId: number;\n  players: Set<player>;\n  _array?: Array<player>;\n}\nexport interface group extends agent {\n  groupId: number;\n  units: Set<unit>;\n  _array?: Array<unit>;\n}\nexport interface trigger extends agent {\n  actions: Array<triggeraction>;\n  conditions: Array<triggercondition>;\n  enabled: boolean;\n  evaluate: () => boolean;\n  evaluations: number;\n  events: Array<event>;\n  execute: () => void;\n  executions: number;\n  triggerId: number;\n  waitOnSleeps: boolean;\n}\nexport interface triggercondition extends agent {\n  triggerconditionId: number;\n  condition: boolexpr;\n}\nexport interface triggeraction extends handle {\n  triggeractionId: number;\n  func: () => void;\n}\nexport interface timer extends agent {\n  active: boolean;\n  callback: (() => void) | null;\n  interval: number;\n  lastTick: number;\n  nextTick: number;\n  periodic: boolean;\n  start: number;\n  timerId: number;\n}\nexport interface location extends agent {\n  locationId: number;\n  x: number;\n  y: number;\n}\nexport interface region extends agent {\n  // deno-lint-ignore no-explicit-any\n  addEnterListener: (callback: (unit: unit) => void, reference: any) => void;\n  contains: <T extends { x: number; y: number }>(point: T) => boolean;\n  regionId: number;\n  addUnit: (unit: unit) => void;\n  rects: rect[];\n}\nexport interface rect extends agent {\n  maxX: number;\n  maxY: number;\n  minX: number;\n  minY: number;\n  rectId: number;\n  contains: <T extends { x: number; y: number }>(point: T) => boolean;\n}\nexport interface boolexpr extends agent {\n  boolexprId: number;\n  func: () => boolean;\n}\nexport interface sound extends agent {\n  soundId: number;\n}\nexport interface conditionfunc extends boolexpr {\n  conditionfuncId: number;\n}\nexport interface filterfunc extends boolexpr {\n  filterfuncId: number;\n}\nexport interface unitpool extends handle {\n  unitpoolId: number;\n}\nexport interface itempool extends handle {\n  itempoolId: number;\n}\nexport interface race extends handle {\n  raceId: number;\n}\nexport interface alliancetype extends handle {\n  alliancetypeId: number;\n}\nexport interface racepreference extends handle {\n  racepreferenceId: number;\n}\nexport interface gamestate extends handle {\n  gamestateId: number;\n}\nexport interface igamestate extends gamestate {\n  igamestateId: number;\n}\nexport interface fgamestate extends gamestate {\n  fgamestateId: number;\n}\nexport interface playerstate extends handle {\n  playerstateId: number;\n}\nexport interface playerscore extends handle {\n  playerscoreId: number;\n}\nexport interface playergameresult extends handle {\n  playergameresultId: number;\n}\nexport interface unitstate extends handle {\n  unitstateId: number;\n}\nexport interface aidifficulty extends handle {\n  aidifficultyId: number;\n}\n\nexport interface eventid extends handle {\n  eventidId: number;\n}\nexport interface gameevent extends eventid {\n  gameeventId: number;\n}\nexport interface playerevent extends eventid {\n  playereventId: number;\n}\nexport interface playerunitevent extends eventid {\n  playeruniteventId: number;\n}\nexport interface unitevent extends eventid {\n  uniteventId: number;\n}\nexport interface limitop extends eventid {\n  limitopId: number;\n}\nexport interface widgetevent extends eventid {\n  widgeteventId: number;\n}\nexport interface dialogevent extends eventid {\n  dialogeventId: number;\n}\nexport interface unittype extends handle {\n  unittypeId: number;\n}\n\nexport interface gamespeed extends handle {\n  gamespeedId: number;\n}\nexport interface gamedifficulty extends handle {\n  gamedifficultyId: number;\n}\nexport interface gametype extends handle {\n  gametypeId: number;\n}\nexport interface mapflag extends handle {\n  mapflagId: number;\n}\nexport interface mapvisibility extends handle {\n  mapvisibilityId: number;\n}\nexport interface mapsetting extends handle {\n  mapsettingId: number;\n}\nexport interface mapdensity extends handle {\n  mapdensityId: number;\n}\nexport interface mapcontrol extends handle {\n  mapcontrolId: number;\n}\nexport interface playerslotstate extends handle {\n  playerslotstateId: number;\n}\nexport interface volumegroup extends handle {\n  volumegroupId: number;\n}\nexport interface camerafield extends handle {\n  camerafieldId: number;\n}\nexport interface camerasetup extends handle {\n  camerasetupId: number;\n}\nexport interface playercolor extends handle {\n  playercolorId: number;\n}\nexport interface placement extends handle {\n  placementId: number;\n}\nexport interface startlocprio extends handle {\n  startlocprioId: number;\n}\nexport interface raritycontrol extends handle {\n  raritycontrolId: number;\n}\nexport interface blendmode extends handle {\n  blendmodeId: number;\n}\nexport interface texmapflags extends handle {\n  texmapflagsId: number;\n}\nexport interface effect extends agent {\n  effectId: number;\n}\nexport interface effecttype extends handle {\n  effecttypeId: number;\n}\nexport interface weathereffect extends handle {\n  weathereffectId: number;\n}\nexport interface terraindeformation extends handle {\n  terraindeformationId: number;\n}\nexport interface fogstate extends handle {\n  fogstateId: number;\n}\nexport interface fogmodifier extends agent {\n  fogmodifierId: number;\n}\nexport interface dialog extends agent {\n  dialogId: number;\n}\nexport interface button extends agent {\n  buttonId: number;\n}\nexport interface quest extends agent {\n  questId: number;\n}\nexport interface questitem extends agent {\n  questitemId: number;\n}\nexport interface defeatcondition extends agent {\n  defeatconditionId: number;\n}\nexport interface timerdialog extends agent {\n  timerdialogId: number;\n}\nexport interface leaderboard extends agent {\n  leaderboardId: number;\n}\nexport interface multiboard extends agent {\n  multiboardId: number;\n}\nexport interface multiboarditem extends agent {\n  multiboarditemId: number;\n}\nexport interface trackable extends agent {\n  trackableId: number;\n}\nexport interface gamecache extends agent {\n  gamecacheId: number;\n}\nexport interface version extends handle {\n  versionId: number;\n}\nexport interface itemtype extends handle {\n  itemtypeId: number;\n}\nexport interface texttag extends handle {\n  texttagId: number;\n}\nexport interface attacktype extends handle {\n  attacktypeId: number;\n}\nexport interface damagetype extends handle {\n  damagetypeId: number;\n}\nexport interface weapontype extends handle {\n  weapontypeId: number;\n}\nexport interface soundtype extends handle {\n  soundtypeId: number;\n}\nexport interface lightning extends handle {\n  lightningId: number;\n}\nexport interface pathingtype extends handle {\n  pathingtypeId: number;\n}\nexport interface mousebuttontype extends handle {\n  mousebuttontypeId: number;\n}\nexport interface animtype extends handle {\n  animtypeId: number;\n}\nexport interface subanimtype extends handle {\n  subanimtypeId: number;\n}\nexport interface image extends handle {\n  imageId: number;\n}\nexport interface ubersplat extends handle {\n  ubersplatId: number;\n}\nexport interface hashtable extends agent {\n  hashtableId: number;\n}\nexport interface framehandle extends handle {\n  framehandleId: number;\n  // name: string;\n  def: any\n  parent: framehandle | null;\n  // priority: number;\n  // createContext: number;\n  typeName?: string;\n  inherits?: string;\n  node: unknown;\n  width: number;\n  height: number;\n  pos: {\n    left: FrameSide;\n    top: FrameSide;\n    right: FrameSide;\n    bottom: FrameSide;\n    center: RelativeFrameSide | { x: number; y: number } | undefined;\n  };\n  children: framehandle[];\n  text?: string;\n  visible: boolean;\n  scale: number;\n  image?: string;\n  controlStyles?: string[];\n  fontSize?: number;\n  alpha?: number;\n  \n}\nexport interface originframetype extends handle {\n  originframetypeId: number;\n}\nexport interface framepointtype extends handle {\n  framepointtypeId: number;\n}\nexport interface textaligntype extends handle {\n  textaligntypeId: number;\n}\nexport interface frameeventtype extends handle {\n  frameeventtypeId: number;\n}\nexport interface oskeytype extends handle {\n  oskeytypeId: number;\n}\nexport interface abilityintegerfield extends handle {\n  abilityintegerfieldId: number;\n}\nexport interface abilityrealfield extends handle {\n  abilityrealfieldId: number;\n}\nexport interface abilitybooleanfield extends handle {\n  abilitybooleanfieldId: number;\n}\nexport interface abilitystringfield extends handle {\n  abilitystringfieldId: number;\n}\nexport interface abilityintegerlevelfield extends handle {\n  abilityintegerlevelfieldId: number;\n}\nexport interface abilityreallevelfield extends handle {\n  abilityreallevelfieldId: number;\n}\nexport interface abilitybooleanlevelfield extends handle {\n  abilitybooleanlevelfieldId: number;\n}\nexport interface abilitystringlevelfield extends handle {\n  abilitystringlevelfieldId: number;\n}\nexport interface abilityintegerlevelarrayfield extends handle {\n  abilityintegerlevelarrayfieldId: number;\n}\nexport interface abilityreallevelarrayfield extends handle {\n  abilityreallevelarrayfieldId: number;\n}\nexport interface abilitybooleanlevelarrayfield extends handle {\n  abilitybooleanlevelarrayfieldId: number;\n}\nexport interface abilitystringlevelarrayfield extends handle {\n  abilitystringlevelarrayfieldId: number;\n}\nexport interface unitintegerfield extends handle {\n  unitintegerfieldId: number;\n}\nexport interface unitrealfield extends handle {\n  unitrealfieldId: number;\n}\nexport interface unitbooleanfield extends handle {\n  unitbooleanfieldId: number;\n}\nexport interface unitstringfield extends handle {\n  unitstringfieldId: number;\n}\nexport interface unitweaponintegerfield extends handle {\n  unitweaponintegerfieldId: number;\n}\nexport interface unitweaponrealfield extends handle {\n  unitweaponrealfieldId: number;\n}\nexport interface unitweaponbooleanfield extends handle {\n  unitweaponbooleanfieldId: number;\n}\nexport interface unitweaponstringfield extends handle {\n  unitweaponstringfieldId: number;\n}\nexport interface itemintegerfield extends handle {\n  itemintegerfieldId: number;\n}\nexport interface itemrealfield extends handle {\n  itemrealfieldId: number;\n}\nexport interface itembooleanfield extends handle {\n  itembooleanfieldId: number;\n}\nexport interface itemstringfield extends handle {\n  itemstringfieldId: number;\n}\nexport interface movetype extends handle {\n  movetypeId: number;\n}\nexport interface targetflag extends handle {\n  targetflagId: number;\n}\nexport interface armortype extends handle {\n  armortypeId: number;\n}\nexport interface heroattribute extends handle {\n  heroattributeId: number;\n}\nexport interface defensetype extends handle {\n  defensetypeId: number;\n}\nexport interface regentype extends handle {\n  regentypeId: number;\n}\nexport interface unitcategory extends handle {\n  unitcategoryId: number;\n}\nexport interface pathingflag extends handle {\n  pathingflagId: number;\n}\n","import {\n  FrameSide,\n  framehandle,\n  FRAMEEVENT_CHECKBOX_CHECKED,\n  FRAMEEVENT_CHECKBOX_UNCHECKED,\n  FRAMEEVENT_CONTROL_CLICK,\n  FRAMEEVENT_EDITBOX_ENTER,\n  FRAMEEVENT_EDITBOX_TEXT_CHANGED,\n  FRAMEEVENT_MOUSE_DOUBLECLICK,\n  FRAMEEVENT_MOUSE_DOWN,\n  FRAMEEVENT_MOUSE_ENTER,\n  FRAMEEVENT_MOUSE_LEAVE,\n  FRAMEEVENT_MOUSE_UP,\n  FRAMEEVENT_MOUSE_WHEEL,\n  FRAMEEVENT_SLIDER_VALUE_CHANGED,\n  originframetype,\n  frameeventtype,\n} from \"./customUiApi\";\nimport { FrameLib } from \"./frames\";\n\nconst frameEventMap = new Map([\n  [FRAMEEVENT_CONTROL_CLICK, \"click\"],\n  [FRAMEEVENT_MOUSE_ENTER, \"mouseenter\"],\n  [FRAMEEVENT_MOUSE_LEAVE, \"mouseleave\"],\n  [FRAMEEVENT_MOUSE_UP, \"mouseup\"],\n  [FRAMEEVENT_MOUSE_DOWN, \"mousedown\"],\n  [FRAMEEVENT_MOUSE_WHEEL, \"wheel\"],\n  // TODO: need to wrap these...\n  [FRAMEEVENT_CHECKBOX_CHECKED, \"change\"],\n  [FRAMEEVENT_CHECKBOX_UNCHECKED, \"change\"],\n  [FRAMEEVENT_EDITBOX_TEXT_CHANGED, \"change\"],\n  // [FRAMEEVENT_POPUPMENU_ITEM_CHANGED]\n  [FRAMEEVENT_MOUSE_DOUBLECLICK, \"dblclick\"],\n  // [FRAMEEVENT_SPRITE_ANIM_UPDATE]\n  [FRAMEEVENT_SLIDER_VALUE_CHANGED, \"change\"],\n  // [FRAMEEVENT_DIALOG_CANCEL]\n  // FRAMEEVENT_DIALOG_ACCEPT\n  // TODO: need to wrap this...\n  [FRAMEEVENT_EDITBOX_ENTER, \"keypress\"],\n]);\n\nconst frameMap = new Map<HTMLElement, framehandle>();\nconst nodeMap = new Map<framehandle, HTMLElement>();\n// values depend on key\nconst positionDependencies = new WeakMap<framehandle, Set<framehandle>>();\nconst reversePositionDependencies = new WeakMap<\n  framehandle,\n  Set<Set<framehandle>>\n>();\nconst markDeps = (frame: framehandle, side: FrameSide) => {\n  if (typeof side !== \"object\") return;\n  if (side.relative == undefined) return;\n  let deps = positionDependencies.get(side.relative);\n  if (!deps) {\n    deps = new Set();\n    positionDependencies.set(side.relative, deps);\n  }\n  deps.add(frame);\n\n  let reverseDeps = reversePositionDependencies.get(frame);\n  if (!reverseDeps) {\n    reverseDeps = new Set();\n    reversePositionDependencies.set(frame, reverseDeps);\n  }\n  reverseDeps.add(deps);\n};\n\nconst resolveX = (frame: framehandle, side: FrameSide): number | undefined => {\n  if (side === undefined) return undefined;\n  if (typeof side === \"number\") return side;\n  if (side.relative == null) return 1;\n  if (typeof side.relativeSide === \"string\") {\n    markDeps(frame, side);\n\n    const { width } = getSize(side.relative);\n    const xAnchor = getXAnchor(side.relative, width);\n    if (xAnchor === undefined) return;\n\n    const parentOffset = side.relativeSide === \"center\"\n      ? (width ?? 0) / 2\n      : side.relativeSide.includes(\"right\")\n        ? (width ?? 0)\n        : 0;\n    return xAnchor + parentOffset + side.xOffset * getFrameScale(frame);\n  }\n};\n\nconst resolveY = (frame: framehandle, side: FrameSide): number | undefined => {\n  if (side === undefined) return undefined;\n  if (typeof side === \"number\") return side;\n  if (side.relative == null) return 1.0 / 4 * 3;\n  if (typeof side.relativeSide === \"string\") {\n    markDeps(frame, side);\n\n    const { height } = getSize(side.relative);\n    const yAnchor = getYAnchor(side.relative, height);\n    if (yAnchor === undefined) return;\n\n    const parentOffset = side.relativeSide === \"center\"\n      ? (height ?? 0) / 2\n      : side.relativeSide.includes(\"bottom\")\n        ? (height ?? 0)\n        : 0;\n    return yAnchor - parentOffset + side.yOffset * getFrameScale(frame);\n  }\n};\n\nconst getFrameScale = (frame: framehandle): number =>\n  frame.scale * (frame.parent ? getFrameScale(frame.parent) : 1);\n\nconst getSize = (\n  frame: framehandle,\n): {\n  width: number | undefined;\n  height: number | undefined;\n  implicitWidth: boolean;\n  implicitHeight: boolean;\n} => {\n  const widthFrom =\n    frame.pos.left !== undefined && frame.pos.right !== undefined\n      ? \"points\"\n      : frame.width\n        ? \"explicit\"\n        : \"implicit\";\n  let width: number | undefined;\n  if (widthFrom === \"explicit\") width = frame.width * getFrameScale(frame);\n  else if (widthFrom === \"points\") {\n    width = resolveX(frame, frame.pos.right)! -\n      resolveX(frame, frame.pos.left)!;\n  } else if (widthFrom === \"implicit\") {\n    const element = nodeMap.get(frame);\n    if (element) {\n      const oldOpacity = element.style.opacity;\n      const oldVisibility = element.style.visibility;\n      element.style.opacity = \"0\";\n      element.style.visibility = \"visible\";\n      width = px2wc(element.clientWidth);\n      element.style.visibility = oldVisibility;\n      element.style.opacity = oldOpacity;\n    }\n  }\n\n  const heightFrom =\n    frame.pos.top !== undefined && frame.pos.bottom !== undefined\n      ? \"points\"\n      : frame.height\n        ? \"explicit\"\n        : \"implicit\";\n  let height: number | undefined;\n  if (heightFrom === \"explicit\") height = frame.height * getFrameScale(frame);\n  else if (heightFrom === \"points\") {\n    height = resolveY(frame, frame.pos.top)! -\n      resolveY(frame, frame.pos.bottom)!;\n  } else if (heightFrom === \"implicit\") {\n    const element = nodeMap.get(frame);\n    if (element) {\n      const oldOpacity = element.style.opacity;\n      const oldVisibility = element.style.visibility;\n      element.style.opacity = \"0\";\n      element.style.visibility = \"visible\";\n      height = px2wc(element.clientHeight);\n      element.style.visibility = oldVisibility;\n      element.style.opacity = oldOpacity;\n    }\n  }\n\n  return {\n    width,\n    height,\n    implicitWidth: widthFrom === \"implicit\",\n    implicitHeight: heightFrom === \"implicit\",\n  };\n};\n\n/** Returns how many wc units the frame's top is from the bottom */\nconst getYAnchor = (\n  frame: framehandle,\n  height?: number,\n): number | undefined => {\n  let top: number | undefined;\n\n  // Simple top\n  if (frame.pos.top !== undefined) top = resolveY(frame, frame.pos.top);\n  if (top !== undefined) return top;\n\n  // Through bottom\n  if (frame.pos.bottom !== undefined && height !== undefined) {\n    const bot = resolveY(frame, frame.pos.bottom);\n    if (bot !== undefined) return bot + height;\n  }\n\n  // Through center\n  if (frame.pos.center && height !== undefined) {\n    // With abs position\n    if (\"y\" in frame.pos.center) return frame.pos.center.y + height / 2;\n\n    if (frame.parent) {\n      const top = resolveY(frame, frame.pos.center);\n      if (top !== undefined) return top + height / 2;\n    }\n  }\n\n  // Implicit center\n  if (\n    frame.pos.top === undefined && frame.pos.bottom === undefined &&\n    (frame.pos.left !== undefined || frame.pos.right !== undefined) &&\n    height !== undefined\n  ) {\n    const relative = typeof frame.pos.left === \"object\"\n      ? frame.pos.left.relative\n      : typeof frame.pos.right === \"object\"\n        ? frame.pos.right.relative\n        : undefined;\n    if (relative) {\n      const relativeHeight = getSize(relative).height;\n      const relativeTop = getYAnchor(relative, relativeHeight);\n      if (relativeHeight !== undefined && relativeTop !== undefined) {\n        return relativeTop - relativeHeight / 2 + height / 2;\n      }\n    }\n  }\n};\n\n/** Returns how many wc units the frame's left is from the left */\nconst getXAnchor = (frame: framehandle, width?: number): number | undefined => {\n  let left: number | undefined;\n\n  // Simple left\n  if (frame.pos.left !== undefined) left = resolveX(frame, frame.pos.left);\n  if (left !== undefined) return left;\n\n  // Through right\n  if (frame.pos.right !== undefined && width !== undefined) {\n    const right = resolveX(frame, frame.pos.right);\n    if (right !== undefined) return right - width;\n  }\n\n  // Through center\n  if (frame.pos.center && width !== undefined) {\n    // With abs position\n    if (\"x\" in frame.pos.center) return frame.pos.center.x - width / 2;\n\n    if (frame.parent) {\n      const left = resolveX(frame, frame.pos.center);\n      if (left !== undefined) return left - width / 2;\n    }\n  }\n\n  // Implicit center\n  if (\n    frame.pos.left === undefined && frame.pos.right === undefined &&\n    (frame.pos.top !== undefined || frame.pos.bottom !== undefined) &&\n    width !== undefined\n  ) {\n    const relative = typeof frame.pos.top === \"object\"\n      ? frame.pos.top.relative\n      : typeof frame.pos.bottom === \"object\"\n        ? frame.pos.bottom.relative\n        : undefined;\n    if (relative) {\n      const relativeWidth = getSize(relative).width;\n      const relativeLeft = getXAnchor(relative, relativeWidth);\n      if (relativeWidth !== undefined && relativeLeft !== undefined) {\n        return relativeLeft + relativeWidth / 2 - width / 2;\n      }\n    }\n  }\n};\n\nconst getAnchor = (frame: framehandle, width?: number, height?: number) => ({\n  x: getXAnchor(frame, width),\n  y: getYAnchor(frame, height),\n});\n\nexport const getAspectRatio = (): number => {\n  return 4 / 3;\n  // window.innerWidth / window.innerHeight;\n}\n\nexport const getGlobalScale = (): number =>\n  (getAspectRatio() > 4 / 3\n    ? window.innerHeight * (4 / 3)\n    : window.innerWidth) * 1.25;\nexport const getXOffset = (): number => {\n  const ar = getAspectRatio();\n  if (ar > 4 / 3) return ((ar - 4 / 3) / 2) * window.innerHeight;\n  return 0;\n};\nexport const getYOffset = (): number => {\n  const ar = getAspectRatio();\n  if (ar > 4 / 3) return 0;\n  return (window.innerHeight - window.innerWidth * (3 / 4)) / 2;\n};\n\nexport const wc2px = (v: number): number => v * getGlobalScale();\nconst px2wc = (px: number): number => px / getGlobalScale();\n\nexport const wcy2px = (y: number): number => wc2px(0.6 - y) + getYOffset();\nexport const wcx2px = (x: number): number => wc2px(x) + getXOffset();\n\n// TODO: Is it safe to batch these calls?\nconst updateSizeAndPosition = (\n  frame: framehandle,\n  updated = new Set<framehandle>(),\n) => {\n  if (updated.has(frame)) return;\n  updated.add(frame);\n\n  const reverseDeps = reversePositionDependencies.get(frame);\n  if (reverseDeps) {\n    reverseDeps.forEach((set) => set.delete(frame));\n    reverseDeps.clear();\n  }\n\n  const { width, height, implicitWidth, implicitHeight } = getSize(frame);\n  const { x, y } = getAnchor(frame, width, height);\n  const element = nodeMap.get(frame)!;\n  element.style.left = x !== undefined ? wcx2px(x) + \"px\" : \"0\";\n  element.style.top = y !== undefined\n    ? wcy2px(y) + \"px\"\n    : x !== undefined\n      ? \"\"\n      : \"0\";\n\n  if (width !== undefined && !implicitWidth) {\n    element.style.width = wc2px(width) + \"px\";\n  }\n  if (height !== undefined && !implicitHeight) {\n    element.style.height = wc2px(height) + \"px\";\n  }\n\n  new Set(positionDependencies.get(frame))\n    .forEach((f) => updateSizeAndPosition(f, updated));\n};\n\nexport class Adapter {\n  createNode: (handle: framehandle, owner: framehandle) => unknown;\n  selectAll: (selectors: string) => framehandle[];\n  markOrigin: (handle: framehandle, origin: originframetype) => void;\n  setTooltip: (frameLib: FrameLib, frame: framehandle, tooltip: framehandle) => void;\n  update: (frame: framehandle) => void;\n  addFrameListener: (\n    frame: framehandle,\n    event: frameeventtype,\n    callback: () => void,\n  ) => void;\n  addListener: typeof window[\"addEventListener\"];\n  remove: (frame: framehandle) => void;\n  urlRewriter: (url: string) => string;\n\n  constructor() {\n    this.createNode = (hFrame, hParent) => {\n      const createTipSpan = (id, text) => {\n        let span = document.createElement('SPAN');\n        span.style.backgroundColor = 'black';\n        span.style.color = 'white';\n        span.innerText = text;\n        span.style.position = 'absolute';\n        span.style.left = '0';\n        span.style.top = '0';\n        span.id = 'frame-tip-' + id;\n        return span;\n      }\n      const div = <HTMLSpanElement>document.createElement(\"span\");\n      frameMap.set(div, hFrame);\n      nodeMap.set(hFrame, div);\n      // absolute 表示相对于爸爸元素的绝对位置（LT,LB,RT,RB）之一\n      // relative, fixed等除static之外的position可以使内部的绝对定位元素相对于此元素定位\n      div.style.position = hFrame.def.SetAllPoints ? \"relative\" : 'absolute';\n      div.onmouseover = function (e) {\n        div.style.border = '1px dashed purple';\n        let n = 1;\n        let ht = setInterval(() => {\n          div.style.border = n / 2 == 0 ? '1px dashed white' : '1px dashed purple';\n          n++\n        }, 300);\n        let span = createTipSpan(hFrame.handleId, hFrame.def.name);\n        div.appendChild(span);\n        div.onmouseleave = function (e) {\n          div.removeChild(span);\n          clearTimeout(ht);\n        }\n      }\n      div.dataset['def'] = JSON.stringify(hFrame.def.properties);\n      Reflect.set(div, \"frame\", hFrame);\n      div.setAttribute(\"frame\", hFrame.handleId.toString());\n      div.setAttribute(\"name\", hFrame.def.name);\n      if (hParent) {\n        const parentNode = nodeMap.get(hParent);\n        if (parentNode) parentNode.appendChild(div);\n        else {\n          debugger;\n        }\n      }\n      else {\n        document.body.appendChild(div);\n      }\n      this.update(hFrame);\n      return div;\n    };\n\n    this.selectAll = (...args) =>\n      Array.from(document.querySelectorAll(...args))\n        .filter((e): e is HTMLElement => e instanceof HTMLElement)\n        .map((e) => frameMap.get(e))\n        .filter((h): h is framehandle => !!h);\n\n    this.markOrigin = (handle, origin) => {\n      const e = nodeMap.get(handle);\n      e?.classList.add(`origin-${origin.originframetypeId}`);\n      if (e) document.body.appendChild(e);\n    };\n\n    this.setTooltip = (frameLib, frame, tooltip) => {\n      frameLib.BlzFrameSetVisible(tooltip, false);\n      const element = nodeMap.get(frame);\n      if (!element) return;\n      element.addEventListener(\n        \"mouseenter\",\n        () => frameLib.BlzFrameSetVisible(tooltip, true),\n      );\n      element.addEventListener(\n        \"mouseleave\",\n        () => frameLib.BlzFrameSetVisible(tooltip, false),\n      );\n    };\n\n    this.urlRewriter = (url) => `url(${url})`;\n\n    this.update = (frame) => {\n      const element = nodeMap.get(frame);\n      if (!element) return;\n\n      // text\n      if (typeof frame.text === \"string\") {\n        const html = frame.text\n          .replace(/\\|cff([0-9a-fA-F]{6})/g, '<div style=\"color: #$1\">')\n          .replace(/\\|r/g, \"</div>\")\n          .replace(/\\|n/g, \"<br/>\");\n        (element as unknown as { setHTML: (html: string) => void }).setHTML(html);\n\n        if (typeof frame.fontSize === \"number\") {\n          element.style.fontSize = wc2px(frame.fontSize) + \"px\";\n        }\n      }\n\n      if (typeof frame.image === \"string\") {\n        element.style.backgroundImage = this.urlRewriter(frame.image);\n        element.style.backgroundSize = \"cover\";\n      }\n\n      // visible\n      const visibilityChange =\n        frame.visible !== (element.style.visibility !== \"hidden\");\n      if (visibilityChange) {\n        element.style.visibility = frame.visible ? \"\" : \"hidden\";\n      }\n\n      if (typeof frame.alpha === \"number\") {\n        element.style.opacity = (frame.alpha / 255).toString();\n      }\n\n      // size & points\n      const updated = new Set<framehandle>();\n      const originalLeft = element.style.left;\n      const originalTop = element.style.top;\n      updateSizeAndPosition(frame, updated);\n      if (visibilityChange) {\n        frame.children.forEach((child) => updateSizeAndPosition(child, updated));\n      }\n      // 在updateSizeAndPosition调用之后，添加限制逻辑\n      if (element.style.left && wc2px(parseFloat(element.style.left.slice(0, -2))) < 0) {\n        element.style.left = \"0px\";\n      } else if (originalLeft) {\n        element.style.left = originalLeft; // 保持原始值，以防它被其他逻辑修改\n      }\n\n      if (element.style.top && wc2px(parseFloat(element.style.top.slice(0, -2))) < 0) {\n        element.style.top = \"0px\";\n      } else if (originalTop) {\n        element.style.top = originalTop; // 保持原始值，以防它被其他逻辑修改\n      }\n    };\n\n    this.addFrameListener = (frame, event, callback) => {\n      const element = nodeMap.get(frame);\n      if (!element) return;\n\n      const stringEvent = frameEventMap.get(event);\n      if (stringEvent) element.addEventListener(stringEvent, callback);\n      else {\n        throw new Error(\n          `BlzTriggerRegisterFrameEvent with ${JSON.stringify(event)}}`,\n        );\n      }\n    };\n\n    this.addListener = (...args: Parameters<typeof window[\"addEventListener\"]>) =>\n      window.addEventListener(...args);\n\n    this.remove = (frame) => {\n      const element = nodeMap.get(frame);\n      if (!element) return;\n\n      element.remove();\n    }\n  }\n};\n","// deno-lint-ignore-file no-unused-vars\n\nimport { Adapter } from \"./adapter\";\nimport {\n  FRAMEPOINT_BOTTOM,\n  FRAMEPOINT_BOTTOMLEFT,\n  FRAMEPOINT_BOTTOMRIGHT,\n  FRAMEPOINT_CENTER,\n  FRAMEPOINT_LEFT,\n  FRAMEPOINT_RIGHT,\n  FRAMEPOINT_TOP,\n  FRAMEPOINT_TOPLEFT,\n  FRAMEPOINT_TOPRIGHT,\n  originframetype,\n  framehandle,\n  framepointtype,\n  RelativeFrameSide,\n  textaligntype,\n  frameeventtype,\n  trigger,\n  event,\n  handle\n} from \"./customUiApi\";\nimport { FdfArg, FdfFrame } from \"./fdf\";\nconst posRelatativeToWindow = () => {\n  return {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    center: undefined,\n  }\n}\nconst posRelatativeToParent = (parent: framehandle) => {\n  return {\n    top: {\n      relative: parent,\n      relativeSide: \"top\",\n      xOffset: 0,\n      yOffset: 0,\n    },\n    bottom: {\n      relative: parent,\n      relativeSide: \"bottom\",\n      xOffset: 0,\n      yOffset: 0,\n    },\n    left: {\n      relative: parent,\n      relativeSide: \"left\",\n      xOffset: 0,\n      yOffset: 0,\n    },\n    right: {\n      relative: parent,\n      relativeSide: \"right\",\n      xOffset: 0,\n      yOffset: 0,\n    },\n    center: undefined,\n  }\n}\ntype ParseArg<T> = {\n  (\n    args: ReadonlyArray<FdfArg> | undefined,\n    name: string,\n    fn: (text: T) => void,\n  ): void;\n  (\n    args: ReadonlyArray<FdfArg> | undefined,\n    name: string,\n    index: number,\n    fn: (text: T) => void,\n  ): void;\n};\n\nconst parseString = ((\n  args: ReadonlyArray<FdfArg> | undefined,\n  name: string,\n  index: number | ((text: string) => void),\n  fn: undefined | ((text: string) => void),\n) => {\n  if (typeof index === \"function\") {\n    fn = index;\n    index = 0;\n  }\n\n  const value = args?.[index];\n  if (typeof value === \"string\") fn!(value);\n  else {\n    console.warn(\n      `Expected string for ${name}, got: ${JSON.stringify(value)\n      } (index ${index}) in ${JSON.stringify(args)}`,\n    );\n  }\n}) as ParseArg<string>;\n\nconst parseNumber = ((\n  args: ReadonlyArray<FdfArg> | undefined,\n  name: string,\n  index: number | ((value: number) => void),\n  fn: undefined | ((value: number) => void),\n) => {\n  if (typeof index === \"function\") {\n    fn = index;\n    index = 0;\n  }\n\n  const value = args?.[index];\n  if (typeof value === \"number\") fn!(value);\n  else {\n    console.warn(\n      `Expected number for ${name}, got: ${JSON.stringify(value)\n      } (index ${index}) in ${JSON.stringify(args)}`,\n    );\n  }\n}) as ParseArg<number>;\nexport class FrameLib {\n\n  createFrame: (def, parent: framehandle | null) => framehandle;\n  BlzCreateFrame: (name: string, owner: framehandle, priority: number, createContext: number) => framehandle;\n  BlzCreateSimpleFrame: (name: string, owner: framehandle, createContext: number) => framehandle;\n  BlzCreateFrameByType: (typeName: string, name: string, owner: framehandle, inherits: string, createContext: number) => framehandle;\n  BlzDestroyFrame: (frame: framehandle) => void;\n  BlzFrameSetPoint: (frame: framehandle, point: framepointtype, relative: framehandle, relativePoint: framepointtype, x: number, y: number) => void;\n  BlzFrameSetAbsPoint: (frame: framehandle, point: framepointtype, x: number, y: number) => void;\n  BlzFrameClearAllPoints: (frame: framehandle) => void;\n  BlzFrameSetAllPoints: (frame: framehandle, relative: framehandle) => void;\n  BlzFrameSetVisible: (frame: framehandle | null, visible: boolean) => void;\n  BlzFrameIsVisible: (frame: framehandle) => boolean;\n  BlzGetFrameByName: (name: string, createContext: number) => framehandle;\n  BlzFrameGetName: (frame: framehandle) => string;\n  BlzFrameClick: (frame: framehandle) => void;\n  BlzFrameSetText: (frame: framehandle, text: string) => void;\n  BlzFrameGetText: (frame: framehandle) => string | undefined;\n  BlzFrameAddText: (frame: framehandle, text: string) => void;\n  BlzFrameSetTextSizeLimit: (frame: framehandle, size: number) => void;\n  BlzFrameGetTextSizeLimit: (frame: framehandle) => number;\n  BlzFrameSetTextColor: (frame: framehandle, color: number) => void;\n  BlzFrameSetFocus: (frame: framehandle, flag: boolean) => void;\n  BlzFrameSetModel: (frame: framehandle, modelFile: string, cameraIndex: number) => void;\n  BlzFrameSetEnable: (frame: framehandle, enabled: boolean) => void;\n  BlzFrameGetEnable: (frame: framehandle) => boolean;\n  BlzFrameSetAlpha: (frame: framehandle, alpha: number) => void;\n  BlzFrameGetAlpha: (frame: framehandle) => number;\n  BlzFrameSetSpriteAnimate: (frame: framehandle, primaryProp: number, flags: number) => void;\n  BlzFrameSetTexture: (frame: framehandle, texFile: string, flag: number, blend: boolean) => void;\n  BlzFrameSetScale: (frame: framehandle, scale: number) => void;\n  BlzFrameSetTooltip: (frame: framehandle, tooltip: framehandle) => void;\n  BlzFrameCageMouse: (frame: framehandle, enable: boolean) => void;\n  BlzFrameSetValue: (frame: framehandle, value: number) => void;\n  BlzFrameGetValue: (frame: framehandle) => number;\n  BlzFrameSetMinMaxValue: (frame: framehandle, minValue: number, maxValue: number) => void;\n  BlzFrameSetStepSize: (frame: framehandle, stepSize: number) => void;\n  BlzFrameSetSize: (frame: framehandle, width: number, height: number) => void;\n  BlzFrameSetVertexColor: (frame: framehandle, color: number) => void;\n  BlzFrameSetLevel: (frame: framehandle, level: number) => void;\n  BlzFrameSetParent: (frame: framehandle, parent: framehandle) => void;\n  BlzFrameGetParent: (frame: framehandle) => framehandle | null;\n  BlzFrameGetHeight: (frame: framehandle) => number;\n  BlzFrameGetWidth: (frame: framehandle) => number;\n  BlzFrameSetFont: (frame: framehandle, fileName: string, height: number, flags: number) => void;\n  BlzFrameSetTextAlignment: (frame: framehandle, vert: textaligntype, horz: textaligntype) => void;\n  BlzTriggerRegisterFrameEvent: (whichTrigger: trigger, frame: framehandle, eventId: frameeventtype) => event;\n  BlzGetTriggerFrame: () => framehandle;\n  BlzGetTriggerFrameEvent: () => frameeventtype;\n  BlzGetTriggerFrameValue: () => number;\n  BlzGetTriggerFrameText: () => string;\n  BlzFrameGetChildrenCount: (frame: framehandle) => number;\n  BlzFrameGetChild: (frame: framehandle, index: number) => framehandle;\n  frameDefs: {};\n  BlzGetOriginFrame: (frameType: originframetype, index: number) => framehandle;\n  BlzEnableUIAutoPosition: (enable: boolean) => void;\n  BlzHideOriginFrames: (enable: boolean) => void;\n  BlzConvertColor: (a: number, r: number, g: number, b: number) => number;\n  idNext = 10000;\n  constructor(frameDefs, adapter: Adapter) {\n    this.frameDefs = frameDefs;\n    this.BlzGetOriginFrame = (\n      frameType: originframetype,\n      index: number,\n    ): framehandle =>\n      adapter.selectAll(\".origin-\" + frameType.originframetypeId)[index];\n\n    const newFrame = (def, id, parent: framehandle | null) => {\n      const isRelativeToRoot = def.setAllPoints || !parent;\n      return <framehandle>{\n        handleId: id,\n        framehandleId: id,\n        parent: parent,\n        def: def,\n        node: null,\n        width: 0,\n        height: 0,\n        pos: isRelativeToRoot ? posRelatativeToWindow() : posRelatativeToParent(parent),\n        children: [],\n        visible: true,\n        scale: 1,\n      }\n    }\n    this.BlzEnableUIAutoPosition = (enable: boolean): void => { };\n\n    this.BlzHideOriginFrames = (enable: boolean): void => { };\n\n    this.BlzConvertColor = (\n      a: number,\n      r: number,\n      g: number,\n      b: number,\n    ): number => a * 255 ** 3 + r * 255 ** 2 + g * 255 + b;\n    this.createFrame = (def, parent) => {\n      const id = this.idNext++;\n      const fh: framehandle = newFrame(def, id, parent);\n      // owner may be missing on root frame\n      parent?.children.push(fh);\n      const inherits: FdfFrame | undefined =\n        this.frameDefs[def.inherits ?? def.name];\n      let decorateFileNames = false;\n      const functionalChildren = new Set<string>();\n      if (inherits) {\n        for (const property of (inherits.properties ?? [])) {\n          const args = property.args;\n          switch (property.name) {\n            case 'SetAllPoints': // 相对于根节点定位?\n              fh.pos = {\n                left: 0,\n                right: 0,\n                bottom: 0,\n                top: 0,\n                center: undefined,\n              };\n              break;\n            case \"DecorateFileNames\":\n              decorateFileNames = true;\n              break;\n            case \"ButtonText\":\n              parseString(\n                args,\n                \"ButtonText\",\n                (name) => functionalChildren.add(name),\n              );\n              break;\n            case \"Text\":\n              parseString(args, \"Text\", (text) => fh.text = text);\n              break;\n            case \"Width\":\n              parseNumber(args, \"Width\", (width) => fh.width = width);\n              break;\n            case \"Height\":\n              parseNumber(args, \"Height\", (height) => fh.height = height);\n              break;\n            case \"ControlStyle\":\n              parseString(\n                args,\n                \"ControlStyle\",\n                (styles) => fh.controlStyles = styles.split(\"|\"),\n              );\n              break;\n            case \"ButtonPushedTextOffset\":\n              // IDK\n              break;\n            case \"FrameFont\":\n              parseNumber(args, \"FrameFont\", 1, (size) => fh.fontSize = size);\n              break;\n            default:\n              console.warn(`Unhandled fdf property ${property.name}`);\n          }\n        }\n      }\n\n      fh.node = adapter.createNode(fh, parent);\n\n      if (inherits) {\n        for (const child of (inherits.children ?? [])) {\n          this.createFrame(child, fh);\n        }\n      }\n\n      return fh;\n    };\n\n    this.BlzCreateFrame = (\n      name: string,\n      owner: framehandle,\n      priority: number,\n      createContext: number,\n    ): framehandle => {\n      let def = this.frameDefs[name];\n      if (def == null)\n        throw new Error('FrameNotFound');\n      return this.createFrame(def, owner);\n    }\n\n    this.BlzCreateSimpleFrame = (\n      name: string,\n      owner: framehandle,\n      createContext: number,\n    ): framehandle => {\n      let def = this.frameDefs[name];\n      if (def == null)\n        throw new Error('FrameNotFound');\n      return this.createFrame(def, owner);\n    }\n\n    this.BlzCreateFrameByType = (\n      typeName: string,\n      name: string,\n      owner: framehandle,\n      inherits: string,\n      createContext: number,\n    ): framehandle => {\n      let def = this.frameDefs[name];\n      if (def == null)\n        throw new Error('FrameNotFound');\n      return this.createFrame(def, owner);\n    };\n\n    this.BlzDestroyFrame = (frame: framehandle): void => {\n      adapter.remove(frame);\n    };\n\n\n    this.BlzFrameSetPoint = (\n      frame: framehandle,\n      point: framepointtype,\n      relative: framehandle,\n      relativePoint: framepointtype,\n      x: number,\n      y: number,\n    ): void => {\n      const relativeSide = pointMap.get(relativePoint);\n      if (!relativeSide) {\n        return console.warn(\n          \"Unknown relativePoint passed to BlzFrameSetPoint: \" +\n          relativePoint.framepointtypeId,\n        );\n      }\n\n      if (leftPoints.includes(point)) {\n        frame.pos.left = { relative, relativeSide, xOffset: x, yOffset: 0 };\n      }\n\n      if (rightPoints.includes(point)) {\n        frame.pos.right = { relative, relativeSide, xOffset: x, yOffset: 0 };\n      }\n\n      if (topPoints.includes(point)) {\n        frame.pos.top = { relative, relativeSide, xOffset: 0, yOffset: y };\n      }\n\n      if (bottomPoints.includes(point)) {\n        frame.pos.bottom = { relative, relativeSide, xOffset: 0, yOffset: y };\n      }\n\n      if (point === FRAMEPOINT_CENTER) {\n        frame.pos.center = { relative, relativeSide, xOffset: x, yOffset: y };\n      }\n\n      adapter.update(frame);\n    };\n\n    this.BlzFrameSetAbsPoint = (\n      frame: framehandle,\n      point: framepointtype,\n      x: number,\n      y: number,\n    ): void => {\n      if (leftPoints.includes(point)) frame.pos.left = x;\n      if (rightPoints.includes(point)) frame.pos.right = x;\n      if (topPoints.includes(point)) frame.pos.top = y;\n      if (bottomPoints.includes(point)) frame.pos.bottom = y;\n\n      if (point === FRAMEPOINT_CENTER) frame.pos.center = { x, y };\n\n      adapter.update(frame);\n    };\n\n    this.BlzFrameClearAllPoints = (frame: framehandle): void => {\n      frame.pos = {\n        left: undefined,\n        right: undefined,\n        bottom: undefined,\n        top: undefined,\n        center: undefined,\n      };\n    };\n\n    this.BlzFrameSetAllPoints = (\n      frame: framehandle,\n      relative: framehandle,\n    ): void => {\n      frame.pos = {\n        top: { relative, relativeSide: \"top\", xOffset: 0, yOffset: 0 },\n        bottom: { relative, relativeSide: \"bottom\", xOffset: 0, yOffset: 0 },\n        left: { relative, relativeSide: \"left\", xOffset: 0, yOffset: 0 },\n        right: { relative, relativeSide: \"right\", xOffset: 0, yOffset: 0 },\n        center: undefined,\n      };\n      adapter.update(frame);\n    };\n\n    this.BlzFrameSetVisible = (\n      frame: framehandle | null,\n      visible: boolean,\n    ): void => {\n      if (!frame) return;\n      frame.visible = visible;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameIsVisible = (frame: framehandle): boolean => {\n      console.log(\"Declared BlzFrameIsVisible\");\n      return false;\n    };\n\n    this.BlzGetFrameByName = (\n      name: string,\n      createContext: number,\n    ): framehandle => adapter.selectAll(`[name=${name}]`)[createContext];\n\n    this.BlzFrameGetName = (frame: framehandle): string => {\n      console.log(\"Declared BlzFrameGetName\");\n      return \"\";\n    };\n\n    this.BlzFrameClick = (frame: framehandle): void => { };\n\n    this.BlzFrameSetText = (frame: framehandle, text: string): void => {\n      frame.text = text;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameGetText = (frame: framehandle): string | undefined =>\n      frame.text;\n\n    this.BlzFrameAddText = (frame: framehandle, text: string): void => {\n      frame.text = (frame.text ?? \"\") + text;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameSetTextSizeLimit = (\n      frame: framehandle,\n      size: number,\n    ): void => { };\n\n    this.BlzFrameGetTextSizeLimit = (frame: framehandle): number => {\n      console.log(\"Declared BlzFrameGetTextSizeLimit\");\n      return 0;\n    };\n\n    this.BlzFrameSetTextColor = (\n      frame: framehandle,\n      color: number,\n    ): void => { };\n\n    this.BlzFrameSetFocus = (frame: framehandle, flag: boolean): void => { };\n\n    this.BlzFrameSetModel = (\n      frame: framehandle,\n      modelFile: string,\n      cameraIndex: number,\n    ): void => { };\n\n    this.BlzFrameSetEnable = (\n      frame: framehandle,\n      enabled: boolean,\n    ): void => { };\n\n    this.BlzFrameGetEnable = (frame: framehandle): boolean => {\n      console.log(\"Declared BlzFrameGetEnable\");\n      return false;\n    };\n\n    this.BlzFrameSetAlpha = (frame: framehandle, alpha: number): void => {\n      frame.alpha = alpha;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameGetAlpha = (frame: framehandle): number =>\n      frame.alpha ?? 255;\n\n    this.BlzFrameSetSpriteAnimate = (\n      frame: framehandle,\n      primaryProp: number,\n      flags: number,\n    ): void => { };\n\n    this.BlzFrameSetTexture = (\n      frame: framehandle,\n      texFile: string,\n      flag: number,\n      blend: boolean,\n    ): void => {\n      frame.image = texFile;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameSetScale = (frame: framehandle, scale: number): void => {\n      frame.scale = scale;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameSetTooltip = (\n      frame: framehandle,\n      tooltip: framehandle,\n    ): void => {\n      adapter.setTooltip(this, frame, tooltip);\n    };\n\n    this.BlzFrameCageMouse = (\n      frame: framehandle,\n      enable: boolean,\n    ): void => { };\n\n    this.BlzFrameSetValue = (frame: framehandle, value: number): void => { };\n\n    this.BlzFrameGetValue = (frame: framehandle): number => {\n      console.log(\"Declared BlzFrameGetValue\");\n      return 0;\n    };\n\n    this.BlzFrameSetMinMaxValue = (\n      frame: framehandle,\n      minValue: number,\n      maxValue: number,\n    ): void => { };\n\n    this.BlzFrameSetStepSize = (\n      frame: framehandle,\n      stepSize: number,\n    ): void => { };\n\n    this.BlzFrameSetSize = (\n      frame: framehandle,\n      width: number,\n      height: number,\n    ): void => {\n      frame.width = width;\n      frame.height = height;\n      adapter.update(frame);\n    };\n\n    this.BlzFrameSetVertexColor = (\n      frame: framehandle,\n      color: number,\n    ): void => { };\n\n    this.BlzFrameSetLevel = (frame: framehandle, level: number): void => { };\n\n    this.BlzFrameSetParent = (\n      frame: framehandle,\n      parent: framehandle,\n    ): void => { };\n\n    this.BlzFrameGetParent = (frame: framehandle): framehandle | null =>\n      frame.parent;\n\n    this.BlzFrameGetHeight = (frame: framehandle): number => {\n      console.log(\"Declared BlzFrameGetHeight\");\n      return 0;\n    };\n\n    this.BlzFrameGetWidth = (frame: framehandle): number => {\n      console.log(\"Declared BlzFrameGetWidth\");\n      return 0;\n    };\n\n    this.BlzFrameSetFont = (\n      frame: framehandle,\n      fileName: string,\n      height: number,\n      flags: number,\n    ): void => { };\n\n    this.BlzFrameSetTextAlignment = (\n      frame: framehandle,\n      vert: textaligntype,\n      horz: textaligntype,\n    ): void => { };\n\n    this.BlzTriggerRegisterFrameEvent = (\n      whichTrigger: trigger,\n      frame: framehandle,\n      eventId: frameeventtype,\n    ): event => {\n      const event = <event>{ handleId: eventId.handleId, eventId, type: eventId, agentId: whichTrigger.agentId };\n      whichTrigger.events.push(event);\n\n      adapter.addFrameListener(frame, eventId, () => {\n        if (whichTrigger.evaluate()) whichTrigger.execute();\n      });\n\n      return event;\n    };\n\n    this.BlzGetTriggerFrame = (): framehandle => {\n      console.log(\"Declared BlzGetTriggerFrame\");\n      return (null as unknown) as framehandle;\n    };\n\n    this.BlzGetTriggerFrameEvent = (): frameeventtype => {\n      console.log(\"Declared BlzGetTriggerFrameEvent\");\n      return (null as unknown) as frameeventtype;\n    };\n\n    this.BlzGetTriggerFrameValue = (): number => {\n      console.log(\"Declared BlzGetTriggerFrameValue\");\n      return 0;\n    };\n\n    this.BlzGetTriggerFrameText = (): string => {\n      console.log(\"Declared BlzGetTriggerFrameText\");\n      return \"\";\n    };\n\n    this.BlzFrameGetChildrenCount = (frame: framehandle): number =>\n      frame.children.length;\n\n    this.BlzFrameGetChild = (\n      frame: framehandle,\n      index: number,\n    ): framehandle => frame.children[index];\n  }\n}\n\n\nconst leftPoints = [FRAMEPOINT_TOPLEFT, FRAMEPOINT_LEFT, FRAMEPOINT_BOTTOMLEFT];\nconst rightPoints = [\n  FRAMEPOINT_TOPRIGHT,\n  FRAMEPOINT_RIGHT,\n  FRAMEPOINT_BOTTOMRIGHT,\n];\nconst topPoints = [FRAMEPOINT_TOPRIGHT, FRAMEPOINT_TOP, FRAMEPOINT_TOPLEFT];\nconst bottomPoints = [\n  FRAMEPOINT_BOTTOMRIGHT,\n  FRAMEPOINT_BOTTOM,\n  FRAMEPOINT_BOTTOMLEFT,\n];\nconst pointMap = new Map<framepointtype, RelativeFrameSide[\"relativeSide\"]>([\n  [FRAMEPOINT_TOPLEFT, \"topleft\"],\n  [FRAMEPOINT_TOP, \"top\"],\n  [FRAMEPOINT_TOPRIGHT, \"topright\"],\n  [FRAMEPOINT_LEFT, \"left\"],\n  [FRAMEPOINT_CENTER, \"center\"],\n  [FRAMEPOINT_RIGHT, \"right\"],\n  [FRAMEPOINT_BOTTOMLEFT, \"bottomleft\"],\n  [FRAMEPOINT_BOTTOM, \"bottom\"],\n  [FRAMEPOINT_BOTTOMRIGHT, \"bottomright\"],\n]);\n","\nimport { Adapter } from \"./adapter\";\nimport { FRAMEPOINT_BOTTOMLEFT, ORIGIN_FRAME_GAME_UI, framehandle } from \"./customUiApi\";\nimport { FrameLib } from \"./frames\";\n\n\nexport const initUI = (frameDefs) => {\n  let adapter = new Adapter();\n  let frameLib = new FrameLib(frameDefs, adapter);\n  const gameUI = frameLib.BlzCreateFrame(\n    \"Loading\",\n    null as unknown as framehandle,\n    0,\n    0,\n  );\n  frameLib.BlzFrameSetAllPoints(gameUI,null);\n  // adapter.markOrigin(gameUI, ORIGIN_FRAME_GAME_UI);\n  frameLib.BlzFrameSetAbsPoint(gameUI, FRAMEPOINT_BOTTOMLEFT, 0, 0);\n  frameLib.BlzFrameSetSize(gameUI, 0.8, 0.6);\n\n  // const consoleUI = frameLib.BlzCreateFrame(\"ConsoleUI\", gameUI, 0, 0);\n  // frameLib.BlzCreateFrame(\"idk\", consoleUI, 0, 0);\n  // frameLib.BlzCreateFrame(\"idk\", consoleUI, 0, 1);\n  // frameLib.BlzCreateFrame(\"idk\", consoleUI, 0, 2);\n  // frameLib.BlzCreateFrame(\"idk\", consoleUI, 0, 3);\n  // frameLib.BlzCreateFrame(\"idk\", consoleUI, 0, 4);\n  // frameLib.BlzCreateFrame(\"idk\", consoleUI, 0, 5);\n}\n","import { JassRuntime } from \"game/jass2js/JassRuntime\";\nimport { ArrayList } from \"../jass2js/gameFunctions\";\nimport Resource from \"../../mdx/viewer/resource\";\nimport { initUI } from \"./init\";\n\ntype Token = {\n  type:\n  | \"newline\"\n  | \"string\"\n  | \"id\"\n  | \"whitespace\"\n  | \"lcurl\"\n  | \"rcurl\"\n  | \"comma\"\n  | \"number\"\n  | \"comment\";\n  content: string;\n  index: number;\n};\n\nexport const tokenizeFdf = (\n  contents: string,\n): Token[] => {\n  const tokens: Token[] = [];\n  let index = 0;\n\n  const testAddAndAdvance = (name: Token[\"type\"], regexp: RegExp) => {\n    regexp.lastIndex = index;\n    const results = regexp.exec(contents);\n    if (results) {\n      if (name !== \"whitespace\") {\n        tokens.push({ type: name, content: results[0], index });\n      }\n      index += results[0].length;\n\n      return true;\n    }\n    return false;\n  };\n\n  while (index < contents.length) {\n    if (testAddAndAdvance(\"newline\", /(?:\\r?\\n)+/y)) continue;\n    if (testAddAndAdvance(\"string\", /\"[^\"]*\"/y)) continue;\n    if (testAddAndAdvance(\"id\", /[A-Za-z][A-Za-z0-9_]*/y)) continue;\n    if (testAddAndAdvance(\"whitespace\", /[ \\t]+/y)) continue;\n    if (testAddAndAdvance(\"lcurl\", /\\{/y)) continue;\n    if (testAddAndAdvance(\"rcurl\", /\\}/y)) continue;\n    if (testAddAndAdvance(\"comma\", /\\,/y)) continue;\n    if (testAddAndAdvance(\"number\", /-?(?:\\d+(?:\\.\\d*)?|\\.\\d+)f?/y)) continue;\n    if (testAddAndAdvance(\"comment\", /(?:\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*)/y)) continue;\n\n    throw new Error(`Unknown part: ${contents.slice(index, index + 100)}`);\n  }\n\n  return tokens;\n};\n\ntype FdfId = {\n  type: \"FdfId\";\n  name: string;\n};\n\nexport type FdfArg = string | number | FdfId;\n\ntype FdfProperty = {\n  name: string;\n  args?: ReadonlyArray<FdfArg>;\n};\n\nexport type FdfFrame = {\n  type: string;\n  name: string;\n  inherits?: string;\n  inheritsChildren?: true;\n  properties?: FdfProperty[];\n  children?: FdfFrame[];\n};\n\ntype Context = {\n  index: number;\n  tokens: Token[];\n};\n\nconst peek = (context: Context) => context.tokens[context.index];\n\nconst parseSingleToken = (context: Context, token: Token[\"type\"]) => {\n  const next = peek(context);\n  if (next.type === token) {\n    return context.tokens[context.index++];\n  }\n  throw new Error(\n    `Expected ${token}, got ${JSON.stringify(next)}`,\n  );\n};\n\nconst parseProperty = (context: Context): FdfProperty => {\n  const name = parseSingleToken(context, \"id\");\n  const args: FdfArg[] = [];\n\n  const property: FdfProperty = {\n    name: name.content,\n  };\n\n  while (peek(context).type !== \"newline\") {\n    const token = context.tokens[context.index++];\n    if (token.type === \"string\") args.push(token.content.slice(1, -1));\n    else if (token.type === \"id\") {\n      args.push({ type: \"FdfId\", name: token.content });\n    } else if (token.type === \"number\") args.push(parseFloat(token.content));\n    else if (\n      token.type == \"comma\" || token.type === \"comment\"\n    ) { /* do nothing */ } else {\n      throw new Error(\n        `Unexpected token when parsing property: ${JSON.stringify(token)}`,\n      );\n    }\n  }\n\n  if (args.length) property.args = args;\n\n  return property;\n};\n\nconst eat = (context: Context) => {\n  while (\n    context.index < context.tokens.length &&\n    [\"comment\", \"newline\"].includes(\n      peek(context).type,\n    )\n  ) parseSingleToken(context, peek(context).type);\n};\n\nconst parseFrameBody = (context: Context) => {\n  const properties: FdfProperty[] = [];\n  const children: FdfFrame[] = [];\n  parseSingleToken(context, \"lcurl\");\n  while (peek(context).type !== \"rcurl\") {\n    eat(context);\n\n    const next = peek(context);\n    if (next.type === \"rcurl\") break;\n\n    if (\n      next.type === \"id\" &&\n      [\"Frame\", \"Texture\", \"String\", \"Layer\"].includes(next.content)\n    ) {\n      children.push(parseFrame(context));\n    } else properties.push(parseProperty(context));\n  }\n  parseSingleToken(context, \"rcurl\");\n\n  return [properties, children] as const;\n};\n\nconst parseFrameOpening = (context: Context): FdfFrame => {\n  const opening = parseSingleToken(context, \"id\");\n\n  if (opening.content === \"Frame\") {\n    return {\n      type: parseSingleToken(context, \"string\").content.slice(1, -1),\n      name: parseSingleToken(context, \"string\").content.slice(1, -1),\n    };\n  }\n\n  return {\n    type: opening.content.toUpperCase(),\n    name: peek(context).type === \"string\"\n      ? parseSingleToken(context, \"string\").content.slice(1, -1)\n      : \"\",\n  };\n};\n\nconst parseFrame = (context: Context): FdfFrame => {\n  const frame = parseFrameOpening(context);\n\n  if (peek(context).type === \"id\" && peek(context).content === \"INHERITS\") {\n    parseSingleToken(context, \"id\");\n\n    if (\n      peek(context).type === \"id\" && peek(context).content === \"WITHCHILDREN\"\n    ) {\n      frame.inheritsChildren = true;\n      parseSingleToken(context, \"id\");\n    }\n\n    frame.inherits = parseSingleToken(context, \"string\").content.slice(1, -1);\n  }\n\n  const [properties, children] = parseFrameBody(context);\n\n  if (properties.length) frame.properties = properties;\n  if (children.length) frame.children = children;\n\n  return frame;\n};\n\nconst parseInclude = (context: Context) => {\n  parseSingleToken(context, \"id\");\n  const path = parseSingleToken(context, \"string\").content.slice(1, -1);\n  parseSingleToken(context, \"comma\");\n  return path;\n};\n\nconst parseStrings = (context: Context) => {\n  parseSingleToken(context, \"id\");\n\n  const strings: Record<string, string> = {};\n  parseSingleToken(context, \"lcurl\");\n\n  while (peek(context).type !== \"rcurl\") {\n    eat(context);\n    if (peek(context).type === \"rcurl\") break;\n\n    strings[parseSingleToken(context, \"id\").content] = parseSingleToken(\n      context,\n      \"string\",\n    ).content.slice(1, -1);\n    parseSingleToken(context, \"comma\");\n  }\n\n  parseSingleToken(context, \"rcurl\");\n\n  return strings;\n};\n\nexport const parseFdf = (\n  contents: string,\n): {\n  frames: FdfFrame[];\n  includes: string[];\n  strings: Record<string, string>;\n} => {\n  const frames: FdfFrame[] = [];\n  const includes: string[] = [];\n  const strings: Record<string, string> = {};\n  const context = { index: 0, tokens: tokenizeFdf(contents) };\n\n  while (context.index < context.tokens.length) {\n    eat(context);\n    if (context.index === context.tokens.length) break;\n\n    const next = peek(context);\n    if ([\"Frame\", \"Texture\", \"String\", \"Layer\"].includes(next.content)) {\n      frames.push(parseFrame(context));\n    } else if (next.content === \"IncludeFile\") {\n      includes.push(parseInclude(context));\n    } else if (next.content === \"StringList\") {\n      Object.assign(strings, parseStrings(context));\n    } else {\n      throw new Error(\n        `Expected Frame or IncludeFile, got ${JSON.stringify(next)}`,\n      );\n    }\n  }\n\n  return { frames, includes, strings };\n};\n\nexport class FdfDocument extends Resource {\n  tocDocument: TOCDocument;\n  constructor(d: { viewer: any, handler: any, extension: any, pathSolver: any, fetchUrl: string, path: string }) {\n    super(d);\n    this.tocDocument = d.viewer.tocDocument;\n  }\n  load(contents: any): Promise<any> {\n    const { frames, includes, strings } = parseFdf(contents);\n    Object.assign(\n      this.tocDocument.frameDefs,\n      Object.fromEntries(\n        frames.map((frame) => [frame.name, frame]),\n      ),\n    );\n    Object.assign(\n      this.tocDocument.strings,\n      strings,\n    );\n    return Promise.all(includes.map((fdf) => this.tocDocument.loadFdf(fdf)));\n  }\n}\nexport class TOCDocument extends Resource {\n  loadingFdfs = new ArrayList();\n  frameDefs = {};\n  strings = {};\n  constructor(d: { viewer: any, handler: any, extension: any, pathSolver: any, fetchUrl: string, path: string }) {\n    super(d);\n    d.viewer.tocDocument = this;\n  }\n  load(contents: string): Promise<any> {\n    const fdfs = contents.split(/[\\r\\n]/).filter((v: string) => v.length > 0);\n    return Promise.all(fdfs.map((fdf: string) => this.loadFdf(fdf)));\n  }\n\n  loadFdf(fdf: string) {\n    if (this.loadingFdfs.has(fdf.toLowerCase())) return;\n    this.loadingFdfs.add(fdf.toLowerCase());\n    return this.viewer.load(fdf).whenLoaded();\n  }\n  lateLoad(): void {\n    initUI(this.frameDefs);\n  }\n}\n","import { FdfDocument, TOCDocument } from \"../../../game/ui/fdf\";\n\n\nexport default {\n  extensions: [['.toc', 'text']],\n  fdfHandler: {\n    extensions: [['.fdf', 'text']],\n    Constructor: FdfDocument\n  },\n  install(viewer:any) {\n    viewer.addHandler(this.fdfHandler);\n    return true;\n  },\n  Constructor: TOCDocument,\n  resolveToc(path: string) {\n    return [path, '.toc', true]\n  }\n};\n","/* eslint-disable */\nconst { JassParser } = require('./JassParser')\nconst BasicJassVisitor = new JassParser().getBaseCstVisitorConstructorWithDefaults();\nconst NL = '\\n';\nconst NL2 = '\\n\\n';\nconst padleft = function (x, n) {\n  const minus = n - x.length;\n  if (minus >= 0) {\n    const padstr = new Array(minus).map(x => ' ').join(' ');\n    return x + padstr;\n  }\n  else {\n    return x;\n  }\n}\nlet jass2js_stack = [];\nlet idNext = 0;\nexport class jassAstNode {\n  pad = '  ';\n  autoID = idNext++;\n  constructor(ctx, d) {\n    this.ctx = ctx;\n    this.$symbol = {};\n    // proxy method to support scope injection\n    this._jass2js = this.jass2js;\n    this.jass2js = function (visitor, indent) {\n      this.parentNode = jass2js_stack.length > 0 ? jass2js_stack[jass2js_stack.length - 1] : null;\n      jass2js_stack.push(this)\n      let o = this._jass2js(...arguments);\n      jass2js_stack.pop();\n      return o;\n    }\n  }\n\n  convertToJs(visitor, node, indent) {\n    indent = indent || '';\n    if (node instanceof Array) {\n      if (node.length == 0)\n        return '';\n      return node.map(x => this.convertToJs(visitor, x, indent)).join(', ');\n    }\n    return this.checkJs(node.jass2js(visitor, indent));\n  }\n  convertToTs(visitor, node, indent) {\n    indent = indent || '';\n    if (node instanceof Array) {\n      if (node.length == 0)\n        return '';\n      return node.map(x => this.convertToTs(visitor, x, indent)).join(', ');\n    }\n    return this.checkJs(node.jass2ts(visitor, indent));\n  }\n  checkJs(code) {\n    if (code == null || code == undefined) {\n      throw new Error('notImplemented');\n    }\n    const str = code.toString();\n    if (str.indexOf('NaN') != -1) {\n      throw new Error('notImplemented');\n    }\n    if (str.indexOf('undefined') != -1 || str.indexOf('[object') != -1) {\n      throw new Error('notImplemented');\n    }\n    return code;\n  }\n  jass2js(visitor, indent) {\n    throw new Error('notImplemented');\n  }\n  lock(stack) {\n    if (stack == null)\n      throw new Error('invalid call');\n    this.stack = stack.slice();\n    stack.push(this);\n    return this;\n  }\n  fill(d) {\n    for (const key in d) {\n      if (Object.hasOwnProperty.call(d, key)) {\n        this[key] = d[key];\n      }\n    }\n    return this;\n  }\n  locateInStack(fn) {\n    return this.stack.find(x => x.constructor.name == fn.name);\n  }\n}\nclass jassNativeFunctionDecl extends jassAstNode {\n  $symbol = {\n    localVars: [],\n    paramVars: [],\n    resolvingVars: {},\n    resolvingFunctions: {}\n  }\n\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    if (visitor.jass2js_debug) {\n      output = indent + '/* native_decl */\\n'\n    }\n    output += indent + '// ' + this.name + '(';\n\n    if (this.params) {\n      output += this.convertToTs(visitor, this.params);\n    }\n    output += '){\\n'\n    output += indent + '// console.log(\"[NotImplemented]\",\"' + this.name + '\",arguments)\\n'\n    output += indent + '// }'\n    visitor.$symbol.functionDecls[this.name] = {\n      type: 'function',\n      native: true,\n      name: this.name,\n      paramList: this.params ? this.convertToJs(visitor, this.params) : 'nothing'\n    }\n    return output;\n  }\n}\nclass jassTypeDef extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    if (this.extendFrom) {\n      return visitor.jass2js_debug ? this.type + '/*type_def_extend_' + this.extendFrom + \"*/\" : this.type;\n    }\n    return visitor.jass2js_debug ? this.type + '/*type_def*/' : this.type;\n  }\n}\nclass program extends jassAstNode {\n  pad = '  ';\n  $symbol = {\n    globalVars: [],\n    functions: [],\n  }\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    output += (indent + '// Auto-generated-source, lang=js\\n');\n    output += (indent + '// input source: ' + visitor.jassfile + '\\n');\n    output += (indent + '// jass2js version ' + visitor.version + '\\n');\n    output += NL;\n    output += `function ${visitor.jassfile}(){\\n`;\n    output += indent + \"    if(this.constructor.name !== 'JassRuntime')\\n\";\n    output += indent + \"        throw new Error('Generated code must runs in JassRuntime.run!');\\n\"\n    output += indent + this.pad + 'let rt = this;\\n'\n    output += indent + this.pad + 'let fileName = \"' + visitor.jassfile + '\";\\n'\n    output += indent + this.pad + 'rt.loadStart(fileName);' + NL2;\n    output += indent + this.pad + '// delcare native functions' + NL\n    // output += indent + this.pad + '   // Skipped due to we implement all natvie functions in runtime' + NL\n    output += this.natives.map((x, i) => x.jass2js(visitor, indent + this.pad, i)).join('\\n' + indent) + NL;\n    output += indent + this.pad + '// global variables' + NL\n    // output += indent + this.pad + '   // Skipped due to we defined all global variables in runtime' + NL\n    output += this.globals.map(x => x.jass2js(visitor, indent + this.pad)).join('\\n' + indent + this.pad);\n    output += indent + this.pad + '// function decls' + NL\n    output += this.functions.map((x, i) => x.jass2js(visitor, indent + this.pad, i)).join('\\n' + indent) + NL;\n\n    // bind functions to vm\n    let fnDecls = visitor.$symbol.functionDecls;\n    output += NL;\n    let resolvingFunctions = Object.keys(visitor.$symbol.functionDecls)\n      .map(x => Object.keys(fnDecls[x].resolvingFunctions || {}))\n      .reduce((a, b) => a.concat(b), []);\n    visitor.$symbol.resolvingFunctions = [...new Set(resolvingFunctions)];\n\n    let resolvingVars = Object.keys(visitor.$symbol.functionDecls)\n      .map(x => Object.keys(visitor.$symbol.functionDecls[x].resolvingVars || {}))\n      .reduce((a, b) => a.concat(b), []);\n    visitor.$symbol.resolvingVars = [...new Set(resolvingVars)];\n\n    let requiredVars = visitor.$symbol.resolvingVars.map(x => JSON.stringify(x)).join(', \\n    ' + indent + this.pad);\n    output += indent + this.pad + 'rt.resolveVars(['\n    output += requiredVars;\n    output += ']);'\n    output += NL2;\n\n    let requiredFunctions = visitor.$symbol.resolvingFunctions.map(x => JSON.stringify(x)).join(', \\n    ' + indent + this.pad);\n    output += indent + this.pad + 'rt.resolveFunctions(['\n    output += requiredFunctions;\n    output += ']);'\n    output += NL;\n\n    // let enums = JSON.stringify(visitor.$symbol.enums).split(',').join(', \\n    ' + indent + this.pad);\n    // output += indent + this.pad + 'rt.defineEnums(['\n    // output += enums;\n    // output += ']);'\n    // output += NL;\n\n    output += indent + this.pad + 'rt.loaded(fileName);' + NL2;\n    output += \"}\"\n    return output;\n  }\n}\nclass callstatement extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n\n    return this.call.jass2js(visitor, indent);\n  }\n}\nclass jassSetAssign extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    output += indent;\n    let id = this.variable.id;\n    if (this.variable.arrayAccess) {\n      id = id + this.variable.arrayAccess.jass2js(visitor,);\n    }\n    const fn = this.locateInStack(jassFunctionDecl);\n    if (!fn.$symbol.localVars.find(x => x.name == this.variable.id)) {\n      output += 'this.' + id;\n    }\n    else {\n      output += id;\n    }\n    output += ' = ' + this.value[0].jass2js(visitor,);\n    return visitor.jass2js_debug ? output + \"/*set*/\" : output;\n  }\n}\nclass jassElseIfStatement extends jassAstNode {\n  pad = '    ';\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    output += indent + 'else if'\n    let predicate = this.condition.jass2js(visitor,);\n    if (this.condition instanceof jassBracketed) {\n      output += predicate;\n    }\n    else\n      output += '(' + predicate + ')';\n\n    output += '{\\n'\n    output += indent + this.pad + this.convertToJs(visitor, this.statements) + NL;\n    output += indent + '}'\n    return visitor.jass2js_debug ? output + '/*end_elseif*/' : output;\n  }\n}\nclass jassElseStatement extends jassAstNode {\n  pad = '    ';\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = indent + 'else{\\n';\n    output += this.convertToJs(visitor, this.statements, indent + this.pad) + NL;\n    output += indent + '}'\n    return visitor.jass2js_debug ? output + '/*end_else*/' : output;\n  }\n}\nclass jassIfStatement extends jassAstNode {\n  pad = '    ';\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    output += indent + 'if'\n    let predicate = this.condition.jass2js(visitor,);\n    if (this.condition instanceof jassBracketed) {\n      output += predicate;\n    }\n    else {\n      output += '(' + predicate + ')';\n    }\n    output += `/*start_of_statements_${this.autoID}*/{`\n    if (this.statements.length) {\n      output += NL\n      output += this.convertToJs(visitor, this.statements, indent + this.pad) + NL;\n      output += indent + '}';\n    }\n    else {\n      output += '}/*empty_statements*/'\n    }\n    if (this.elseIfStatement) {\n      output += NL\n      output += this.elseIfStatement.jass2js(visitor, indent);\n    }\n    if (this.elseStatement) {\n      output += NL\n      output += this.elseStatement.jass2js(visitor, indent);\n    }\n    return visitor.jass2js_debug ? output + '/*end_if*/' : output;\n  }\n}\nclass jassOp extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    return this.code;\n  }\n}\nclass jassValue extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    if (this.type === 'STRING' && this.value) {\n      this.value = this.value.replace(/\\n/g, '\\\\n')\n    }\n    return this.checkJs(this.code || this.value);\n  }\n}\nclass jassParamList extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    return this.params.map(x => x.jass2js(visitor, '')).join(', ');\n  }\n  jass2ts(visitor, indent) {\n    indent = indent || '';\n    return this.params.map(x => x.jass2ts(visitor, '')).join(', ');\n  }\n}\nclass jassArgumentList extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    return this.convertToJs(visitor, this.expressions, indent);\n  }\n}\nclass jassBracketed extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    return '(' + this.expression.jass2js(visitor,) + ')';\n  }\n}\nclass jassReturn extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = indent;\n    if (this.nothing || !this.expression) {\n      output += \"return;\"\n    }\n    else {\n      output += \"return \" + this.expression.jass2js(visitor,);\n    }\n    return output;\n  }\n}\nclass jassNothing extends jassAstNode {\n  code = 'nothing';\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    return this.code || this.value;\n  }\n  jass2ts(visitor, indent) {\n    indent = indent || '';\n    return '/*void*/';\n  }\n}\nclass jassParamDecl extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let fn = this.locateInStack(jassFunctionDecl) || this.locateInStack(jassNativeFunctionDecl);\n    fn.$symbol.paramVars.push({\n      name: this.name,\n      type: this.convertToJs(visitor, this.type),\n    });\n    return visitor.jass2js_debug ? this.name + '/*jass_param ' + this.convertToJs(visitor, this.type) + ' */' : this.name;\n  }\n  jass2ts(visitor, indent) {\n    indent = indent || '';\n    let fn = this.locateInStack(jassFunctionDecl) || this.locateInStack(jassNativeFunctionDecl);\n    fn.$symbol.paramVars.push({\n      name: this.name,\n      type: this.convertToTs(visitor, this.type),\n    });\n    return this.name + ':' + this.convertToTs(visitor, this.type);\n  }\n}\nclass jassNull extends jassAstNode {\n  code = 'null';\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    return this.code || this.value;\n  }\n}\nclass jassRefExpression extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = 'this.' + this.name;\n    if (this.type == 'FUNCTION') {\n      if (visitor.jass2js_debug) {\n        if (visitor.$symbol.functionDecls[this.name]) {\n          output = 'await ' + output + '/*ref*/';\n        }\n        else\n          output += '/*?ref*/';\n      }\n      return output;\n    }\n    throw new Error('notImplemented')\n  }\n}\nclass jassUnaryExpression extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    if (this.type = 'NEG') {\n      return '-' + this.expression.jass2js(visitor,);\n    }\n    let output = ''; throw new Error('notImplemented')\n  }\n}\nclass jassExpression extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = ''; throw new Error('notImplemented')\n  }\n}\nclass jassBinaryExpression extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    if (this.right != null) {\n      return this.checkJs(this.left.jass2js(visitor,))\n        + ' '\n        + this.checkJs(this.op.jass2js(visitor,))\n        + ' '\n        + this.checkJs(this.right.jass2js(visitor,))\n    }\n    return this.left.jass2js(visitor,);\n  }\n}\nclass jassArrayAccess extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '[' + this.convertToJs(visitor, this.expression) + ']';\n    return visitor.jass2js_debug ? output + '/*arr_access*/' : output\n  }\n}\nclass jassVarAccess extends jassAstNode {\n  jass2js(visitor, indent) {\n    const p = this.locateInStack(program);\n    const fn = this.locateInStack(jassFunctionDecl);\n    const fnVars = fn ? fn.$symbol.localVars.concat(fn.$symbol.paramVars) : [];\n    const fnScoped = fnVars.find(x => x.name == this.target);\n    if (!visitor.$symbol.globalVarDecls[this.target] && !fnScoped && fn && !visitor.runtime[this.target]) {\n      fn.$symbol.resolvingVars[this.target] = this.target;\n    }\n    indent = indent || '';\n    let output = '';\n    if (fnScoped) {\n      // function scoped\n    }\n    else {\n      output += 'this.'\n    }\n    output += this.target;\n    if (this.array) {\n      output += this.array.jass2js(visitor);\n    }\n    return visitor.jass2js_debug ? output + '/*jassvar*/' : output;\n  }\n}\nclass loopstatement extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    output += indent + 'while(true){' + NL;\n    output += this.statements\n      .map(x => this.convertToJs(visitor, x, indent + this.pad)).join(';' + NL) + NL;\n    output += indent + '}'\n    return output;\n  }\n}\nclass exithenstatement extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    if (this.expression.length > 1)\n      throw new Error('notImplemented');\n    output += indent + 'if(' + this.expression[0].jass2js(visitor, indent) + '){' + NL;\n    output += indent + this.pad + 'break;' + NL;\n    output += indent + '}';\n    return output;\n  }\n}\nclass jassVarDecl extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = indent + 'let ';\n    let pad = this.scope == 'global' ? 30 : 20;\n    let type = this.type.jass2js(visitor,);\n    let nameCode = this.type.isArrayType() ? this.name + \"[]\" : this.name;\n    if (this.scope == 'global') {\n      visitor.$symbol.globalVarDecls[this.name] = {\n        name: this.name,\n        type: this.type.jass2js(visitor,)\n      };\n      if (this.value == null) {\n        output = indent + 'this.' + this.name.padEnd(30);\n        if (this.type.isArrayType()) {\n          output += '= []'\n        }\n      }\n      else if (this.name.startsWith('CAMERA_MARGIN')) { // as a  ENUM\n        output = indent + 'this.' + this.name.padEnd(30) + '= [\"camera.margin\",\"' + this.name + '\",' + this.value[0].jass2js(visitor,) + ']';\n      }\n      else if (this.name.startsWith('PLAYER_NEUTRAL')) { // as a  ENUM\n        output = indent + 'this.' + this.name.padEnd(30) + '= [\"player.neutral\",\"' + this.name + '\",' + this.value[0].jass2js(visitor,) + ']';\n      }\n      else\n        output = indent + 'this.' + this.name.padEnd(30) + '= ' + this.value[0].jass2js(visitor,);\n\n    }\n    else {\n      let fn = this.locateInStack(jassFunctionDecl);\n      fn.$symbol.localVars.push({\n        name: this.name,\n        type: this.type.jass2js(visitor,)\n      });\n      if (this.value == null) {\n        output += padleft(this.name, indent + pad) + ' ';\n        if (this.type.isArrayType()) {\n          output += '= []'\n        }\n      }\n      else\n        output += padleft(this.name, indent + pad) + ' = ' + this.value[0].jass2js(visitor,);\n    }\n    return visitor.jass2js_debug ? output + \"/* var_decl of \" + this.type.jass2js(visitor,) + \"*/ \" : output;\n\n    return output;\n  }\n}\nclass jassType extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    if (this.type.type == 'identifier') {\n      if (this.ctx.ARRAY) {\n        return this.type.value + '[]';\n      }\n      return this.type.value;\n    }\n    throw new Error('notImplemented');\n  }\n  isArrayType() {\n    return this.ctx.ARRAY;\n  }\n}\nclass jassGlobalVar extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let output = '';\n    return this.declaration.map(x => x.jass2js(visitor, indent)).join('\\n') + NL;\n  }\n}\n\nclass jassFunctionCall extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let fn = this.locateInStack(jassFunctionDecl);\n    if (visitor.$symbol.functionDecls[this.name.image] == undefined) {\n      visitor.$symbol.resolvingFunctions[this.name.image] = {\n        type: 'function',\n        name: this.name.image,\n        args: this.args ? this.convertToJs(visitor, this.args) : 'nothing'\n      };\n    }\n    let bg = `/*call ${this.name.image} */`;\n    let output = indent;\n    let inVarDecl = this.stack[this.stack.length - 2] instanceof jassVarDecl;\n    if (this.args) {\n      // enum\n      let value = this.convertToJs(visitor, this.args);\n      if (this.name.image.startsWith('Convert') && inVarDecl) {\n        // varDecl.name\n        let enumName = this.stack[this.stack.length - 2].name;\n        let typeName = this.stack[3].type.value\n        visitor.$symbol.enums[enumName] = value;\n        if (!typeName) {\n          debugger\n        }\n        output += `[\"${typeName}\",\"${enumName}\",${value}]`\n      }\n      else if (!visitor.runtime.isPromisedFunction(this.name.image)) {\n        output += \"this.call(\\\"\" + this.name.image + '\\\", [' + value + \"])\";\n      }\n      else {\n        output += \"await this.call2(\\\"\" + this.name.image + '\\\", [' + value + \"])\";\n      }\n    }\n    else if (!visitor.runtime.isPromisedFunction(this.name.image)) {\n      output += \"this.call(\\\"\" + this.name.image + '\\\")';\n    }\n    else {\n      output += \"await this.call2(\\\"\" + this.name.image + '\\\")';\n    }\n    return visitor.jass2js_debug ? output + bg : output;\n  }\n}\nclass jassFunctionDecl extends jassAstNode {\n  pad = padleft('', 4)\n  $symbol = {\n    localVars: [],\n    paramVars: [],\n    resolvingVars: {},\n    resolvingFunctions: {}\n  }\n\n  jass2js(visitor, indent, index) {\n    indent = indent || '';\n    let output = '';\n    output += indent + '// offset=' + index + NL;\n    output += indent + 'this.'\n    output += this.name + '=async';\n    if (this.paramList.params.length == 1 && this.paramList.params[0].code == 'nothing') {\n      // no args\n      output += '()=>'\n    }\n    else {\n      output += '('\n      output += this.paramList.jass2js(visitor, indent);// this.args.map(x => x.jass2js(visitor,indent)).join(', ');\n      output += ')=>';\n    }\n    output += '{';\n    if (this.vardecls.length > 0) {\n      output += NL;\n      output += indent + this.pad + \"// local variables\\n\"\n      output += this.vardecls.map(x => x.jass2js(visitor, indent + this.pad)).join(NL) + NL2;\n    }\n    if (this.statements.length > 0) {\n      output += NL;\n      // output += indent + this.pad + \"// statements\\n\"\n      output += this.statements.map(x => x.jass2js(visitor, indent + this.pad)).join(NL) + NL;\n    }\n    if (output.endsWith(')=>{'))\n      output += '}';\n    else\n      output += indent + '}';\n    visitor.$symbol.functionDecls[this.name] = this.$symbol;\n    return output;\n  }\n}\nclass jassIdentifier extends jassAstNode {\n  jass2js(visitor, indent) {\n    indent = indent || '';\n    let rt = visitor.$symbol.resolvingTypes[this.value];\n    if (!rt) {\n      rt = visitor.$symbol.resolvingTypes[this.value] = { usages: [] };\n    }\n    rt.usages.push(this.stack);\n    return indent + this.value;\n  }\n  jass2ts(visitor, indent) {\n    indent = indent || '';\n    let rt = visitor.$symbol.resolvingTypes[this.value];\n    if (!rt) {\n      rt = visitor.$symbol.resolvingTypes[this.value] = { usages: [] };\n    }\n    rt.usages.push(this.stack);\n    if (this.value == 'integer' || this.value == 'real') {\n      return indent + 'number';\n    }\n    return indent + this.value;\n  }\n}\nexport class JassVisitor extends BasicJassVisitor {\n  $symbol = {\n    functionDecls: {}, //functionBlock or nativeFunctionDecl\n    globalVarDecls: {},\n    resolvingTypes: {\n    },\n    resolvingFunctions: {},\n    enums: {}\n  }\n  version = '0.8.2'\n  constructor(runtime, fileName, api) {\n    super()\n    this.validateVisitor();\n    this.runtime = runtime;\n    this.natives = api;\n    this.jassfile = fileName;\n    this.jass2js_debug = 1;\n  }\n  addResolvingSymbol(d) {\n    let symbol = this.resovingSymbols.find(x => x.name == d.name && x.type == d.type);\n    if (!symbol) {\n      this.resovingSymbols.push(d);\n    }\n  }\n  locateInStack(stack, fn) {\n    return stack.find(x => x.constructor.name == fn.name);\n  }\n  visit(ctx, stack) {\n    if (stack == null)\n      throw new Error('invalid call.');\n    if (ctx instanceof Array) {\n      return ctx.map(x => this.visit(x, stack.slice()));\n    }\n    else if (ctx.image) {\n      const d = this.visitImage(ctx, stack);\n      let b = this.locateInStack(stack, jassFunctionDecl);\n      if (b != null) {\n\n      }\n      return d;\n    }\n    else {\n      const d = super.visit.call(this, ctx, stack);\n      if (d == undefined) {\n        debugger;\n        d = super.visit.call(this, ctx, stack);\n        throw new Error('notImplemented');\n      }\n      return d;\n    }\n  }\n  visitImage(ctx, stack) {\n\n    const tktype = ctx.tokenType.name;\n    if (tktype === 'NULL') {\n      return new jassNull(ctx).lock(stack);\n    }\n    else if (tktype == \"INTEGER\") {\n      return new jassValue(ctx).lock(stack).fill({ type: ctx.tokenType.name, value: parseInt(ctx.image) }).lock(stack);\n    }\n    else if (tktype == \"TRUE\") {\n      return new jassValue(ctx).lock(stack).fill({ type: 'BOOLEAN', value: true }).lock(stack);\n    }\n    else if (tktype == \"FALSE\") {\n      return new jassValue(ctx).lock(stack).fill({ type: 'BOOLEAN', value: false }).lock(stack);\n    }\n    else if (tktype == \"IDLITERAL\") {\n      return new jassValue(ctx).lock(stack).fill({ type: 'STRING', value: ctx.image }).lock(stack);\n    }\n    else if (tktype == \"STRINGLITERAL\") {\n      return new jassValue(ctx).lock(stack).fill({ type: 'STRING', value: ctx.image }).lock(stack);\n    }\n    else if (tktype == \"REAL\") {\n      return new jassValue(ctx).lock(stack).fill({ type: 'REAL', value: parseFloat(ctx.image) }).lock(stack);\n    }\n    else if (tktype == \"EQUALSEQUALS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"==\"\n      }).lock(stack);\n    }\n    else if (tktype == \"NOTEQUALS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"!=\"\n      }).lock(stack);\n    }\n    else if (tktype == \"AND\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"&&\"\n      }).lock(stack);\n    }\n    else if (tktype == \"OR\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"||\"\n      }).lock(stack);\n    }\n    else if (tktype == \"PLUS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"+\"\n      }).lock(stack);\n    }\n    else if (tktype == \"MINUS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"-\"\n      }).lock(stack);\n    }\n    else if (tktype == \"MULT\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"*\"\n      }).lock(stack);\n    }\n    else if (tktype == \"DIV\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"/\"\n      }).lock(stack);\n    }\n    else if (tktype == \"GREATER\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \">\"\n      }).lock(stack);\n    }\n    else if (tktype == \"LESS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"<\"\n      }).lock(stack);\n    }\n    else if (tktype == \"GREATEROREQUALS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \">=\"\n      }).lock(stack);\n    }\n    else if (tktype == \"LESSOREQUALS\") {\n      return new jassOp(ctx).lock(stack).fill({\n        code: \"<=\"\n      }).lock(stack);\n    }\n    throw new Error('notImplemented');\n  }\n  FunctionReferenceExpression(ctx, stack) {\n    return new jassRefExpression(ctx).lock(stack).fill({\n      type: 'FUNCTION',\n      name: ctx.ID[0].image\n    });\n  }\n  NegateExpression(ctx, stack) {\n    //数字取负数\n    return new jassUnaryExpression(ctx).lock(stack).fill({\n      type: 'NEG',\n      expression: this.visit(ctx.expression, stack.slice())[0]\n    });\n  }\n  NotExpression(ctx, stack) {\n    //逻辑非\n    return new jassUnaryExpression(ctx).lock(stack).fill({\n      type: 'NOT',\n      expression: this.visit(ctx.expression, stack.slice())[0]\n    });\n  }\n  functionCallExpression(ctx, stack) {\n    return new jassFunctionCall(ctx).lock(stack).fill({\n      name: ctx.ID[0],\n      args: ctx.argList ? ctx.argList.map(x => this.visit(x, stack.slice())) : []\n    });\n  }\n  argList(ctx, stack) {\n    return new jassArgumentList(ctx).lock(stack).fill({\n      expressions: this.visit(ctx.expression, stack.slice())\n    });\n  }\n  ParentheticalExpression(ctx, stack) {\n    return new jassBracketed(ctx).lock(stack).fill({ expression: this.visit(ctx.expression, stack.slice())[0] });;\n  }\n  type(ctx, stack) {\n    if (ctx.NOTHING)\n      return new jassNothing(ctx).lock(stack)\n    if (ctx.ID) {\n\n      return new jassIdentifier(ctx).lock(stack).fill({ type: 'identifier', value: ctx.ID[0].image });\n    }\n    return new jassNothing(ctx).lock(stack)\n  }\n  program(ctx, stack) {\n    ctx = ctx.children;\n    return new program(ctx).lock(stack)\n      .fill({\n        functions: ctx.functionBlock ? ctx.functionBlock.map(fd => this.visit(fd, stack.slice())) : [],\n        globals: ctx.globalsBlock ? ctx.globalsBlock.map(fd => this.visit(fd, stack.slice())) : [],\n        types: ctx.typeDefinition ? ctx.typeDefinition.map(fd => this.visit(fd, stack.slice())) : [],\n        natives: ctx.nativeBlock ? ctx.nativeBlock.map(fd => this.visit(fd, stack.slice())) : [],\n      });\n  }\n  nativeBlock(ctx, stack) {\n    return new jassNativeFunctionDecl(ctx).lock(stack).fill({\n      constant: !!ctx.CONSTANT,\n      name: ctx.ID[0].image,\n      params: this.visit(ctx.paramList, stack.slice()),\n      returnType: this.visit(ctx.returnType, stack.slice())\n    });\n  }\n  typeDefinition(ctx, stack) {\n    if (ctx.EXTENDS) {\n      return new jassTypeDef(ctx).lock(stack).fill({\n        type: ctx.ID[0].image,\n        extendFrom: ctx.ID[1].image\n      });\n    }\n    else {\n      debugger\n    }\n  }\n  statement(ctx, stack) {\n    return ctx.statements.map(x => this.visit(ctx.statements, stack.slice()));\n  }\n\n  callStatement(ctx, stack) {\n    return new callstatement(ctx).lock(stack).fill({\n      call: this.visit(ctx.functionCallExpression, stack.slice())[0],\n      type: 'callstatement',\n    });\n  }\n\n  arrayAccess(ctx, stack) {\n    return new jassArrayAccess(ctx).lock(stack).fill({\n      expression: this.visit(ctx.expression, stack.slice())[0]\n    })\n  }\n\n  setStatement(ctx, stack) {\n    if (ctx.arrayAccess) {\n      return new jassSetAssign(ctx).lock(stack).fill({\n        variable: {\n          id: ctx.ID[0].image,\n          arrayAccess: ctx.arrayAccess.map(e => this.visit(e, stack))[0]\n        },\n        value: this.visit(ctx.expression, stack.slice()),\n      });\n    }\n    return new jassSetAssign(ctx).lock(stack).fill({\n      variable: {\n        id: ctx.ID[0].image,\n      },\n      value: this.visit(ctx.expression, stack.slice())\n    });\n  }\n\n  ifStatement(ctx, stack) {\n    return new jassIfStatement(ctx).lock(stack).fill({\n      condition: this.visit(ctx.condition[0], stack.slice()),\n      statements: ctx.statements ? ctx.statements.map(stm => this.visit(stm, stack.slice()))[0] : [],\n      elseStatement: ctx.elseStatement ? this.visit(ctx.elseStatement, stack.slice())[0] : null,\n      elseIfStatement: ctx.elseIfStatement ? this.visit(ctx.elseIfStatement, stack.slice())[0] : null\n    });\n  }\n  elseIfStatement(ctx, stack) {\n    return new jassElseIfStatement(ctx).lock(stack).fill({\n      condition: this.visit(ctx.condition[0], stack.slice()),\n      statements: ctx.statements ? ctx.statements.map(stm => this.visit(stm, stack.slice()))[0] : [],\n    });\n  }\n  elseStatement(ctx, stack) {\n\n    return new jassElseStatement(ctx).lock(stack).fill({\n      statements: ctx.statements ? ctx.statements.map(stm => this.visit(stm, stack.slice()))[0] : [],\n    });\n  }\n  left(ctx, stack) {\n    return this.createJassExpression(ctx, stack);\n  }\n  right(ctx, stack) {\n    return this.createJassExpression(ctx, stack);\n  }\n\n  expression(ctx, stack) {\n    if (ctx.right) {\n      return new jassBinaryExpression(ctx).lock(stack).fill({\n        left: this.visit(ctx.left, stack.slice())[0],\n        op: this.visit(ctx.op, stack.slice())[0],\n        right: this.visit(ctx.right, stack)[0]\n      });\n    }\n    else if (ctx.left) {\n      return this.visit(ctx.left, stack)[0];\n    }\n    throw new Error('notImplemented');\n  }\n\n  createJassExpression(ctx, stack) {\n    if (ctx.image === \"null\") {\n      return new jassNull(ctx).lock(stack).fill({ type: 'NULL', value: null });\n    }\n    else if (ctx.NULL) {\n      return new jassNull(ctx).lock(stack).fill({ type: 'NULL', value: null });\n    }\n    if (ctx.INTEGER) {\n      return new jassValue(ctx).lock(stack).fill({ type: 'INTEGER', value: parseInt(ctx.INTEGER[0].image) });\n    }\n    if (ctx.TRUE) {\n      return new jassValue(ctx).lock(stack).fill({ type: 'BOOLEAN', value: true });\n    }\n    if (ctx.FALSE) {\n      return new jassValue(ctx).lock(stack).fill({ type: 'BOOLEAN', value: false });\n    }\n    if (ctx.EQUALSEQUALS) {\n      return new jassUnaryExpression(ctx).lock(stack)\n    }\n    if (ctx.ParentheticalExpression) {\n      let expr = new jassUnaryExpression(ctx).lock(stack)\n      let innerExpr = ctx.ParentheticalExpression[0].children.expression;\n      expr.expressions = innerExpr.map(x => this.visit(x, stack.slice()));\n      return expr;\n    }\n    if (ctx.jassValueOf) {\n      return this.visit(ctx.jassValueOf[0], stack.slice());\n    }\n    throw new Error('notImplemented');\n  }\n  jassValueOf(ctx, stack) {\n    if (ctx.argList) {\n      return new jassFunctionCall(ctx).lock(stack).fill({\n        type: 'FUNCTION',\n        name: ctx.ID[0],\n        args: ctx.argList.map(x => this.visit(x, stack.slice()))\n      });\n    }\n    else if (ctx.LPAREN) {\n      return new jassFunctionCall(ctx).lock(stack).fill({\n        type: 'FUNCTION',\n        name: ctx.ID[0],\n      });\n    }\n    else if (ctx.arrayAccess) {\n      return new jassVarAccess(ctx).lock(stack).fill({ type: 'VAR', target: ctx.ID[0].image, array: this.visit(ctx.arrayAccess[0], stack.slice()) });\n    }\n    else {\n      return new jassVarAccess(ctx).lock(stack).fill({ type: 'VAR', target: ctx.ID[0].image });\n    }\n    throw new Error('notImplemented');\n  }\n\n  functionBlock(ctx, stack) {\n    let statements = []\n    let vardecls = []\n    let node = new jassFunctionDecl(ctx).lock(stack);\n    if (ctx.statement) {\n      statements = ctx.statement.map(s => this.visit(s, stack.slice())[0][0])\n    }\n    if (ctx.localvardeclaration) {\n      vardecls = ctx.localvardeclaration.map(s => this.visit(s, stack.slice()))\n    }\n    return node.fill({\n      name: ctx.functionName[0].image,\n      paramList: this.visit(ctx.paramList[0], stack.slice()),\n      returnType: this.visit(ctx.returnType[0], stack.slice()),\n      statements,\n      vardecls\n    });\n  }\n\n  returnStatement(ctx, stack) {\n    return new jassReturn(ctx).lock(stack).fill({\n      nothing: ctx.nothing ? new jassNothing(ctx).lock(stack) : null,\n      expression: ctx.expression ? this.visit(ctx.expression[0], stack.slice()) : null\n    })\n  }\n\n  paramList(ctx, stack) {\n    if (ctx.nothing) {\n      return new jassParamList(ctx).lock(stack).fill({\n        params: []\n      });\n    }\n    return new jassParamList(ctx).lock(stack).fill({\n      params: ctx.param.map(fa => this.visit(fa, stack.slice()))\n    });\n  }\n\n  param(ctx, stack) {\n    if (ctx.NOTHING) {\n      return new jassNothing(ctx).lock(stack)\n    }\n    return new jassParamDecl(ctx).lock(stack).fill({\n      type: this.visit(ctx.type[0], stack.slice()),\n      name: ctx.ID[0].image\n    })\n  }\n\n  exitWhenStatement(ctx, stack) {\n    return new exithenstatement(ctx).lock(stack).fill({\n      type: 'exitwhen',\n      expression: this.visit(ctx.expression, stack.slice())\n    });\n  }\n\n  loopStatement(ctx, stack) {\n    let statements = []\n    if (ctx.statement) {\n      statements = ctx.statement.map(s => this.visit(s, stack.slice()))\n    }\n    return new loopstatement(ctx).lock(stack).fill({\n      type: 'loopstatement',\n      statements\n    });\n  }\n\n  globalVar(ctx, stack) {\n    return new jassVarDecl(ctx).lock(stack).fill({\n      scope: 'global',\n      type: new jassType(ctx.type[0].children).lock(stack).fill({ type: this.visit(ctx.type[0], stack.slice()) }),\n      name: ctx.label[0].image,\n      value: ctx.expression ? this.visit(ctx.expression, stack.slice()) : null\n    });\n  }\n  localVars(ctx, stack) {\n    let fn = this.locateInStack(stack, jassFunctionDecl);\n    return new jassVarDecl(ctx).lock(stack).fill({\n      scope: 'local',\n      type: new jassType(ctx.type[0].children).lock(stack).fill({ type: this.visit(ctx.type[0], stack.slice()) }),\n      name: ctx.label[0].image,\n      value: ctx.expression ? this.visit(ctx.expression, stack.slice()) : null\n    });\n  }\n  globalsBlock(ctx, stack) {\n    return new jassGlobalVar(ctx).lock(stack).fill({\n      scope: 'global',\n      declaration: ctx.globalVars.map(x => this.visit(x, stack.slice())),\n    });\n  }\n}\n","/* eslint-disable */\nimport { parse } from \"./JassParser\";\nimport { JassVisitor, jassAstNode } from \"./JassVisitor\";\nimport * as constants from './gameConstants';\nimport { jassNativeFunctions } from \"./gameFunctions\";\nconst visit = function (runtime, inputstr, option) {\n    const visitor = new JassVisitor(runtime, option.jassfile, option.api);\n    const rule = option.rule || 'program';\n    const parsed = parse(inputstr, rule, option.debugParser);\n    const p = visitor[rule](rule == \"program\" ? parsed : parsed.children, []);\n    return p.jass2js(visitor);\n}\nexport class JassRuntime {\n    fileSymbols = [];\n    unresolved = [];\n    enums = {};\n    natives;\n    gameTypes = [];\n    constants = {};\n    scripts = {}\n    converted = []\n    app;\n    triggerData;\n    constructor(app) {\n        this.gameTypes = constants.gameTypes;\n        this.constants = constants;\n        this.natives = new jassNativeFunctions(app);\n        this.app = app;\n        this.triggerData = app.triggerData;\n    }\n    load(jassCode, fileName, parseTarget = \"program\") {\n        fileName = \"GAMESCRIPT_\" + fileName.replaceAll(/[./\\\\]/g, \"_\");\n        let jsCode = visit(this, jassCode, {\n            jassfile: fileName,\n            rule: parseTarget\n        });\n        const blob = new Blob([jsCode], { type: 'text/javascript' });\n        const blobUrl = URL.createObjectURL(blob);\n        const script = document.createElement(\"script\");\n        script.type = blob.type;\n        script.async = true;\n        script.src = blobUrl;\n        script.id = fileName;\n        document.head.appendChild(script);\n        this.scripts[fileName] = script;\n        let runtime = this;\n        return new Promise((resolve, reject) => {\n            script.onload = () => {\n                try {\n                    /* eslint-disable no-undef */\n                    if (parseTarget == 'program')\n                        globalThis[fileName].call(runtime);\n                    resolve();\n                } catch (e) {\n                    reject(e);\n                }\n            }\n        });\n    }\n    loadStart(fileName) {\n        console.log('loadStart', fileName)\n    }\n    loaded(fileName) {\n        console.log('loaded', fileName);\n    }\n    // define enum\n    enum(v, name, type) {\n        if (!this.enums[type]) {\n            this.enums[type] = this.enums[type] || {};\n            this.enums[type][v] = name;\n            this.enums[type][name] = v;\n            this.enums['convert' + type.toLowerCase()] = function (n) {\n                return this.enums[type][n];\n            }\n        };\n        return v;\n    }\n    call(fn, args = []) {\n        // functions that defined using this.xxx = function(){} in blizard.j or common.j\n        if (this[fn] instanceof Function) {\n            if (this.natives[fn] instanceof Function) {\n                console.warn('W', 'duplicate implementation of', fn)\n            }\n            return this[fn](...args);\n        }\n        // functions that define enum like constant, in generated js code, we converted it value to an array\n        // that array contains 3 elements includes enumType enumName enumInt\n        if (fn.startsWith('Convert') && args.length == 1) {\n            if (this.gameTypes.includes(fn.substring(7).toLowerCase()))\n                return this.directConvert(args[0]);\n            let items = this.triggerData.triggerParams\n                .filter(x => x.variableType == fn.substring(7).toLowerCase());\n            if (items.length) {\n                // items.forEach((x, i) => this.constants[x.key] = i);\n                return this.directConvert(args[0]);\n            }\n        }\n        if (this.natives[fn] instanceof Function) {\n            let d = this.natives[fn](...args);\n            if (this.natives.logCalls.contains(fn)) {\n                console.log('[------LOG------]', fn, args || [], ', returns', d === undefined ? 'nothing' : d);\n            }\n            else {\n                console.log('[LOG]', fn, args || [], ', returns', d === undefined ? 'nothing' : [d]);\n            }\n            return d;\n        }\n        return console.info('[NotDeclared]', fn, args || []);\n    }\n    directConvert(n) {\n        return n;\n    }\n    async config() {\n        debugger;\n    }\n    async main() {\n        debugger;\n    }\n    // native\n    checkNative(fn) {\n        return true;\n    }\n    resolveFunctions(names = []) {\n        const unresolved = names.filter(x => !this.natives[x]);\n        if (unresolved.length) {\n            throw new Error('assert: unresolved functions:');\n        }\n        let code = names.map(x => x + '(){\\ndebugger\\n}').join('\\n')\n    }\n    resolveVars(names = []) {\n        const unresolved = names.filter(x => this.constants[x] === undefined);\n        if (unresolved.length) {\n            console.log(\"assert: unresolved vars:\", unresolved);\n            // throw new Error('assert: unresolved vars:');\n        }\n        let code = unresolved.map(x => 'this.' + x + '=null;').join('\\n')\n    }\n    promised = [\"CreateUnit\", \"Preloader\", \"Filter\"];\n    isPromisedFunction(fn) {\n        if (this.promised.includes(fn)) {\n            return true;\n        }\n        else if (this.natives[fn] == undefined) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    async call2(fn, args = []) {\n        let d = this.call(fn, args);\n        if (d instanceof Promise) {\n            await d;\n        }\n        return d;\n    }\n}\n","import { JassRuntime } from \"../../../game/jass2js/JassRuntime\";\nimport Resource from \"../resource\";\n\nclass JassDocument extends Resource {\n    vm: any;\n    constructor(d: { viewer:any, handler:any, extension:any, pathSolver:any, fetchUrl:string, path:string }) {\n        super(d);\n        this.vm = this.viewer.vm || (this.viewer.vm = new JassRuntime(this.viewer));\n    }\n    async load(src: any): Promise<void> {\n        await this.viewer.vm.load(src, this.path);\n        if (this.path.endsWith('war3map.j')) {\n            console.log('jassvm', \"Enter vm::config.\")\n            await this.vm.config()\n            console.log('jassvm', \"Exit vm::config.\")\n            console.log('jassvm', \"Enter vm::main.\")\n            await this.vm.main();\n            console.log('jassvm', \"Exit vm::main.\")\n        }\n    }\n}\nexport default {\n    extensions: [['.j', 'text']],\n    Constructor: JassDocument\n};\n","\n\n/**\n * Returns a promise that will be resolved once all of the given resources get loaded.\n * The promise will resolve instantly if they are already loaded.\n *\n * @param {Iterable<Resource>} resources The resources to wait for.\n * @return {Promise}\n */\nexport const whenLoaded = (resources) => {\n    let promises = [];\n\n    for (let resource of resources) {\n        // Only process actual resources.\n        if (resource && resource.whenLoaded) {\n            promises.push(resource.whenLoaded());\n        }\n    }\n    return Promise.all(promises);\n}","import EventEmitter from 'events';\nimport { createTextureAtlas } from '../common/canvas';\nimport fetchDataType from '../common/fetchdatatype';\nimport WebGL from './gl/gl';\nimport PromiseResource from './promiseresource';\nimport Scene from './scene';\nimport imageTextureHandler from './handlers/imagetexture/handler';\nimport ImageTexture from './handlers/imagetexture/texture';\nimport GenericResource from './genericresource';\nimport toc from './handlers/toc';\nimport jass from './handlers/jass';\nimport { whenLoaded } from 'mdx/utils/promise';\n\n/**\n * A model viewer.\n */\nexport default class ModelViewer extends EventEmitter {\n  /**\n   * @param {HTMLCanvasElement} canvas\n   * @param {?Object} options\n   */\n  constructor(canvas, options) {\n    super();\n\n    /** @member {Map<string, Resource>} */\n    this.resourcesMap = new Map();\n\n    /** @member {Array<Resource>} */\n    this.resources = [];\n\n    /**\n     * The speed of animation. Note that this is not the time of a frame in milliseconds, but rather the amount of animation frames to advance each update.\n     *\n     * @member {number}\n     */\n    this.frameTime = 1000 / 60;\n\n    /** @member {HTMLCanvasElement} */\n    this.canvas = canvas;\n\n    /** @member {WebGL} */\n    this.webgl = new WebGL(canvas, options);\n\n    /** @member {WebGLRenderingContext} */\n    this.gl = this.webgl.gl;\n\n    /** @member {Map<string, ShaderProgram>} */\n    this.shaderMap = new Map();\n\n    /** @member {Set<Object>} */\n    this.handlers = new Set();\n\n    /** @member {Array<Scene>} */\n    this.scenes = [];\n\n    /** @member {Set} */\n    this.resourcesLoading = new Set();\n\n    // Track when resources start loading.\n    this.on('loadstart', (target) => {\n      this.resourcesLoading.add(target);\n    });\n\n    // Track when resources end loading.\n    this.on('loadend', (target) => {\n      this.resourcesLoading.delete(target);\n\n      // If there are currently no resources loading, dispatch the 'idle' event.\n      if (this.resourcesLoading.size === 0) {\n        // A timeout is used so that this event will arrive after the loadend event being processed.\n        // Any nicer solution?\n        setTimeout(() => this.emit('idle'), 0);\n      }\n    });\n\n    this.noCulling = false; // Set to true to disable culling viewer-wide.\n    this.noUpdating = false;\n\n    this.textureAtlases = {};\n\n    /**\n     * The number of instances that a bucket should be able to contain.\n     *\n     * @member {number}\n     */\n    this.batchSize = 8;\n\n    /** @member {number} */\n    this.renderedInstances = 0;\n    /** @member {number} */\n    this.renderedParticles = 0;\n    /** @member {number} */\n    this.renderedBuckets = 0;\n    /** @member {number} */\n    this.renderedScenes = 0;\n    /** @member {number} */\n    this.renderCalls = 0;\n\n    /**\n     * A viewer-wide flag.\n     * If it is false, not only will audio not run, but in fact audio files won't even be fetched in the first place.\n     * If audio is desired, this should be set to true before loading models that use audio.\n     *\n     * @member {boolean}\n     */\n    this.enableAudio = false;\n\n    this.addHandler(imageTextureHandler);\n    this.addHandler(toc);\n    this.addHandler(jass);\n  }\n\n  /**\n   * Add an handler.\n   *\n   * @param {Object} handler\n   * @return {boolean}\n   */\n  addHandler(handler) {\n    if (handler) {\n      let handlers = this.handlers;\n\n      // Allow to pass also the handler's module for convenience.\n      if (handler.handler) {\n        handler = handler.handler;\n      }\n\n      // Check to see if this handler was added already.\n      if (!handlers.has(handler)) {\n        // Check if the handler has a loader, and if so load it.\n        if (handler.install && !handler.install(this)) {\n          this.emit('error', this, 'InvalidHandler', 'FailedToLoad');\n          return false;\n        }\n\n        handlers.add(handler);\n\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Add a scene.\n   *\n   * @return {Scene}\n   */\n  addScene() {\n    let scene = new Scene(this);\n\n    this.scenes.push(scene);\n\n    return scene;\n  }\n\n  /**\n   * Remove a scene.\n   *\n   * @param {Scene} scene The scene to remove.\n   * @return {boolean}\n   */\n  removeScene(scene) {\n    let scenes = this.scenes;\n    let index = scenes.indexOf(scene);\n\n    if (index !== -1) {\n      scenes.splice(index, 1);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Removes all of the scenes in the viewer.\n   */\n  clear() {\n    let scenes = this.scenes;\n\n    for (let i = scenes.length; i--;) {\n      this.removeScene(scenes[i]);\n    }\n  }\n\n  /**\n   * Look for a handler matching the given extension.\n   *\n   * @param {string} ext\n   * @return {?Object}\n   */\n  findHandler(ext) {\n    for (let handler of this.handlers) {\n      for (let extention of handler.extensions) {\n        if (ext === extention[0]) {\n          return [handler, extention[1]];\n        }\n      }\n    }\n  }\n  appendParam = (url, params) => {\n    if (!url.startsWith('blob:')&&params) {\n      for (const key in params) {\n        if (params[key]) {\n          url += (url.indexOf('?') === -1 ? '?' : '&');\n          url += key;\n          url += \"=\";\n          url += params[key];\n        }\n      }\n    }\n    return url;\n  }\n\n  /**\n   * Load something. The meat of this whole project.\n   *\n   * @param {?} src The source used for the load.\n   * @param {function(?)} pathSolver The path solver used by this load, and any subsequent loads that are caused by it (for example, a model that loads its textures).\n   * @return {Resource}\n   */\n  load(src, pathSolver) {\n    if (src) {\n      let extension;\n      let serverFetch;\n\n      let originalSrc = typeof src === \"string\" ? src : null;\n\n      // Built-in texture source\n      if ((src instanceof HTMLImageElement) || (src instanceof HTMLVideoElement) || (src instanceof HTMLCanvasElement) || (src instanceof ImageData) || (src instanceof WebGLTexture)) {\n        extension = '.png';\n        serverFetch = false;\n        pathSolver = null;\n      } else {\n        [src, extension, serverFetch] = pathSolver(src);\n      }\n\n      let handlerAndDataType = this.findHandler(extension.toLowerCase());\n\n      // Is there an handler for this file type?\n      if (handlerAndDataType) {\n        let resource = this.resourcesMap.get(src);\n\n        if (resource) {\n          return resource;\n        }\n\n        let handler = handlerAndDataType[0];\n\n        resource = new handler.Constructor({ viewer: this, handler, extension, pathSolver, fetchUrl: serverFetch ? src : '', path: originalSrc });\n\n        this.resources.push(resource);\n        this.resourcesMap.set(src, resource);\n\n        this.registerEvents(resource);\n\n        resource.emit('loadstart', resource);\n\n        if (serverFetch) {\n          let dataType = handlerAndDataType[1];\n          \n          src = this.appendParam(src, { src: originalSrc });\n          fetchDataType(src, dataType)\n            .then((response) => {\n              let data = response.data;\n\n              if (response.ok) {\n                resource.loadData(data);\n              } else {\n                resource.error('FailedToFetch');\n                // this.emit('error', resource, response.error, data);\n              }\n            });\n        } else {\n          debugger;\n          resource.loadData(src);\n        }\n\n        return resource;\n      } else {\n        debugger;\n        this.emit('error', this, 'MissingHandler', [src, extension, serverFetch]);\n\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Check whether the given key maps to a resource in the cache.\n   *\n   * @param {*} key\n   * @return {boolean}\n   */\n  exists(key) {\n    return this.resourcesMap.has(key);\n  }\n\n  /**\n   * Load a resource generically.\n   * Unlike load(), this does not use handlers or construct any internal objects.\n   * If no callback is given, the resource's data is the fetch data.\n   * If a callback is given, the resource's data is the value returned by it when called with the fetch data.\n   * If a callback returns a promise, the resource's data will be the result of the promise.\n   *\n   * @param {string} path\n   * @param {string} dataType\n   * @param {?function} callback\n   * @return {GenericResource}\n   */\n  loadGeneric(path, dataType, callback, originalPath) {\n    let resource = this.resourcesMap.get(path);\n\n    if (resource) {\n      return resource;\n    }\n\n    resource = new GenericResource({ viewer: this, handler: callback, fetchUrl: path, path: originalPath });\n\n    this.resources.push(resource);\n    this.resourcesMap.set(path, resource);\n\n    this.registerEvents(resource);\n\n    resource.emit('loadstart', resource);\n\n    function appyCallback(data) {\n      if (callback) {\n        data = callback(data);\n\n        if (data instanceof Promise) {\n          data.then((data) => resource.loadData(data));\n        } else {\n          resource.loadData(data);\n        }\n      } else {\n        resource.loadData(data);\n      }\n    }\n    if (path instanceof ArrayBuffer) {\n      appyCallback(path);\n    }\n    else {\n      path = this.appendParam(path, { dataType: dataType, src: originalPath, });\n      fetchDataType(path, dataType)\n        .then((response) => {\n          let data = response.data;\n\n          if (response.ok) {\n            appyCallback(data);\n          } else {\n            resource.error('FailedToFetch');\n\n            this.emit('error', resource, response.error, data);\n          }\n        });\n\n    }\n    return resource;\n  }\n\n  /**\n   * Unload a resource.\n   * Note that this only removes the resource from the viewer's cache.\n   * If it's being referenced and used e.g. by a scene, it will not be garbage collected.\n   *\n   * @param {Resource} resource\n   * @return {boolean}\n   */\n  unload(resource) {\n    // Loop over all of the values and find this resource.\n    // This is needed to support unloading in-memory resources that will have no fetchUrl.\n    for (let [key, value] of this.resourcesMap) {\n      if (value === resource) {\n        this.resourcesMap.delete(key);\n        this.resources.splice(this.resources.indexOf(resource), 1);\n\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Load and cache a shader in the viewer.\n   *\n   * @param {string} name\n   * @param {string} vertex\n   * @param {string} fragment\n   * @return {ShaderProgram}\n   */\n  loadShader(name, vertex, fragment) {\n    let map = this.shaderMap;\n\n    if (!map.has(name)) {\n      map.set(name, this.webgl.createShaderProgram(vertex, fragment));\n    }\n\n    return map.get(name);\n  }\n\n  /**\n   * Load a texture atlas and cache it in the viewer.\n   * The atlas is made from an array (or any iterable object) of textures.\n   *\n   * @param {string} name\n   * @param {Iterable<Texture>} textures\n   * @return {ImageTexture}\n   */\n  loadTextureAtlas(name, textures) {\n    let textureAtlases = this.textureAtlases;\n\n    if (!textureAtlases[name]) {\n      let textureAtlas = { texture: new ImageTexture({ viewer: this }), columns: 0, rows: 0 };\n\n      // Promise that there is a future load that the code cannot know about yet, so whenAllLoaded() isn't called prematurely.\n      let promise = this.promise();\n      \n      // When all of the textures are loaded, it's time to construct a texture atlas\n      whenLoaded(textures)\n        .then((textures) => {\n          for (let texture of textures) {\n            // If a texture failed to load, don't create the atlas.\n            if (!texture.ok) {\n              // Resolve the promise.\n              promise.resolve();\n\n              return;\n            }\n          }\n\n          let atlasData = createTextureAtlas(textures.map((texture) => texture.imageData));\n\n          textureAtlas.texture.loadData(atlasData.imageData);\n          textureAtlas.columns = atlasData.columns;\n          textureAtlas.rows = atlasData.rows;\n\n          // Resolve the promise.\n          promise.resolve();\n        });\n\n      textureAtlases[name] = textureAtlas;\n    }\n\n    return textureAtlases[name];\n  }\n\n  /**\n   * Returns the texture part of a texture atlas, or null if it doesn't exist.\n   *\n   * @param {string} name\n   * @return {Texture|null}\n   */\n  getTextureAtlas(name) {\n    let atlas = this.textureAtlases[name];\n\n    if (atlas) {\n      return atlas.texture;\n    }\n\n    return null;\n  }\n\n  /**\n   * Starts loading a new empty resource, and returns it.\n   * This empty resource will block the \"idle\" event (and thus whenAllLoaded) until it's resolved.\n   * This is used when a resource might get loaded in the future, but it is not known what it is yet.\n   *\n   * @return {PromiseResource}\n   */\n  promise() {\n    let resource = new PromiseResource();\n\n    this.registerEvents(resource);\n\n    resource.promise();\n\n    return resource;\n  }\n\n  /**\n   * Returns a promise that will be resolved once all of the currently loading resources get loaded.\n   * The promise will resolve instantly if nothing is being loaded.\n   *\n   * @return {Promise}\n   */\n  whenAllLoaded() {\n    return new Promise((resolve, reject) => {\n      if (this.resourcesLoading.size === 0) {\n        resolve(this);\n      } else {\n        this.once('idle', () => resolve(this));\n      }\n    });\n  }\n\n  /**\n   * Returns a promise that will be resolved with the canvas blob.\n   *\n   * @return {Promise<Blob>}\n   */\n  toBlob() {\n    return new Promise((resolve) => this.canvas.toBlob((blob) => resolve(blob)));\n  }\n\n  /**\n   * Update and render a frame.\n   */\n  updateAndRender() {\n    this.update();\n    this.startFrame();\n    this.render();\n  }\n\n  /**\n   * Update.\n   */\n  update() {\n    let scenes = this.scenes;\n\n    this.renderedInstances = 0;\n    this.renderedParticles = 0;\n    this.renderedBuckets = 0;\n    this.renderedScenes = 0;\n    this.renderCalls = 0;\n\n    // Update all of the scenes.\n    for (let i = 0, l = scenes.length; i < l; i++) {\n      let scene = scenes[i];\n\n      if (scene.rendered) {\n        scene.update();\n\n        this.renderedInstances += scene.renderedInstances;\n        this.renderedParticles += scene.renderedParticles;\n        this.renderedBuckets += scene.renderedBuckets;\n        this.renderedScenes += 1;\n        this.renderCalls += scene.renderCalls;\n      }\n    }\n  }\n\n  /**\n   * Clears the WebGL buffer.\n   * Called automatically by updateAndRender().\n   * Call this at some point before render() if you need more control.\n   */\n  startFrame() {\n    let gl = this.gl;\n\n    // See https://www.opengl.org/wiki/FAQ#Masking\n    gl.depthMask(1);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n  }\n\n  /**\n   * Render.\n   */\n  render() {\n    this.renderOpaque();\n    this.renderTranslucent();\n  }\n\n  /**\n   * Render opaque things.\n   */\n  renderOpaque() {\n    for (let scene of this.scenes) {\n      scene.renderOpaque();\n    }\n  }\n\n  /**\n   * Render translucent things.\n   */\n  renderTranslucent() {\n    for (let scene of this.scenes) {\n      scene.renderTranslucent();\n    }\n  }\n\n  /**\n   * A shortcut to register the standard events to the given resource for the viewer, so as to forward events to the client.\n   *\n   * @param {Resource} resource\n   */\n  registerEvents(resource) {\n    ['loadstart', 'load', 'error', 'loadend'].map((e) => resource.on(e, (...data) => this.emit(e, ...data)));\n  }\n\n  /**\n   * Clear all of the emitted objects in this viewer.\n   */\n  clearEmittedObjects() {\n    for (let scene of this.scenes) {\n      scene.clearEmittedObjects();\n    }\n  }\n}\n","/**\n * A model view.\n *\n * Model views are used in cases where you want instances of the same model to have different rendering properties.\n * It is used for texture overriding.\n */\nexport default class ModelView {\n  /**\n   * @param {Model} model\n   */\n  constructor(model) {\n    /** @member {Model} */\n    this.model = model;\n\n    this.instanceSet = new Set();\n    this.sceneData = new Map();\n\n    this.renderedInstances = 0;\n    this.renderedParticles = 0;\n    this.renderedBuckets = 0;\n    this.renderCalls = 0;\n  }\n\n  /**\n   * Get a shallow copy of this view.\n   *\n   * A shallow copy in this context means an object that any model view can be compared against.\n   * This is used in equals() to test if two model views share the same properties.\n   *\n   * @return {Object|null}\n   */\n  getShallowCopy() {\n    return null;\n  }\n\n  /**\n   * Given a shallow copy returned by getShallowCopy(), apply it to this model view.\n   *\n   * @param {Object} view\n   */\n  applyShallowCopy(view) {\n\n  }\n\n  /**\n   * Check if this model view is comparable to the given shallow view.\n   *\n   * @param {Object} view\n   * @return {boolean}\n   */\n  equals(view) {\n    return true;\n  }\n\n  /**\n   * Called by the owning model when it finishes loading.\n   */\n  lateLoad() {\n    for (let instance of this.instanceSet) {\n      this.addSceneData(instance, instance.scene);\n    }\n  }\n\n  /**\n   * Add new per-scene data for the given instances.\n   *\n   * @param {ModelInstance} instance\n   * @param {Scene} scene\n   */\n  addSceneData(instance, scene) {\n    if (this.model.ok && scene) {\n      let sceneData = this.sceneData;\n      let data = sceneData.get(scene);\n\n      if (!data) {\n        data = this.createSceneData(scene);\n\n        sceneData.set(scene, data);\n      }\n\n      data.instances.push(instance);\n    }\n  }\n\n  /**\n   * Add a new model instance to this model view.\n   * If the instance was alraedy in this model view, returns false, otherwise returns true.\n   *\n   * @param {ModelInstance} instance\n   * @return {boolean}\n   */\n  addInstance(instance) {\n    let instanceSet = this.instanceSet;\n\n    if (!instanceSet.has(instance)) {\n      // If the instance is already in another view, remove it first.\n      // This is always true, except when the instance is created and added to its first view.\n      let modelView = instance.modelView;\n      if (modelView) {\n        modelView.removeInstance(instance);\n      }\n\n      // Add the instance\n      instanceSet.add(instance);\n      instance.modelView = this;\n\n      this.addSceneData(instance, instance.scene);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Create a new scene data object.\n   *\n   * @param {Scene} scene\n   * @return {Object}\n   */\n  createSceneData(scene) {\n    return {\n      scene,\n      modelView: this,\n      baseIndex: 0,\n      instances: [],\n      buckets: [],\n      usedBuckets: 0,\n    };\n  }\n\n  /**\n   * Remove a model instance from this model view.\n   * If the instance wasn't in this model view, returns false, otherwise returns true.\n   *\n   * @param {ModelInstance} instance\n   * @return {boolean}\n   */\n  removeInstance(instance) {\n    let instanceSet = this.instanceSet;\n\n    if (instanceSet.delete(instance)) {\n      let sceneData = this.sceneData;\n      let scene = instance.scene;\n\n      if (scene) {\n        let data = sceneData.get(scene);\n        let instances = data.instances;\n        let buckets = data.buckets;\n\n        // Remove the instance from its scene data.\n        instances.splice(instances.indexOf(instance), 1);\n\n        // See how many buckets are needed to hold all of the instances.\n        let neededBuckets = Math.ceil(instances.length / this.model.batchSize);\n\n        // If there are more buckets than are needed, remove them.\n        if (neededBuckets < buckets.length) {\n          buckets.length = neededBuckets;\n        }\n      }\n\n      instance.modelView = null;\n\n      // If this view has no instances, ask the model to remove it.\n      if (instanceSet.size === 0) {\n        // / TODO: THIS NEEDS TO ALSO UPDATE ALL SCENES???\n        this.model.removeView(this);\n      }\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Called every time an instance changes its scene via scene.addInstance(instance) or instance.setScene(scene).\n   *\n   * @param {ModelInstance} instance\n   * @param {Scene} scene\n   */\n  sceneChanged(instance, scene) {\n    if (this.model.ok) {\n      let sceneData = this.sceneData;\n      let oldScene = instance.scene;\n\n      if (oldScene) {\n        let data = sceneData.get(oldScene);\n        let instances = data.instances;\n        let buckets = data.buckets;\n\n        // Remove the instance from its scene data.\n        instances.splice(instances.indexOf(instance), 1);\n\n        // See how many buckets are needed to hold all of the instances.\n        let neededBuckets = Math.ceil(instances.length / this.model.batchSize);\n\n        // If there are more buckets than are needed, remove them.\n        if (neededBuckets < buckets.length) {\n          buckets.length = neededBuckets;\n        }\n      }\n\n      if (scene) {\n        this.addSceneData(instance, scene);\n      }\n    }\n  }\n\n  /**\n   * Clear this model view from instances.\n   *\n   * TODO:Implement this.\n   */\n  clear() {\n\n  }\n\n  /**\n   * Detach this model view from its model viewer.\n   *\n   * TODO: Implement this.\n   */\n  detach() {\n\n  }\n\n  /**\n   * Update this model view.\n   * This invovles updating all of its buckets, particle emitters, and whatever else is needed.\n   *\n   * If this model view actually has data for the given scene, it will be returned. Otherwise null is returned.\n   *\n   * @param {Scene} scene\n   * @return {Object|null}\n   */\n  update(scene) {\n    if (this.model.ok) {\n      let data = this.sceneData.get(scene);\n\n      if (data) {\n        let instancesCount = data.instances.length;\n        let buckets = data.buckets;\n\n        data.baseIndex = 0;\n        data.usedBuckets = 0;\n\n        while (data.baseIndex < instancesCount) {\n          if (data.usedBuckets === buckets.length) {\n            buckets[data.usedBuckets] = new this.model.handler.Bucket(this);\n          }\n\n          data.baseIndex = buckets[data.usedBuckets].fill(data);\n          data.usedBuckets += 1;\n        }\n\n        return data;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Tell the model to render opaque things in this model view.\n   *\n   * @param {Scene} scene\n   */\n  renderOpaque(scene) {\n    let data = this.sceneData.get(scene);\n\n    if (data && data.baseIndex) {\n      this.model.renderOpaque(data);\n    }\n  }\n\n  /**\n   * Tell the model to render translucent things in this model view.\n   *\n   * @param {Scene} scene\n   */\n  renderTranslucent(scene) {\n    let data = this.sceneData.get(scene);\n\n    if (data && data.baseIndex) {\n      this.model.renderTranslucent(data);\n    }\n  }\n}\n","import ModelView from './modelview';\n\n/**\n * A textured model view.\n * Gives a consistent API for texture overloading for handlers that use it.\n */\nexport default class TexturedModelView extends ModelView {\n  /**\n   * @param {Model} model\n   */\n  constructor(model) {\n    super(model);\n\n    /** @member {Map<Texture, Texture>} */\n    this.textures = new Map();\n  }\n\n  /**\n   * The shallow copy of a textured model view is a map of its textures.\n   *\n   * @return {Object}\n   */\n  getShallowCopy() {\n    return {textures: new Map(this.textures)};\n  }\n\n  /**\n   * Apply the texture map from the given shallow view.\n   *\n   * @param {Object} view\n   */\n  applyShallowCopy(view) {\n    let textures = this.textures;\n\n    for (let [src, dst] of view.textures) {\n      textures.set(src, dst);\n    }\n  }\n\n  /**\n   * Two textured model views are equal if their texture maps have the same mapping.\n   *\n   * @param {Object} view\n   * @return {boolean}\n   */\n  equals(view) {\n    let textures = this.textures;\n    let dstTextures = view.textures;\n\n    if (textures.length !== dstTextures.length) {\n      return false;\n    }\n\n    for (let [src, dst] of dstTextures) {\n      if (textures.get(src) !== dst) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n}\n","import Resource from './resource';\n\n/**\n * A model.\n */\nexport default class Model extends Resource {\n  /**\n   * @param {Object} resourceData\n   */\n  constructor(resourceData) {\n    super(resourceData);\n\n    /** @member {number} */\n    this.batchSize = resourceData.viewer.batchSize;\n\n    /** @member {Array<ModelInstance>} */\n    this.instances = [];\n\n    /** @member {Array<ModelView>} */\n    this.views = [];\n  }\n\n  /**\n   * Adds a new instance to this model, and returns it.\n   *\n   * @return {ModelInstance}\n   */\n  addInstance() {\n    let views = this.views;\n    let instance = new this.handler.Instance(this);\n\n    this.instances.push(instance);\n\n    if (views.length === 0) {\n      this.addView();\n    }\n\n    views[0].addInstance(instance);\n\n    if (this.ok) {\n      instance.load();\n    }\n\n    return instance;\n  }\n\n  /**\n   * Render opaque things.\n   *\n   * @param {*} data\n   * @param {*} scene\n   * @param {*} modelView\n   */\n  renderOpaque(data, scene, modelView) {\n\n  }\n\n  /**\n   * Render translucent things.\n   *\n   * @param {*} data\n   * @param {*} scene\n   * @param {*} modelView\n   */\n  renderTranslucent(data, scene, modelView) {\n\n  }\n\n  /**\n   * Create a new model view for this model, and return it.\n   *\n   * @return {ModelView}\n   */\n  addView() {\n    let view = new this.handler.View(this);\n\n    this.views.push(view);\n\n    return view;\n  }\n\n  /**\n   * Remove a model view from this model.\n   *\n   * @param {*} modelView\n   */\n  removeView(modelView) {\n    let views = this.views;\n\n    views.splice(views.indexOf(modelView), 1);\n  }\n\n  /**\n   * Called every time an instance changes a model view.\n   * This generally corresponds to the instance creation, and to texture overriding.\n   *\n   * @param {ModelInstance} instance\n   * @param {Object} shallowView\n   */\n  viewChanged(instance, shallowView) {\n    // Check if there's another view that matches the instance\n    for (let view of this.views) {\n      if (view.equals(shallowView)) {\n        view.addInstance(instance);\n        return;\n      }\n    }\n\n    // Since no view matched, create a new one\n    let view = this.addView();\n\n    view.applyShallowCopy(shallowView);\n    view.addInstance(instance);\n\n    // If the instance is already in a scene, and this is a new view, it will not be in the scene, so add it.\n    if (instance.scene) {\n      instance.scene.addView(view);\n    }\n  }\n\n  /**\n   * Called when the model finishes loading.\n   * Automatically finalizes loading for all of the model instances and views of this model.\n   */\n  lateLoad() {\n    for (let instance of this.instances) {\n      instance.load();\n    }\n\n    for (let view of this.views) {\n      view.lateLoad();\n    }\n  }\n}\n","import Model from './model';\n\n/**\n * A textured model.\n * Gives a consistent API for texture overloading for handlers that use it.\n */\nexport default class TexturedModel extends Model {\n  /**\n   * Bind a texture to some texture unit.\n   * Checks the model view for an override.\n   *\n   * @param {Texture} texture\n   * @param {number} unit\n   * @param {ModelView} modelView\n   */\n  bindTexture(texture, unit, modelView) {\n    let viewer = this.viewer;\n    let textures = modelView.textures;\n\n    if (textures.has(texture)) {\n      texture = textures.get(texture);\n    }\n\n    // If the texture exists, bind it.\n    // Otherwise, bind null, which will result in a black texture being bound to avoid console errors.\n    if (texture) {\n      texture.bind(unit);\n    } else {\n      viewer.webgl.bindTexture(null, unit);\n    }\n  }\n}\n","import TexturedModel from '../../texturedmodel';\n\n/**\n * A geometry model.\n *\n * Used to render simple geometric shapes.\n */\nexport default class GeometryModel extends TexturedModel {\n  /**\n   * Load the model.\n   *\n   * @param {Object} src\n   */\n  load(src) {\n    const gl = this.viewer.gl;\n\n    let geometry = src.geometry;\n    let material = src.material;\n\n    let vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, geometry.vertices, gl.STATIC_DRAW);\n\n    let uvBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, geometry.uvs, gl.STATIC_DRAW);\n\n    let faceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, geometry.faces, gl.STATIC_DRAW);\n\n    let edgeBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, edgeBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, geometry.edges, gl.STATIC_DRAW);\n\n    this.boundingRadius = geometry.boundingRadius;\n\n    this.vertexArray = geometry.vertices;\n    this.uvArray = geometry.uvs;\n    this.faceArray = geometry.faces;\n    this.edgeArray = geometry.edges;\n    this.vertexBuffer = vertexBuffer;\n    this.uvBuffer = uvBuffer;\n    this.faceBuffer = faceBuffer;\n    this.edgeBuffer = edgeBuffer;\n\n    let bytesPerElement = geometry.faces.BYTES_PER_ELEMENT;\n\n    if (bytesPerElement === 1) {\n      this.faceIndexType = gl.UNSIGNED_BYTE;\n    } else if (bytesPerElement === 2) {\n      this.faceIndexType = gl.UNSIGNED_SHORT;\n    } else {\n      this.faceIndexType = gl.UNSIGNED_INT;\n    }\n\n    bytesPerElement = geometry.edges.BYTES_PER_ELEMENT;\n\n    if (bytesPerElement === 1) {\n      this.edgeIndexType = gl.UNSIGNED_BYTE;\n    } else if (bytesPerElement === 2) {\n      this.edgeIndexType = gl.UNSIGNED_SHORT;\n    } else {\n      this.edgeIndexType = gl.UNSIGNED_INT;\n    }\n\n    this.texture = material.texture;\n\n    this.twoSided = material.twoSided || false;\n    this.noDepthTest = material.noDepthSet || false;\n    this.noDepthSet = material.noDepthSet || false;\n\n    this.uvScale = material.uvScale || new Float32Array([1, 1]);\n    this.uvOffset = material.uvOffset || new Float32Array(2);\n\n    this.vertexColor = material.vertexColor || new Float32Array([255, 255, 255, 255]);\n    this.edgeColor = material.edgeColor || new Float32Array([255, 255, 255, 255]);\n\n    this.renderMode = 0;\n\n    if (material.renderMode > 0) {\n      this.renderMode = material.renderMode;\n    }\n\n    this.isBGR = material.isBGR || false;\n    this.isBlended = material.isBlended || false;\n\n    if (this.isBlended) {\n      this.translucent = true;\n    } else {\n      this.opaque = true;\n    }\n  }\n\n  /**\n   *\n   * @param {*} bucket\n   * @param {*} scene\n   * @param {*} modelView\n   */\n  render(bucket, scene, modelView) {\n    let webgl = this.viewer.webgl;\n    let gl = this.viewer.gl;\n    let instancedArrays = webgl.extensions.instancedArrays;\n    let shader = this.viewer.shaderMap.get('GeoStandardShader');\n    let uniforms = shader.uniforms;\n    let attribs = shader.attribs;\n\n    webgl.useShaderProgram(shader);\n\n    gl.uniformMatrix4fv(uniforms.u_mvp, false, scene.camera.worldProjectionMatrix);\n\n    // Bone texture\n    gl.activeTexture(gl.TEXTURE15);\n    gl.bindTexture(gl.TEXTURE_2D, bucket.boneTexture);\n    gl.uniform1i(uniforms.u_boneMap, 15);\n    gl.uniform1f(uniforms.u_vectorSize, bucket.vectorSize);\n    gl.uniform1f(uniforms.u_rowSize, bucket.rowSize);\n\n    // Instanced IDs\n    let instanceIdAttrib = attribs.a_InstanceID;\n    gl.bindBuffer(gl.ARRAY_BUFFER, bucket.instanceIdBuffer);\n    gl.vertexAttribPointer(instanceIdAttrib, 1, gl.UNSIGNED_SHORT, false, 2, 0);\n    instancedArrays.vertexAttribDivisorANGLE(instanceIdAttrib, 1);\n\n    // Vertices\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    gl.vertexAttribPointer(attribs.a_position, 3, gl.FLOAT, false, 12, 0);\n\n    // UVs\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);\n    gl.vertexAttribPointer(attribs.a_uv, 2, gl.FLOAT, false, 8, 0);\n\n    if (this.twoSided) {\n      gl.disable(gl.CULL_FACE);\n    } else {\n      gl.enable(gl.CULL_FACE);\n    }\n\n    if (this.noDepthTest) {\n      gl.disable(gl.DEPTH_TEST);\n    } else {\n      gl.enable(gl.DEPTH_TEST);\n    }\n\n    if (this.noDepthSet) {\n      gl.depthMask(0);\n    } else {\n      gl.depthMask(1);\n    }\n\n    if (this.isBlended) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n    } else {\n      gl.disable(gl.BLEND);\n    }\n\n    gl.uniform1i(uniforms.u_texture, 0);\n\n    let colorAttrib = attribs.a_color;\n    instancedArrays.vertexAttribDivisorANGLE(colorAttrib, 1);\n\n    if (this.renderMode === 0 || this.renderMode === 2) {\n      let texture = modelView.textures.get(null) || this.texture;\n\n      webgl.bindTexture(texture, 0);\n\n      let hasTexture = uniforms.u_hasTexture;\n      if (texture) {\n        gl.uniform1f(hasTexture, 1);\n      } else {\n        gl.uniform1f(hasTexture, 0);\n      }\n\n      gl.uniform1f(uniforms.u_isEdge, 0);\n      gl.uniform2fv(uniforms.u_uvScale, this.uvScale);\n      gl.uniform2fv(uniforms.u_uvOffset, this.uvOffset);\n      gl.uniform1f(uniforms.u_isBGR, this.isBGR);\n      gl.uniform1f(uniforms.u_alphaMod, this.alpha);\n\n      // Colors\n      gl.bindBuffer(gl.ARRAY_BUFFER, bucket.vertexColorBuffer);\n      gl.vertexAttribPointer(colorAttrib, 4, gl.UNSIGNED_BYTE, true, 0, 0);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.faceBuffer);\n      instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, this.faceArray.length, this.faceIndexType, 0, bucket.count);\n    }\n\n    if (this.renderMode === 1 || this.renderMode === 2) {\n      gl.uniform1f(uniforms.u_isEdge, 1);\n\n      // Edge colors\n      gl.bindBuffer(gl.ARRAY_BUFFER, bucket.edgeColorBuffer);\n      gl.vertexAttribPointer(colorAttrib, 4, gl.UNSIGNED_BYTE, true, 0, 0);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.edgeBuffer);\n      instancedArrays.drawElementsInstancedANGLE(gl.LINES, this.edgeArray.length, this.edgeIndexType, 0, bucket.count);\n    }\n\n    // / Reset the attributes to play nice with other handlers\n    instancedArrays.vertexAttribDivisorANGLE(instanceIdAttrib, 0);\n    instancedArrays.vertexAttribDivisorANGLE(colorAttrib, 0);\n  }\n\n  /**\n   * @param {*} data\n   */\n  renderBuckets(data) {\n    let scene = data.scene;\n    let buckets = data.buckets;\n    let modelView = data.modelView;\n\n    for (let i = 0, l = data.usedBuckets; i < l; i++) {\n      this.render(buckets[i], scene, modelView);\n    }\n  }\n\n  /**\n   * Render the opaque things in the given scene data.\n   *\n   * @param {Object} data\n   */\n  renderOpaque(data) {\n    if (this.opaque) {\n      this.renderBuckets(data);\n    }\n  }\n\n  /**\n   * Render the translucent things in the given scene data.\n   *\n   * @param {Object} data\n   */\n  renderTranslucent(data) {\n    if (this.translucent) {\n      this.renderBuckets(data);\n    }\n  }\n}\n","/**\n * A bucket.\n */\nexport default class Bucket {\n  /**\n  * @param {ModelView} modelView\n  */\n  constructor(modelView) {\n    let model = modelView.model;\n    let gl = model.viewer.gl;\n\n    /** @member {ModelView} */\n    this.modelView = modelView;\n    /** @member {Model} */\n    this.model = model;\n    /** @member {number} */\n    this.count = 0;\n\n    // The index buffer is used instead of gl_InstanceID, which isn't defined in WebGL shaders.\n    // It's a simple buffer of indices, [0, 1, ..., this.size - 1].\n    // While it can be shared between all buckets in the viewer, this makes the code slightly messy and less dynamic.\n    // It's 256 bytes per bucket, no big deal. Right?\n    this.instanceIdBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.instanceIdBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Uint16Array(model.batchSize).map((currentValue, index, array) => index), gl.STATIC_DRAW);\n  }\n\n  /**\n   * Fills in data from a collection of model instances.\n   *\n   * @param {Object} data\n   * @param {number} baseInstance\n   * @param {Scene} scene\n   * @return {number}\n   */\n  fill(data, baseInstance, scene) {\n    // Make believe the bucket is now filled with data for all instances.\n    // This is because if a non-specific bucket implementation is supplied, instancing isn't used, so batching is irrelevant.\n    return data.instances.length;\n  }\n}\n","import Bucket from '../../bucket';\n\n/**\n * GEO bucket implementation.\n */\nexport default class GeometryBucket extends Bucket {\n  /**\n   * @param {GeometryModelView} modelView\n   */\n  constructor(modelView) {\n    super(modelView);\n\n    const gl = this.model.viewer.gl;\n    const numberOfBones = 1;\n\n    this.gl = gl;\n\n    let model = this.model;\n    let batchSize = model.batchSize;\n\n    this.boneArrayInstanceSize = numberOfBones * 16;\n    this.boneArray = new Float32Array(this.boneArrayInstanceSize * batchSize);\n\n    this.boneTexture = gl.createTexture();\n    this.boneTextureWidth = numberOfBones * 4;\n    this.boneTextureHeight = batchSize;\n    this.vectorSize = 1 / this.boneTextureWidth;\n    this.rowSize = 1 / this.boneTextureHeight;\n\n    gl.activeTexture(gl.TEXTURE15);\n    gl.bindTexture(gl.TEXTURE_2D, this.boneTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA32F, this.boneTextureWidth, this.boneTextureHeight, 0, gl.RGBA, gl.FLOAT, this.boneArray);\n\n    // Color (per instance)\n    this.vertexColorArray = new Uint8Array(4 * batchSize);\n    this.vertexColorBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexColorBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, this.vertexColorArray, gl.DYNAMIC_DRAW);\n\n    // Edge color (per instance)\n    this.edgeColorArray = new Uint8Array(4 * batchSize);\n    this.edgeColorBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.edgeColorBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, this.edgeColorArray, gl.DYNAMIC_DRAW);\n  }\n\n  /**\n   * Fill this bucket with scene data.\n   *\n   * @param {Object} data\n   * @return {number}\n   */\n  fill(data) {\n    let baseIndex = data.baseIndex;\n    let model = this.model;\n    let gl = model.viewer.gl;\n    let batchSize = model.batchSize;\n    let boneArray = this.boneArray;\n    let vertexColorArray = this.vertexColorArray;\n    let edgeColorArray = this.edgeColorArray;\n    let instanceOffset = 0;\n    let instances = data.instances;\n\n    for (let l = instances.length; baseIndex < l && instanceOffset < batchSize; baseIndex++) {\n      let instance = instances[baseIndex];\n\n      if (instance.rendered && !instance.culled) {\n        let worldMatrix = instance.worldMatrix;\n        let vertexColor = instance.vertexColor;\n        let edgeColor = instance.edgeColor;\n        let offset = instanceOffset * 16;\n\n        boneArray[offset] = worldMatrix[0];\n        boneArray[offset + 1] = worldMatrix[1];\n        boneArray[offset + 2] = worldMatrix[2];\n        boneArray[offset + 3] = worldMatrix[3];\n        boneArray[offset + 4] = worldMatrix[4];\n        boneArray[offset + 5] = worldMatrix[5];\n        boneArray[offset + 6] = worldMatrix[6];\n        boneArray[offset + 7] = worldMatrix[7];\n        boneArray[offset + 8] = worldMatrix[8];\n        boneArray[offset + 9] = worldMatrix[9];\n        boneArray[offset + 10] = worldMatrix[10];\n        boneArray[offset + 11] = worldMatrix[11];\n        boneArray[offset + 12] = worldMatrix[12];\n        boneArray[offset + 13] = worldMatrix[13];\n        boneArray[offset + 14] = worldMatrix[14];\n        boneArray[offset + 15] = worldMatrix[15];\n\n        // Vertex color\n        vertexColorArray[instanceOffset * 4] = vertexColor[0];\n        vertexColorArray[instanceOffset * 4 + 1] = vertexColor[1];\n        vertexColorArray[instanceOffset * 4 + 2] = vertexColor[2];\n        vertexColorArray[instanceOffset * 4 + 3] = vertexColor[3];\n\n        // Edge color\n        edgeColorArray[instanceOffset * 4] = edgeColor[0];\n        edgeColorArray[instanceOffset * 4 + 1] = edgeColor[1];\n        edgeColorArray[instanceOffset * 4 + 2] = edgeColor[2];\n        edgeColorArray[instanceOffset * 4 + 3] = edgeColor[3];\n\n        instanceOffset += 1;\n      }\n    }\n\n    this.count = instanceOffset;\n\n    if (instanceOffset) {\n      gl.activeTexture(gl.TEXTURE15);\n      gl.bindTexture(gl.TEXTURE_2D, this.boneTexture);\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, this.boneTextureWidth, instanceOffset, gl.RGBA, gl.FLOAT, boneArray);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexColorBuffer);\n      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.vertexColorArray);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.edgeColorBuffer);\n      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.edgeColorArray);\n    }\n\n    return baseIndex;\n  }\n}\n","import {EventNode} from './node';\n\n/**\n * A model instance.\n */\nexport default class ModelInstance extends EventNode {\n  /**\n   * @param {Model} model\n   */\n  constructor(model) {\n    super();\n\n    /** @member {?ModelView} */\n    this.modelView = null;\n    /** @member {Model} */\n    this.model = model;\n    /** @member {boolean} */\n    this.paused = false;\n    /** @member {boolean} */\n    this.rendered = true;\n    /** @member {boolean} */\n    this.culled = false;\n    /**\n     *  Set to true if this instance should always be rendered.\n     *\n     * @member {boolean}\n     */\n    this.noCulling = false;\n    /** @member {?object} */\n    this.bounds = null;\n  }\n\n  /**\n   * This instance should be shown.\n   * Note that it can still be hidden due to culling.\n   */\n  show() {\n    this.rendered = true;\n  }\n\n  /**\n   * This instance should be hidden.\n   */\n  hide() {\n    this.rendered = false;\n  }\n\n  /**\n   * Should the instance be shown?\n   *\n   * @return {boolean}\n   */\n  shown() {\n    return this.rendered;\n  }\n\n  /**\n   * Should the instance be hidden?\n   *\n   * @return {boolean}\n   */\n  hidden() {\n    return !this.rendered;\n  }\n\n  /**\n   * Detach this instance from the scene it's in.\n   * Equivalent to scene.removeInstance(instance).\n   *\n   * @return {boolean}\n   */\n  detach() {\n    if (this.scene) {\n      return this.scene.removeInstance(this);\n    }\n\n    return false;\n  }\n\n  /**\n   * Called once the model is loaded, or immediately if the model was already loaded.\n   *\n   * @param {ArrayBuffer|string|Image} buffer\n   */\n  load(buffer) {\n\n  }\n\n  /**\n   * Called every frame.\n   * Do lightweight updates here, like updating animation timers.\n   */\n  updateTimers() {\n\n  }\n\n  /**\n   * Called if the instance is shown and not culled.\n   * Do heavyweight updates here, like updating skeletons.\n   */\n  updateAnimations() {\n\n  }\n\n  /**\n   * Clears any objects that were emitted by this instance.\n   */\n  clearEmittedObjects() {\n\n  }\n\n  /**\n   * Update this model instance.\n   * Called automatically by the scene that owns this model instance.\n   *\n   * @param {Scene} scene\n   */\n  updateObject(scene) {\n    if (!this.paused && this.model.ok) {\n      this.updateTimers();\n\n      if (this.rendered) {\n        let visible = scene.isVisible(this) || this.noCulling || this.model.viewer.noCulling;\n\n        this.culled = !visible;\n\n        if (visible) {\n          this.updateAnimations();\n        }\n      }\n    }\n  }\n\n  /**\n   * Sets the scene of this instance.\n   * This is equivalent to scene.addInstance(instance).\n   *\n   * @param {Scene} scene\n   * @return {boolean}\n   */\n  setScene(scene) {\n    return scene.addInstance(this);\n  }\n}\n","import ModelInstance from './modelinstance';\n\n/**\n * A textured model instance.\n * Gives a consistent API for texture overloading for handlers that use it.\n */\nexport default class TexturedModelInstance extends ModelInstance {\n  /**\n   * Overrides a texture with another one.\n   *\n   * @param {Texture} which\n   * @param {Texture} texture\n   */\n  setTexture(which, texture) {\n    let view = this.modelView.getShallowCopy();\n\n    view.textures.set(which, texture);\n\n    this.model.viewChanged(this, view);\n  }\n}\n","import TexturedModelInstance from '../../texturedmodelinstance';\n\n/**\n * A GEO model instance.\n */\nexport default class GeometryModelInstance extends TexturedModelInstance {\n  /**\n   * @param {GeometryModel} model\n   */\n  constructor(model) {\n    super(model);\n\n    this.vertexColor = new Uint8Array(4);\n    this.edgeColor = new Uint8Array(4);\n  }\n\n  /**\n   *\n   */\n  load() {\n    // Initialize to the model's material colors.\n    this.setVertexColor(this.model.vertexColor);\n    this.setEdgeColor(this.model.edgeColor);\n  }\n\n  /**\n   * @param {Uint8Array} color\n   * @return {this}\n   */\n  setVertexColor(color) {\n    this.vertexColor.set(color);\n\n    return this;\n  }\n\n  /**\n   * @param {Uint8Array} color\n   * @return {this}\n   */\n  setEdgeColor(color) {\n    this.edgeColor.set(color);\n\n    return this;\n  }\n}\n","\nexport default {\n  // Shared shader code to mimic gl_InstanceID\n  instanceId: `\n    attribute float a_InstanceID;\n  `,\n  // Shared shader code to handle bone textures\n  boneTexture: `\n    uniform sampler2D u_boneMap;\n    uniform float u_vectorSize;\n    uniform float u_rowSize;\n\n    mat4 fetchMatrix(float column, float row) {\n      column *= u_vectorSize * 4.0;\n      row *= u_rowSize;\n      // Add in half texel to sample in the middle of the texel.\n      // Otherwise, since the sample is directly on the boundry, small floating point errors can cause the sample to get the wrong pixel.\n      // This is mostly noticable with NPOT textures, which the bone maps are.\n      column += 0.5 * u_vectorSize;\n      row += 0.5 * u_rowSize;\n\n      return mat4(texture2D(u_boneMap, vec2(column, row)),\n                  texture2D(u_boneMap, vec2(column + u_vectorSize, row)),\n                  texture2D(u_boneMap, vec2(column + u_vectorSize * 2.0, row)),\n                  texture2D(u_boneMap, vec2(column + u_vectorSize * 3.0, row)));\n    }\n  `,\n  // Shared shader code to handle decoding multiple bytes stored in floats\n  decodeFloat: `\n    vec2 decodeFloat2(float f) {\n      vec2 v;\n\n      v[1] = floor(f / 256.0);\n      v[0] = floor(f - v[1] * 256.0);\n\n      return v;\n    }\n\n    vec3 decodeFloat3(float f) {\n      vec3 v;\n\n      v[2] = floor(f / 65536.0);\n      v[1] = floor((f - v[2] * 65536.0) / 256.0);\n      v[0] = floor(f - v[2] * 65536.0 - v[1] * 256.0);\n\n      return v;\n    }\n\n    vec4 decodeFloat4(float v) {\n      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\n      enc = fract(enc);\n      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n      return enc;\n    }\n  `,\n  quat_transform: `\n    // A 2D quaternion*vector.\n    // q is the zw components of the original quaternion.\n    vec2 quat_transform(vec2 q, vec2 v) {\n      vec2 uv = vec2(-q.x * v.y, q.x * v.x);\n      vec2 uuv = vec2(-q.x * uv.y, q.x * uv.x);\n\n      return v + 2.0 * (uv * q.y + uuv);\n    }\n\n    // A 2D quaternion*vector.\n    // q is the zw components of the original quaternion.\n    vec3 quat_transform(vec2 q, vec3 v) {\n      return vec3(quat_transform(q, v.xy), v.z);\n    }\n  `,\n};\n","import shaders from '../../shaders';\n\nexport default {\n  vs: `\n    ${shaders.instanceId}\n    ${shaders.boneTexture}\n    uniform mat4 u_mvp;\n    uniform vec2 u_uvOffset;\n    uniform vec2 u_uvScale;\n\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    attribute vec2 a_uvScale;\n    attribute vec4 a_color;\n\n    varying vec2 v_uv;\n    varying vec4 v_color;\n\n    void main() {\n      v_uv = a_uv * u_uvScale + u_uvOffset;\n      v_color = a_color;\n\n      gl_Position = u_mvp * fetchMatrix(0.0, a_InstanceID) * vec4(a_position, 1.0);\n    }\n  `,\n  ps: `\n    uniform sampler2D u_diffuseMap;\n    uniform float u_alphaMod;\n    uniform bool u_isEdge;\n    uniform bool u_hasTexture;\n    uniform bool u_isBGR;\n\n    varying vec2 v_uv;\n    varying vec4 v_color;\n\n    void main() {\n      gl_FragColor = v_color;\n\n      if (u_hasTexture && !u_isEdge) {\n        vec4 texel = texture2D(u_diffuseMap, v_uv);\n\n        if (u_isBGR) {\n          texel = texel.bgra;\n        }\n\n        gl_FragColor *= texel;\n      } \n    }\n  `,\n};\n","import ModelView from './modelview';\nimport Model from './model';\nimport Bucket from './bucket';\nimport ModelInstance from './modelinstance';\nimport shaders from './shaders';\n\nexport default {\n  install(viewer) {\n    let shader = viewer.loadShader('GeoStandardShader', shaders.vs, shaders.ps);\n\n    // If a shader failed to compile, don't allow the handler to be registered, and send an error instead.\n    return shader.ok;\n  },\n\n  extensions: [['.geo']],\n  Constructor: Model,\n  View: ModelView,\n  Bucket: Bucket,\n  Instance: ModelInstance,\n};\n","import TexturedModelView from '../../texturedmodelview';\n\n/**\n * GEO model view implementation.\n */\nexport default class ModelView extends TexturedModelView {\n  /**\n   * @param {Scene} scene\n   */\n  update(scene) {\n    let data = super.update(scene);\n\n    if (data) {\n      let batchCount = (this.model.renderMode === 2 ? 2 : 1);\n      let buckets = data.buckets;\n      let renderedInstances = 0;\n      let renderedBuckets = 0;\n      let renderCalls = 0;\n\n      for (let i = 0, l = data.usedBuckets; i < l; i++) {\n        renderedInstances += buckets[i].count;\n        renderedBuckets += 1;\n        renderCalls += batchCount;\n      }\n\n      this.renderedInstances = renderedInstances;\n      this.renderedBuckets = renderedBuckets;\n      this.renderCalls = renderCalls;\n    }\n  }\n}\n","import handler from './handler';\nimport Model from './model';\nimport ModelInstance from './modelinstance';\nimport Bucket from './bucket';\n\nexport default {\n  handler,\n  Model,\n  ModelInstance,\n  Bucket,\n};\n","import {clamp} from '../../../common/math';\nimport {interpolateScalar, interpolateVector, interpolateQuaternion} from '../../../common/interpolator';\nimport {UintAnimation, FloatAnimation, Vector3Animation, Vector4Animation} from '../../../parsers/mdlx/animations';\n\n/**\n * Templated animated data for a specific sequence.\n *\n * @param {function} interpolator\n * @return {class}\n */\nconst templatedSdSequence = (interpolator) => class {\n  /**\n   * @param {Sd} sd\n   * @param {number} start\n   * @param {number} end\n   * @param {Array<Track>} keyframes\n   * @param {boolean} isGlobalSequence\n   */\n  constructor(sd, start, end, keyframes, isGlobalSequence) {\n    let defval = sd.defval;\n\n    this.sd = sd;\n    this.start = start;\n    this.end = end;\n    this.keyframes = [];\n\n    // When using a global sequence, where the first key is outside of the sequence's length, it becomes its constant value.\n    // When having one key in the sequence's range, and one key outside of it, results seem to be non-deterministic.\n    // Sometimes the second key is used too, sometimes not.\n    // It also differs depending where the model is viewed - the WE previewer, the WE itself, or the game.\n    // All three show different results, none of them make sense.\n    // Therefore, only handle the case where the first key is outside.\n    // This fixes problems spread over many models, e.g. HeroMountainKing (compare in WE and in Magos).\n    if (isGlobalSequence && keyframes[0].frame > end) {\n      this.keyframes.push(keyframes[0]);\n    }\n\n    // Go over the keyframes, and add all of the ones that are in this sequence (start <= frame <= end).\n    for (let i = 0, l = keyframes.length; i < l; i++) {\n      let keyframe = keyframes[i];\n      let frame = keyframe.frame;\n\n      if (frame >= start && frame <= end) {\n        this.keyframes.push(keyframe);\n      }\n    }\n\n    let keyframeCount = this.keyframes.length;\n\n    if (keyframeCount === 0) {\n      // If there are no keys, use the default value directly.\n      this.constant = true;\n      this.keyframes.push({frame: start, value: defval, inTan: defval, outTan: defval});\n    } else if (keyframeCount === 1) {\n      // If there's only one key, use it directly.\n      this.constant = true;\n    } else {\n      // If all of the values in this sequence are the same, might as well make it constant.\n      let constant = true;\n      let firstValue = this.keyframes[0].value;\n\n      for (let i = 1, l = this.keyframes.length; i < l; i++) {\n        let keyframe = this.keyframes[i];\n        let value = keyframe.value;\n\n        if (value.length > 0) {\n          for (let j = 0, k = value.length; j < k; j++) {\n            if (firstValue[j] !== value[j]) {\n              constant = false;\n              break;\n            }\n          }\n        } else {\n          if (value !== firstValue) {\n            constant = false;\n            break;\n          }\n        }\n      }\n\n      if (constant) {\n        this.constant = true;\n      } else {\n        this.constant = false;\n\n        // If there is no opening keyframe for this sequence, inject one with the default value.\n        if (this.keyframes[0].frame !== start) {\n          this.keyframes.unshift({frame: start, value: defval, inTan: defval, outTan: defval});\n        }\n\n        // If there is no closing keyframe for this sequence, inject one with the default value.\n        if (this.keyframes[this.keyframes.length - 1].frame !== end) {\n          this.keyframes.push({frame: end, value: this.keyframes[0].value, inTan: this.keyframes[0].outTan, outTan: this.keyframes[0].inTan});\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Uint32Array|Float32Array|vec3|quat} out\n   * @param {number} frame\n   * @return {number}\n   */\n  getValue(out, frame) {\n    let keyframes = this.keyframes;\n    let index = this.getKeyframe(frame);\n    let length = keyframes.length;\n\n    if (index === -1) {\n      out.set(keyframes[0].value);\n\n      return 0;\n    } else if (index === length) {\n      out.set(keyframes[length - 1].value);\n\n      return length - 1;\n    } else {\n      let start = keyframes[index - 1];\n      let end = keyframes[index];\n      let t = clamp((frame - start.frame) / (end.frame - start.frame), 0, 1);\n\n      interpolator(out, start.value, start.outTan, end.inTan, end.value, t, this.sd.interpolationType);\n\n      return index;\n    }\n  }\n\n  /**\n   * @param {number} frame\n   * @return {number}\n   */\n  getKeyframe(frame) {\n    if (this.constant) {\n      return -1;\n    } else {\n      let keyframes = this.keyframes;\n      let l = keyframes.length;\n\n      if (frame < this.start) {\n        return -1;\n      } else if (frame >= this.end) {\n        return l;\n      } else {\n        for (let i = 1; i < l; i++) {\n          let keyframe = keyframes[i];\n\n          if (keyframe.frame > frame) {\n            return i;\n          }\n        }\n      }\n    }\n  }\n};\n\nconst forcedInterpMap = {\n  KLAV: 0,\n  KATV: 0,\n  KPEV: 0,\n  KP2V: 0,\n  KRVS: 0,\n};\n\nconst defVals = {\n  // LAYS\n  KMTF: [0],\n  KMTA: [1],\n  // TXAN\n  KTAT: [0, 0, 0],\n  KTAR: [0, 0, 0, 1],\n  KTAS: [1, 1, 1],\n  // GEOA\n  KGAO: [1],\n  KGAC: [0, 0, 0],\n  // LITE\n  KLAS: [0],\n  KLAE: [0],\n  KLAC: [0, 0, 0],\n  KLAI: [0],\n  KLBI: [0],\n  KLBC: [0, 0, 0],\n  KLAV: [1],\n  // ATCH\n  KATV: [1],\n  // PREM\n  KPEE: [0],\n  KPEG: [0],\n  KPLN: [0],\n  KPLT: [0],\n  KPEL: [0],\n  KPES: [0],\n  KPEV: [1],\n  // PRE2\n  KP2S: [0],\n  KP2R: [0],\n  KP2L: [0],\n  KP2G: [0],\n  KP2E: [0],\n  KP2N: [0],\n  KP2W: [0],\n  KP2V: [1],\n  // RIBB\n  KRHA: [0],\n  KRHB: [0],\n  KRAL: [1],\n  KRCO: [0, 0, 0],\n  KRTX: [0],\n  KRVS: [1],\n  // CAMS\n  KCTR: [0, 0, 0],\n  KTTR: [0, 0, 0],\n  KCRL: [0],\n  // NODE\n  KGTR: [0, 0, 0],\n  KGRT: [0, 0, 0, 1],\n  KGSC: [1, 1, 1],\n};\n\n/**\n * Templated sequence data.\n *\n * @param {UintSequence|FloatSequence|Vector3Sequence|Vector4Sequence} SequenceType\n * @return {class}\n */\nconst templatedSd = (SequenceType) => class {\n  /**\n   * @param {MdxModel} model\n   * @param {UintAnimation|FloatAnimation|Vector3Animation|Vector4Animation} animation\n   */\n  constructor(model, animation) {\n    let globalSequences = model.globalSequences;\n    let globalSequenceId = animation.globalSequenceId;\n    let tracks = animation.tracks;\n    let forcedInterp = forcedInterpMap[animation.name];\n\n    this.model = model;\n    this.name = animation.name;\n    this.defval = defVals[animation.name];\n    this.globalSequence = null;\n    this.sequences = [];\n\n    // Allow to force an interpolation type.\n    // The game seems to do this with visibility tracks, where the type is forced to None.\n    // It came up as a bug report by a user who used the wrong interpolation type.\n    this.interpolationType = forcedInterp !== undefined ? forcedInterp : animation.interpolationType;\n\n    if (globalSequenceId !== -1 && globalSequences) {\n      this.globalSequence = new SequenceType(this, 0, globalSequences[globalSequenceId], tracks, true);\n    } else {\n      for (let sequence of model.sequences) {\n        this.sequences.push(new SequenceType(this, ...sequence.interval, tracks, false));\n      }\n    }\n  }\n\n  /**\n   * @param {Uint32Array|Float32Array|vec3|quat} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getValue(out, instance) {\n    if (this.globalSequence) {\n      return this.globalSequence.getValue(out, instance.counter % this.globalSequence.end);\n    } else if (instance.sequence !== -1) {\n      return this.sequences[instance.sequence].getValue(out, instance.frame);\n    } else {\n      out.set(this.defval);\n      return -1;\n    }\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isVariant(sequence) {\n    if (this.globalSequence) {\n      return !this.globalSequence.constant;\n    } else {\n      return !this.sequences[sequence].constant;\n    }\n  }\n\n  /**\n   * @return {Array<number|vec3|quat>}\n   */\n  getValues() {\n    if (this.globalSequence) {\n      return this.globalSequence.keyframes.map((track) => track.value);\n    } else {\n      let values = [];\n\n      for (let sequence of this.sequences) {\n        values.push(...sequence.keyframes.map((track) => track.value));\n      }\n\n      return values;\n    }\n  }\n};\n\nconst ScalarSd = templatedSd(templatedSdSequence(interpolateScalar));\nconst Vector3Sd = templatedSd(templatedSdSequence(interpolateVector));\nconst Vector4Sd = templatedSd(templatedSdSequence(interpolateQuaternion));\n\n/**\n * @param {Model} model\n * @param {UintAnimation|FloatAnimation|Vector3Animation|Vector4Animation} animation\n * @return {ScalarSd|Vector3Sd|Vector4Sd}\n */\nexport default function createTypedSd(model, animation) {\n  let ClassObject;\n\n  if (animation instanceof UintAnimation || animation instanceof FloatAnimation) {\n    ClassObject = ScalarSd;\n  } else if (animation instanceof Vector3Animation) {\n    ClassObject = Vector3Sd;\n  } else if (animation instanceof Vector4Animation) {\n    ClassObject = Vector4Sd;\n  }\n\n  return new ClassObject(model, animation);\n}\n","import {vec3, quat} from 'gl-matrix';\nimport {lerp, hermite, bezier} from './math';\n\n/**\n * @param {ArrayBufferView} out\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @param {number} d\n * @param {number} t\n * @param {number} type\n * @return {out}\n */\nexport function interpolateScalar(out, a, b, c, d, t, type) {\n  if (type === 0) {\n    out[0] = a[0];\n  } else if (type === 1) {\n    out[0] = lerp(a[0], d[0], t);\n  } else if (type === 2) {\n    out[0] = hermite(a[0], b[0], c[0], d[0], t);\n  } else if (type === 3) {\n    out[0] = bezier(a[0], b[0], c[0], d[0], t);\n  }\n\n  return out;\n}\n\n/**\n * @param {vec3} out\n * @param {vec3} a\n * @param {vec3} b\n * @param {vec3} c\n * @param {vec3} d\n * @param {number} t\n * @param {number} type\n * @return {out}\n */\nexport function interpolateVector(out, a, b, c, d, t, type) {\n  if (type === 0) {\n    vec3.copy(out, a);\n  } else if (type === 1) {\n    vec3.lerp(out, a, d, t);\n  } else if (type === 2) {\n    vec3.hermite(out, a, b, c, d, t);\n  } else if (type === 3) {\n    vec3.bezier(out, a, b, c, d, t);\n  }\n\n  return out;\n}\n\n/**\n * @param {quat} out\n * @param {quat} a\n * @param {quat} b\n * @param {quat} c\n * @param {quat} d\n * @param {number} t\n * @param {number} type\n * @return {out}\n */\nexport function interpolateQuaternion(out, a, b, c, d, t, type) {\n  if (type === 0) {\n    quat.copy(out, a);\n  } else if (type === 1) {\n    quat.slerp(out, a, d, t);\n  } else if (type === 2 || type === 3) {\n    quat.sqlerp(out, a, b, c, d, t);\n  }\n\n  return out;\n}\n","import {vec3, quat} from 'gl-matrix';\nimport createTypedSd from './sd';\n\n/**\n * An animation object.\n */\nexport default class AnimatedObject {\n  /**\n   * @param {Model} model\n   * @param {mdlx.AnimatedObject} object\n   */\n  constructor(model, object) {\n    /** @member {Model} */\n    this.model = model;\n    /** @member {Object<string, ScalarSd|Vector3Sd|Vector4Sd>} */\n    this.animations = {};\n\n    for (let animation of object.animations) {\n      this.animations[animation.name] = createTypedSd(model, animation);\n    }\n  }\n\n  /**\n   * @param {string} name\n   * @return {Array<number|vec3|quat>}\n   */\n  getValues(name) {\n    let animation = this.animations[name];\n\n    if (animation) {\n      return animation.getValues();\n    }\n\n    return [];\n  }\n\n  /**\n   * @param {Uint32Array} out\n   * @param {string} name\n   * @param {ModelInstance} instance\n   * @param {number} defaultValue\n   * @return {number}\n   */\n  getUintValue(out, name, instance, defaultValue) {\n    let animation = this.animations[name];\n\n    if (animation) {\n      return animation.getValue(out, instance);\n    }\n\n    out[0] = defaultValue;\n    return -1;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {string} name\n   * @param {ModelInstance} instance\n   * @param {number} defaultValue\n   * @return {number}\n   */\n  getFloatValue(out, name, instance, defaultValue) {\n    let animation = this.animations[name];\n\n    if (animation) {\n      return animation.getValue(out, instance);\n    }\n\n    out[0] = defaultValue;\n    return -1;\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {string} name\n   * @param {ModelInstance} instance\n   * @param {vec3} defaultValue\n   * @return {number}\n   */\n  getVector3Value(out, name, instance, defaultValue) {\n    let animation = this.animations[name];\n\n    if (animation) {\n      return animation.getValue(out, instance);\n    }\n\n    vec3.copy(out, defaultValue);\n    return -1;\n  }\n\n  /**\n   * @param {quat} out\n   * @param {string} name\n   * @param {ModelInstance} instance\n   * @param {quat} defaultValue\n   * @return {number}\n   */\n  getVector4Value(out, name, instance, defaultValue) {\n    let animation = this.animations[name];\n\n    if (animation) {\n      return animation.getValue(out, instance);\n    }\n\n    quat.copy(out, defaultValue);\n    return -1;\n  }\n\n  /**\n   * @param {string} name\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isVariant(name, sequence) {\n    let animation = this.animations[name];\n\n    if (animation) {\n      return animation.isVariant(sequence);\n    }\n\n    return false;\n  }\n}\n","import {VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT} from '../../../common/gl-matrix-addon';\nimport AnimatedObject from './animatedobject';\n\n/**\n * An MDX texture animation.\n */\nexport default class TextureAnimation extends AnimatedObject {\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getTranslation(out, instance) {\n    return this.getVector3Value(out, 'KTAT', instance, VEC3_ZERO);\n  }\n\n  /**\n   * @param {quat} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getRotation(out, instance) {\n    return this.getVector4Value(out, 'KTAR', instance, QUAT_DEFAULT);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getScale(out, instance) {\n    return this.getVector3Value(out, 'KTAS', instance, VEC3_ONE);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isTranslationVariant(sequence) {\n    return this.isVariant('KTAT', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isRotationVariant(sequence) {\n    return this.isVariant('KTAR', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isScaleVariant(sequence) {\n    return this.isVariant('KTAS', sequence);\n  }\n}\n","/**\n * Returns an array that only contains unique values found in the source array.\n *\n * @param {array} a\n * @return {array}\n */\nexport default function unique(a) {\n  return a.reverse().filter((e, i, arr) => {\n    return arr.indexOf(e, i + 1) === -1;\n  }).reverse();\n}\n","/**\n * @param {number} filterMode\n * @param {WebGLContext} gl\n * @return {Array<number>}\n */\nexport function layerFilterMode(filterMode, gl) {\n  if (filterMode === 2) {\n    return [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA]; // Blend\n  } else if (filterMode === 3) {\n    return [gl.ONE, gl.ONE]; // Additive\n  } else if (filterMode === 4) {\n    return [gl.SRC_ALPHA, gl.ONE]; // Add alpha\n  } else if (filterMode === 5) {\n    return [gl.ZERO, gl.SRC_COLOR]; // Modulate\n  } else if (filterMode === 6) {\n    return [gl.DST_COLOR, gl.SRC_COLOR]; // Modulate 2x\n  }\n\n  return [0, 0];\n}\n\n/**\n * @param {number} filterMode\n * @param {WebGLContext} gl\n * @return {Array<number>}\n */\nexport function emitterFilterMode(filterMode, gl) {\n  if (filterMode === 0) {\n    return [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA]; // Blend\n  } else if (filterMode === 1) {\n    return [gl.SRC_ALPHA, gl.ONE]; // Add alpha\n  } else if (filterMode === 2) {\n    return [gl.ZERO, gl.SRC_COLOR]; // Modulate\n  } else if (filterMode === 3) {\n    return [gl.DEST_COLOR, gl.SRC_COLOR]; // Modulate 2x\n  } else if (filterMode === 4) {\n    return [gl.SRC_ALPHA, gl.ONE]; // Add alpha\n  }\n}\n","import {vec3, quat} from 'gl-matrix';\nimport {VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT} from '../../../common/gl-matrix-addon';\nimport stringHash from '../../../common/stringhash';\nimport unique from '../../../common/arrayunique';\nimport AnimatedObject from './animatedobject';\nimport {layerFilterMode} from './filtermode';\n\n/**\n * An MDX layer.\n */\nexport default class Layer extends AnimatedObject {\n  /**\n   * @param {Model} model\n   * @param {ModelViewer.parser.mdlx.Layer} layer\n   * @param {number} layerId\n   * @param {number} priorityPlane\n   */\n  constructor(model, layer, layerId, priorityPlane) {\n    let filterMode = layer.filterMode;\n    let textureAnimationId = layer.textureAnimationId;\n    let gl = model.viewer.gl;\n\n    super(model, layer);\n\n    this.index = layerId;\n    this.priorityPlane = priorityPlane;\n    this.filterMode = filterMode;\n    this.textureId = layer.textureId;\n    this.coordId = layer.coordId;\n    this.alpha = layer.alpha;\n\n    let flags = layer.flags;\n\n    this.unshaded = flags & 0x1;\n    this.sphereEnvironmentMap = flags & 0x2;\n    this.twoSided = flags & 0x10;\n    this.unfogged = flags & 0x20;\n    this.noDepthTest = flags & 0x40;\n    this.noDepthSet = flags & 0x80;\n\n    this.depthMaskValue = (filterMode === 0 || filterMode === 1) ? 1 : 0;\n    this.alphaTestValue = (filterMode === 1) ? 1 : 0;\n\n    this.blendSrc = 0;\n    this.blendDst = 0;\n    this.blended = (filterMode > 1) ? true : false;\n\n    if (this.blended) {\n      [this.blendSrc, this.blendDst] = layerFilterMode(filterMode, gl);\n    }\n\n    this.uvDivisor = new Float32Array([1, 1]);\n\n    if (textureAnimationId !== -1) {\n      let textureAnimation = model.textureAnimations[textureAnimationId];\n\n      if (textureAnimation) {\n        this.textureAnimation = textureAnimation;\n      }\n    }\n\n    let variants = {\n      alpha: [],\n      slot: [],\n      translation: [],\n      rotation: [],\n      scale: [],\n    };\n\n    let hasSlotAnim = false;\n    let hasTranslationAnim = false;\n    let hasRotationAnim = false;\n    let hasScaleAnim = false;\n\n    for (let i = 0, l = model.sequences.length; i < l; i++) {\n      let alpha = this.isAlphaVariant(i);\n      let slot = this.isTextureIdVariant(i);\n      let translation = this.isTranslationVariant(i);\n      let rotation = this.isRotationVariant(i);\n      let scale = this.isScaleVariant(i);\n\n      variants.alpha[i] = alpha;\n      variants.slot[i] = slot;\n      variants.translation[i] = translation;\n      variants.rotation[i] = rotation;\n      variants.scale[i] = scale;\n\n      hasSlotAnim = hasSlotAnim || slot;\n      hasTranslationAnim = hasTranslationAnim || translation;\n      hasRotationAnim = hasRotationAnim || rotation;\n      hasScaleAnim = hasScaleAnim || scale;\n    }\n\n    this.variants = variants;\n    this.hasSlotAnim = hasSlotAnim;\n    this.hasTranslationAnim = hasTranslationAnim;\n    this.hasRotationAnim = hasRotationAnim;\n    this.hasScaleAnim = hasScaleAnim;\n\n    // Handle sprite animations\n    if (this.animations.KMTF) {\n      // Get all unique texture IDs used by this layer\n      let textureIds = unique(this.animations.KMTF.getValues());\n\n      if (textureIds.length > 1) {\n        let hash = stringHash(textureIds.join(''));\n        let textures = [];\n\n        // Grab all of the textures\n        for (let i = 0, l = textureIds.length; i < l; i++) {\n          textures[i] = model.textures[textureIds[i]];\n        }\n\n        let atlas = model.viewer.loadTextureAtlas(hash, textures);\n\n        atlas.texture.whenLoaded()\n          .then(() => {\n            let texture = atlas.texture;\n\n            texture.wrapS = true;\n            texture.wrapT = true;\n\n            model.textures.push(texture);\n\n            this.textureId = model.textures.length - 1;\n            this.uvDivisor.set([atlas.columns, atlas.rows]);\n          });\n      }\n    }\n  }\n\n  /**\n   * @param {ShaderProgram} shader\n   */\n  bind(shader) {\n    let gl = this.model.viewer.gl;\n\n    gl.uniform1f(shader.uniforms.u_alphaTest, this.alphaTestValue);\n    // gl.uniform1f(shader.uniforms.u_unshaded, this.unshaded);\n\n    if (this.blended) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(this.blendSrc, this.blendDst);\n    } else {\n      gl.disable(gl.BLEND);\n    }\n\n    if (this.twoSided) {\n      gl.disable(gl.CULL_FACE);\n    } else {\n      gl.enable(gl.CULL_FACE);\n    }\n\n    if (this.noDepthTest) {\n      gl.disable(gl.DEPTH_TEST);\n    } else {\n      gl.enable(gl.DEPTH_TEST);\n    }\n\n    if (this.noDepthSet) {\n      gl.depthMask(0);\n    } else {\n      gl.depthMask(this.depthMaskValue);\n    }\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAlpha(out, instance) {\n    return this.getFloatValue(out, 'KMTA', instance, this.alpha);\n  }\n\n  /**\n   * @param {Uint32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getTextureId(out, instance) {\n    /// TODO: map the returned slot to a texture atlas slot if one exists.\n    return this.getUintValue(out, 'KMTF', instance, this.textureId);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getTranslation(out, instance) {\n    if (this.textureAnimation) {\n      return this.textureAnimation.getTranslation(out, instance);\n    }\n\n    vec3.copy(out, VEC3_ZERO);\n    return -1;\n  }\n\n  /**\n   * @param {quat} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getRotation(out, instance) {\n    if (this.textureAnimation) {\n      return this.textureAnimation.getRotation(out, instance);\n    }\n\n    quat.copy(out, QUAT_DEFAULT);\n    return -1;\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getScale(out, instance) {\n    if (this.textureAnimation) {\n      return this.textureAnimation.getScale(out, instance);\n    }\n\n    vec3.copy(out, VEC3_ONE);\n    return -1;\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isAlphaVariant(sequence) {\n    return this.isVariant('KMTA', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isTextureIdVariant(sequence) {\n    return this.isVariant('KMTF', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isTranslationVariant(sequence) {\n    return this.textureAnimation && this.textureAnimation.isTranslationVariant(sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isRotationVariant(sequence) {\n    return this.textureAnimation && this.textureAnimation.isRotationVariant(sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isScaleVariant(sequence) {\n    return this.textureAnimation && this.textureAnimation.isScaleVariant(sequence);\n  }\n}\n","import AnimatedObject from './animatedobject';\n\n/**\n * A geoset animation.\n */\nexport default class GeosetAnimation extends AnimatedObject {\n  /**\n   * @param {MdxModel} model\n   * @param {MdxParserGeosetAnimation} geosetAnimation\n   */\n  constructor(model, geosetAnimation) {\n    super(model, geosetAnimation);\n\n    this.alpha = geosetAnimation.alpha;\n    this.color = [...geosetAnimation.color].reverse(); // Stored as RGB, but animated colors are stored as BGR, so sizzle.\n    this.geosetId = geosetAnimation.geosetId;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAlpha(out, instance) {\n    // I don't quite understand how the static alpha is used. Weird rules.\n    // For now hardcode it to 1 if there is no animation.\n    return this.getFloatValue(out, 'KGAO', instance, 1);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {vec3}\n   */\n  getColor(out, instance) {\n    return this.getVector3Value(out, 'KGAC', instance, this.color);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isAlphaVariant(sequence) {\n    return this.isVariant('KGAO', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isColorVariant(sequence) {\n    return this.isVariant('KGAC', sequence);\n  }\n}\n","import {vec3} from 'gl-matrix';\nimport {VEC3_ONE} from '../../../common/gl-matrix-addon';\n\n/**\n * A shallow geoset.\n */\nexport class ShallowGeoset {\n  /**\n   * @param {MdxModel} model\n   * @param {Array<number>} offsets\n   * @param {number} uvSetSize\n   * @param {Uint16Array} elements\n   */\n  constructor(model, offsets, uvSetSize, elements) {\n    this.model = model;\n    this.offsets = offsets;\n    this.uvSetSize = uvSetSize;\n    this.elements = elements;\n  }\n\n  /**\n   * @param {ShaderProgram} shader\n   * @param {number} coordId\n   */\n  bind(shader, coordId) {\n    let gl = this.model.viewer.gl;\n    let offsets = this.offsets;\n    let attribs = shader.attribs;\n\n    gl.vertexAttribPointer(attribs.a_position, 3, gl.FLOAT, false, 12, offsets[0]);\n    gl.vertexAttribPointer(attribs.a_normal, 3, gl.FLOAT, false, 12, offsets[1]);\n    gl.vertexAttribPointer(attribs.a_uv, 2, gl.FLOAT, false, 8, offsets[2] + coordId * this.uvSetSize);\n    gl.vertexAttribPointer(attribs.a_bones, 4, gl.UNSIGNED_BYTE, false, 4, offsets[3]);\n    gl.vertexAttribPointer(attribs.a_boneNumber, 1, gl.UNSIGNED_BYTE, false, 4, offsets[4]);\n  }\n\n  /**\n   * @param {number} instances\n   */\n  render(instances) {\n    let gl = this.model.viewer.gl;\n\n    gl.extensions.instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, this.elements, gl.UNSIGNED_SHORT, this.offsets[5], instances);\n  }\n}\n\n/**\n * A geoset.\n */\nexport class Geoset {\n  /**\n   * @param {MdxModel} model\n   * @param {MdxParserGeoset} geoset\n   * @param {number} index\n   */\n  constructor(model, geoset, index) {\n    let positions = geoset.vertices;\n    let normals = geoset.normals;\n    let textureCoordinateSets = geoset.uvSets;\n    let uvsetSize = textureCoordinateSets[0].length;\n    let vertices = positions.length / 3;\n    let uvs;\n    let boneIndices = new Uint8Array(vertices * 4);\n    // A note for the future, since I keep coming back to this.\n    // The reason bone numbers are stored as 32 bits instead of 8 are because of offset rules.\n    // WebGL complains if the bind() method of ShallowGeoset above uses offset 1 instead of 4, even if the shader gets one float.\n    // Why? heck if I know.\n    // I don't see the alignment issues, but WebGL does.\n    let boneNumbers = new Uint32Array(vertices);\n    let vertexGroups = geoset.vertexGroups;\n    let matrixGroups = geoset.matrixGroups;\n    let matrixIndices = geoset.matrixIndices;\n    let slices = [];\n\n    // Make one typed array for the texture coordinates, in case there are multiple ones\n    if (textureCoordinateSets.length > 1) {\n      uvs = new Float32Array(textureCoordinateSets.length * uvsetSize);\n\n      for (let i = 0, l = textureCoordinateSets.length; i < l; i++) {\n        uvs.set(textureCoordinateSets[i], i * uvsetSize);\n      }\n    } else {\n      uvs = textureCoordinateSets[0];\n    }\n\n    // Parse the bone indices by slicing the matrix groups\n    for (let i = 0, l = matrixGroups.length, k = 0; i < l; i++) {\n      slices.push(matrixIndices.subarray(k, k + matrixGroups[i]));\n      k += matrixGroups[i];\n    }\n\n    // Construct the final bone arrays\n    for (let i = 0; i < vertices; i++) {\n      let slice = slices[vertexGroups[i]];\n\n      // Somehow in some bad models a vertex group index refers to an invalid matrix group.\n      // Such models are still loaded by the game.\n      if (slice) {\n        let bones = slices[vertexGroups[i]];\n        let boneCount = Math.min(bones.length, 4); // The viewer supports up to 4 bones per vertex, the game handles any(?) amount.\n\n        for (let j = 0; j < boneCount; j++) {\n          // 1 is added to every index for shader optimization (index 0 is a zero matrix)\n          boneIndices[i * 4 + j] = bones[j] + 1;\n        }\n\n        boneNumbers[i] = boneCount;\n      }\n    }\n\n    this.index = index;\n    this.materialId = geoset.materialId;\n    this.locationArray = positions;\n    this.normalArray = normals;\n    this.uvsArray = uvs;\n    this.boneIndexArray = boneIndices;\n    this.boneNumberArray = boneNumbers;\n    this.faceArray = geoset.faces;\n    this.uvSetSize = uvsetSize * 4;\n\n    let geosetAnimations = model.geosetAnimations;\n\n    for (let i = 0, l = geosetAnimations.length; i < l; i++) {\n      if (geosetAnimations[i].geosetId === index) {\n        this.geosetAnimation = geosetAnimations[i];\n      }\n    }\n\n    let variants = {\n      alpha: [],\n      color: [],\n    };\n\n    let hasAnim = false;\n\n    for (let i = 0, l = model.sequences.length; i < l; i++) {\n      let alpha = this.isAlphaVariant(i);\n      let color = this.isColorVariant(i);\n\n      if (alpha || color) {\n        hasAnim = true;\n      }\n\n      variants.alpha[i] = alpha;\n      variants.color[i] = color;\n    }\n\n    this.variants = variants;\n    this.hasAnim = hasAnim;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAlpha(out, instance) {\n    if (this.geosetAnimation) {\n      return this.geosetAnimation.getAlpha(out, instance);\n    }\n\n    out[0] = 1;\n    return -1;\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getColor(out, instance) {\n    if (this.geosetAnimation) {\n      return this.geosetAnimation.getColor(out, instance);\n    }\n\n    vec3.copy(out, VEC3_ONE);\n    return -1;\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isAlphaVariant(sequence) {\n    return this.geosetAnimation && this.geosetAnimation.isAlphaVariant(sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isColorVariant(sequence) {\n    return this.geosetAnimation && this.geosetAnimation.isColorVariant(sequence);\n  }\n}\n","/**\n * An MDX batch.\n */\nexport default class Batch {\n  /**\n   * @param {number} index\n   * @param {Layer} layer\n   * @param {Geoset} geoset\n   */\n  constructor(index, layer, geoset) {\n    /** @member {number} */\n    this.index = index;\n    /** @member {Layer} */\n    this.layer = layer;\n    /** @member {Geoset} */\n    this.geoset = geoset;\n  }\n}\n","export default {\n  1: 'TeamColor/TeamColor00',\n  2: 'TeamGlow/TeamGlow00',\n  11: 'Cliff/Cliff0',\n  21: '', // Used by all cursor models (HumanCursor, OrcCursor, UndeadCursor, NightElfCursor)\n  31: 'LordaeronTree/LordaeronSummerTree',\n  32: 'AshenvaleTree/AshenTree',\n  33: 'BarrensTree/BarrensTree',\n  34: 'NorthrendTree/NorthTree',\n  35: 'Mushroom/MushroomTree',\n  36: 'RuinsTree/RuinsTree',\n  37: 'OutlandMushroomTree/MushroomTree',\n};\n","import {vec3} from 'gl-matrix';\nimport {VEC3_ZERO, VEC3_ONE, QUAT_DEFAULT} from '../../../common/gl-matrix-addon';\nimport AnimatedObject from './animatedobject';\n\n/**\n * An MDX generic object.\n */\nexport default class GenericObject extends AnimatedObject {\n  /**\n   * @param {handlers.mdl.Model} model\n   * @param {parsers.mdlx.GenericObject} object\n   * @param {number} index\n   */\n  constructor(model, object, index) {\n    super(model, object);\n\n    this.index = index;\n    this.name = object.name;\n    this.objectId = object.objectId;\n    this.parentId = object.parentId;\n    this.pivot = model.pivotPoints[object.objectId] || vec3.create();\n\n    let flags = object.flags;\n\n    this.dontInheritTranslation = flags & 0x1;\n    this.dontInheritRotation = flags & 0x2;\n    this.dontInheritScaling = flags & 0x4;\n    this.billboarded = flags & 0x8;\n    this.billboardedX = flags & 0x10;\n    this.billboardedY = flags & 0x20;\n    this.billboardedZ = flags & 0x40;\n    this.cameraAnchored = flags & 0x80;\n    this.bone = flags & 0x100;\n    this.light = flags & 0x200;\n    this.eventObject = flags & 0x400;\n    this.attachment = flags & 0x800;\n    this.particleEmitter = flags & 0x1000;\n    this.collisionShape = flags & 0x2000;\n    this.ribbonEmitter = flags & 0x4000;\n    this.emitterUsesMdlOrUnshaded = flags & 0x8000;\n    this.emitterUsesTgaOrSortPrimitivesFarZ = flags & 0x10000;\n    this.lineEmitter = flags & 0x20000;\n    this.unfogged = flags & 0x40000;\n    this.modelSpace = flags & 0x80000;\n    this.xYQuad = flags & 0x100000;\n\n    this.anyBillboarding = this.billboarded || this.billboardedX || this.billboardedY || this.billboardedZ;\n\n    if (object.objectId === object.parentId) {\n      this.parentId = -1;\n    }\n\n    let variants = {\n      translation: [],\n      rotation: [],\n      scale: [],\n      generic: [],\n    };\n\n    for (let i = 0, l = model.sequences.length; i < l; i++) {\n      let translation = this.isTranslationVariant(i);\n      let rotation = this.isRotationVariant(i);\n      let scale = this.isScaleVariant(i);\n\n      variants.translation[i] = translation;\n      variants.rotation[i] = rotation;\n      variants.scale[i] = scale;\n      variants.generic[i] = translation || rotation || scale;\n    }\n\n    this.variants = variants;\n  }\n\n  /**\n   * Many of the generic objects have animated visibilities.\n   * This is a generic getter to allow the code to be consistent.\n   *\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVisibility(out, instance) {\n    out[0] = 1;\n    return -1;\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getTranslation(out, instance) {\n    return this.getVector3Value(out, 'KGTR', instance, VEC3_ZERO);\n  }\n\n  /**\n   * @param {quat} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getRotation(out, instance) {\n    return this.getVector4Value(out, 'KGRT', instance, QUAT_DEFAULT);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getScale(out, instance) {\n    return this.getVector3Value(out, 'KGSC', instance, VEC3_ONE);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isTranslationVariant(sequence) {\n    return this.isVariant('KGTR', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isRotationVariant(sequence) {\n    return this.isVariant('KGRT', sequence);\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isScaleVariant(sequence) {\n    return this.isVariant('KGSC', sequence);\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX bone.\n */\nexport default class Bone extends GenericObject {\n  /**\n   * @param {ModelViewer.viewer.Model} model\n   * @param {ModelViewer.parsers.mdx.Bone} bone\n   * @param {number} index\n   */\n  constructor(model, bone, index) {\n    super(model, bone, index);\n\n    this.geosetAnimation = model.geosetAnimations[bone.geosetAnimationId];\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVisibility(out, instance) {\n    if (this.geosetAnimation) {\n      return this.geosetAnimation.getAlpha(out, instance);\n    }\n\n    out[0] = 1;\n    return -1;\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX light.\n */\nexport default class Light extends GenericObject {\n  /**\n   * @param {Model} model\n   * @param {Light} light\n   * @param {number} index\n   */\n  constructor(model, light, index) {\n    super(model, light, index);\n\n    this.type = light.type;\n    this.attenuation = light.attenuation;\n    this.color = light.color;\n    this.intensity = light.intensity;\n    this.ambientColor = light.ambientColor;\n    this.ambientIntensity = light.ambientIntensity;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAttenuationStart(out, instance) {\n    return this.getFloatValue(out, 'KLAS', instance, this.attenuation[0]);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAttenuationEnd(out, instance) {\n    return this.getFloatValue(out, 'KLAE', instance, this.attenuation[1]);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getIntensity(out, instance) {\n    return this.getFloatValue(out, 'KLAI', instance, this.intensity);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getColor(out, instance) {\n    return this.getVector3Value(out, 'KLAC', instance, this.color);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAmbientIntensity(out, instance) {\n    return this.getFloatValue(out, 'KLBI', instance, this.ambientIntensity);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAmbientColor(out, instance) {\n    return this.getVector3Value(out, 'KLBC', instance, this.ambientColor);\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX helper.\n */\nexport default class Helper extends GenericObject {}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX attachment.\n */\nexport default class Attachment extends GenericObject {\n  /**\n   * @param {Model} model\n   * @param {mdlx.Attachment} attachment\n   * @param {number} index\n   */\n  constructor(model, attachment, index) {\n    super(model, attachment, index);\n\n    let path = attachment.path.replace(/\\\\/g, '/').toLowerCase().replace('.mdl', '.mdx');\n\n    this.path = path;\n    this.attachmentId = attachment.attachmentId;\n\n    // Second condition is against custom resources using arbitrary paths...\n    if (path !== '' && path.indexOf('.mdx') !== -1) {\n      this.internalModel = model.viewer.load(path, model.pathSolver);\n    }\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVisibility(out, instance) {\n    return this.getFloatValue(out, 'KATV', instance, 1);\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX particle emitter.\n */\nexport default class ParticleEmitter extends GenericObject {\n  /**\n   * @param {MdxModel} model\n   * @param {MdxParserParticleEmitter} emitter\n   * @param {number} index\n   */\n  constructor(model, emitter, index) {\n    super(model, emitter, index);\n\n    this.internalResource = model.viewer.load(emitter.path.replace(/\\\\/g, '/').toLowerCase().replace('.mdl', '.mdx'), model.pathSolver);\n    this.speed = emitter.speed;\n    this.latitude = emitter.latitude;\n    this.longitude = emitter.longitude;\n    this.lifeSpan = emitter.lifeSpan;\n    this.gravity = emitter.gravity;\n    this.emissionRate = emitter.emissionRate;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getSpeed(out, instance) {\n    return this.getFloatValue(out, 'KPES', instance, this.speed);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getLatitude(out, instance) {\n    return this.getFloatValue(out, 'KPLTV', instance, this.latitude);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getLongitude(out, instance) {\n    return this.getFloatValue(out, 'KPLN', instance, this.longitude);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getLifeSpan(out, instance) {\n    return this.getFloatValue(out, 'KPEL', instance, this.lifeSpan);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getGravity(out, instance) {\n    return this.getFloatValue(out, 'KPEG', instance, this.gravity);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getEmissionRate(out, instance) {\n    return this.getFloatValue(out, 'KPEE', instance, this.emissionRate);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVisibility(out, instance) {\n    return this.getFloatValue(out, 'KPEV', instance, 1);\n  }\n}\n","import GenericObject from './genericobject';\nimport {emitterFilterMode} from './filtermode';\nimport replaceableIds from './replaceableids';\n\n/**\n * An MDX particle emitter type 2.\n */\nexport default class ParticleEmitter2 extends GenericObject {\n  /**\n   * @param {MdxModel} model\n   * @param {MdxParserParticleEmitter2} emitter\n   * @param {number} index\n   */\n  constructor(model, emitter, index) {\n    super(model, emitter, index);\n\n    this.width = emitter.width;\n    this.length = emitter.length;\n    this.speed = emitter.speed;\n    this.latitude = emitter.latitude;\n    this.gravity = emitter.gravity;\n    this.emissionRate = emitter.emissionRate;\n    this.squirt = emitter.squirt;\n    this.lifeSpan = emitter.lifeSpan;\n    this.variation = emitter.variation;\n    this.tailLength = emitter.tailLength;\n    this.timeMiddle = emitter.timeMiddle;\n\n    let replaceableId = emitter.replaceableId;\n\n    this.dimensions = [emitter.columns, emitter.rows];\n\n    this.teamColored = false;\n\n    if (replaceableId === 0) {\n      this.internalResource = model.textures[emitter.textureId];\n    } else if (replaceableId === 1) {\n      this.internalResource = model.viewer.getTextureAtlas('teamColors');\n      this.dimensions.fill(4);\n      this.teamColored = true;\n    } else if (replaceableId === 2) {\n      this.internalResource = model.viewer.getTextureAtlas('teamGlows');\n      this.dimensions.fill(4);\n      this.teamColored = true;\n    } else {\n      this.internalResource = model.viewer.load('ReplaceableTextures\\\\' + replaceableIds[replaceableId] + '.blp', model.pathSolver);\n    }\n\n    this.replaceableId = emitter.replaceableId;\n\n    let headOrTail = emitter.headOrTail;\n\n    this.head = (headOrTail === 0 || headOrTail === 2);\n    this.tail = (headOrTail === 1 || headOrTail === 2);\n\n    this.cellWidth = 1 / emitter.columns;\n    this.cellHeight = 1 / emitter.rows;\n    this.colors = [];\n\n    let colors = emitter.segmentColors;\n    let alpha = emitter.segmentAlphas;\n\n    for (let i = 0; i < 3; i++) {\n      this.colors[i] = new Uint8Array([Math.min(colors[i][0], 1) * 255, Math.min(colors[i][1], 1) * 255, Math.min(colors[i][2], 1) * 255, alpha[i]]);\n    }\n\n    this.scaling = emitter.segmentScaling;\n\n    this.intervals = [...emitter.headIntervals, ...emitter.tailIntervals];\n\n    this.lineEmitter = emitter.flags & 0x20000;\n    this.modelSpace = emitter.flags & 0x80000;\n    this.xYQuad = emitter.flags & 0x100000;\n\n    [this.blendSrc, this.blendDst] = emitterFilterMode(emitter.filterMode, this.model.viewer.gl);\n\n    this.priorityPlane = emitter.priorityPlane;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getWidth(out, instance) {\n    return this.getFloatValue(out, 'KP2W', instance, this.width);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getLength(out, instance) {\n    return this.getFloatValue(out, 'KP2N', instance, this.length);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getSpeed(out, instance) {\n    return this.getFloatValue(out, 'KP2S', instance, this.speed);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getLatitude(out, instance) {\n    return this.getFloatValue(out, 'KP2L', instance, this.latitude);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getGravity(out, instance) {\n    return this.getFloatValue(out, 'KP2G', instance, this.gravity);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getEmissionRate(out, instance) {\n    return this.getFloatValue(out, 'KP2E', instance, this.emissionRate);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVisibility(out, instance) {\n    return this.getFloatValue(out, 'KP2V', instance, 1);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVariation(out, instance) {\n    return this.getFloatValue(out, 'KP2R', instance, this.variation);\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * An MDX ribbon emitter.\n */\nexport default class RibbonEmitter extends GenericObject {\n  /**\n   * @param {MdxModel} model\n   * @param {MdxParserParticleEmitter} emitter\n   * @param {number} index\n   */\n  constructor(model, emitter, index) {\n    super(model, emitter, index);\n\n    this.layer = model.materials[emitter.materialId][0];\n    this.texture = model.textures[this.layer.textureId];\n\n    this.heightAbove = emitter.heightAbove;\n    this.heightBelow = emitter.heightBelow;\n    this.alpha = emitter.alpha;\n    this.color = emitter.color;\n    this.lifeSpan = emitter.lifeSpan;\n    this.textureSlot = emitter.textureSlot;\n    this.emissionRate = emitter.emissionRate;\n    this.gravity = emitter.gravity;\n\n    this.dimensions = [emitter.columns, emitter.rows];\n    this.cellWidth = 1 / emitter.columns;\n    this.cellHeight = 1 / emitter.rows;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getHeightBelow(out, instance) {\n    return this.getFloatValue(out, 'KRHB', instance, this.heightBelow);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getHeightAbove(out, instance) {\n    return this.getFloatValue(out, 'KRHA', instance, this.heightAbove);\n  }\n\n  /**\n   * @param {Uint32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getTextureSlot(out, instance) {\n    return this.getUintValue(out, 'KRTX', instance, 0);\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getColor(out, instance) {\n    return this.getVector3Value(out, 'KRCO', instance, this.color);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getAlpha(out, instance) {\n    return this.getFloatValue(out, 'KRAL', instance, this.alpha);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getVisibility(out, instance) {\n    return this.getFloatValue(out, 'KRVS', instance, 1);\n  }\n}\n","import GenericObject from './genericobject';\nimport {vec3} from 'gl-matrix';\n\nconst zero = vec3.create();\n\n/**\n * An MDX camera.\n */\nexport default class Camera extends GenericObject {\n  /**\n   * @param {ModelViewer.viewer.handlers.mdx.Model} model\n   * @param {ModelViewer.parsers.mdlx.Camera} camera\n   * @param {number} index\n   */\n  constructor(model, camera, index) {\n    super(model, camera, index);\n\n    this.name = camera.name;\n    this.position = camera.position;\n    this.fieldOfView = camera.fieldOfView;\n    this.farClippingPlane = camera.farClippingPlane;\n    this.nearClippingPlane = camera.nearClippingPlane;\n    this.targetPosition = camera.targetPosition;\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getPositionTranslation(out, instance) {\n    const res = this.getVector3Value(out, 'KCTR', instance, zero);\n    vec3.add(out, out, this.position);\n    return res;\n  }\n\n  /**\n   * @param {vec3} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getTargetTranslation(out, instance) {\n    const res = this.getVector3Value(out, 'KTTR', instance, zero);\n    vec3.add(out, out, this.targetPosition);\n    return res;\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @param {ModelInstance} instance\n   * @return {number}\n   */\n  getRotation(out, instance) {\n    return this.getFloatValue(out, 'KCRL', instance, 0);\n  }\n}\n","import SlkFile from '../parsers/slk/file';\nimport IniFile from '../parsers/ini/file';\n\n/**\n * A structure that holds mapped data from INI and SLK files.\n * In the case of SLK files, the first row is expected to hold the names of the columns.\n */\nexport default class MappedData {\n  /**\n   * @param {?string} buffer\n   */\n  constructor(buffer) {\n    /** @member {Object<string, Object<string, string>>} */\n    this.map = {};\n  \n    this.load(buffer);\n    \n  }\n  load(buffer){\n    if (buffer) {\n\n      if (buffer instanceof ArrayBuffer) {\n        const decoder = new TextDecoder('utf-8');\n        let uint8Array = new Uint8Array(buffer);\n\n        this.loadText(decoder.decode(uint8Array));\n      }\n      else {\n        this.loadText(buffer);\n      }\n    }\n  }\n\n  /**\n   * Load data from an SLK file or an INI file.\n   * Note that this may override previous properties!\n   *\n   * @param {string} buffer\n   */\n  loadText(buffer) {\n    if (buffer.startsWith('ID;')) {\n      let file = new SlkFile(buffer);\n      let rows = file.rows;\n      let header = rows[0];\n      let map = this.map;\n\n      for (let i = 1, l = rows.length; i < l; i++) {\n        let row = rows[i];\n        let name = row[0];\n\n        if (name) {\n          name = name.toLowerCase();\n\n          if (!map[name]) {\n            map[name] = {};\n          }\n\n          let mapped = map[name];\n\n          for (let j = 0, k = header.length; j < k; j++) {\n            let key = header[j];\n\n            // UnitBalance.slk doesn't define the name of one row.\n            if (key === undefined) {\n              key = `column${j}`;\n            }\n\n            mapped[key] = row[j];\n          }\n        }\n      }\n    } else {\n      let file = new IniFile(buffer);\n      let sections = file.sections;\n      let map = this.map;\n\n      for (let [row, properties] of sections.entries()) {\n        if (!map[row]) {\n          map[row] = {};\n        }\n\n        let mapped = map[row];\n\n        for (let [name, property] of properties) {\n          mapped[name] = property;\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {string} key\n   * @return {?Object<string, string>}\n   */\n  getRow(key) {\n    return this.map[key.toLowerCase()];\n  }\n\n  /**\n   * @param {string} key\n   * @param {string} name\n   * @return {?string}\n   */\n  getProperty(key, name) {\n    return this.map[key.toLowerCase()][name];\n  }\n\n  /**\n   * @param {string} key\n   * @param {Object} values\n   */\n  setRow(key, values) {\n    this.map[key.toLowerCase()] = values;\n  }\n}\n","let audioContext = new OfflineAudioContext(1, 1, 48000);\n\n/**\n * A context-less decodeAudioData().\n *\n * @param {ArrayBuffer} buffer\n * @return {Promise}\n */\nexport function decodeAudioData(buffer) {\n  return audioContext.decodeAudioData(buffer);\n}\n","import {vec2} from 'gl-matrix';\nimport MappedData from '../../../utils/mappeddata';\nimport {decodeAudioData} from '../../../common/audio';\nimport GenericObject from './genericobject';\nimport {emitterFilterMode} from './filtermode';\nimport { whenLoaded } from 'mdx/utils/promise';\n\nlet mappedDataCallback = (text) => new MappedData(text);\nlet decodedDataCallback = (arrayBuffer) => decodeAudioData(arrayBuffer);\n\n/**\n * An event object.\n */\nexport default class EventObject extends GenericObject {\n  /**\n   * @param {MdxModel} model\n   * @param {MdxParserEventObjectEmitter} eventObject\n   * @param {number} index\n   */\n  constructor(model, eventObject, index) {\n    super(model, eventObject, index);\n\n    let viewer = model.viewer;\n    let name = eventObject.name;\n    let type = name.substring(0, 3);\n    let id = name.substring(4);\n\n    // Same thing\n    if (type === 'FPT') {\n      type = 'SPL';\n    }\n\n    this.ok = false;\n    this.type = type;\n    this.id = id;\n\n    this.internalResource = null;\n\n    // For SND\n    this.decodedBuffers = [];\n\n    this.tracks = eventObject.tracks;\n    this.ok = false;\n    this.globalSequence = null;\n    this.defval = vec2.create();\n\n    let globalSequenceId = eventObject.globalSequenceId;\n    if (globalSequenceId !== -1) {\n      this.globalSequence = model.globalSequences[globalSequenceId];\n    }\n\n    let tables = [];\n    let pathSolver = model.pathSolver;\n\n    if (type === 'SPN') {\n      tables[0] = viewer.loadGeneric(pathSolver('Splats\\\\SpawnData.slk')[0], 'text', mappedDataCallback);\n    } else if (type === 'SPL') {\n      tables[0] = viewer.loadGeneric(pathSolver('Splats\\\\SplatData.slk')[0], 'text', mappedDataCallback);\n    } else if (type === 'UBR') {\n      tables[0] = viewer.loadGeneric(pathSolver('Splats\\\\UberSplatData.slk')[0], 'text', mappedDataCallback);\n    } else if (type === 'SND') {\n      tables[0] = viewer.loadGeneric(pathSolver('UI\\\\SoundInfo\\\\AnimLookups.slk')[0], 'text', mappedDataCallback);\n      tables[1] = viewer.loadGeneric(pathSolver('UI\\\\SoundInfo\\\\AnimSounds.slk')[0], 'text', mappedDataCallback);\n    } else {\n      // Units\\Critters\\BlackStagMale\\BlackStagMale.mdx has an event object named \"Point01\".\n      return;\n    }\n\n    let promise = viewer.promise();\n    whenLoaded(tables)\n      .then((tables) => {\n        this.load(tables);\n        promise.resolve();\n      });\n  }\n\n  /**\n   * @param {Array<SlkFile>} tables\n   */\n  load(tables) {\n    if (!tables[0].ok) {\n      return;\n    }\n\n    let type = this.type;\n    let model = this.model;\n    let viewer = model.viewer;\n    let pathSolver = model.pathSolver;\n    let row = tables[0].data.getRow(this.id);\n\n    if (row) {\n      if (type === 'SPN') {\n        this.internalResource = viewer.load(row.Model.replace('.mdl', '.mdx'), pathSolver);\n      } else if (type === 'SPL' || type === 'UBR') {\n        this.internalResource = viewer.load('replaceabletextures/splats/' + row.file + '.blp', pathSolver);\n        this.colors = [[row.StartR, row.StartG, row.StartB, row.StartA], [row.MiddleR, row.MiddleG, row.MiddleB, row.MiddleA], [row.EndR, row.EndG, row.EndB, row.EndA]];\n        this.scale = row.Scale;\n\n        if (type === 'SPL') {\n          this.dimensions = [row.Columns, row.Rows];\n          this.intervals = [[row.UVLifespanStart, row.UVLifespanEnd, row.LifespanRepeat], [row.UVDecayStart, row.UVDecayEnd, row.DecayRepeat]];\n          this.intervalTimes = [row.Lifespan, row.Decay];\n          this.lifespan = row.Lifespan + row.Decay;\n        } else {\n          this.dimensions = [1, 1];\n          this.intervalTimes = [row.BirthTime, row.PauseTime, row.Decay];\n          this.lifespan = row.BirthTime + row.PauseTime + row.Decay;\n        }\n\n        [this.blendSrc, this.blendDst] = emitterFilterMode(row.BlendMode, viewer.gl);\n      } else if (type === 'SND') {\n        // Only load sounds if audio is enabled.\n        // This is mostly to save on bandwidth and loading time, especially when loading full maps.\n        if (viewer.enableAudio) {\n          if (!tables[1].ok) {\n            return;\n          }\n\n          row = tables[1].data.getRow(row.SoundLabel);\n\n          if (row) {\n            this.distanceCutoff = row.DistanceCutoff;\n            this.maxDistance = row.MaxDistance;\n            this.minDistance = row.MinDistance;\n            this.pitch = row.Pitch;\n            this.pitchVariance = row.PitchVariance;\n            this.volume = row.Volume;\n\n            let fileNames = row.FileNames.split(',');\n\n            whenLoaded(fileNames.map((fileName) => viewer.loadGeneric(pathSolver(row.DirectoryBase + fileName)[0], 'arrayBuffer', decodedDataCallback)))\n              .then((resources) => {\n                for (let resource of resources) {\n                  this.decodedBuffers.push(resource.data);\n                }\n\n                this.ok = true;\n              });\n          }\n        }\n      }\n\n      if (this.internalResource) {\n        this.internalResource.whenLoaded()\n          .then(() => this.ok = true);\n      }\n    } else {\n      console.warn('Unknown event object ID', type, this.id);\n    }\n  }\n\n  getValue(out, instance) {\n    if (this.globalSequence) {\n      let globalSequence = this.globalSequence;\n\n      return this.getValueAtTime(out, instance.counter % globalSequence, 0, globalSequence);\n    } else if (instance.sequence !== -1) {\n      let interval = this.model.sequences[instance.sequence].interval;\n\n      return this.getValueAtTime(out, instance.frame, interval[0], interval[1]);\n    } else {\n      let defval = this.defval;\n\n      out[0] = defval[0];\n      out[1] = defval[1];\n\n      return out;\n    }\n  }\n\n  getValueAtTime(out, frame, start, end) {\n    let tracks = this.tracks;\n\n    if (frame < start || frame > end) {\n      out[0] = 0;\n      out[1] = 0;\n      return out;\n    }\n\n    for (let i = tracks.length - 1; i > -1; i--) {\n      if (tracks[i] < start) {\n        out[0] = 0;\n        out[1] = i;\n        return out;\n      } else if (tracks[i] <= frame) {\n        out[0] = 1;\n        out[1] = i;\n        return out;\n      }\n    }\n\n    out[0] = 0;\n    out[1] = 0;\n    return out;\n  }\n}\n","import GenericObject from './genericobject';\n\n/**\n * A collision shape.\n */\nexport default class CollisionShape extends GenericObject {}\n","import {extentToSphere} from '../../../common/bounds';\nimport Parser from '../../../parsers/mdlx/model';\nimport TexturedModel from '../../texturedmodel';\nimport TextureAnimation from './textureanimation';\nimport Layer from './layer';\nimport GeosetAnimation from './geosetanimation';\nimport {Geoset} from './geoset';\nimport Batch from './batch';\nimport {ShallowGeoset} from './geoset';\nimport replaceableIds from './replaceableids';\nimport Bone from './bone';\nimport Light from './light';\nimport Helper from './helper';\nimport Attachment from './attachment';\nimport ParticleEmitter from './modelparticleemitter';\nimport ParticleEmitter2 from './modelparticleemitter2';\nimport RibbonEmitter from './modelribbonemitter';\nimport Camera from './camera';\nimport EventObject from './modeleventobject';\nimport CollisionShape from './collisionshape';\n/**\n * An MDX model.\n */\nexport default class Model extends TexturedModel {\n  /**\n   * @param {Object} resourceData\n   */\n  constructor(resourceData) {\n    super(resourceData);\n\n    this.parser = null;\n    this.name = '';\n    this.extent = null;\n    this.bounds = null;\n    this.sequences = [];\n    this.globalSequences = [];\n    this.materials = [];\n    this.layers = [];\n    this.textures = [];\n    this.textureAnimations = [];\n    this.geosets = [];\n    this.geosetAnimations = [];\n    this.bones = [];\n    this.lights = [];\n    this.helpers = [];\n    this.attachments = [];\n    this.pivotPoints = [];\n    this.particleEmitters = [];\n    this.particleEmitters2 = [];\n    this.ribbonEmitters = [];\n    this.cameras = [];\n    this.eventObjects = [];\n    this.collisionShapes = [];\n\n    this.hasLayerAnims = false;\n    this.hasGeosetAnims = false;\n    this.batches = [];\n    this.opaqueBatches = [];\n    this.translucentBatches = [];\n\n    this.genericObjects = [];\n    this.sortedGenericObjects = [];\n    this.hierarchy = [];\n    this.replaceables = [];\n  }\n\n  /**\n   * @param {ArrayBuffer|string} buffer\n   */\n  load(buffer) {\n    // Parsing\n    let parser = new Parser();\n\n    parser.load(buffer);\n\n    this.parser = parser;\n\n    // Model\n    this.name = parser.name;\n\n    // Make a bounding sphere from the model extent.\n    let extent = parser.extent;\n    this.bounds = extentToSphere(extent.min, extent.max);\n    this.extent = extent;\n\n    // Sequences\n    for (let sequence of parser.sequences) {\n      this.sequences.push(sequence);\n    }\n\n    // Global sequences\n    for (let globalSequence of parser.globalSequences) {\n      this.globalSequences.push(globalSequence);\n    }\n\n    let usingTeamTextures = false;\n\n    // Textures\n    for (let texture of parser.textures) {\n      let path = texture.path;\n      let replaceableId = texture.replaceableId;\n      let flags = texture.flags;\n\n      if (replaceableId !== 0) {\n        path = `ReplaceableTextures\\\\${replaceableIds[replaceableId]}.blp`;\n\n        if (replaceableId === 1 || replaceableId === 2) {\n          usingTeamTextures = true;\n        }\n      }\n\n      // If the path is corrupted, try to fix it.\n      if (!path.endsWith('.blp') && !path.endsWith('.tga')) {\n        // Try to search for .blp\n        let index = path.indexOf('.blp');\n\n        if (index === -1) {\n          // Not a .blp, try to search for .tga\n          index = path.indexOf('.tga');\n        }\n\n        if (index !== -1) {\n          // Hopefully fix the path\n          path = path.slice(0, index + 4);\n        }\n      }\n\n      this.replaceables.push(replaceableId);\n\n      let textureRes = this.viewer.load(path, this.pathSolver);\n\n      textureRes.wrapS = !!(flags & 0x1);\n      textureRes.wrapT = !!(flags & 0x2);\n\n      this.textures.push(textureRes);\n    }\n\n    if (usingTeamTextures) {\n      // Start loading the team color and glow textures.\n      this.loadTeamTextures();\n    }\n\n    // Texture animations\n    for (let textureAnimation of parser.textureAnimations) {\n      this.textureAnimations.push(new TextureAnimation(this, textureAnimation));\n    }\n\n    // Materials\n    let layerId = 0;\n    for (let material of parser.materials) {\n      let vMaterial = [];\n\n      for (let layer of material.layers) {\n        let vLayer = new Layer(this, layer, layerId++, material.priorityPlane);\n\n        vMaterial.push(vLayer);\n        this.layers.push(vLayer);\n\n        if (vLayer.hasAnim) {\n          this.hasLayerAnims = true;\n        }\n      }\n\n      this.materials.push(vMaterial);\n    }\n\n    // Geoset animations\n    for (let geosetAnimation of parser.geosetAnimations) {\n      this.geosetAnimations.push(new GeosetAnimation(this, geosetAnimation));\n    }\n\n    // Geosets\n    if (parser.geosets.length) {\n      let geosetId = 0;\n      let batchId = 0;\n      let opaqueBatches = [];\n      let translucentBatches = [];\n\n      for (let geoset of parser.geosets) {\n        let vGeoset = new Geoset(this, geoset, geosetId++);\n\n        if (vGeoset.hasAnim) {\n          this.hasGeosetAnims = true;\n        }\n\n        this.geosets.push(vGeoset);\n\n        // Batches\n        for (let vLayer of this.materials[geoset.materialId]) {\n          let batch = new Batch(batchId++, vLayer, vGeoset);\n\n          if (vLayer.filterMode < 2) {\n            opaqueBatches.push(batch);\n          } else {\n            translucentBatches.push(batch);\n          }\n        }\n      }\n\n      // / TODO: I don't remember if this is actually needed, are the layers ever not sorted?\n      translucentBatches.sort((a, b) => a.layer.priorityPlane - b.layer.priorityPlane);\n\n      this.opaqueBatches.push(...opaqueBatches);\n      this.translucentBatches.push(...translucentBatches);\n      this.batches.push(...opaqueBatches, ...translucentBatches);\n\n      this.setupGeosets();\n    }\n\n    this.pivotPoints = parser.pivotPoints;\n\n    // Tracks the IDs of all generic objects.\n    let objectId = 0;\n\n    // Bones\n    for (let bone of parser.bones) {\n      this.bones.push(new Bone(this, bone, objectId++));\n    }\n\n    // Lights\n    for (let light of parser.lights) {\n      this.lights.push(new Light(this, light, objectId++));\n    }\n\n    // Helpers\n    for (let helper of parser.helpers) {\n      this.helpers.push(new Helper(this, helper, objectId++));\n    }\n\n    // Attachments\n    for (let attachment of parser.attachments) {\n      this.attachments.push(new Attachment(this, attachment, objectId++));\n    }\n\n    // Particle emitters\n    for (let particleEmitter of parser.particleEmitters) {\n      this.particleEmitters.push(new ParticleEmitter(this, particleEmitter, objectId++));\n    }\n\n    // Particle emitters 2\n    for (let particleEmitter2 of parser.particleEmitters2) {\n      this.particleEmitters2.push(new ParticleEmitter2(this, particleEmitter2, objectId++));\n    }\n\n    // E.g. Wisp\n    this.particleEmitters2.sort((a, b) => a.priorityPlane - b.priorityPlane);\n\n\n    // Ribbon emitters\n    for (let ribbonEmitter of parser.ribbonEmitters) {\n      this.ribbonEmitters.push(new RibbonEmitter(this, ribbonEmitter, objectId++));\n    }\n\n    // Cameras\n    for (let camera of parser.cameras) {\n      this.cameras.push(new Camera(this, camera, objectId++));\n    }\n\n    // Event objects\n    for (let eventObject of parser.eventObjects) {\n      this.eventObjects.push(new EventObject(this, eventObject, objectId++));\n    }\n\n    // Collision shapes\n    for (let collisionShape of parser.collisionShapes) {\n      this.collisionShapes.push(new CollisionShape(this, collisionShape, objectId++));\n    }\n\n    // One array for all generic objects.\n    this.genericObjects.push(...this.bones, ...this.lights, ...this.helpers, ...this.attachments, ...this.particleEmitters, ...this.particleEmitters2, ...this.ribbonEmitters, ...this.cameras, ...this.eventObjects, ...this.collisionShapes);\n\n    // Creates the sorted indices array of the generic objects.\n    this.setupHierarchy(-1);\n\n    // Keep a sorted array.\n    for (let i = 0, l = this.genericObjects.length; i < l; i++) {\n      this.sortedGenericObjects[i] = this.genericObjects[this.hierarchy[i]];\n    }\n\n    // Checks what sequences are variant or not.\n    this.setupVariants();\n\n    // this.calculateExtent();\n  }\n\n  /**\n   *\n   */\n  loadTeamTextures() {\n    let viewer = this.viewer;\n\n    if (!viewer.getTextureAtlas('teamColors')) {\n      let pathSolver = this.pathSolver;\n      let teamColors = [];\n      let teamGlows = [];\n\n      for (let i = 0; i < 15; i++) {\n        let id = ('' + i).padStart(2, '0');\n\n        teamColors[i] = viewer.load(`ReplaceableTextures\\\\TeamColor\\\\TeamColor${id}.blp`, pathSolver);\n        teamGlows[i] = viewer.load(`ReplaceableTextures\\\\TeamGlow\\\\TeamGlow${id}.blp`, pathSolver);\n      }\n\n      viewer.loadTextureAtlas('teamColors', teamColors);\n      viewer.loadTextureAtlas('teamGlows', teamGlows);\n    }\n  }\n\n  /**\n   * @param {number} sequence\n   * @return {boolean}\n   */\n  isVariant(sequence) {\n    let genericObjects = this.genericObjects;\n\n    for (let i = 0, l = genericObjects.length; i < l; i++) {\n      if (genericObjects[i].variants.generic[sequence]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   *\n   */\n  setupVariants() {\n    let variants = [];\n\n    for (let i = 0, l = this.sequences.length; i < l; i++) {\n      variants[i] = this.isVariant(i);\n    }\n\n    this.variants = variants;\n  }\n\n  /**\n   *\n   */\n  setupGeosets() {\n    let geosets = this.geosets;\n\n    if (geosets.length > 0) {\n      let gl = this.viewer.gl;\n      let shallowGeosets = [];\n      let typedArrays = [];\n      let totalArrayOffset = 0;\n      let elementTypedArrays = [];\n      let totalElementOffset = 0;\n\n      for (let i = 0, l = geosets.length; i < l; i++) {\n        let geoset = geosets[i];\n        let vertices = geoset.locationArray;\n        let normals = geoset.normalArray;\n        let uvSets = geoset.uvsArray;\n        let boneIndices = geoset.boneIndexArray;\n        let boneNumbers = geoset.boneNumberArray;\n        let faces = geoset.faceArray;\n        let verticesOffset = totalArrayOffset;\n        let normalsOffset = verticesOffset + vertices.byteLength;\n        let uvSetsOffset = normalsOffset + normals.byteLength;\n        let boneIndicesOffset = uvSetsOffset + uvSets.byteLength;\n        let boneNumbersOffset = boneIndicesOffset + boneIndices.byteLength;\n\n        shallowGeosets[i] = new ShallowGeoset(this, [verticesOffset, normalsOffset, uvSetsOffset, boneIndicesOffset, boneNumbersOffset, totalElementOffset], geoset.uvSetSize, faces.length);\n\n        typedArrays.push([verticesOffset, vertices]);\n        typedArrays.push([normalsOffset, normals]);\n        typedArrays.push([uvSetsOffset, uvSets]);\n        typedArrays.push([boneIndicesOffset, boneIndices]);\n        typedArrays.push([boneNumbersOffset, boneNumbers]);\n\n        elementTypedArrays.push([totalElementOffset, faces]);\n\n        totalArrayOffset = boneNumbersOffset + boneNumbers.byteLength;\n        totalElementOffset += faces.byteLength;\n      }\n\n      let arrayBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, arrayBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, totalArrayOffset, gl.STATIC_DRAW);\n\n      for (let i = 0, l = typedArrays.length; i < l; i++) {\n        gl.bufferSubData(gl.ARRAY_BUFFER, typedArrays[i][0], typedArrays[i][1]);\n      }\n\n      let faceBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, totalElementOffset, gl.STATIC_DRAW);\n\n      for (let i = 0, l = elementTypedArrays.length; i < l; i++) {\n        gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, elementTypedArrays[i][0], elementTypedArrays[i][1]);\n      }\n\n      this.__webglArrayBuffer = arrayBuffer;\n      this.__webglElementBuffer = faceBuffer;\n      this.shallowGeosets = shallowGeosets;\n    }\n  }\n\n  /**\n   * @param {number} parent\n   */\n  setupHierarchy(parent) {\n    for (let i = 0, l = this.genericObjects.length; i < l; i++) {\n      let object = this.genericObjects[i];\n\n      if (object.parentId === parent) {\n        this.hierarchy.push(i);\n\n        this.setupHierarchy(object.objectId);\n      }\n    }\n  }\n\n  /**\n   * @param {Bucket} bucket\n   * @param {Scene} scene\n   */\n  bind(bucket, scene) {\n    const webgl = this.viewer.webgl;\n    let gl = this.viewer.gl;\n\n    // HACK UNTIL I IMPLEMENT MULTIPLE SHADERS AGAIN\n\n    let shader = this.viewer.shaderMap.get('MdxStandardShader');\n    webgl.useShaderProgram(shader);\n    this.shader = shader;\n\n    const instancedArrays = gl.extensions.instancedArrays;\n    const attribs = shader.attribs;\n    const uniforms = shader.uniforms;\n\n    gl.uniformMatrix4fv(uniforms.u_mvp, false, scene.camera.worldProjectionMatrix);\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.__webglElementBuffer);\n\n    gl.uniform1i(uniforms.u_texture, 0);\n\n\n    // Team and vertex colors.\n    let teamColor = attribs.a_teamColor;\n    let vertexColor = attribs.a_vertexColor;\n    gl.bindBuffer(gl.ARRAY_BUFFER, bucket.colorBuffer);\n    gl.vertexAttribPointer(teamColor, 1, gl.UNSIGNED_BYTE, false, 5, 0);\n    gl.vertexAttribPointer(vertexColor, 4, gl.UNSIGNED_BYTE, true, 5, 1); // normalize the colors from [0, 255] to [0, 1] here instead of in the pixel shader\n\n    gl.activeTexture(gl.TEXTURE15);\n    gl.bindTexture(gl.TEXTURE_2D, bucket.boneTexture);\n    gl.uniform1i(uniforms.u_boneMap, 15);\n    gl.uniform1f(uniforms.u_vectorSize, bucket.vectorSize);\n    gl.uniform1f(uniforms.u_rowSize, bucket.rowSize);\n\n    let instanceId = attribs.a_InstanceID;\n    gl.bindBuffer(gl.ARRAY_BUFFER, bucket.instanceIdBuffer);\n    gl.vertexAttribPointer(instanceId, 1, gl.UNSIGNED_SHORT, false, 0, 0);\n\n    instancedArrays.vertexAttribDivisorANGLE(teamColor, 1);\n    instancedArrays.vertexAttribDivisorANGLE(vertexColor, 1);\n    instancedArrays.vertexAttribDivisorANGLE(instanceId, 1);\n  }\n\n  /**\n   *\n   */\n  unbind() {\n    let gl = this.viewer.gl;\n    let instancedArrays = gl.extensions.instancedArrays;\n    let attribs = this.shader.attribs;\n\n    // Reset gl values to default, to play nice with other handlers\n    gl.depthMask(1);\n    gl.disable(gl.BLEND);\n    gl.enable(gl.CULL_FACE);\n    gl.enable(gl.DEPTH_TEST);\n\n    // Reset the attributes to play nice with other handlers\n    instancedArrays.vertexAttribDivisorANGLE(attribs.a_teamColor, 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs.a_vertexColor, 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs.a_InstanceID, 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs.a_geosetColor, 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs.a_layerAlpha, 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs.uvTransRot, 0);\n    instancedArrays.vertexAttribDivisorANGLE(attribs.uvScaleSprite, 0);\n  }\n\n  /**\n   * @param {Bucket} bucket\n   * @param {Batch} batch\n   */\n  renderBatch(bucket, batch) {\n    let gl = this.viewer.gl;\n    let instancedArrays = gl.extensions.instancedArrays;\n    let shader = this.shader;\n    let attribs = this.shader.attribs;\n    let uniforms = shader.uniforms;\n    let geoset = batch.geoset;\n    let layer = batch.layer;\n    let shallowGeoset = this.shallowGeosets[geoset.index];\n    let replaceable = this.replaceables[layer.textureId];\n\n    layer.bind(shader);\n\n    let texture;\n    let isTeamColor = false;\n\n    if (replaceable === 1) {\n      texture = this.viewer.getTextureAtlas('teamColors');\n      isTeamColor = true;\n    } else if (replaceable === 2) {\n      texture = this.viewer.getTextureAtlas('teamGlows');\n      isTeamColor = true;\n    } else {\n      texture = this.textures[layer.textureId];\n    }\n\n    gl.uniform1f(uniforms.u_isTeamColor, isTeamColor);\n    gl.uniform1f(uniforms.u_hasSlotAnim, layer.hasSlotAnim);\n    gl.uniform1f(uniforms.u_hasTranslationAnim, layer.hasTranslationAnim);\n    gl.uniform1f(uniforms.u_hasRotationAnim, layer.hasRotationAnim);\n    gl.uniform1f(uniforms.u_hasScaleAnim, layer.hasScaleAnim);\n\n    // Texture coordinate divisor\n    // Used for layers that use image animations, in order to scale the coordinates to match the generated texture atlas\n    gl.uniform2f(uniforms.u_uvScale, 1 / layer.uvDivisor[0], 1 / layer.uvDivisor[1]);\n\n    this.bindTexture(texture, 0, bucket.modelView);\n\n    let geosetColor = attribs.a_geosetColor;\n    let uvTransRot = attribs.a_uvTransRot;\n    let uvScaleSprite = attribs.a_uvScaleSprite;\n    let layerAlpha = attribs.a_layerAlpha;\n\n    instancedArrays.vertexAttribDivisorANGLE(geosetColor, 1);\n    instancedArrays.vertexAttribDivisorANGLE(uvTransRot, 1);\n    instancedArrays.vertexAttribDivisorANGLE(uvScaleSprite, 1);\n    instancedArrays.vertexAttribDivisorANGLE(layerAlpha, 1);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, bucket.geosetColorsBuffer);\n    // Geoset colors.\n    gl.vertexAttribPointer(geosetColor, 4, gl.UNSIGNED_BYTE, true, 4, this.batchSize * geoset.index * 4);\n\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, bucket.layersBuffer);\n    // Texture animations.\n    gl.vertexAttribPointer(uvTransRot, 4, gl.FLOAT, false, 28, this.batchSize * 7 * layer.index * 4);\n    gl.vertexAttribPointer(uvScaleSprite, 3, gl.FLOAT, false, 28, this.batchSize * 7 * layer.index * 4 + 16);\n    // Layer alphas.\n    gl.vertexAttribPointer(layerAlpha, 1, gl.UNSIGNED_BYTE, true, 1, bucket.layerAlphasData.byteOffset + this.batchSize * layer.index);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.__webglArrayBuffer);\n    // Vertices.\n    shallowGeoset.bind(shader, layer.coordId);\n\n    shallowGeoset.render(bucket.count);\n  }\n\n  /**\n   * @param {Bucket} bucket\n   * @param {Scene} scene\n   * @param {Array<Batch>} batches\n   */\n  renderBatches(bucket, scene, batches) {\n    if (batches && batches.length) {\n      this.bind(bucket, scene);\n\n      for (let i = 0, l = batches.length; i < l; i++) {\n        this.renderBatch(bucket, batches[i]);\n      }\n\n      this.unbind();\n    }\n  }\n\n  /**\n   * Render the opaque things in the given scene data.\n   *\n   * @param {Object} data\n   */\n  renderOpaque(data) {\n    let scene = data.scene;\n    let buckets = data.buckets;\n\n    for (let i = 0, l = data.usedBuckets; i < l; i++) {\n      this.renderBatches(buckets[i], scene, this.opaqueBatches);\n    }\n  }\n\n  /**\n   * Render the translucent things in the given scene data.\n   *\n   * @param {Object} data\n   */\n  renderTranslucent(data) {\n    let scene = data.scene;\n    let modelView = data.modelView;\n    let buckets = data.buckets;\n    let particleEmitters2 = data.particleEmitters2;\n    let ribbonEmitters = data.ribbonEmitters;\n    let eventObjectEmitters = data.eventObjectEmitters;\n\n    // Batches\n    for (let i = 0, l = data.usedBuckets; i < l; i++) {\n      this.renderBatches(buckets[i], scene, this.translucentBatches);\n    }\n\n    // Emitters\n    if (particleEmitters2.length || eventObjectEmitters.length || ribbonEmitters.length) {\n      let webgl = this.viewer.webgl;\n      let gl = this.viewer.gl;\n\n      gl.depthMask(0);\n      gl.enable(gl.BLEND);\n      gl.disable(gl.CULL_FACE);\n      gl.enable(gl.DEPTH_TEST);\n\n      let shader = this.viewer.shaderMap.get('MdxParticleShader');\n      webgl.useShaderProgram(shader);\n\n      gl.uniformMatrix4fv(shader.uniforms.u_mvp, false, scene.camera.worldProjectionMatrix);\n\n      gl.uniform1i(shader.uniforms.u_texture, 0);\n\n      gl.uniform1f(shader.uniforms.u_isRibbonEmitter, false);\n\n      for (let i = 0, l = particleEmitters2.length; i < l; i++) {\n        particleEmitters2[i].render(modelView, shader);\n      }\n\n      for (let i = 0, l = eventObjectEmitters.length; i < l; i++) {\n        eventObjectEmitters[i].render(modelView, shader);\n      }\n\n      gl.uniform1f(shader.uniforms.u_isRibbonEmitter, true);\n\n      for (let i = 0, l = ribbonEmitters.length; i < l; i++) {\n        ribbonEmitters[i].render(modelView, shader);\n      }\n    }\n  }\n}\n","/**\n * Returns an array that only contains unique values found in the source array.\n *\n * @param {Float32Array} min\n * @param {Float32Array} max\n * @return {Object}\n */\nexport function extentToSphere(min, max) {\n  let minx = min[0];\n  let miny = min[1];\n  let minz = min[2];\n  let maxx = max[0];\n  let maxy = max[1];\n  let maxz = max[2];\n  let dx = maxx - minx;\n  let dy = maxy - miny;\n  let dz = maxz - minz;\n\n  return {\n    center: new Float32Array([(minx + maxx) / 2, (miny + maxy) / 2, (minz + maxz) / 2]),\n    radius: Math.sqrt(dx * dx + dy * dy + dz * dz) / 2,\n  };\n}\n","/**\n * A shared emitter.\n * The base class of all MDX emitters.\n */\nexport default class SharedEmitter {\n  /**\n   * @param {ParticleEmitter|ParticleEmitter2|RibbonEmitter|EventObject} modelObject\n   */\n  constructor(modelObject) {\n    /** @member {ParticleEmitter|ParticleEmitter2|RibbonEmitter|EventObject} */\n    this.modelObject = modelObject;\n    /** @member {Array<Particle|Particle2|Ribbon|EventObjectSpn|EventObjectSpl|EventObjectUbr>} */\n    this.objects = [];\n    /** @member {number} */\n    this.alive = 0;\n  }\n\n  /**\n   * Note: flag is used for ParticleEmitter2's head/tail selection.\n   *\n   * @param {ParticleEmitterView|ParticleEmitter2View|RibbonEmitterView|EventObjectEmitterView} emitterView\n   * @param {boolean} flag\n   * @return {Particle|Particle2|Ribbon|EventObjectSpn|EventObjectSpl|EventObjectUbr}\n   */\n  emitObject(emitterView, flag) {\n    let objects = this.objects;\n\n    // If there are no unused objects, create a new one.\n    if (this.alive === objects.length) {\n      objects.push(this.createObject());\n    }\n\n    // Get the first unused object.\n    let object = objects[this.alive];\n\n    this.alive += 1;\n\n    object.reset(emitterView, flag);\n\n    return object;\n  }\n\n  /**\n   *\n   */\n  update() {\n    let objects = this.objects;\n\n    for (let i = 0; i < this.alive; i++) {\n      let object = objects[i];\n\n      object.update();\n\n      if (object.health <= 0) {\n        this.alive -= 1;\n\n        // Swap between this object and the first unused object.\n        // Decrement the iterator so the moved object is indexed.\n        if (i !== this.alive) {\n          objects[i] = objects[this.alive];\n          objects[this.alive] = object;\n          i -= 1;\n        }\n      }\n    }\n\n    this.updateData();\n  }\n\n  /**\n   * @param {ParticleEmitterView|ParticleEmitter2View|RibbonEmitterView|EventObjectEmitterView} emitterView\n   */\n  fill(emitterView) {\n    let emission = emitterView.currentEmission;\n\n    if (emission >= 1) {\n      for (let i = 0; i < emission; i += 1, emitterView.currentEmission--) {\n        this.emit(emitterView);\n      }\n    }\n  }\n\n  /**\n   *\n   */\n  updateData() {\n\n  }\n\n  /**\n   * @param {ModelView} modelView\n   * @param {ShaderProgram} shader\n   */\n  render(modelView, shader) {\n\n  }\n\n  /**\n   * Clear any emitted objects belonging to the given owner.\n   *\n   * @param {ModelInstance} owner\n   */\n  clear(owner) {\n    for (let object of this.objects) {\n      if (owner === object.emitterView.instance) {\n        object.health = 0;\n      }\n    }\n  }\n}\n","import {vec3, quat} from 'gl-matrix';\nimport {VEC3_UNIT_Z} from '../../../common/gl-matrix-addon';\nimport {randomInRange} from '../../../common/math';\n\n// Heap allocations needed for this module.\nlet rotationHeap = quat.create();\nlet velocityHeap = vec3.create();\nlet latitudeHeap = new Float32Array(1);\n// let longitudeHeap = new Float32Array(1);\nlet lifeSpanHeap = new Float32Array(1);\nlet gravityHeap = new Float32Array(1);\nlet speedHeap = new Float32Array(1);\n\n/**\n * A spawned model particle.\n */\nexport default class Particle {\n  /**\n   * @param {MdxParticleEmitter} emitter\n   */\n  constructor(emitter) {\n    this.emitter = emitter;\n    this.emitterView = null;\n\n    this.internalInstance = emitter.modelObject.internalResource.addInstance();\n    this.velocity = vec3.create();\n    this.gravity = 0;\n  }\n\n  /**\n   * @param {ParticleEmitterView} emitterView\n   */\n  reset(emitterView) {\n    let instance = emitterView.instance;\n    let node = instance.nodes[this.emitter.modelObject.index];\n    let internalInstance = this.internalInstance;\n    let scale = node.worldScale;\n    let velocity = this.velocity;\n\n    emitterView.getLatitude(latitudeHeap);\n    // emitterView.getLongitude(longitudeHeap);\n    emitterView.getLifeSpan(lifeSpanHeap);\n    emitterView.getGravity(gravityHeap);\n    emitterView.getSpeed(speedHeap);\n\n    this.emitterView = emitterView;\n    this.node = node;\n    this.health = lifeSpanHeap[0];\n    this.gravity = gravityHeap[0] * scale[2];\n\n    // Local rotation\n    quat.identity(rotationHeap);\n    quat.rotateZ(rotationHeap, rotationHeap, randomInRange(-Math.PI, Math.PI));\n    quat.rotateY(rotationHeap, rotationHeap, randomInRange(-latitudeHeap[0], latitudeHeap[0]));\n    vec3.transformQuat(velocity, VEC3_UNIT_Z, rotationHeap);\n\n    // World rotation\n    vec3.transformQuat(velocity, velocity, node.worldRotation);\n\n    // Apply speed\n    vec3.scale(velocity, velocity, speedHeap[0]);\n\n    // Apply the parent's scale\n    vec3.mul(velocity, velocity, scale);\n\n    instance.scene.addInstance(internalInstance);\n\n    internalInstance.setTransformation(node.worldLocation, quat.setAxisAngle(rotationHeap, VEC3_UNIT_Z, randomInRange(0, Math.PI * 2)), node.worldScale);\n    internalInstance.setSequence(0);\n    internalInstance.show();\n  }\n\n  /**\n   *\n   */\n  update() {\n    let internalInstance = this.internalInstance;\n    let velocity = this.velocity;\n    let frameTimeS = internalInstance.model.viewer.frameTime * 0.001;\n\n    internalInstance.paused = false;\n\n    this.health -= frameTimeS;\n\n    velocity[2] -= this.gravity * frameTimeS;\n\n    internalInstance.move(vec3.scale(velocityHeap, velocity, frameTimeS));\n\n    if (this.health <= 0) {\n      this.internalInstance.hide();\n    }\n  }\n}\n","import SharedEmitter from './sharedemitter';\nimport Particle from './particle';\n\n/**\n * An MDX particle emitter.\n */\nexport default class ParticleEmitter extends SharedEmitter {\n  /**\n   * @param {ParticleEmitterView} emitterView\n   */\n  emit(emitterView) {\n    this.emitObject(emitterView);\n  }\n\n  /**\n   * @return {Particle}\n   */\n  createObject() {\n    return new Particle(this);\n  }\n}\n","import {powerOfTwo} from '../../../common/math';\nimport SharedEmitter from './sharedemitter';\n\n/**\n * Shared structure used by all geometry emitters.\n */\nexport default class SharedGeometryEmitter extends SharedEmitter {\n  /**\n   * @param {ParticleEmitter2|RibbonEmitter|EventObjectSplEmitter|EventObjectUbrEmitter} modelObject\n   */\n  constructor(modelObject) {\n    super(modelObject);\n\n    this.data = new Float32Array(0);\n    this.buffer = modelObject.model.viewer.gl.createBuffer();\n    this.bufferSize = 0;\n  }\n\n  /**\n   * @param {ParticleEmitter2View|RibbonEmitterView|EventObjectEmitterView} emitterView\n   * @param {boolean} flag\n   * @return {Particle2|Ribbon|EventObjectSpl|EventObjectUbr}\n   */\n  emitObject(emitterView, flag) {\n    return super.emitObject(emitterView, flag);\n  }\n\n  /**\n   *\n   */\n  updateData() {\n    let objects = this.objects;\n    let alive = this.alive;\n    let sizeNeeded = alive * this.elementsPerEmit;\n\n    if (this.data.length < sizeNeeded) {\n      this.data = new Float32Array(powerOfTwo(sizeNeeded));\n\n      let gl = this.modelObject.model.viewer.gl;\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.data.byteLength, gl.DYNAMIC_DRAW);\n    }\n\n    let data = this.data;\n\n    for (let i = 0, offset = 0; i < alive; i += 1, offset += 30) {\n      let object = objects[i];\n      let vertices = object.vertices;\n      let lta = object.lta;\n      let lba = object.lba;\n      let rta = object.rta;\n      let rba = object.rba;\n      let rgb = object.rgb;\n\n      data[offset + 0] = vertices[0];\n      data[offset + 1] = vertices[1];\n      data[offset + 2] = vertices[2];\n      data[offset + 3] = lta;\n      data[offset + 4] = rgb;\n\n      data[offset + 5] = vertices[3];\n      data[offset + 6] = vertices[4];\n      data[offset + 7] = vertices[5];\n      data[offset + 8] = lba;\n      data[offset + 9] = rgb;\n\n      data[offset + 10] = vertices[6];\n      data[offset + 11] = vertices[7];\n      data[offset + 12] = vertices[8];\n      data[offset + 13] = rba;\n      data[offset + 14] = rgb;\n\n      data[offset + 15] = vertices[0];\n      data[offset + 16] = vertices[1];\n      data[offset + 17] = vertices[2];\n      data[offset + 18] = lta;\n      data[offset + 19] = rgb;\n\n      data[offset + 20] = vertices[6];\n      data[offset + 21] = vertices[7];\n      data[offset + 22] = vertices[8];\n      data[offset + 23] = rba;\n      data[offset + 24] = rgb;\n\n      data[offset + 25] = vertices[9];\n      data[offset + 26] = vertices[10];\n      data[offset + 27] = vertices[11];\n      data[offset + 28] = rta;\n      data[offset + 29] = rgb;\n    }\n  }\n\n  /**\n   * @param {ModelView} modelView\n   * @param {ShaderProgram} shader\n   */\n  render(modelView, shader) {\n    let modelObject = this.modelObject;\n    let alive = this.alive;\n\n    if (modelObject.internalResource && alive > 0) {\n      let model = modelObject.model;\n      let gl = model.viewer.gl;\n\n      gl.blendFunc(modelObject.blendSrc, modelObject.blendDst);\n\n      gl.uniform2fv(shader.uniforms.u_dimensions, modelObject.dimensions);\n\n      model.bindTexture(modelObject.internalResource, 0, modelView);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.data.subarray(0, alive * 30));\n\n      gl.vertexAttribPointer(shader.attribs.a_position, 3, gl.FLOAT, false, 20, 0);\n      gl.vertexAttribPointer(shader.attribs.a_uva_rgb, 2, gl.FLOAT, false, 20, 12);\n\n      gl.drawArrays(gl.TRIANGLES, 0, alive * 6);\n    }\n  }\n}\n","import {vec3, vec4, quat} from 'gl-matrix';\nimport {VEC3_UNIT_Z} from '../../../common/gl-matrix-addon';\nimport {degToRad, randomInRange, lerp} from '../../../common/math';\nimport {uint8ToUint24} from '../../../common/typecast';\n\n// Heap allocations needed for this module.\nlet rotationHeap = quat.create();\nlet locationHeap = vec3.create();\nlet colorHeap = new Uint8Array(4);\nlet widthHeap = new Float32Array(1);\nlet lengthHeap = new Float32Array(1);\nlet latitudeHeap = new Float32Array(1);\nlet variationHeap = new Float32Array(1);\nlet speedHeap = new Float32Array(1);\nlet gravityHeap = new Float32Array(1);\n// let mat3Heap = new Float32Array(9);\nlet vec3Heap = [vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n\n/**\n * A type 2 particle.\n */\nexport default class Particle2 {\n  /**\n   * @param {MdxParticle2Emitter} emitter\n   */\n  constructor(emitter) {\n    this.emitter = emitter;\n    this.emitterView = null;\n    this.health = 0;\n    this.head = true;\n    this.location = vec3.create();\n    this.velocity = vec3.create();\n    this.gravity = 0;\n    this.nodeScale = vec3.create();\n\n    this.vertices = new Float32Array(12);\n    this.lta = 0;\n    this.lba = 0;\n    this.rta = 0;\n    this.rba = 0;\n    this.rgb = 0;\n  }\n\n  /**\n   * @param {ParticleEmitter2View} emitterView\n   * @param {boolean} isHead\n   */\n  reset(emitterView, isHead) {\n    emitterView.getWidth(widthHeap);\n    emitterView.getLength(lengthHeap);\n    emitterView.getLatitude(latitudeHeap);\n    emitterView.getVariation(variationHeap);\n    emitterView.getSpeed(speedHeap);\n    emitterView.getGravity(gravityHeap);\n\n    let modelObject = this.emitter.modelObject;\n    let node = emitterView.instance.nodes[modelObject.index];\n    let pivot = node.pivot;\n    let scale = node.worldScale;\n    let width = widthHeap[0] * 0.5;\n    let length = lengthHeap[0] * 0.5;\n    let latitude = degToRad(latitudeHeap[0]);\n    let variation = variationHeap[0];\n    let speed = speedHeap[0];\n    let location = this.location;\n    let velocity = this.velocity;\n\n    this.emitterView = emitterView;\n    this.node = node;\n    this.health = modelObject.lifeSpan;\n    this.head = isHead;\n    this.gravity = gravityHeap[0] * scale[2];\n\n    vec3.copy(this.nodeScale, scale);\n\n    // Local location\n    location[0] = pivot[0] + randomInRange(-width, width);\n    location[1] = pivot[1] + randomInRange(-length, length);\n    location[2] = pivot[2];\n\n    // World location\n    if (!modelObject.modelSpace) {\n      vec3.transformMat4(location, location, node.worldMatrix);\n    }\n\n    // Local rotation\n    quat.identity(rotationHeap);\n    quat.rotateZ(rotationHeap, rotationHeap, Math.PI / 2);\n    quat.rotateY(rotationHeap, rotationHeap, randomInRange(-latitude, latitude));\n\n    // If this is not a line emitter, emit in a sphere rather than a circle.\n    if (!modelObject.lineEmitter) {\n      quat.rotateX(rotationHeap, rotationHeap, randomInRange(-latitude, latitude));\n    }\n\n    // World rotation\n    if (!modelObject.modelSpace) {\n      quat.mul(rotationHeap, node.worldRotation, rotationHeap);\n    }\n\n    // Apply the rotation\n    vec3.transformQuat(velocity, VEC3_UNIT_Z, rotationHeap);\n\n    // Apply speed\n    vec3.scale(velocity, velocity, speed + randomInRange(-variation, variation));\n\n    // Apply the parent's scale\n    vec3.mul(velocity, velocity, scale);\n  }\n\n  /**\n   *\n   */\n  update() {\n    let modelObject = this.emitter.modelObject;\n    let dt = modelObject.model.viewer.frameTime * 0.001;\n    let location = this.location;\n    let worldLocation = locationHeap;\n    let velocity = this.velocity;\n\n    this.health -= dt;\n\n    velocity[2] -= this.gravity * dt;\n\n    vec3.scaleAndAdd(location, location, velocity, dt);\n\n    vec3.copy(worldLocation, location);\n\n    let lifeFactor = (modelObject.lifeSpan - this.health) / modelObject.lifeSpan;\n    let timeMiddle = modelObject.timeMiddle;\n    let intervals = modelObject.intervals;\n    let factor;\n    let firstColor;\n    let head = this.head;\n    let interval;\n\n    if (lifeFactor < timeMiddle) {\n      factor = lifeFactor / timeMiddle;\n\n      firstColor = 0;\n\n      if (head) {\n        interval = intervals[0];\n      } else {\n        interval = intervals[2];\n      }\n    } else {\n      factor = (lifeFactor - timeMiddle) / (1 - timeMiddle);\n\n      firstColor = 1;\n\n      if (head) {\n        interval = intervals[1];\n      } else {\n        interval = intervals[3];\n      }\n    }\n\n    factor = Math.min(factor, 1);\n\n    let start = interval[0];\n    let end = interval[1];\n    let repeat = interval[2];\n    let scaling = modelObject.scaling;\n    let colors = modelObject.colors;\n    let scale = lerp(scaling[firstColor], scaling[firstColor + 1], factor);\n    let left;\n    let top;\n    let right;\n    let bottom;\n    let instance = this.emitterView.instance;\n\n    // If this is a team colored emitter, get the team color tile from the atlas.\n    // Otherwise do normal texture atlas handling.\n    if (modelObject.teamColored) {\n      let teamColor = instance.teamColor;\n\n      left = teamColor % 4;\n      top = (teamColor / 4) | 0;\n      right = left + 1;\n      bottom = top + 1;\n    } else {\n      let columns = modelObject.dimensions[0];\n      let index = 0;\n      let spriteCount = end - start;\n\n      if (spriteCount) {\n        // Repeating speeds up the sprite animation, which makes it effectively run N times in its interval.\n        // E.g. if repeat is 4, the sprite animation will be seen 4 times, and thus also run 4 times as fast.\n        index = start + Math.floor(spriteCount * repeat * factor) % spriteCount;\n      }\n\n      left = index % columns;\n      top = (index / columns) | 0;\n      right = left + 1;\n      bottom = top + 1;\n    }\n\n    vec4.lerp(colorHeap, colors[firstColor], colors[firstColor + 1], factor);\n\n    let a = colorHeap[3];\n\n    this.lta = uint8ToUint24(right, bottom, a);\n    this.lba = uint8ToUint24(left, bottom, a);\n    this.rta = uint8ToUint24(right, top, a);\n    this.rba = uint8ToUint24(left, top, a);\n    this.rgb = uint8ToUint24(colorHeap[0], colorHeap[1], colorHeap[2]);\n\n    if (!instance.scene) {\n      debugger;\n    }\n    let camera = instance.scene.camera;\n    let vectors;\n\n    // Choose between a default rectangle or billboarded one\n    if (modelObject.xYQuad) {\n      vectors = camera.vectors;\n    } else {\n      vectors = camera.billboardedVectors;\n    }\n\n    let vertices = this.vertices;\n    let nodeScale = this.nodeScale;\n\n    let scalex = scale * nodeScale[0];\n    let scaley = scale * nodeScale[1];\n    let scalez = scale * nodeScale[2];\n\n    if (head) {\n      // If this is a model space emitter, the particle location is in local space, so convert it now to world space.\n      if (modelObject.modelSpace) {\n        vec3.transformMat4(worldLocation, worldLocation, this.node.worldMatrix);\n      }\n\n      let px = worldLocation[0];\n      let py = worldLocation[1];\n      let pz = worldLocation[2];\n\n      if (modelObject.xYQuad) {\n        let vx = vec3Heap[4], vy = vec3Heap[5];\n        vx[0] = velocity[0];\n        vx[1] = velocity[1];\n        vx[2] = 0;\n        vec3.normalize(vx, vx);\n        vy[0] = -vx[1];\n        vy[1] = vx[0];\n        vy[2] = 0;\n        vec3.add(vec3Heap[2], vx, vy);\n        vec3.sub(vec3Heap[1], vy, vx);\n        vec3.negate(vec3Heap[0], vec3Heap[2]);\n        vec3.negate(vec3Heap[3], vec3Heap[1]);\n        vectors = vec3Heap;\n      }\n\n      let pv1 = vectors[0];\n      let pv2 = vectors[1];\n      let pv3 = vectors[2];\n      let pv4 = vectors[3];\n\n      vertices[0] = px + pv1[0] * scalex;\n      vertices[1] = py + pv1[1] * scaley;\n      vertices[2] = pz + pv1[2] * scalez;\n      vertices[3] = px + pv2[0] * scalex;\n      vertices[4] = py + pv2[1] * scaley;\n      vertices[5] = pz + pv2[2] * scalez;\n      vertices[6] = px + pv3[0] * scalex;\n      vertices[7] = py + pv3[1] * scaley;\n      vertices[8] = pz + pv3[2] * scalez;\n      vertices[9] = px + pv4[0] * scalex;\n      vertices[10] = py + pv4[1] * scaley;\n      vertices[11] = pz + pv4[2] * scalez;\n    } else {\n      let tailLength = modelObject.tailLength;\n      let offsetx = tailLength * velocity[0] * 1;\n      let offsety = tailLength * velocity[1] * 1;\n      let offsetz = tailLength * velocity[2] * 1;\n\n      // The start and end of the tail.\n      let start = [worldLocation[0] - offsetx, worldLocation[1] - offsety, worldLocation[2] - offsetz];\n      let end = [worldLocation[0], worldLocation[1], worldLocation[2]];\n\n      // If this is a model space emitter, the start and end are is in local space, so convert them to world space.\n      if (modelObject.modelSpace) {\n        vec3.transformMat4(start, start, this.node.worldMatrix);\n        vec3.transformMat4(end, end, this.node.worldMatrix);\n      }\n\n      let startx = start[0];\n      let starty = start[1];\n      let startz = start[2];\n      let endx = end[0];\n      let endy = end[1];\n      let endz = end[2];\n\n      // Get the normal to the tail in camera space.\n      // This allows to build a 2D rectangle around the 3D tail.\n      let tail = [endx - startx, endy - starty, endz - startz];\n      vec3.normalize(tail, tail);\n      let normal = vec3.cross([], camera.billboardedVectors[6], tail);\n      vec3.normalize(normal, normal);\n\n      let normalX = normal[0] * scalex;\n      let normalY = normal[1] * scaley;\n      let normalZ = normal[2] * scalez;\n\n      vertices[0] = startx - normalX;\n      vertices[1] = starty - normalY;\n      vertices[2] = startz - normalZ;\n\n      vertices[6] = endx + normalX;\n      vertices[7] = endy + normalY;\n      vertices[8] = endz + normalZ;\n\n      vertices[3] = endx - normalX;\n      vertices[4] = endy - normalY;\n      vertices[5] = endz - normalZ;\n\n      vertices[9] = startx + normalX;\n      vertices[10] = starty + normalY;\n      vertices[11] = startz + normalZ;\n    }\n  }\n}\n","import SharedGeometryEmitter from './sharedgeometryemitter';\nimport Particle2 from './particle2';\n\n/**\n * An MDX particle emitter type 2.\n */\nexport default class ParticleEmitter2 extends SharedGeometryEmitter {\n  /**\n   * @param {ParticleEmitter2} modelObject\n   */\n  constructor(modelObject) {\n    super(modelObject);\n\n    this.elementsPerEmit = ((modelObject.headOrTail === 2) ? 2 : 1) * 30;\n  }\n\n  /**\n   * @param {ParticleEmitter2View} emitterView\n   */\n  emit(emitterView) {\n    if (this.modelObject.head) {\n      this.emitObject(emitterView, true);\n    }\n\n    if (this.modelObject.tail) {\n      this.emitObject(emitterView, false);\n    }\n  }\n\n  /**\n   * @return {Particle2}\n   */\n  createObject() {\n    return new Particle2(this);\n  }\n}\n","import {vec3} from 'gl-matrix';\nimport {uint8ToUint24} from '../../../common/typecast';\n\n// Heap allocations needed for this module.\nlet belowHeap = vec3.create();\nlet aboveHeap = vec3.create();\nlet colorHeap = vec3.create();\nlet alphaHeap = new Float32Array(1);\nlet slotHeap = new Float32Array(1);\n\n/**\n * A ribbon.\n */\nexport default class Ribbon {\n  /**\n   * @param {MdxRibbonEmitter} emitter\n   */\n  constructor(emitter) {\n    this.emitter = emitter;\n    this.health = 0;\n    this.emitterView = null;\n\n    this.vertices = new Float32Array(12);\n    this.lta = 0;\n    this.lba = 0;\n    this.rta = 0;\n    this.rba = 0;\n    this.rgb = 0;\n  }\n\n  /**\n   * @param {RibbonEmitterView} emitterView\n   */\n  reset(emitterView) {\n    let emitter = this.emitter;\n    let vertices = this.vertices;\n\n    this.index = emitterView.currentRibbon++;\n\n    emitterView.ribbonCount++;\n\n    this.emitterView = emitterView;\n\n    this.health = emitter.modelObject.lifeSpan;\n\n    let lastEmit = emitterView.lastEmit;\n\n    // If this isn't the first ribbon, construct a quad.\n    // Otherwise, the vertices will be filled with zeroes, and the ribbon will not render.\n    // This allows the emitter to always work with quads, and therefore it can work with many views, because the ribbon chains are implicit.\n    if (lastEmit && lastEmit.health > 0) {\n      let node = emitterView.instance.nodes[emitter.modelObject.index];\n      let pivot = node.pivot;\n\n      emitterView.getHeightBelow(belowHeap);\n      emitterView.getHeightAbove(aboveHeap);\n\n      vec3.set(belowHeap, pivot[0], pivot[1] - belowHeap[0], pivot[2]);\n      vec3.transformMat4(belowHeap, belowHeap, node.worldMatrix);\n\n      vec3.set(aboveHeap, pivot[0], pivot[1] + aboveHeap[0], pivot[2]);\n      vec3.transformMat4(aboveHeap, aboveHeap, node.worldMatrix);\n\n      let lastVertices = lastEmit.vertices;\n\n      // Left top\n      vertices[0] = aboveHeap[0];\n      vertices[1] = aboveHeap[1];\n      vertices[2] = aboveHeap[2];\n\n      // Left bottom\n      vertices[3] = belowHeap[0];\n      vertices[4] = belowHeap[1];\n      vertices[5] = belowHeap[2];\n\n      // Right bottom\n      vertices[6] = lastVertices[3];\n      vertices[7] = lastVertices[4];\n      vertices[8] = lastVertices[5];\n\n      // Right top\n      vertices[9] = lastVertices[0];\n      vertices[10] = lastVertices[1];\n      vertices[11] = lastVertices[2];\n    } else {\n      vertices[0] = 0;\n      vertices[1] = 0;\n      vertices[2] = 0;\n      vertices[3] = 0;\n      vertices[4] = 0;\n      vertices[5] = 0;\n      vertices[6] = 0;\n      vertices[7] = 0;\n      vertices[8] = 0;\n      vertices[9] = 0;\n      vertices[10] = 0;\n      vertices[11] = 0;\n    }\n  }\n\n  /**\n   *\n   */\n  update() {\n    let emitterView = this.emitterView;\n\n    emitterView.getColor(colorHeap);\n    emitterView.getAlpha(alphaHeap);\n    emitterView.getTextureSlot(slotHeap);\n\n    let modelObject = this.emitter.modelObject;\n    let dt = modelObject.model.viewer.frameTime * 0.001;\n    let gravity = modelObject.gravity * dt * dt;\n    let vertices = this.vertices;\n    let animatedAlpha = alphaHeap[0];\n    let animatedSlot = slotHeap[0];\n    let chainLengthFactor = 1 / emitterView.ribbonCount;\n    let locationInChain = (emitterView.currentRibbon - this.index - 1);\n\n    this.health -= dt;\n\n    vertices[1] -= gravity;\n    vertices[4] -= gravity;\n    vertices[7] -= gravity;\n    vertices[10] -= gravity;\n\n    if (this.health <= 0) {\n      emitterView.ribbonCount--;\n    } else {\n      let columns = modelObject.dimensions[0];\n      let left = (animatedSlot % columns) + (locationInChain * chainLengthFactor);\n      let top = (animatedSlot / columns) | 0;\n      let right = left + chainLengthFactor;\n      let bottom = top + 1;\n\n      left = (left * 255) | 0;\n      top = (top * 255) | 0;\n      right = (right * 255) | 0;\n      bottom = (bottom * 255);\n      animatedAlpha = (animatedAlpha * 255) | 0;\n\n      this.lta = uint8ToUint24(left, top, animatedAlpha);\n      this.lba = uint8ToUint24(left, bottom, animatedAlpha);\n      this.rta = uint8ToUint24(right, top, animatedAlpha);\n      this.rba = uint8ToUint24(right, bottom, animatedAlpha);\n      this.rgb = uint8ToUint24((colorHeap[0] * 255) | 0, (colorHeap[1] * 255) | 0, (colorHeap[2] * 255) | 0); // Color even used???\n    }\n  }\n}\n","import SharedGeometryEmitter from './sharedgeometryemitter';\nimport Ribbon from './ribbon';\n\n/**\n * A ribbon emitter.\n */\nexport default class RibbonEmitter extends SharedGeometryEmitter {\n  /**\n   * @param {RibbonEmitter} modelObject\n   */\n  constructor(modelObject) {\n    super(modelObject);\n\n    this.elementsPerEmit = 30;\n  }\n\n  /**\n   * @param {RibbonEmitterView} emitterView\n   */\n  emit(emitterView) {\n    emitterView.lastEmit = this.emitObject(emitterView);\n  }\n\n  /**\n   * @return {Ribbon}\n   */\n  createObject() {\n    return new Ribbon(this);\n  }\n\n  /**\n   * @param {*} emitterView\n   */\n  fill(emitterView) {\n    let emission = emitterView.currentEmission;\n\n    if (emission >= 1) {\n      this.emit(emitterView);\n      emitterView.currentEmission--;\n    }\n  }\n\n  /**\n   * @param {ModelView} modelView\n   * @param {ShaderProgram} shader\n   */\n  render(modelView, shader) {\n    let alive = this.alive;\n\n    if (alive > 0) {\n      let modelObject = this.modelObject;\n      let model = modelObject.model;\n      let gl = model.viewer.gl;\n\n      modelObject.layer.bind(shader);\n\n      gl.uniform2fv(shader.uniforms.u_dimensions, modelObject.dimensions);\n\n      model.bindTexture(modelObject.texture, 0, modelView);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.data.subarray(0, alive * 30));\n\n      gl.vertexAttribPointer(shader.attribs.a_position, 3, gl.FLOAT, false, 20, 0);\n      gl.vertexAttribPointer(shader.attribs.a_uva_rgb, 2, gl.FLOAT, false, 20, 12);\n\n      gl.drawArrays(gl.TRIANGLES, 0, alive * 6);\n    }\n  }\n}\n","/**\n * An MDX spawned model object.\n */\nexport default class EventObjectSpn {\n  /**\n   * @param {MdxEventObjectEmitter} emitter\n   */\n  constructor(emitter) {\n    this.emitter = emitter;\n    this.emitterView = null;\n    this.health = 0;\n    this.internalResource = emitter.modelObject.internalResource.addInstance();\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  reset(emitterView) {\n    let instance = this.internalResource;\n    let node = emitterView.instance.nodes[this.emitter.modelObject.index];\n\n    this.emitterView = emitterView;\n\n    instance.setSequence(0);\n    instance.setTransformation(node.worldLocation, node.worldRotation, node.worldScale);\n    instance.show();\n\n    emitterView.instance.scene.addInstance(instance);\n\n    this.health = 1;\n  }\n\n  /**\n   *\n   */\n  update() {\n    let instance = this.internalResource;\n\n    // Once the sequence finishes, this event object dies\n    if (instance.frame >= instance.model.sequences[0].interval[1]) {\n      this.health = 0;\n\n      instance.hide();\n    }\n  }\n}\n","import SharedEmitter from './sharedemitter';\nimport EventObjectSpn from './eventobjectspn';\n\n/**\n * An MDX model emitter.\n */\nexport default class EventObjectSpnEmitter extends SharedEmitter {\n  /**\n   * @param {EventObject} modelObject\n   */\n  constructor(modelObject) {\n    super(modelObject);\n\n    this.type = 'SPN';\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  emit(emitterView) {\n    if (this.modelObject.ok) {\n      this.emitObject(emitterView);\n    }\n  }\n\n  /**\n   * @return {EventObjectSpn}\n   */\n  createObject() {\n    return new EventObjectSpn(this);\n  }\n}\n","import {vec3, vec4} from 'gl-matrix';\nimport {lerp} from '../../../common/math';\nimport {uint8ToUint24} from '../../../common/typecast';\n\n/**\n * An MDX splat object.\n */\nexport default class EventObjectSpl {\n  /**\n   * @param {MdxEventObjectEmitter} emitter\n   */\n  constructor(emitter) {\n    this.emitter = emitter;\n    this.emitterView = null;\n    this.health = 0;\n    this.color = new Uint8Array(4);\n    this.vertices = new Float32Array(12);\n    this.lta = 0;\n    this.lba = 0;\n    this.rta = 0;\n    this.rba = 0;\n    this.rgb = 0;\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  reset(emitterView) {\n    let modelObject = this.emitter.modelObject;\n    let vertices = this.vertices;\n    let emitterScale = modelObject.scale;\n    let node = emitterView.instance.nodes[modelObject.index];\n    let worldMatrix = node.worldMatrix;\n    let vertex;\n\n    this.emitterView = emitterView;\n\n    vertex = vertices.subarray(0, 2);\n    vec3.transformMat4(vertex, [-emitterScale, -emitterScale, 0], worldMatrix);\n\n    vertex = vertices.subarray(3, 5);\n    vec3.transformMat4(vertex, [-emitterScale, emitterScale, 0], worldMatrix);\n\n    vertex = vertices.subarray(6, 8);\n    vec3.transformMat4(vertex, [emitterScale, emitterScale, 0], worldMatrix);\n\n    vertex = vertices.subarray(9, 11);\n    vec3.transformMat4(vertex, [emitterScale, -emitterScale, 0], worldMatrix);\n\n    this.health = modelObject.lifespan;\n  }\n\n  /**\n   *\n   */\n  update() {\n    let modelObject = this.emitter.modelObject;\n    let columns = modelObject.dimensions[0];\n    let intervalTimes = modelObject.intervalTimes;\n    let intervals = modelObject.intervals;\n    let first = intervalTimes[0];\n    let second = intervalTimes[1];\n    let colors = modelObject.colors;\n    let color = this.color;\n    let factor;\n    let interval;\n    let firstColor;\n    let index;\n\n    this.health -= modelObject.model.viewer.frameTime * 0.001;\n\n    // Inverse of health\n    let time = modelObject.lifespan - this.health;\n\n    if (time < first) {\n      factor = time / first;\n      interval = intervals[0];\n      firstColor = 0;\n    } else {\n      factor = (time - first) / second;\n      interval = intervals[1];\n      firstColor = 1;\n    }\n\n    // Interpolated color\n    vec4.lerp(color, colors[firstColor], colors[firstColor + 1], factor);\n\n    // The texture portion to index\n    index = Math.floor(lerp(interval[0], interval[1], factor));\n\n    // Calculate the UV rectangle.\n    let left = index % columns;\n    let top = Math.floor(index / columns);\n    let right = left + 1;\n    let bottom = top + 1;\n    let a = color[3];\n\n    // Encode the UV rectangle and color in floats.\n    // This is a shader optimization.\n    this.lta = uint8ToUint24(right, bottom, a);\n    this.lba = uint8ToUint24(left, bottom, a);\n    this.rta = uint8ToUint24(right, top, a);\n    this.rba = uint8ToUint24(left, top, a);\n    this.rgb = uint8ToUint24(color[0], color[1], color[2]);\n  }\n}\n","import SharedGeometryEmitter from './sharedgeometryemitter';\nimport EventObjectSpl from './eventobjectspl';\n\n/**\n * An MDX splat emitter.\n */\nexport default class EventObjectSplEmitter extends SharedGeometryEmitter {\n  /**\n   * @param {EventObject} modelObject\n   */\n  constructor(modelObject) {\n    super(modelObject);\n\n    this.type = 'SPL';\n    this.elementsPerEmit = 30;\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  emit(emitterView) {\n    if (this.modelObject.ok) {\n      this.emitObject(emitterView);\n    }\n  }\n\n  /**\n   * @return {EventObjectSpl}\n   */\n  createObject() {\n    return new EventObjectSpl(this);\n  }\n}\n","import {vec3, vec4} from 'gl-matrix';\nimport {uint8ToUint24} from '../../../common/typecast';\n\n/**\n * An MDX ubersplat object.\n */\nexport default class EventObjectUbr {\n  /**\n   * @param {MdxEventObjectEmitter} emitter\n   */\n  constructor(emitter) {\n    this.emitter = emitter;\n    this.emitterView = null;\n    this.health = 0;\n    this.color = new Uint8Array(4);\n    this.vertices = new Float32Array(12);\n    this.lta = 0;\n    this.lba = 0;\n    this.rta = 0;\n    this.rba = 0;\n    this.rgb = 0;\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  reset(emitterView) {\n    let modelObject = this.emitter.modelObject;\n    let vertices = this.vertices;\n    let emitterScale = modelObject.scale;\n    let node = emitterView.instance.nodes[modelObject.index];\n    let worldMatrix = node.worldMatrix;\n    let vertex;\n\n    this.emitterView = emitterView;\n\n    vertex = vertices.subarray(0, 2);\n    vec3.transformMat4(vertex, [-emitterScale, -emitterScale, 0], worldMatrix);\n\n    vertex = vertices.subarray(3, 5);\n    vec3.transformMat4(vertex, [-emitterScale, emitterScale, 0], worldMatrix);\n\n    vertex = vertices.subarray(6, 8);\n    vec3.transformMat4(vertex, [emitterScale, emitterScale, 0], worldMatrix);\n\n    vertex = vertices.subarray(9, 11);\n    vec3.transformMat4(vertex, [emitterScale, -emitterScale, 0], worldMatrix);\n\n    this.health = modelObject.lifespan;\n  }\n\n  /**\n   *\n   */\n  update() {\n    let modelObject = this.emitter.modelObject;\n    let intervalTimes = modelObject.intervalTimes;\n    let first = intervalTimes[0];\n    let second = intervalTimes[1];\n    let third = intervalTimes[2];\n    let colors = modelObject.colors;\n    let color = this.color;\n\n    this.health -= modelObject.model.viewer.frameTime * 0.001;\n\n    // Inverse of health\n    let time = modelObject.lifespan - this.health;\n\n    if (time < first) {\n      vec4.lerp(color, colors[0], colors[1], time / first);\n    } else if (time < first + second) {\n      vec4.copy(color, modelObject.colors[1]);\n    } else {\n      vec4.lerp(color, colors[1], colors[2], (time - first - second) / third);\n    }\n\n    // Calculate the UV rectangle.\n    let a = color[3];\n\n    // Encode the UV rectangle and color in floats.\n    // This is a shader optimization.\n    this.lta = uint8ToUint24(1, 0, a);\n    this.lba = uint8ToUint24(0, 0, a);\n    this.rta = uint8ToUint24(1, 1, a);\n    this.rba = uint8ToUint24(0, 1, a);\n    this.rgb = uint8ToUint24(color[0], color[1], color[2]);\n  }\n}\n","import SharedGeometryEmitter from './sharedgeometryemitter';\nimport EventObjectUbr from './eventobjectubr';\n\n/**\n * An MDX ubersplat emitter.\n */\nexport default class EventObjectUbrEmitter extends SharedGeometryEmitter {\n  /**\n   * @param {EventObject} modelObject\n   */\n  constructor(modelObject) {\n    super(modelObject);\n\n    this.type = 'UBR';\n    this.elementsPerEmit = 30;\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  emit(emitterView) {\n    if (this.modelObject.ok) {\n      this.emitObject(emitterView);\n    }\n  }\n\n  /**\n   * @return {EventObjectUbr}\n   */\n  createObject() {\n    return new EventObjectUbr(this);\n  }\n}\n","/**\n * An MDX sound emitter.\n */\nexport default class EventObjectSndEmitter {\n  /**\n   * @param {EventEmitter} modelObject\n   */\n  constructor(modelObject) {\n    this.modelObject = modelObject;\n    this.type = 'SND';\n  }\n\n  /**\n   * @param {EventObjectEmitterView} emitterView\n   */\n  emit(emitterView) {\n    if (this.modelObject.ok) {\n      let viewer = this.modelObject.model.viewer;\n      let scene = emitterView.instance.scene;\n\n      // Is audio enabled both viewer-wide and in this scene?\n      if (viewer.enableAudio && scene.audioEnabled) {\n        let audioContext = scene.audioContext;\n        let emitter = emitterView.emitter;\n        let decodedBuffers = emitter.decodedBuffers;\n        let panner = audioContext.createPanner();\n        let source = audioContext.createBufferSource();\n\n        // Panner settings.\n        panner.setPosition(...emitterView.instance.nodes[emitter.objectId].worldLocation);\n        panner.maxDistance = emitter.distanceCutoff;\n        panner.refDistance = emitter.minDistance;\n        panner.connect(audioContext.destination);\n\n        // Source.\n        source.buffer = decodedBuffers[(Math.random() * decodedBuffers.length) | 0];\n        source.connect(panner);\n\n        // Make a sound.\n        source.start(0);\n      }\n    }\n  }\n\n  /**\n   *\n   */\n  update() {\n\n  }\n\n  /**\n   * @param {*} emitterView\n   */\n  fill(emitterView) {\n    let emission = emitterView.currentEmission;\n\n    if (emission >= 1) {\n      for (let i = 0; i < emission; i += 1, emitterView.currentEmission--) {\n        this.emit(emitterView);\n      }\n    }\n  }\n\n  /**\n   * @param {ModelView} modelView\n   * @param {ShaderProgram} shader\n   */\n  render(modelView, shader) {\n\n  }\n\n  /**\n   * Does nothing.\n   * Defined to stay compatible with SharedEmitter.\n   *\n   * @param {ModelInstance} owner\n   */\n  clear(owner) {\n\n  }\n}\n","import Bucket from '../../bucket';\n\n/**\n * An MDX bucket.\n */\nexport default class extends Bucket {\n  /**\n   * @param {MdxModelView} modelView\n   */\n  constructor(modelView) {\n    super(modelView);\n\n    let model = this.model;\n    let batchSize = model.batchSize;\n    let gl = model.viewer.gl;\n    let numberOfBones = model.bones.length + 1;\n\n    this.boneArrayInstanceSize = numberOfBones * 16;\n    this.boneArray = new Float32Array(this.boneArrayInstanceSize * batchSize);\n\n    this.boneTexture = gl.createTexture();\n    this.boneTextureWidth = numberOfBones * 4;\n    this.boneTextureHeight = batchSize;\n    this.vectorSize = 1 / this.boneTextureWidth;\n    this.rowSize = 1 / this.boneTextureHeight;\n\n    gl.activeTexture(gl.TEXTURE15);\n    gl.bindTexture(gl.TEXTURE_2D, this.boneTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA32F, this.boneTextureWidth, this.boneTextureHeight, 0, gl.RGBA, gl.FLOAT, this.boneArray);\n\n    // Team colors and vertex colors\n    // [TC, RR, GG, BB, AA]\n    this.colorData = new Uint8Array(batchSize * 5);\n    this.colorBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.colorBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, this.colorData.byteLength, gl.DYNAMIC_DRAW);\n\n    // Batches\n    if (model.batches.length > 0) {\n      this.geosetColorsData = new Uint8Array(batchSize * model.geosets.length * 4);\n      this.geosetColorsBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.geosetColorsBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.geosetColorsData.byteLength, gl.DYNAMIC_DRAW);\n\n      // This buffer first contains the texture animation data for each instance, for each layer, and then every alpha for each instance for each layer.\n      // Every texture animation data per instance contains the following:\n      //     [Tx, Ty, Rz, Rw, S, Ox, Oy]\n      // Where:\n      //     T = translation\n      //     R = rotation (quaternion with x=0 and y=0)\n      //     S = scale (uniform)\n      //     O = offset for sprite animations\n      this.layersData = new ArrayBuffer(batchSize * model.layers.length * 29);\n      this.uvTransformsData = new Float32Array(this.layersData, 0, batchSize * model.layers.length * 7);\n      this.layerAlphasData = new Uint8Array(this.layersData, batchSize * model.layers.length * 28, batchSize * model.layers.length);\n      this.layersBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.layersBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.layersData.byteLength, gl.DYNAMIC_DRAW);\n    }\n  }\n\n  /**\n   * Fill this bucket with scene data.\n   *\n   * @param {Object} data\n   * @return {number}\n   */\n  fill(data) {\n    let baseIndex = data.baseIndex;\n    let model = this.model;\n    let gl = model.viewer.gl;\n    let batchSize = model.batchSize;\n    let geosetCount = model.geosets.length;\n    let layerCount = model.layers.length;\n    let boneCount = model.bones.length;\n    let boneArray = this.boneArray;\n    let colorData = this.colorData;\n    let geosetColorsData = this.geosetColorsData;\n    let layerAlphasData = this.layerAlphasData;\n    let uvTransformsData = this.uvTransformsData;\n    let instanceOffset = 0;\n    let instances = data.instances;\n    let particleEmitters = data.particleEmitters;\n    let particleEmitters2 = data.particleEmitters2;\n    let ribbonEmitters = data.ribbonEmitters;\n    let eventObjectEmitters = data.eventObjectEmitters;\n\n    for (let l = instances.length; baseIndex < l && instanceOffset < batchSize; baseIndex++) {\n      let instance = instances[baseIndex];\n\n      if (instance.rendered && !instance.culled) {\n        let vertexColor = instance.vertexColor;\n        let worldMatrices = instance.worldMatrices;\n        let geosetColors = instance.geosetColors;\n        let layerAlphas = instance.layerAlphas;\n        let uvOffsets = instance.uvOffsets;\n        let uvScales = instance.uvScales;\n        let uvRots = instance.uvRots;\n        let base = 16 + instanceOffset * (16 + boneCount * 16);\n        let particleEmitterViews = instance.particleEmitters;\n        let particleEmitter2Views = instance.particleEmitters2;\n        let ribbonEmitterViews = instance.ribbonEmitters;\n        let eventObjectEmitterViews = instance.eventObjectEmitters;\n        let instanceOffset4 = instanceOffset * 4;\n        let instanceOffset5 = instanceOffset * 5;\n        let instanceOffset7 = instanceOffset * 7;\n\n        // Bones\n        for (let j = 0, k = boneCount * 16; j < k; j++) {\n          boneArray[base + j] = worldMatrices[j];\n        }\n\n        // Team color\n        colorData[instanceOffset5] = instance.teamColor;\n\n        // Vertex color\n        colorData[instanceOffset5 + 1] = vertexColor[0];\n        colorData[instanceOffset5 + 2] = vertexColor[1];\n        colorData[instanceOffset5 + 3] = vertexColor[2];\n        colorData[instanceOffset5 + 4] = vertexColor[3];\n\n        for (let geosetIndex = 0; geosetIndex < geosetCount; geosetIndex++) {\n          let geosetIndex4 = geosetIndex * 4;\n          let base = batchSize * geosetIndex4 + instanceOffset4;\n\n          // Geoset color\n          geosetColorsData[base] = geosetColors[geosetIndex4];\n          geosetColorsData[base + 1] = geosetColors[geosetIndex4 + 1];\n          geosetColorsData[base + 2] = geosetColors[geosetIndex4 + 2];\n          geosetColorsData[base + 3] = geosetColors[geosetIndex4 + 3];\n        }\n\n        if (model.batches.length > 0) {\n          for (let layerIndex = 0; layerIndex < layerCount; layerIndex++) {\n            let layerIndex4 = layerIndex * 4;\n            let uvBase = batchSize * layerIndex * 7 + instanceOffset7;\n\n            // Layer alpha\n            layerAlphasData[batchSize * layerIndex + instanceOffset] = layerAlphas[layerIndex];\n\n            // Translation\n            uvTransformsData[uvBase] = uvOffsets[layerIndex4];\n            uvTransformsData[uvBase + 1] = uvOffsets[layerIndex4 + 1];\n\n            // Rotation\n            uvTransformsData[uvBase + 2] = uvRots[layerIndex * 2];\n            uvTransformsData[uvBase + 3] = uvRots[layerIndex * 2 + 1];\n\n            // Scale\n            uvTransformsData[uvBase + 4] = uvScales[layerIndex];\n\n            // Sprite animation\n            uvTransformsData[uvBase + 5] = uvOffsets[layerIndex4 + 2];\n            uvTransformsData[uvBase + 6] = uvOffsets[layerIndex4 + 3];\n          }\n        }\n\n        for (let i = 0, l = particleEmitters.length; i < l; i++) {\n          particleEmitters[i].fill(particleEmitterViews[i]);\n        }\n\n        for (let i = 0, l = particleEmitters2.length; i < l; i++) {\n          particleEmitters2[i].fill(particleEmitter2Views[i]);\n        }\n\n        for (let i = 0, l = ribbonEmitters.length; i < l; i++) {\n          ribbonEmitters[i].fill(ribbonEmitterViews[i]);\n        }\n\n        for (let i = 0, l = eventObjectEmitters.length; i < l; i++) {\n          eventObjectEmitters[i].fill(eventObjectEmitterViews[i]);\n        }\n\n        instanceOffset += 1;\n      }\n    }\n\n    // Save the number of instances of which data was copied.\n    this.count = instanceOffset;\n\n    if (instanceOffset) {\n      gl.activeTexture(gl.TEXTURE15);\n      gl.bindTexture(gl.TEXTURE_2D, this.boneTexture);\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, this.boneTextureWidth, instanceOffset, gl.RGBA, gl.FLOAT, boneArray);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.colorBuffer);\n      gl.bufferSubData(gl.ARRAY_BUFFER, 0, colorData);\n\n      if (geosetCount) {\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.geosetColorsBuffer);\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, geosetColorsData);\n      }\n\n      if (layerCount && model.batches.length > 0) {\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.layersBuffer);\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.layersData);\n      }\n    }\n\n    return baseIndex;\n  }\n}\n","import {quat} from 'gl-matrix';\nimport {SkeletalNode} from '../../node';\n\n/**\n * An MDX node.\n */\nexport default class MdxNode extends SkeletalNode {\n  /**\n   * @param {quat} rotation\n   */\n  convertBasis(rotation) {\n    quat.rotateY(rotation, rotation, -Math.PI / 2);\n  }\n}\n","\n// Heap allocations needed for this module.\nlet visibilityHeap = new Float32Array(1);\n\n/**\n * An attachment instance.\n */\nexport default class AttachmentInstance {\n  /**\n   * @param {ModelInstance} instance\n   * @param {Attachment} attachment\n   */\n  constructor(instance, attachment) {\n    let internalModel = attachment.internalModel;\n    let internalInstance = internalModel.addInstance();\n\n    internalInstance.setSequenceLoopMode(2);\n    internalInstance.dontInheritScale = false;\n    internalInstance.hide();\n    internalInstance.setParent(instance.nodes[attachment.objectId]);\n\n    this.instance = instance;\n    this.attachment = attachment;\n    this.internalInstance = internalInstance;\n  }\n\n  /**\n   *\n   */\n  update() {\n    let internalInstance = this.internalInstance;\n\n    if (internalInstance.model.ok) {\n      this.attachment.getVisibility(visibilityHeap, this.instance);\n\n      if (visibilityHeap[0] > 0.1) {\n        // The parent instance might not actually be in a scene.\n        // This happens if loading a local model, where loading is instant and adding to a scene always comes afterwards.\n        // Therefore, do it here dynamically.\n        this.instance.scene.addInstance(internalInstance);\n\n        if (internalInstance.hidden()) {\n          internalInstance.show();\n\n          // Every time the attachment becomes visible again, restart its first sequence.\n          internalInstance.setSequence(0);\n        }\n      } else {\n        internalInstance.hide();\n      }\n    }\n  }\n}\n","// Heap allocations needed for this module.\nlet emissionRateHeap = new Float32Array(1);\n\n/**\n * An MDX particle emitter view.\n */\nexport default class ParticleEmitterView {\n  /**\n   * @param {MdxModelInstance} instance\n   * @param {MdxParticleEmitter} emitter\n   */\n  constructor(instance, emitter) {\n    this.instance = instance;\n    this.emitter = emitter;\n    this.currentEmission = 0;\n  }\n\n  /**\n   *\n   */\n  update() {\n    if (this.instance.allowParticleSpawn) {\n      this.getEmissionRate(emissionRateHeap);\n\n      this.currentEmission += emissionRateHeap[0] * this.instance.model.viewer.frameTime * 0.001;\n    }\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getSpeed(out) {\n    return this.emitter.getSpeed(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getLatitude(out) {\n    return this.emitter.getLatitude(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getLongitude(out) {\n    return this.emitter.getLongitude(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getLifeSpan(out) {\n    return this.emitter.getLifeSpan(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getGravity(out) {\n    return this.emitter.getGravity(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getEmissionRate(out) {\n    return this.emitter.getEmissionRate(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getVisibility(out) {\n    return this.emitter.getVisibility(out, this.instance);\n  }\n}\n","// Heap allocations needed for this module.\nlet emissionRateHeap = new Float32Array(1);\n\n/**\n * An MDX particle emitter type 2 view.\n */\nexport default class ParticleEmitter2View {\n  /**\n   * @param {MdxModelInstance} instance\n   * @param {MdxParticle2Emitter} emitter\n   */\n  constructor(instance, emitter) {\n    this.instance = instance;\n    this.emitter = emitter;\n    this.currentEmission = 0;\n    this.lastEmissionKey = -1;\n  }\n\n  /**\n   *\n   */\n  update() {\n    if (this.instance.allowParticleSpawn) {\n      let keyframe = this.getEmissionRate(emissionRateHeap);\n\n      if (this.emitter.squirt) {\n        if (keyframe !== this.lastEmissionKey) {\n          this.currentEmission += emissionRateHeap[0];\n        }\n\n        this.lastEmissionKey = keyframe;\n      } else {\n        this.currentEmission += emissionRateHeap[0] * this.instance.model.viewer.frameTime * 0.001;\n      }\n    }\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getWidth(out) {\n    return this.emitter.getWidth(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getLength(out) {\n    return this.emitter.getLength(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getSpeed(out) {\n    return this.emitter.getSpeed(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getLatitude(out) {\n    return this.emitter.getLatitude(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getGravity(out) {\n    return this.emitter.getGravity(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getEmissionRate(out) {\n    return this.emitter.getEmissionRate(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getVisibility(out) {\n    return this.emitter.getVisibility(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getVariation(out) {\n    return this.emitter.getVariation(out, this.instance);\n  }\n}\n","/**\n * An MDX ribbon emitter view.\n */\nexport default class RibbonEmitterView {\n  /**\n   * @param {MdxInstance} instance\n   * @param {MdxRibbonEmitter} emitter\n   */\n  constructor(instance, emitter) {\n    this.instance = instance;\n    this.emitter = emitter;\n    this.currentEmission = 0;\n    this.lastEmit = null;\n    this.currentRibbon = -1;\n    this.ribbonCount = 0;\n  }\n\n  /**\n   *\n   */\n  update() {\n    if (this.instance.allowParticleSpawn) {\n      this.currentEmission += this.emitter.emissionRate * this.instance.model.viewer.frameTime * 0.001;\n    }\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getHeightBelow(out) {\n    return this.emitter.getHeightBelow(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getHeightAbove(out) {\n    return this.emitter.getHeightAbove(out, this.instance);\n  }\n\n  /**\n   * @param {Uint32Array} out\n   * @return {number}\n   */\n  getTextureSlot(out) {\n    return this.emitter.getTextureSlot(out, this.instance);\n  }\n\n  /**\n   * @param {vec3} out\n   * @return {number}\n   */\n  getColor(out) {\n    return this.emitter.getColor(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getAlpha(out) {\n    return this.emitter.getAlpha(out, this.instance);\n  }\n\n  /**\n   * @param {Float32Array} out\n   * @return {number}\n   */\n  getVisibility(out) {\n    return this.emitter.getVisibility(out, this.instance);\n  }\n}\n","import {vec2} from 'gl-matrix';\n\n// Heap allocations needed for this module.\nlet track = vec2.create();\n\n/**\n * An event object emitter view.\n */\nexport default class EventObjectEmitterView {\n  /**\n   * @param {ModelInstance} instance\n   * @param {EventObjectEmitter} emitter\n   */\n  constructor(instance, emitter) {\n    this.instance = instance;\n    this.emitter = emitter;\n    this.lastTrack = new Uint16Array(2); // Support more than 256 keyframes per sequence, why not.\n    this.currentEmission = 0;\n  }\n\n  /**\n   *\n   */\n  reset() {\n    this.lastTrack.fill(0);\n  }\n\n  /**\n   *\n   */\n  update() {\n    if (this.instance.allowParticleSpawn) {\n      let emitter = this.emitter;\n      let lastTrack = this.lastTrack;\n\n      emitter.getValue(track, this.instance);\n\n      if (track[0] === 1 && (track[0] !== lastTrack[0] || track[1] !== lastTrack[1])) {\n        this.currentEmission += 1;\n      }\n\n      lastTrack[0] = track[0];\n      lastTrack[1] = track[1];\n    }\n  }\n}\n","import {vec3, quat} from 'gl-matrix';\nimport TexturedModelInstance from '../../texturedmodelinstance';\nimport {createSkeletalNodes} from '../../node';\nimport Node from './node';\nimport AttachmentInstance from './attachmentinstance';\nimport ParticleEmitterView from './particleemitterview';\nimport ParticleEmitter2View from './particleemitter2view';\nimport RibbonEmitterView from './ribbonemitterview';\nimport EventObjectEmitterView from './eventobjectemitterview';\n\n// Heap allocations needed for this module.\nlet visibilityHeap = new Float32Array(1);\nlet translationHeap = vec3.create();\nlet rotationHeap = quat.create();\nlet scaleHeap = vec3.create();\nlet colorHeap = new Float32Array(3);\nlet alphaHeap = new Float32Array(1);\nlet textureIdHeap = new Float32Array(1);\n\n/**\n * An MDX model instance.\n */\nexport default class ModelInstance extends TexturedModelInstance {\n  /**\n   * @param {MdxModel} model\n   */\n  constructor(model) {\n    super(model);\n\n    this.attachments = [];\n    this.particleEmitters = [];\n    this.particleEmitters2 = [];\n    this.ribbonEmitters = [];\n    this.eventObjectEmitters = [];\n    this.nodes = [];\n    this.sortedNodes = [];\n\n    this.frame = 0;\n    this.counter = 0; // Global sequences\n    this.sequence = -1;\n    this.sequenceLoopMode = 0;\n\n    this.teamColor = 0;\n    this.vertexColor = new Uint8Array([255, 255, 255, 255]);\n\n    this.allowParticleSpawn = false; // Particles do not spawn when the sequence is -1, or when the sequence finished and it's not repeating\n\n    // If forced is true, everything will update regardless of variancy.\n    // Any later non-forced update can then use variancy to skip updating things.\n    // It is set to true every time the sequence is set with setSequence().\n    this.forced = true;\n  }\n\n  /**\n   * Called when the model finishes loading, or immediately if it was already loaded when this instance was created.\n   */\n  load() {\n    let model = this.model;\n    let geosetCount = model.geosets.length;\n    let layerCount = model.layers.length;\n\n    this.geosetColors = new Uint8Array(geosetCount * 4);\n    this.layerAlphas = new Uint8Array(layerCount);\n    this.uvOffsets = new Float32Array(layerCount * 4);\n    this.uvScales = new Float32Array(layerCount);\n    this.uvRots = new Float32Array(layerCount * 2);\n\n    // Create the needed amount of shared nodes.\n    let sharedNodeData = createSkeletalNodes(model.genericObjects.length, Node);\n    let nodes = sharedNodeData.nodes;\n    let nodeIndex = 0;\n\n    this.nodes.push(...nodes);\n\n    // A shared typed array for all world matrices of the internal nodes.\n    this.worldMatrices = sharedNodeData.worldMatrices;\n\n    // And now initialize all of the nodes and objects\n    for (let bone of model.bones) {\n      this.initNode(nodes, nodes[nodeIndex++], bone);\n    }\n\n    for (let light of model.lights) {\n      this.initNode(nodes, nodes[nodeIndex++], light);\n    }\n\n    for (let helper of model.helpers) {\n      this.initNode(nodes, nodes[nodeIndex++], helper);\n    }\n\n    for (let attachment of model.attachments) {\n      let attachmentInstance;\n\n      // Attachments may have game models attached to them, such as Undead and Nightelf building animations.\n      if (attachment.internalModel) {\n        attachmentInstance = new AttachmentInstance(this, attachment);\n\n        this.attachments.push(attachmentInstance);\n      }\n\n      this.initNode(nodes, nodes[nodeIndex++], attachment, attachmentInstance);\n    }\n\n    for (let emitter of model.particleEmitters) {\n      let emitterView = new ParticleEmitterView(this, emitter);\n\n      this.particleEmitters.push(emitterView);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitter, emitterView);\n    }\n\n    for (let emitter of model.particleEmitters2) {\n      let emitterView = new ParticleEmitter2View(this, emitter);\n\n      this.particleEmitters2.push(emitterView);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitter, emitterView);\n    }\n\n    for (let emitter of model.ribbonEmitters) {\n      let emitterView = new RibbonEmitterView(this, emitter);\n\n      this.ribbonEmitters.push(emitterView);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitter, emitterView);\n    }\n\n    for (let camera of model.cameras) {\n      this.initNode(nodes, nodes[nodeIndex++], camera);\n    }\n\n    for (let emitter of model.eventObjects) {\n      let emitterView = new EventObjectEmitterView(this, emitter);\n\n      this.eventObjectEmitters.push(emitterView);\n\n      this.initNode(nodes, nodes[nodeIndex++], emitter, emitterView);\n    }\n\n    for (let collisionShape of model.collisionShapes) {\n      this.initNode(nodes, nodes[nodeIndex++], collisionShape);\n    }\n\n    // Save a sorted array of all of the nodes, such that every child node comes after its parent.\n    // This allows for flat iteration when updating.\n    let hierarchy = model.hierarchy;\n\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      this.sortedNodes[i] = nodes[hierarchy[i]];\n    }\n\n    // If the sequence was changed before the model was loaded, reset it now that the model loaded.\n    this.setSequence(this.sequence);\n  }\n\n  /**\n   * Clear all of the emitted objects that belong to this instance.\n   */\n  clearEmittedObjects() {\n    if (this.modelView) {\n      for (let sceneData of this.modelView.sceneData.values()) {\n        for (let emitter of sceneData.particleEmitters) {\n          emitter.clear(this);\n        }\n\n        for (let emitter of sceneData.particleEmitters2) {\n          emitter.clear(this);\n        }\n\n        for (let emitter of sceneData.ribbonEmitters) {\n          emitter.clear(this);\n        }\n\n        for (let emitter of sceneData.eventObjectEmitters) {\n          emitter.clear(this);\n        }\n      }\n    }\n  }\n\n  /**\n   * Initialize a skeletal node.\n   *\n   * @param {Array<SkeletalNode>} nodes\n   * @param {SkeletalNode} node\n   * @param {GenericObject} genericObject\n   * @param {*} object\n   */\n  initNode(nodes, node, genericObject, object) {\n    node.pivot.set(genericObject.pivot);\n\n\n    // this.index = index;\n    // this.name = object.name;\n    // this.objectId = object.objectId;\n    // this.parentId = object.parentId;\n    // this.pivot = model.pivotPoints[object.objectId] || vec3.create();\n\n    // let flags = object.flags;\n\n    // this.dontInheritTranslation = flags & 0x1;\n    // this.dontInheritRotation = flags & 0x2;\n    // this.dontInheritScaling = flags & 0x4;\n    // this.billboarded = flags & 0x8;\n    // this.billboardedX = flags & 0x10;\n    // this.billboardedY = flags & 0x20;\n    // this.billboardedZ = flags & 0x40;\n    // this.cameraAnchored = flags & 0x80;\n    // this.bone = flags & 0x100;\n    // this.light = flags & 0x200;\n    // this.eventObject = flags & 0x400;\n    // this.attachment = flags & 0x800;\n    // this.particleEmitter = flags & 0x1000;\n    // this.collisionShape = flags & 0x2000;\n    // this.ribbonEmitter = flags & 0x4000;\n    // this.emitterUsesMdlOrUnshaded = flags & 0x8000;\n    // this.emitterUsesTgaOrSortPrimitivesFarZ = flags & 0x10000;\n    // this.lineEmitter = flags & 0x20000;\n    // this.unfogged = flags & 0x40000;\n    // this.modelSpace = flags & 0x80000;\n    // this.xYQuad = flags & 0x100000;\n    node.name = genericObject.name;\n    node.gen = genericObject;\n\n    if (genericObject.parentId === -1) {\n      node.parent = this;\n    } else {\n      node.parent = nodes[genericObject.parentId];\n    }\n\n    if (genericObject.billboarded) {\n      node.billboarded = true;\n    } else if (genericObject.billboardedX) {\n      node.billboardedX = true;\n    } else if (genericObject.billboardedY) {\n      node.billboardedY = true;\n    } else if (genericObject.billboardedZ) {\n      node.billboardedZ = true;\n    }\n\n    if (object) {\n      node.object = object;\n    }\n  }\n\n  /**\n   * Overriden to hide also attachment models.\n   */\n  hide() {\n    super.hide();\n\n    for (let attachment of this.attachments) {\n      attachment.internalInstance.hide();\n    }\n  }\n\n  /**\n   * Overriden to show also attachment models.\n   */\n  show() {\n    super.show();\n\n    for (let attachment of this.attachments) {\n      attachment.internalInstance.show();\n    }\n  }\n\n  /**\n   * Updates the animation timers.\n   * Emits a 'seqend' event every time a sequence ends.\n   */\n  updateTimers() {\n    if (this.sequence !== -1) {\n      let model = this.model;\n      let sequence = model.sequences[this.sequence];\n      let interval = sequence.interval;\n      let frameTime = model.viewer.frameTime;\n\n      this.frame += frameTime;\n      this.counter += frameTime;\n      this.allowParticleSpawn = true;\n\n      if (this.frame >= interval[1]) {\n        if (this.sequenceLoopMode === 2 || (this.sequenceLoopMode === 0 && sequence.flags === 0)) {\n          this.frame = interval[0];\n\n          this.resetEventEmitters();\n        } else {\n          this.frame = interval[1];\n          this.counter -= frameTime;\n          this.allowParticleSpawn = false;\n        }\n\n        this.emit('seqend', this);\n      }\n    }\n  }\n\n  /**\n   * Updates all of this instance internal nodes and objects.\n   * Nodes that are determined to not be visible will not be updated, nor will any of their children down the hierarchy.\n   *\n   * @param {boolean} forced\n   */\n  updateNodes(forced) {\n    let sortedNodes = this.sortedNodes;\n    let sequence = this.sequence;\n    let sortedGenericObjects = this.model.sortedGenericObjects;\n    let scene = this.scene;\n\n    // Update the nodes\n    for (let i = 0, l = sortedNodes.length; i < l; i++) {\n      let genericObject = sortedGenericObjects[i];\n      let node = sortedNodes[i];\n      let parent = node.parent;\n\n      genericObject.getVisibility(visibilityHeap, this);\n\n      let objectVisible = visibilityHeap[0] >= 0.75;\n      let nodeVisible = forced || (parent.visible && objectVisible);\n\n      node.visible = nodeVisible;\n\n      // Every node only needs to be updated if this is a forced update, or if both the parent node and the generic object corresponding to this node are visible.\n      // Incoming messy code for optimizations!\n      if (nodeVisible) {\n        let wasDirty = false;\n        let variants = genericObject.variants;\n        let localLocation = node.localLocation;\n        let localRotation = node.localRotation;\n        let localScale = node.localScale;\n\n        // Only update the local node data if there is a need to\n        if (forced || variants.generic[sequence]) {\n          wasDirty = true;\n\n          // Translation\n          if (forced || variants.translation[sequence]) {\n            genericObject.getTranslation(translationHeap, this);\n\n            localLocation[0] = translationHeap[0];\n            localLocation[1] = translationHeap[1];\n            localLocation[2] = translationHeap[2];\n          }\n\n          // Rotation\n          if (forced || variants.rotation[sequence]) {\n            genericObject.getRotation(rotationHeap, this);\n\n            localRotation[0] = rotationHeap[0];\n            localRotation[1] = rotationHeap[1];\n            localRotation[2] = rotationHeap[2];\n            localRotation[3] = rotationHeap[3];\n          }\n\n          // Scale\n          if (forced || variants.scale[sequence]) {\n            genericObject.getScale(scaleHeap, this);\n\n            localScale[0] = scaleHeap[0];\n            localScale[1] = scaleHeap[1];\n            localScale[2] = scaleHeap[2];\n          }\n        }\n\n        let wasReallyDirty = forced || wasDirty || parent.wasDirty || genericObject.anyBillboarding;\n\n        node.wasDirty = wasReallyDirty;\n\n        // If this is a forced update, or this node's local data was updated, or the parent node was updated, do a full world update.\n        if (wasReallyDirty) {\n          node.recalculateTransformation(scene);\n        }\n\n        // If there is an instance object associated with this node, and the node is visible (which might not be the case for a forced update!), update the object.\n        // This includes attachments and emitters.\n        let object = node.object;\n\n        if (object && objectVisible) {\n          object.update();\n        }\n\n        // Update all of the node's non-skeletal children, which will update their children, and so on.\n        node.updateChildren(scene);\n      }\n    }\n  }\n\n  /**\n   * Update the batch data.\n   *\n   * @param {boolean} forced\n   */\n  updateBatches(forced) {\n    let model = this.model;\n    let geosets = model.geosets;\n    let layers = model.layers;\n    let geosetColors = this.geosetColors;\n    let layerAlphas = this.layerAlphas;\n    let uvOffsets = this.uvOffsets;\n    let uvScales = this.uvScales;\n    let uvRots = this.uvRots;\n    let sequence = this.sequence;\n\n    // Geosets\n    for (let i = 0, l = geosets.length; i < l; i++) {\n      let geoset = geosets[i];\n      let i4 = i * 4;\n\n      // Color\n      if (forced || geoset.variants.color[sequence]) {\n        geoset.getColor(colorHeap, this);\n\n        // Some Blizzard models have values greater than 1, which messes things up.\n        // Geoset animations are supposed to modulate colors, not intensify them.\n        geosetColors[i4] = colorHeap[0] * 255;\n        geosetColors[i4 + 1] = colorHeap[1] * 255;\n        geosetColors[i4 + 2] = colorHeap[2] * 255;\n      }\n\n      // Alpha\n      if (forced || geoset.variants.alpha[sequence]) {\n        geoset.getAlpha(alphaHeap, this);\n\n        geosetColors[i4 + 3] = alphaHeap[0] * 255;\n      }\n    }\n\n    // Layers\n    for (let i = 0, l = layers.length; i < l; i++) {\n      let layer = layers[i];\n      let i2 = i * 2;\n      let i4 = i * 4;\n\n      // Alpha\n      if (forced || layer.variants.alpha[sequence]) {\n        layer.getAlpha(alphaHeap, this);\n\n        layerAlphas[i] = alphaHeap[0] * 255;\n      }\n\n      // UV translation animation\n      if (forced || layer.variants.translation[sequence]) {\n        layer.getTranslation(translationHeap, this);\n\n        uvOffsets[i4] = translationHeap[0];\n        uvOffsets[i4 + 1] = translationHeap[1];\n      }\n\n      // UV rotation animation\n      if (forced || layer.variants.rotation[sequence]) {\n        layer.getRotation(rotationHeap, this);\n\n        uvRots[i2] = rotationHeap[2];\n        uvRots[i2 + 1] = rotationHeap[3];\n      }\n\n      // UV scale animation\n      if (forced || layer.variants.scale[sequence]) {\n        layer.getScale(scaleHeap, this);\n\n        uvScales[i] = scaleHeap[0];\n      }\n\n      // Sprite animation\n      if (forced || layer.variants.slot[sequence]) {\n        layer.getTextureId(textureIdHeap, this);\n\n        let uvDivisor = layer.uvDivisor;\n        let textureId = textureIdHeap[0];\n\n        uvOffsets[i4 + 2] = textureId % uvDivisor[0];\n        uvOffsets[i4 + 3] = (textureId / uvDivisor[1]) | 0;\n      }\n    }\n  }\n\n  /**\n   * Update all of the animated data.\n   */\n  updateAnimations() {\n    let forced = this.forced;\n\n    if (forced || (this.sequence !== -1 && !this.model.viewer.noUpdating)) {\n      this.forced = false;\n\n      // Update the nodes\n      this.updateNodes(forced);\n\n      // Update the batches\n      this.updateBatches(forced);\n    }\n  }\n\n  /**\n   * Set the team color of this instance.\n   *\n   * @param {number} id\n   * @return {this}\n   */\n  setTeamColor(id) {\n    this.teamColor = id;\n\n    return this;\n  }\n\n  /**\n   * Set the vertex color of this instance.\n   *\n   * @param {Uint8Array|Array<number>} color\n   * @return {this}\n   */\n  setVertexColor(color) {\n    this.vertexColor.set(color);\n\n    return this;\n  }\n\n  /**\n   * Set the sequence of this instance.\n   *\n   * @param {number} id\n   * @return {this}\n   */\n  setSequence(id) {\n    this.sequence = id;\n\n    if (this.model.ok) {\n      let sequences = this.model.sequences;\n\n      if (id < 0 || id > sequences.length - 1) {\n        this.sequence = -1;\n        this.frame = 0;\n        this.allowParticleSpawn = false;\n      } else {\n        this.frame = sequences[id].interval[0];\n      }\n\n      this.resetEventEmitters();\n\n      this.forced = true;\n    }\n\n    return this;\n  }\n\n  /**\n   * Set the seuqnece loop mode.\n   * 0 to never loop, 1 to loop based on the model, and 2 to always loop.\n   *\n   * @param {number} mode\n   * @return {this}\n   */\n  setSequenceLoopMode(mode) {\n    this.sequenceLoopMode = mode;\n\n    return this;\n  }\n\n  /**\n   * Get an attachment node.\n   *\n   * @param {number} id\n   * @return {SkeletalNode}\n   */\n  getAttachment(id) {\n    let attachment = this.model.attachments[id];\n\n    if (attachment) {\n      return this.nodes[attachment.index];\n    }\n  }\n\n  /**\n   * Event emitters depend on keyframe index changes to emit, rather than only values.\n   * To work, they need to check what the last keyframe was, and only if it's a different one, do something.\n   * When changing sequences, these states need to be reset, so they can immediately emit things if needed.\n   */\n  resetEventEmitters() {\n    for (let eventEmitterView of this.eventObjectEmitters) {\n      eventEmitterView.reset();\n    }\n  }\n}\n","import shaders from '../../shaders';\n\nexport default {\n  vs: `\n    ${shaders.instanceId}\n    ${shaders.boneTexture}\n    uniform mat4 u_mvp;\n\n    attribute vec3 a_position;\n    attribute vec3 a_normal;\n    attribute vec2 a_uv;\n    attribute vec4 a_bones;\n    attribute float a_boneNumber;\n    attribute float a_teamColor;\n    attribute vec4 a_vertexColor;\n    attribute vec4 a_geosetColor;\n    attribute float a_layerAlpha;\n    attribute vec4 a_uvTransRot;\n    attribute vec3 a_uvScaleSprite;\n\n    varying vec3 v_normal;\n    varying vec2 v_uv;\n    varying float v_teamColor;\n    varying vec4 v_vertexColor;\n    varying vec4 v_geosetColor;\n    varying vec4 v_uvTransRot;\n    varying vec3 v_uvScaleSprite;\n\n    void transform(inout vec3 position, inout vec3 normal, float boneNumber, vec4 bones) {\n      // For the broken models out there, since the game supports this.\n      if (boneNumber > 0.0) {\n        mat4 b0 = fetchMatrix(bones[0], a_InstanceID);\n        mat4 b1 = fetchMatrix(bones[1], a_InstanceID);\n        mat4 b2 = fetchMatrix(bones[2], a_InstanceID);\n        mat4 b3 = fetchMatrix(bones[3], a_InstanceID);\n        vec4 p = vec4(position, 1);\n        vec4 n = vec4(normal, 0);\n\n        position = vec3(b0 * p + b1 * p + b2 * p + b3 * p) / boneNumber;\n        normal = normalize(vec3(b0 * n + b1 * n + b2 * n + b3 * n));\n      }\n    }\n\n    void main() {\n      vec2 uv = a_uv;\n      vec3 position = a_position;\n      vec3 normal = a_normal;\n\n      transform(position, normal, a_boneNumber, a_bones);\n\n      v_uv = a_uv;\n      v_uvTransRot = a_uvTransRot;\n      v_uvScaleSprite = a_uvScaleSprite;\n\n      v_normal = normal;\n      v_teamColor = a_teamColor;\n      v_vertexColor = a_vertexColor;\n\n      // Is the alpha here even correct?\n      v_geosetColor = vec4(a_geosetColor.rgb, a_layerAlpha);\n\n      // Definitely not correct, but the best I could figure so far.\n      if (a_geosetColor.a < 0.75 || a_layerAlpha < 0.1) {\n        gl_Position = vec4(0.0);\n      } else {\n        gl_Position = u_mvp * vec4(position, 1);\n      }\n    }\n  `,\n  fs: `\n    uniform sampler2D u_texture;\n    uniform bool u_alphaTest;\n    // uniform bool u_unshaded;\n    uniform bool u_isTeamColor;\n    uniform vec2 u_uvScale;\n    uniform bool u_hasSlotAnim;\n    uniform bool u_hasTranslationAnim;\n    uniform bool u_hasRotationAnim;\n    uniform bool u_hasScaleAnim;\n\n    varying vec3 v_normal;\n    varying vec2 v_uv;\n    varying float v_teamColor;\n    varying vec4 v_vertexColor;\n    varying vec4 v_geosetColor;\n    varying vec4 v_uvTransRot;\n    varying vec3 v_uvScaleSprite;\n\n    // const vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\n    ${shaders.quat_transform}\n\n    void main() {\n      vec2 uv;\n\n      if (u_isTeamColor) {\n        // 4 is the amount of columns and rows in the team colors/glows texture.\n        uv = (vec2(mod((v_teamColor + 0.5), 8.0) - 0.5, floor((v_teamColor + 0.5) / 8.0)) + v_uv) / vec2(8.0, 4.0);\n      } else {\n        uv = v_uv;\n\n        // Translation animation\n        if (u_hasTranslationAnim) {\n          uv += v_uvTransRot.xy;\n        }\n\n        // Rotation animation\n        if (u_hasRotationAnim) {\n          uv = quat_transform(v_uvTransRot.zw, uv - 0.5) + 0.5;\n        }\n\n        // Scale animation\n        if (u_hasScaleAnim) {\n          uv = v_uvScaleSprite.x * (uv - 0.5) + 0.5;\n        }\n\n        // Sprite animation\n        if (u_hasSlotAnim) {\n          uv = (v_uvScaleSprite.yz + fract(uv)) * u_uvScale;\n        }\n      }\n\n      vec4 texel = texture2D(u_texture, uv).rgba;\n\n      // 1bit Alpha\n      if (u_alphaTest && texel.a < 0.75) {\n        discard;\n      }\n\n      vec4 color = texel * v_geosetColor.bgra * v_vertexColor;\n\n      // if (!u_unshaded) {\n      //   color *= clamp(dot(v_normal, lightDirection) + 0.45, 0.0, 1.0);\n      // }\n\n      gl_FragColor = color;\n    }\n  `,\n  vsParticles: `\n    ${shaders.decodeFloat}\n    uniform mat4 u_mvp;\n    uniform vec2 u_dimensions;\n    uniform bool u_isRibbonEmitter;\n\n    attribute vec3 a_position;\n    attribute vec2 a_uva_rgb;\n\n    varying vec2 v_uv;\n    varying vec4 v_color;\n\n    void main() {\n      vec3 uva = decodeFloat3(a_uva_rgb[0]);\n      vec3 rgb = decodeFloat3(a_uva_rgb[1]);\n      vec2 uv = uva.xy;\n\n      if (u_isRibbonEmitter) {\n        uv /= 255.0;\n      }\n\n      v_uv = uv / u_dimensions;\n      v_color = vec4(rgb, uva.z) / 255.0;\n\n      gl_Position = u_mvp * vec4(a_position, 1);\n    }\n  `,\n  fsParticles: `\n    uniform sampler2D u_texture;\n    uniform bool u_alphaTest;\n    uniform bool u_isRibbonEmitter;\n\n    varying vec2 v_uv;\n    varying vec4 v_color;\n\n    void main() {\n      vec4 texel = texture2D(u_texture, v_uv).rgba;\n\n      // 1bit Alpha, used by ribbon emitters\n      if (u_isRibbonEmitter && u_alphaTest && texel.a < 0.75) {\n        discard;\n      }\n\n      gl_FragColor = texel * v_color;\n    }\n  `,\n};\n","import imagetexture from '../imagetexture/handler';\nimport Model from './model';\nimport ModelView from './modelview';\nimport Bucket from './bucket';\nimport ModelInstance from './modelinstance';\nimport shaders from './shaders';\n\nexport default {\n  install(viewer) {\n    viewer.addHandler(imagetexture);\n\n    let standardShader = viewer.loadShader('MdxStandardShader', shaders.vs, shaders.fs);\n    let particleShader = viewer.loadShader('MdxParticleShader', shaders.vsParticles, shaders.fsParticles);\n\n    // If a shader failed to compile, don't allow the handler to be registered, and send an error instead.\n    return standardShader.ok && particleShader.ok;\n  },\n\n  extensions: [['.mdx', 'arrayBuffer'], ['.mdl', 'text']],\n  Constructor: Model,\n  View: ModelView,\n  Bucket: Bucket,\n  Instance: ModelInstance,\n};\n","import TexturedModelView from '../../texturedmodelview';\nimport ParticleEmitter from './particleemitter';\nimport ParticleEmitter2 from './particleemitter2';\nimport RibbonEmitter from './ribbonemitter';\nimport EventObjectSpnEmitter from './eventobjectspnemitter';\nimport EventObjectSplEmitter from './eventobjectsplemitter';\nimport EventObjectUbrEmitter from './eventobjectubremitter';\nimport EventObjectSndEmitter from './eventobjectsndemitter';\n\n/**\n * An MDX model view.\n */\nexport default class ModelView extends TexturedModelView {\n  /**\n   * @param {Scene} scene\n   * @return {Object}\n   */\n  createSceneData(scene) {\n    let model = this.model;\n    let data = super.createSceneData(scene);\n    let particleEmitters = [];\n    let particleEmitters2 = [];\n    let ribbonEmitters = [];\n    let eventObjectEmitters = [];\n\n    for (let emitter of model.particleEmitters) {\n      particleEmitters.push(new ParticleEmitter(emitter));\n    }\n\n    for (let emitter of model.particleEmitters2) {\n      particleEmitters2.push(new ParticleEmitter2(emitter));\n    }\n\n    for (let emitter of model.ribbonEmitters) {\n      ribbonEmitters.push(new RibbonEmitter(emitter));\n    }\n\n    for (let emitter of model.eventObjects) {\n      let type = emitter.type;\n\n      if (type === 'SPN') {\n        eventObjectEmitters.push(new EventObjectSpnEmitter(emitter));\n      } else if (type === 'SPL') {\n        eventObjectEmitters.push(new EventObjectSplEmitter(emitter));\n      } else if (type === 'UBR') {\n        eventObjectEmitters.push(new EventObjectUbrEmitter(emitter));\n      } else if (type === 'SND') {\n        eventObjectEmitters.push(new EventObjectSndEmitter(emitter));\n      }\n    }\n\n    return {\n      ...data,\n      particleEmitters,\n      particleEmitters2,\n      ribbonEmitters,\n      eventObjectEmitters,\n    };\n  }\n\n  /**\n   * @param {Scene} scene\n   */\n  update(scene) {\n    let data = super.update(scene);\n\n    if (data) {\n      let batchCount = this.model.batches.length;\n      let buckets = data.buckets;\n      let renderedInstances = 0;\n      let renderedParticles = 0;\n      let renderedBuckets = 0;\n      let renderCalls = 0;\n\n      for (let i = 0, l = data.usedBuckets; i < l; i++) {\n        renderedInstances += buckets[i].count;\n        renderedBuckets += 1;\n        renderCalls += batchCount;\n      }\n\n      for (let emitter of data.particleEmitters) {\n        emitter.update();\n\n        let particles = emitter.alive;\n\n        if (particles) {\n          renderedParticles += particles;\n          renderCalls += 1;\n        }\n      }\n\n      for (let emitter of data.particleEmitters2) {\n        emitter.update();\n\n        let particles = emitter.alive;\n\n        if (particles) {\n          renderedParticles += particles;\n          renderCalls += 1;\n        }\n      }\n\n      for (let emitter of data.ribbonEmitters) {\n        emitter.update();\n\n        let particles = emitter.alive;\n\n        if (particles) {\n          renderedParticles += particles;\n          renderCalls += 1;\n        }\n      }\n\n      for (let emitter of data.eventObjectEmitters) {\n        emitter.update();\n\n        // Sounds are not particles.\n        if (emitter.type !== 'SND') {\n          let particles = emitter.alive;\n\n          if (particles) {\n            renderedParticles += particles;\n            renderCalls += 1;\n          }\n        }\n      }\n\n      this.renderedInstances = renderedInstances;\n      this.renderedParticles = renderedParticles;\n      this.renderedBuckets = renderedBuckets;\n      this.renderCalls = renderCalls;\n    }\n  }\n}\n","import handler from './handler';\nimport Model from './model';\nimport ModelInstance from './modelinstance';\nimport Bucket from './bucket';\n\nexport default {\n  handler,\n  Model,\n  ModelInstance,\n  Bucket,\n};\n","import handler from './handler';\nimport Texture from './texture';\n\nexport default {\n  handler,\n  Texture,\n};\n","import shaders from '../../shaders';\n\nexport default {\n  vsGround: `\n    uniform mat4 u_mvp;\n    uniform sampler2D u_heightMap;\n    uniform sampler2D u_heightMap0;\n    uniform vec2 u_size;\n    uniform vec2 u_offset;\n    uniform float u_tilesetHeight;\n    uniform float u_tilesetCount;\n    uniform vec2 u_pixel;\n\n    attribute vec2 a_position;\n    ${shaders.instanceId}\n    attribute vec4 a_textures;\n    attribute vec4 a_variations;\n\n    varying vec2 v_uv[4];\n    varying vec2 v_suv;\n    varying vec3 v_normal;\n\n    vec4 getCell(float tileset, float variation) {\n      float x = variation * 0.03125;\n      float y = tileset * u_tilesetHeight;\n\n      return vec4(x, y, x + 0.03125, y + u_tilesetHeight);\n    }\n    \n    vec2 getUV(vec2 position, float tileset, float variation) {\n      vec2 uv = vec2(position.x, 1.0 - position.y);\n      vec4 cell = getCell(tileset, variation);\n      vec2 cellSize = vec2(1.0 / 32.0, 1.0 / u_tilesetCount);\n      vec2 pixelSize = vec2(2.0 / 2048.0, 2.0 / (64.0 * u_tilesetCount));\n\n      return clamp(cell.xy + uv * cellSize, cell.xy + pixelSize, cell.zw - pixelSize);\n    }\n\n    const float normalDist = 1.0;\n\n    void main() {\n      if (a_textures[0] > 0.5) {\n        v_uv[0] = getUV(a_position, a_textures[0], a_variations[0]);\n        v_uv[1] = getUV(a_position, a_textures[1], a_variations[1]);\n        v_uv[2] = getUV(a_position, a_textures[2], a_variations[2]);\n        v_uv[3] = getUV(a_position, a_textures[3], a_variations[3]);\n\n        vec2 halfPixel = vec2(0.5, 0.5) * u_pixel;\n        vec2 corner = vec2(mod(a_InstanceID, u_size.x), floor(a_InstanceID / u_size.x));\n        vec2 base = floor(corner + a_position);\n        float height = texture2D(u_heightMap, base * u_pixel + halfPixel).COMP1D;\n\n        float hL = texture2D(u_heightMap0, vec2(base - vec2(normalDist, 0.0)) * u_pixel + halfPixel).COMP1D;\n        float hR = texture2D(u_heightMap0, vec2(base + vec2(normalDist, 0.0)) * u_pixel + halfPixel).COMP1D;\n        float hD = texture2D(u_heightMap0, vec2(base - vec2(0.0, normalDist)) * u_pixel + halfPixel).COMP1D;\n        float hU = texture2D(u_heightMap0, vec2(base + vec2(0.0, normalDist)) * u_pixel + halfPixel).COMP1D;\n\n        v_normal = normalize(vec3(hL - hR, hD - hU, normalDist * 2.0));\n\n        v_suv = base / u_size;\n        gl_Position = u_mvp * vec4(base * 128.0 + u_offset, height * 128.0, 1.0);\n      } else {\n        v_uv[0] = vec2(0.0);\n        v_uv[1] = vec2(0.0);\n        v_uv[2] = vec2(0.0);\n        v_uv[3] = vec2(0.0);\n        v_suv = vec2(0.0);\n\n        v_normal = vec3(0.0);\n\n        gl_Position = vec4(0.0);\n      }\n    }\n  `,\n  fsGround: `\n    uniform sampler2D u_tilesets;\n    uniform sampler2D u_shadowMap;\n\n    varying vec2 v_uv[4];\n    varying vec2 v_suv;\n    varying vec3 v_normal;\n\n    const vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\n    vec4 blend(vec4 color, vec2 uv) {\n      vec4 texel = texture2D(u_tilesets, uv).rgba;\n\n      return mix(color, texel, texel.a);\n    }\n\n    void main() {\n      vec4 color = texture2D(u_tilesets, v_uv[0]).rgba;\n      color = blend(color, v_uv[1]);\n      color = blend(color, v_uv[2]);\n      color = blend(color, v_uv[3]);\n\n      float shadow = texture2D(u_shadowMap, v_suv).COMP1D;\n      color.xyz *= clamp(dot(v_normal, lightDirection) + 0.45, 0.0, 1.0);\n      color.xyz *= 1.0 - shadow;\n\n      gl_FragColor = color;\n    }\n  `,\n  vsWater: `\n    uniform mat4 u_mvp;\n    uniform sampler2D u_heightMap;\n    uniform sampler2D u_waterHeightMap;\n    uniform vec2 u_size;\n    uniform vec2 u_pixel;\n    uniform vec2 u_offset;\n    uniform float u_offsetHeight;\n    uniform float u_tileIndex;\n    uniform vec4 u_minDeepColor;\n    uniform vec4 u_maxDeepColor;\n    uniform vec4 u_minShallowColor;\n    uniform vec4 u_maxShallowColor;\n\n    attribute vec2 a_position;\n    ${shaders.instanceId}\n    attribute float a_isWater;\n\n    varying vec2 v_uv;\n    varying vec2 v_position;\n    varying vec4 v_color;\n\n    const float minDepth = 10.0 / 128.0;\n    const float deepLevel = 64.0 / 128.0;\n    const float maxDepth = 72.0 / 128.0;\n\n    void main() {\n      if (a_isWater > 0.5) {\n        vec2 corner = vec2(mod(a_InstanceID, u_size.x), floor(a_InstanceID / u_size.x));\n        vec2 texPosition = (mod(corner, 2.0) + a_position) * 0.5;\n        v_uv = (vec2(mod(u_tileIndex, 16.0), floor(u_tileIndex / 16.0)) + texPosition) / vec2(16.0, 3.0);\n\n        vec2 halfPixel = vec2(0.5, 0.5) * u_pixel;\n        vec2 base = corner + a_position;\n        float height = texture2D(u_heightMap, base * u_pixel + halfPixel).COMP1D;\n        float waterHeight = texture2D(u_waterHeightMap, base * u_pixel + halfPixel).COMP1D + u_offsetHeight;\n        float value = clamp(waterHeight - height, 0.0, 1.0);\n\n        if (value <= deepLevel) {\n          value = max(0.0, value - minDepth) / (deepLevel - minDepth);\n          v_color = mix(u_minShallowColor, u_maxShallowColor, value) / 255.0;\n        } else {\n          value = clamp(value - deepLevel, 0.0, maxDepth - deepLevel) / (maxDepth - deepLevel);\n          v_color = mix(u_minDeepColor, u_maxDeepColor, value) / 255.0;\n        }\n\n        v_position = base * 128.0 + u_offset;\n        gl_Position = u_mvp * vec4(v_position, waterHeight * 128.0, 1.0);\n      } else {\n        v_uv = vec2(0.0);\n        v_color = vec4(0.0);\n\n        gl_Position = vec4(0.0);\n      }\n    }\n  `,\n  fsWater: `\n    uniform sampler2D u_waterMap;\n\n    uniform vec4 u_mapBounds;\n\n    varying vec2 v_position;\n    varying vec2 v_uv;\n    varying vec4 v_color;\n\n    void main() {\n      vec2 d2 = min(v_position - u_mapBounds.xy, u_mapBounds.zw - v_position);\n      float d1 = clamp(min(d2.x, d2.y) / 64.0 + 1.0, 0.0, 1.0) * 0.8 + 0.2;\n      gl_FragColor = texture2D(u_waterMap, v_uv).rgba * vec4(v_color.rgb * d1, v_color.a);\n    }\n  `,\n  vsCliffs: `\n    uniform mat4 u_mvp;\n    uniform sampler2D u_heightMap;\n    uniform vec2 u_pixel;\n    uniform vec2 u_size;\n    uniform vec2 u_centerOffset;\n\n    attribute vec3 a_position;\n    attribute vec3 a_normal;\n    attribute vec2 a_uv1;\n    attribute vec2 a_uv2;\n    attribute vec3 a_instancePosition;\n    attribute float a_instanceTexture;\n\n    varying vec3 v_normal1;\n    varying vec3 v_normal2;\n    varying float v_height;\n    varying vec2 v_uv1;\n    varying vec2 v_uv2;\n    varying vec2 v_suv;\n    varying float v_texture;\n\n    const float normalDist = 1.0;\n\n    void main() {\n      // Half of a pixel in the cliff height map.\n      vec2 halfPixel = u_pixel * 0.5;\n\n      vec3 position = vec3(a_position.y, -a_position.x, a_position.z);\n\n      // The bottom left corner of the map tile this vertex is on.\n      vec2 corner = ((a_instancePosition.xy - u_centerOffset.xy + position.xy) / 128.0);\n\n      float height = texture2D(u_heightMap, corner * u_pixel + halfPixel).COMP1D;\n\n      float hL = texture2D(u_heightMap, vec2(corner - vec2(normalDist, 0.0)) * u_pixel + halfPixel).COMP1D;\n      float hR = texture2D(u_heightMap, vec2(corner + vec2(normalDist, 0.0)) * u_pixel + halfPixel).COMP1D;\n      float hD = texture2D(u_heightMap, vec2(corner - vec2(0.0, normalDist)) * u_pixel + halfPixel).COMP1D;\n      float hU = texture2D(u_heightMap, vec2(corner + vec2(0.0, normalDist)) * u_pixel + halfPixel).COMP1D;\n\n      v_normal1 = normalize(vec3(hL - hR, hD - hU, normalDist * 2.0));\n      v_normal2 = vec3(a_normal.y, -a_normal.x, a_normal.z);\n      v_height = position.z / 128.0;\n\n      v_uv1 = a_uv1;\n      v_uv2 = a_uv2;\n      v_suv = corner / u_size;\n      v_texture = a_instanceTexture;\n\n      gl_Position = u_mvp * vec4(position + vec3(a_instancePosition.xy, a_instancePosition.z + height * 128.0), 1.0);\n    }\n  `,\n  fsCliffs: `\n    uniform sampler2D u_texture1;\n    uniform sampler2D u_texture2;\n    uniform sampler2D u_shadowMap;\n\n    varying vec3 v_normal1;\n    varying vec3 v_normal2;\n    varying float v_height;\n    varying vec2 v_uv1;\n    varying vec2 v_uv2;\n    varying vec2 v_suv;\n    varying float v_texture;\n\n    const vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\n    vec4 sample(int texture) {\n      if (texture == 0) {\n        return texture2D(u_texture1, v_uv1);\n      } else if (texture == 1) {\n        return texture2D(u_texture2, v_uv1);\n      } else {\n        vec4 c1 = texture2D(u_texture1, v_uv1).rgba;\n        vec4 c2 = texture2D(u_texture2, v_uv2).rgba;\n        return mix(c1, c2, c2.a);\n      }\n    }\n\n    void main() {\n      vec4 color = sample(int(v_texture+0.01)).rgba;\n\n      float height = 2.0 * (fract(v_height) - 0.5);\n      height = height * height;\n      vec3 normal = normalize(mix(v_normal2, v_normal1, height));\n\n      float shadow = texture2D(u_shadowMap, v_suv).COMP1D;\n      color.xyz *= clamp(dot(normal, lightDirection) + 0.45, 0.1, 1.0);\n      color.xyz *= 1.0 - shadow;\n\n      gl_FragColor = color;\n    }\n  `,\n  vsUberSplat: `\n    uniform mat4 u_mvp;\n    uniform sampler2D u_heightMap;\n    uniform vec2 u_pixel;\n    uniform vec2 u_size;\n    uniform vec2 u_shadowPixel;\n    uniform vec2 u_centerOffset;\n\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n\n    varying vec2 v_uv;\n    varying vec2 v_suv;\n    varying vec3 v_normal;\n\n    const float normalDist = 0.25;\n\n    void main() {\n      vec2 halfPixel = u_pixel * 0.5;\n\n      vec2 base = (a_position.xy - u_centerOffset) / 128.0;\n      float height = texture2D(u_heightMap, base * u_pixel + halfPixel).COMP1D;\n\n      float hL = texture2D(u_heightMap, vec2(base - vec2(normalDist, 0.0)) * u_pixel + halfPixel).COMP1D;\n      float hR = texture2D(u_heightMap, vec2(base + vec2(normalDist, 0.0)) * u_pixel + halfPixel).COMP1D;\n      float hD = texture2D(u_heightMap, vec2(base - vec2(0.0, normalDist)) * u_pixel + halfPixel).COMP1D;\n      float hU = texture2D(u_heightMap, vec2(base + vec2(0.0, normalDist)) * u_pixel + halfPixel).COMP1D;\n\n      v_normal = normalize(vec3(hL - hR, hD - hU, normalDist * 2.0));\n      v_uv = a_uv;\n      v_suv = base / u_size;\n\n      gl_Position = u_mvp * vec4(a_position.xy, height * 128.0 + a_position.z, 1.0);\n    }\n  `,\n  fsUberSplat: `\n    uniform sampler2D u_texture;\n    uniform sampler2D u_shadowMap;\n    uniform vec4 u_color;\n\n    varying vec2 v_uv;\n    varying vec2 v_suv;\n    varying vec3 v_normal;\n\n    const vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\n    void main() {\n      if (any(bvec4(lessThan(v_uv, vec2(0.0)), greaterThan(v_uv, vec2(1.0))))) {\n        discard;\n      }\n      vec4 color = texture2D(u_texture, clamp(v_uv, 0.0, 1.0)).rgba * u_color;\n\n      float shadow = texture2D(u_shadowMap, v_suv).COMP1D;\n      color.xyz *= clamp(dot(v_normal, lightDirection) + 0.45, 0.0, 1.0);\n      color.xyz *= 1.0 - shadow;\n\n      gl_FragColor = color;\n    }\n  `,\n  vsSimpleModel: `\n    uniform mat4 u_mvp;\n\n    attribute vec3 a_position;\n    attribute vec3 a_normal;\n    attribute vec2 a_uv;\n    attribute vec3 a_instancePosition;\n    attribute vec2 a_instanceRotation;\n    attribute float a_instanceScale;\n\n    varying vec3 v_normal;\n    varying vec2 v_uv;\n\n    ${shaders.quat_transform}\n\n    void main() {\n      v_normal = quat_transform(a_instanceRotation, a_normal);\n      v_uv = a_uv;\n\n      gl_Position = u_mvp * vec4(quat_transform(a_instanceRotation, a_position) * a_instanceScale + a_instancePosition, 1.0);\n    }\n  `,\n  fsSimpleModel: `\n    uniform sampler2D u_texture;\n    uniform bool u_alphaTest;\n    uniform bool u_unshaded;\n\n    varying vec3 v_normal;\n    varying vec2 v_uv;\n\n    const vec3 lightDirection = normalize(vec3(-0.3, -0.3, 0.25));\n\n    void main() {\n      vec4 color = texture2D(u_texture, v_uv).rgba;\n\n      // 1bit Alpha\n      if (u_alphaTest && color.a < 0.75) {\n        discard;\n      }\n\n      if (!u_unshaded) {\n        color *= clamp(dot(v_normal, lightDirection) + 0.45, 0.1, 1.0);\n      }\n\n      gl_FragColor = color;\n    }\n  `,\n};\n","const cliffVariations = {\n  AAAB: 1,\n  AAAC: 1,\n  AABA: 1,\n  AABB: 2,\n  AABC: 0,\n  AACA: 1,\n  AACB: 0,\n  AACC: 1,\n  ABAA: 1,\n  ABAB: 1,\n  ABAC: 0,\n  ABBA: 2,\n  ABBB: 1,\n  ABBC: 0,\n  ABCA: 0,\n  ABCB: 0,\n  ABCC: 0,\n  ACAA: 1,\n  ACAB: 0,\n  ACAC: 1,\n  ACBA: 0,\n  ACBB: 0,\n  ACBC: 0,\n  ACCA: 1,\n  ACCB: 0,\n  ACCC: 1,\n  BAAA: 1,\n  BAAB: 1,\n  BAAC: 0,\n  BABA: 1,\n  BABB: 1,\n  BABC: 0,\n  BACA: 0,\n  BACB: 0,\n  BACC: 0,\n  BBAA: 1,\n  BBAB: 1,\n  BBAC: 0,\n  BBBA: 1,\n  BBCA: 0,\n  BCAA: 0,\n  BCAB: 0,\n  BCAC: 0,\n  BCBA: 0,\n  BCCA: 0,\n  CAAA: 1,\n  CAAB: 0,\n  CAAC: 1,\n  CABA: 0,\n  CABB: 0,\n  CABC: 0,\n  CACA: 1,\n  CACB: 0,\n  CACC: 1,\n  CBAA: 0,\n  CBAB: 0,\n  CBAC: 0,\n  CBBA: 0,\n  CBCA: 0,\n  CCAA: 1,\n  CCAB: 0,\n  CCAC: 1,\n  CCBA: 0,\n  CCCA: 1,\n};\n\nconst cityCliffVariations = {\n  AAAB: 2,\n  AAAC: 1,\n  AABA: 1,\n  AABB: 3,\n  AABC: 0,\n  AACA: 1,\n  AACB: 0,\n  AACC: 3,\n  ABAA: 1,\n  ABAB: 2,\n  ABAC: 0,\n  ABBA: 3,\n  ABBB: 0,\n  ABBC: 0,\n  ABCA: 0,\n  ABCB: 0,\n  ABCC: 0,\n  ACAA: 1,\n  ACAB: 0,\n  ACAC: 2,\n  ACBA: 0,\n  ACBB: 0,\n  ACBC: 0,\n  ACCA: 3,\n  ACCB: 0,\n  ACCC: 1,\n  BAAA: 1,\n  BAAB: 3,\n  BAAC: 0,\n  BABA: 2,\n  BABB: 0,\n  BABC: 0,\n  BACA: 0,\n  BACB: 0,\n  BACC: 0,\n  BBAA: 3,\n  BBAB: 1,\n  BBAC: 0,\n  BBBA: 1,\n  BBCA: 0,\n  BCAA: 0,\n  BCAB: 0,\n  BCAC: 0,\n  BCBA: 0,\n  BCCA: 0,\n  CAAA: 1,\n  CAAB: 0,\n  CAAC: 3,\n  CABA: 0,\n  CABB: 0,\n  CABC: 0,\n  CACA: 2,\n  CACB: 0,\n  CACC: 1,\n  CBAA: 0,\n  CBAB: 0,\n  CBAC: 0,\n  CBBA: 0,\n  CBCA: 0,\n  CCAA: 3,\n  CCAB: 0,\n  CCAC: 1,\n  CCBA: 0,\n  CCCA: 1,\n};\n\n/**\n * @param {string} dir\n * @param {string} tag\n * @param {number} variation\n * @return {number}\n */\nexport default function getCliffVariation(dir, tag, variation) {\n  if (dir === 'Cliffs') {\n    return Math.min(variation, cliffVariations[tag]);\n  } else {\n    return Math.min(variation, cityCliffVariations[tag]);\n  }\n}\n","import MdxParser from '../../../parsers/mdlx/model';\n\n/**\n * A static terrain model.\n */\nexport default class TerrainModel {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {ArrayBuffer} arrayBuffer\n   * @param {Array<number>} locations\n   * @param {Array<number>} textures\n   */\n  constructor(gl, arrayBuffer, locations, textures, loader) {\n    let parser = new MdxParser(arrayBuffer);\n    let geoset = parser.geosets[0];\n    let vertices = geoset.vertices;\n    let normals = geoset.normals;\n    let uvs = geoset.uvSets[0];\n    let uvs2 = geoset.uvSets[1];\n    let faces = geoset.faces;\n    let normalsOffset = vertices.byteLength;\n    let uvsOffset = normalsOffset + normals.byteLength;\n    let uvs2Offset = uvsOffset + uvs.byteLength;\n    let totalLength = uvs2Offset + (uvs2 ? uvs2.byteLength : 0);\n    if (!uvs2) {\n      uvs2Offset = uvsOffset;\n    }\n    let instances = locations.length / 3;\n\n    if (!textures) {\n      this.textures = parser.textures.map(tex => tex.path ? loader.load(tex.path) : null);\n      textures = new Uint8Array(instances);\n      if (uvs2 && parser.textures.length >= 2) {\n        for (let i = 0; i < instances; ++i) {\n          textures[i] = 2;\n        }\n      }\n    }\n\n\n    let vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, totalLength, gl.STATIC_DRAW);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, vertices);\n    gl.bufferSubData(gl.ARRAY_BUFFER, normalsOffset, normals);\n    gl.bufferSubData(gl.ARRAY_BUFFER, uvsOffset, uvs);\n    if (uvs2) gl.bufferSubData(gl.ARRAY_BUFFER, uvs2Offset, uvs2);\n\n    let faceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\n\n    let texturesOffset = locations.length * 4;\n    let locationAndTextureBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, locationAndTextureBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, texturesOffset + instances, gl.STATIC_DRAW);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(locations));\n    gl.bufferSubData(gl.ARRAY_BUFFER, texturesOffset, new Uint8Array(textures));\n\n    /** @member {WebGLBuffer} */\n    this.vertexBuffer = vertexBuffer;\n    /** @member {WebGLBuffer} */\n    this.faceBuffer = faceBuffer;\n    /** @member {number} */\n    this.normalsOffset = normalsOffset;\n    /** @member {number} */\n    this.uvsOffset = uvsOffset;\n    /** @member {number} */\n    this.uvs2Offset = uvs2Offset;\n    /** @member {number} */\n    this.elements = faces.length;\n    /** @member {WebGLBuffer} */\n    this.locationAndTextureBuffer = locationAndTextureBuffer;\n    /** @member {number} */\n    this.texturesOffset = texturesOffset;\n    /** @member {number} */\n    this.instances = instances;\n  }\n\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {ANGLEInstancedArrays} instancedArrays\n   * @param {Object} attribs\n   */\n  render(gl, instancedArrays, attribs, tex) {\n    if (this.textures) {\n      for (let i = 0; i < this.textures.length && i < 2; ++i) {\n        gl.activeTexture(gl.TEXTURE1 + i);\n        if (this.textures[i]) {\n          if (!this.textures[i].webglResource) {\n            return;\n          }\n          gl.bindTexture(gl.TEXTURE_2D, this.textures[i].webglResource);\n          if (!this.disabledMips) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            this.disabledMips = true;\n          }\n        } else {\n          gl.bindTexture(gl.TEXTURE_2D, tex[i].webglResource);\n        }\n      }\n    }\n\n    // Locations and textures.\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.locationAndTextureBuffer);\n    gl.vertexAttribPointer(attribs.a_instancePosition, 3, gl.FLOAT, false, 12, 0);\n    gl.vertexAttribPointer(attribs.a_instanceTexture, 1, gl.UNSIGNED_BYTE, false, 1, this.texturesOffset);\n\n    // Vertices.\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    gl.vertexAttribPointer(attribs.a_position, 3, gl.FLOAT, false, 12, 0);\n    gl.vertexAttribPointer(attribs.a_normal, 3, gl.FLOAT, false, 12, this.normalsOffset);\n    gl.vertexAttribPointer(attribs.a_uv1, 2, gl.FLOAT, false, 8, this.uvsOffset);\n    gl.vertexAttribPointer(attribs.a_uv2, 2, gl.FLOAT, false, 8, this.uvs2Offset);\n\n    // Faces.\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.faceBuffer);\n\n    // Draw.\n    instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, this.elements, gl.UNSIGNED_SHORT, 0, this.instances);\n  }\n}\n","/**\n * A static terrain model.\n */\nexport default class SplatModel {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {ArrayBuffer} arrayBuffer\n   * @param {Array<number>} locations\n   * @param {Array<number>} textures\n   */\n  constructor(gl, path, texture, locations, centerOffset) {\n    this.texture = texture;\n    this.batches = [];\n    this.path = path;\n    this.color = [1, 1, 1, 1];\n    this.locations = locations;\n    const MaxVertices = 65000;\n\n    let vertices = [];\n    let uvs = [];\n    let indices = [];\n    let instances = locations.length / 5;\n    for (let idx = 0; idx < instances; ++idx) {\n      let [x0, y0, x1, y1, zoffs] = locations.slice(idx * 5, idx * 5 + 5);\n\n      let ix0 = Math.floor((x0 - centerOffset[0]) / 128.0);\n      let ix1 = Math.ceil((x1 - centerOffset[0]) / 128.0);\n      let iy0 = Math.floor((y0 - centerOffset[1]) / 128.0);\n      let iy1 = Math.ceil((y1 - centerOffset[1]) / 128.0);\n\n      let newVerts = (iy1 - iy0 + 1) * (ix1 - ix0 + 1);\n      if (newVerts > MaxVertices) {\n        continue;\n      }\n\n      let start = vertices.length / 3, step = ix1 - ix0 + 1;\n      if (start + newVerts > MaxVertices) {\n        this.addBatch(gl, vertices, uvs, indices);\n        vertices.length = 0;\n        uvs.length = 0;\n        indices.length = 0;\n        start = 0;\n      }\n\n      for (let iy = iy0; iy <= iy1; ++iy) {\n        let y = iy * 128.0 + centerOffset[1];\n        for (let ix = ix0; ix <= ix1; ++ix) {\n          let x = ix * 128.0 + centerOffset[0];\n          vertices.push(x, y, zoffs);\n          uvs.push((x - x0) / (x1 - x0), 1.0 - (y - y0) / (y1 - y0));\n        }\n      }\n      for (let i = 0; i < iy1 - iy0; ++i) {\n        for (let j = 0; j < ix1 - ix0; ++j) {\n          let i0 = start + i * step + j;\n          indices.push(i0, i0 + 1, i0 + step, i0 + 1, i0 + step + 1, i0 + step);\n        }\n      }\n    }\n\n    if (indices.length) {\n      this.addBatch(gl, vertices, uvs, indices);\n    }\n  }\n\n  addBatch(gl, vertices, uvs, indices) {\n    let uvsOffset = vertices.length * 4;\n\n    let vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, uvsOffset + uvs.length * 4, gl.STATIC_DRAW);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(vertices));\n    gl.bufferSubData(gl.ARRAY_BUFFER, uvsOffset, new Float32Array(uvs));\n\n    let faceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\n\n    this.batches.push({\n      uvsOffset,\n      vertexBuffer,\n      faceBuffer,\n      elements: indices.length,\n    });\n  }\n\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {Object} attribs\n   */\n  render(gl, uniforms, attribs) {\n    // Texture\n    gl.activeTexture(gl.TEXTURE1);\n    gl.bindTexture(gl.TEXTURE_2D, this.texture.webglResource);\n    gl.uniform4fv(uniforms.u_color, this.color);\n\n    for (let b of this.batches) {\n      // Vertices\n      gl.bindBuffer(gl.ARRAY_BUFFER, b.vertexBuffer);\n      gl.vertexAttribPointer(attribs.a_position, 3, gl.FLOAT, false, 12, 0);\n      gl.vertexAttribPointer(attribs.a_uv, 2, gl.FLOAT, false, 8, b.uvsOffset);\n\n      // Faces.\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, b.faceBuffer);\n\n      // Draw.\n      gl.drawElements(gl.TRIANGLES, b.elements, gl.UNSIGNED_SHORT, 0);\n    }\n  }\n}\n","function sequenceSorter(a, b) {\n  return a.sequence.rarity < b.sequence.rarity;\n}\n\nfunction sequenceMatch(props, name) {\n  let names = name.toLowerCase().split(/[- ]/).map(x => x.trim());\n  return props.every(p => names.includes(p));\n}\n\nfunction filterSequences(type, sequences, props) {\n  let filtered = [];\n\n  for (let i = 0, l = sequences.length; i < l; i++) {\n    let sequence = sequences[i],\n      name = sequence.name.split('-')[0].replace(/\\d/g, '').trim().toLowerCase();\n\n    if (name === type && sequenceMatch(props, sequence.name)) {\n      filtered.push({sequence, index: i});\n    }\n  }\n\n  return filtered;\n}\n\nfunction selectSequence(type, original, animProps) {\n  let props = animProps ? animProps.split(',').filter(x => x.length).map(p => p.toLowerCase()) : [];\n  let sequences = filterSequences(type, original, props);\n  if (!sequences.length) {\n    props.push(type);\n    let first = original.findIndex(x => sequenceMatch(props, x.name));\n    if (first >= 0) {\n      sequences.push({sequence: original[first], index: first});\n    }\n  }\n\n  sequences.sort(sequenceSorter);\n\n  for (var i = 0, l = sequences.length; i < l; i++) {\n    var sequence = sequences[i].sequence;\n    let rarity = sequence.rarity;\n\n    if (rarity === 0) {\n      break;\n    }\n\n    if (Math.random() * 10 > rarity) {\n      return sequences[i];\n    }\n  }\n\n  let sequencesLeft = sequences.length - i;\n  let random = i + Math.floor(Math.random() * sequencesLeft);\n  var sequence = sequences[random];\n\n  return sequence;\n}\n\nfunction standSequence(target, animProps) {\n  let sequences = target.model.sequences;\n  let sequence = selectSequence('stand', sequences, animProps);\n\n  if (sequence) {\n    target.setSequence(sequence.index);\n  }\n};\n\nexport default function standOnRepeat(target, animProps) {\n  target.model.whenLoaded()\n    .then((model) => {\n      standSequence(target, animProps);\n      target.on('seqend', () => standSequence(target, animProps));\n    });\n};\n","import { vec3, quat } from 'gl-matrix';\nimport { VEC3_UNIT_Z } from '../../../common/gl-matrix-addon';\nimport unique from '../../../common/arrayunique';\nimport War3Map from '../../../parsers/w3x/map';\nimport War3MapW3i from '../../../parsers/w3x/w3i/file';\nimport War3MapW3e from '../../../parsers/w3x/w3e/file';\nimport War3MapDoo from '../../../parsers/w3x/doo/file';\nimport War3MapUnitsDoo from '../../../parsers/w3x/unitsdoo/file';\nimport MappedData from '../../../utils/mappeddata';\nimport ModelViewer from '../../viewer';\nimport geoHandler from '../geo/handler';\nimport mdxHandler from '../mdx/handler';\nimport shaders from './shaders';\nimport getCliffVariation from './variations';\nimport TerrainModel from './terrainmodel';\nimport SplatModel from './splatmodel';\n// import SimpleModel from './simplemodel';\nimport standOnRepeat from './standsequence';\nimport { JassRuntime } from '../../../../game/jass2js/JassRuntime';\nimport AppCache from 'data/cache';\nimport tocHandler from '../toc';\nimport React from 'react';\nimport { whenLoaded } from 'mdx/utils/promise';\n\nlet normalHeap1 = vec3.create();\nlet normalHeap2 = vec3.create();\nclass DummyRoot {\n  cache = new AppCache(this);\n  beginMapLoad(name) {\n  }\n  onMapProgress(stage) {\n  }\n  finishMapLoad(id) {\n    debugger;\n  }\n  failMapLoad(error) {\n  }\n  forceUpdate() {\n\n  }\n}\nlet cache = new DummyRoot().cache;\n\n/**\n *\n */\nexport default class War3MapViewer extends ModelViewer {\n  /**\n   * @param {HTMLCanvasElement} canvas\n   * @param {function} wc3PathSolver\n   */\n  constructor(canvas, wc3PathSolver, mapData) {\n    super(canvas);\n    this.vm = new JassRuntime(this);\n    this.batchSize = 256;\n\n    this.on('error', (target, error, reason) => console.error(target, error, reason));\n\n    this.addHandler(geoHandler);\n    this.addHandler(mdxHandler);\n    this.addHandler(tocHandler)\n\n    /** @member {function} */\n    this.wc3PathSolver = wc3PathSolver;\n\n    this.groundShader = this.loadShader('Ground', shaders.vsGround, shaders.fsGround);\n    this.waterShader = this.loadShader('Water', shaders.vsWater, shaders.fsWater);\n    this.cliffShader = this.loadShader('Cliffs', shaders.vsCliffs, shaders.fsCliffs);\n    this.simpleModelShader = this.loadShader('SimpleModel', shaders.vsSimpleModel, shaders.fsSimpleModel);\n    this.uberSplatShader = this.loadShader('UberSplats', shaders.vsUberSplat, shaders.fsUberSplat);\n\n    this.scene = this.addScene();\n    this.camera = this.scene.camera;\n    this.units = [];\n\n    this.waterIndex = 0;\n    this.waterIncreasePerFrame = 0;\n\n    this.anyReady = false;\n\n    this.terrainCliffsAndWaterLoaded = false;\n    this.terrainData = new MappedData();\n    this.cliffTypesData = new MappedData();\n    this.waterData = new MappedData();\n    this.terrainReady = false;\n    this.cliffsReady = false;\n    this.shadowsReady = false;\n\n    const objects = mapData.objects();\n\n    Promise.all([\n      objects,\n      ...['TerrainArt\\\\Terrain.slk', 'TerrainArt\\\\CliffTypes.slk', 'TerrainArt\\\\Water.slk']\n        .map((path) => this.loadGeneric(wc3PathSolver(path)[0], 'text', undefined, path).whenLoaded())\n    ]).then(([obj, terrain, cliffTypes, water]) => {\n      this.terrainObjects = obj.objects;\n      this.terrainCliffsAndWaterLoaded = true;\n      this.terrainData.load(terrain.data);\n      this.cliffTypesData.load(cliffTypes.data);\n      this.waterData.load(water.data);\n      this.emit('terrainloaded');\n    });\n\n    this.doodadsAndDestructiblesLoaded = false;\n    this.doodadsData = new MappedData();\n    this.doodadMetaData = new MappedData();\n    this.destructableMetaData = new MappedData();\n    this.doodads = [];\n    this.terrainDoodads = [];\n    this.doodadsReady = false;\n    this.uberSplats = [];\n    this.uberSplatsReady = false;\n\n    objects.then(obj => {\n      this.doodadsAndDestructiblesLoaded = true;\n      this.doodadsData = obj.objects;\n      this.emit('doodadsloaded');\n    });\n\n    this.unitsAndItemsLoaded = false;\n    this.unitsData = new MappedData();\n    this.unitMetaData = new MappedData();\n    this.uberSplatData = new MappedData();\n    this.units = [];\n    this.unitsReady = false;\n\n    Promise.all([objects, this.loadGeneric(wc3PathSolver('Splats\\\\UberSplatData.slk')[0], 'text', undefined, 'Splats\\\\UberSplatData.slk')])\n      .then(([obj, uberSplatData]) => {\n        this.unitsAndItemsLoaded = true;\n        this.unitsData = obj.objects;\n        this.uberSplatData.load(uberSplatData.data);\n        this.emit('unitsloaded');\n      });\n\n    let gl = this.gl;\n    let shadowMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, shadowMap);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.R8, 4, 4, 0, gl.RED, gl.UNSIGNED_BYTE, new Uint8Array(16));\n    this.shadowMap = shadowMap;\n    this.tocDocument = null;\n  }\n\n  /**\n   *\n   */\n  renderGround() {\n    if (this.terrainReady) {\n      let gl = this.gl;\n      let webgl = this.webgl;\n      let instancedArrays = webgl.extensions.instancedArrays;\n      let shader = this.groundShader;\n      let uniforms = shader.uniforms;\n      let attribs = shader.attribs;\n      let { columns, rows, centerOffset, vertexBuffer, faceBuffer, heightMap, cliffHeightMap, instanceBuffer,\n        instanceCount, textureBuffer, variationBuffer, heightMapSize } = this.terrainRenderData;\n      let tilesetTextures = this.tilesetTextures;\n      let instanceAttrib = attribs.a_InstanceID;\n      let positionAttrib = attribs.a_position;\n      let texturesAttrib = attribs.a_textures;\n      let variationsAttrib = attribs.a_variations;\n\n      gl.disable(gl.BLEND);\n\n      webgl.useShaderProgram(shader);\n\n      gl.uniformMatrix4fv(uniforms.u_mvp, false, this.camera.worldProjectionMatrix);\n      gl.uniform2fv(uniforms.u_offset, centerOffset);\n      gl.uniform2f(uniforms.u_size, columns - 1, rows - 1);\n      gl.uniform2fv(uniforms.u_pixel, heightMapSize);\n      gl.uniform1i(uniforms.u_heightMap, 0);\n      gl.uniform1i(uniforms.u_tilesets, 1);\n      gl.uniform1i(uniforms.u_shadowMap, 2);\n      gl.uniform1i(uniforms.u_heightMap0, 3);\n      gl.uniform1f(uniforms.u_tilesetHeight, 1 / (tilesetTextures.length + 1));\n      gl.uniform1f(uniforms.u_tilesetCount, tilesetTextures.length + 1);\n\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, heightMap);\n\n      gl.activeTexture(gl.TEXTURE1);\n      gl.bindTexture(gl.TEXTURE_2D, this.tilesetsTexture);\n\n      gl.activeTexture(gl.TEXTURE2);\n      gl.bindTexture(gl.TEXTURE_2D, this.shadowMap);\n\n      gl.activeTexture(gl.TEXTURE3);\n      gl.bindTexture(gl.TEXTURE_2D, cliffHeightMap);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n      gl.vertexAttribPointer(positionAttrib, 2, gl.FLOAT, false, 8, 0);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, instanceBuffer);\n      gl.vertexAttribPointer(instanceAttrib, 1, gl.FLOAT, false, 4, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, textureBuffer);\n      gl.vertexAttribPointer(texturesAttrib, 4, gl.UNSIGNED_BYTE, false, 4, 0);\n      instancedArrays.vertexAttribDivisorANGLE(texturesAttrib, 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, variationBuffer);\n      gl.vertexAttribPointer(variationsAttrib, 4, gl.UNSIGNED_BYTE, false, 4, 0);\n      instancedArrays.vertexAttribDivisorANGLE(variationsAttrib, 1);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n\n      instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, 6, gl.UNSIGNED_BYTE, 0, instanceCount);\n\n      instancedArrays.vertexAttribDivisorANGLE(texturesAttrib, 0);\n      instancedArrays.vertexAttribDivisorANGLE(variationsAttrib, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 0);\n    }\n  }\n\n  /**\n   *\n   */\n  renderWater() {\n    if (this.terrainReady) {\n      let gl = this.gl;\n      let webgl = this.webgl;\n      let instancedArrays = webgl.extensions.instancedArrays;\n      let shader = this.waterShader;\n      let uniforms = shader.uniforms;\n      let attribs = shader.attribs;\n      let mapBounds = this.mapBounds;\n      let { columns, rows, centerOffset, vertexBuffer, faceBuffer, heightMap, instanceBuffer, instanceCount, waterHeightMap, waterBuffer, heightMapSize } = this.terrainRenderData;\n      let instanceAttrib = attribs.a_InstanceID;\n      let positionAttrib = attribs.a_position;\n      let isWaterAttrib = attribs.a_isWater;\n\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n      webgl.useShaderProgram(shader);\n\n      gl.uniformMatrix4fv(uniforms.u_mvp, false, this.camera.worldProjectionMatrix);\n      gl.uniform2fv(uniforms.u_offset, centerOffset);\n      gl.uniform2f(uniforms.u_size, columns - 1, rows - 1);\n      gl.uniform2fv(uniforms.u_pixel, heightMapSize);\n      gl.uniform1i(uniforms.u_heightMap, 0);\n      gl.uniform1i(uniforms.u_waterHeightMap, 1);\n      gl.uniform1i(uniforms.u_waterMap, 2);\n      gl.uniform1f(uniforms.u_offsetHeight, this.waterHeightOffset);\n      gl.uniform1f(uniforms.u_tileIndex, this.waterIndex | 0);\n      gl.uniform4fv(uniforms.u_maxDeepColor, this.maxDeepColor);\n      gl.uniform4fv(uniforms.u_minDeepColor, this.minDeepColor);\n      gl.uniform4fv(uniforms.u_maxShallowColor, this.maxShallowColor);\n      gl.uniform4f(uniforms.u_mapBounds, mapBounds[0] * 128.0 + centerOffset[0],\n        mapBounds[2] * 128.0 + centerOffset[1],\n        (columns - mapBounds[1] - 1) * 128.0 + centerOffset[0],\n        (rows - mapBounds[3] - 1) * 128.0 + centerOffset[1]);\n\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, heightMap);\n\n      gl.activeTexture(gl.TEXTURE1);\n      gl.bindTexture(gl.TEXTURE_2D, waterHeightMap);\n\n      gl.activeTexture(gl.TEXTURE2);\n      gl.bindTexture(gl.TEXTURE_2D, this.waterTexture);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n      gl.vertexAttribPointer(positionAttrib, 2, gl.FLOAT, false, 8, 0);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, instanceBuffer);\n      gl.vertexAttribPointer(instanceAttrib, 1, gl.FLOAT, false, 4, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 1);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, waterBuffer);\n      gl.vertexAttribPointer(isWaterAttrib, 1, gl.UNSIGNED_BYTE, false, 1, 0);\n      instancedArrays.vertexAttribDivisorANGLE(isWaterAttrib, 1);\n\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n      instancedArrays.drawElementsInstancedANGLE(gl.TRIANGLES, 6, gl.UNSIGNED_BYTE, 0, instanceCount);\n\n      instancedArrays.vertexAttribDivisorANGLE(isWaterAttrib, 0);\n      instancedArrays.vertexAttribDivisorANGLE(instanceAttrib, 0);\n    }\n  }\n\n  /**\n   *\n   */\n  renderCliffs() {\n    if (this.cliffsReady) {\n      let gl = this.gl;\n      let instancedArrays = gl.extensions.instancedArrays;\n      let webgl = this.webgl;\n      let shader = this.cliffShader;\n      let attribs = shader.attribs;\n      let uniforms = shader.uniforms;\n      let { columns, rows, centerOffset, cliffHeightMap, heightMapSize } = this.terrainRenderData;\n\n      gl.disable(gl.BLEND);\n\n      webgl.useShaderProgram(shader);\n\n      gl.uniformMatrix4fv(uniforms.u_mvp, false, this.camera.worldProjectionMatrix);\n      gl.uniform1i(uniforms.u_heightMap, 0);\n      gl.uniform2f(uniforms.u_size, columns - 1, rows - 1);\n      gl.uniform2fv(uniforms.u_pixel, heightMapSize);\n      gl.uniform2fv(uniforms.u_centerOffset, centerOffset);\n      gl.uniform1i(uniforms.u_texture1, 1);\n      gl.uniform1i(uniforms.u_texture2, 2);\n      gl.uniform1i(uniforms.u_shadowMap, 3);\n\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, cliffHeightMap);\n\n      gl.activeTexture(gl.TEXTURE1);\n      gl.bindTexture(gl.TEXTURE_2D, this.cliffTextures[0].webglResource);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\n      if (this.cliffTextures.length > 1) {\n        gl.activeTexture(gl.TEXTURE2);\n        gl.bindTexture(gl.TEXTURE_2D, this.cliffTextures[1].webglResource);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      }\n\n      gl.activeTexture(gl.TEXTURE3);\n      gl.bindTexture(gl.TEXTURE_2D, this.shadowMap);\n\n      // Set instanced attributes.\n      instancedArrays.vertexAttribDivisorANGLE(attribs.a_instancePosition, 1);\n      instancedArrays.vertexAttribDivisorANGLE(attribs.a_instanceTexture, 1);\n\n      // Render the cliffs.\n      for (let cliff of this.cliffModels) {\n        cliff.render(gl, instancedArrays, attribs, this.cliffTextures);\n      }\n\n      // Clear instanced attributes.\n      instancedArrays.vertexAttribDivisorANGLE(attribs.a_instancePosition, 0);\n      instancedArrays.vertexAttribDivisorANGLE(attribs.a_instanceTexture, 0);\n    }\n  }\n\n  /**\n   *\n   */\n  renderUberSplats() {\n    if (this.terrainReady && this.uberSplatsReady) {\n      let gl = this.gl;\n      let webgl = this.webgl;\n      let shader = this.uberSplatShader;\n      let attribs = shader.attribs;\n      let uniforms = shader.uniforms;\n      let { columns, rows, centerOffset, heightMap, heightMapSize } = this.terrainRenderData;\n\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n      gl.blendEquation(gl.FUNC_ADD);\n\n      webgl.useShaderProgram(shader);\n\n      gl.uniformMatrix4fv(uniforms.u_mvp, false, this.camera.worldProjectionMatrix);\n      gl.uniform1i(uniforms.u_heightMap, 0);\n      gl.uniform2f(uniforms.u_size, columns - 1, rows - 1);\n      gl.uniform2fv(uniforms.u_pixel, heightMapSize);\n      gl.uniform2fv(uniforms.u_centerOffset, centerOffset);\n      gl.uniform1i(uniforms.u_texture, 1);\n      gl.uniform1i(uniforms.u_shadowMap, 2);\n\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, heightMap);\n\n      gl.activeTexture(gl.TEXTURE2);\n      gl.bindTexture(gl.TEXTURE_2D, this.shadowMap);\n\n      // Render the cliffs.\n      for (let splat of this.uberSplatModels) {\n        splat.render(gl, uniforms, attribs);\n      }\n    }\n  }\n\n  // /**\n  //  * \n  //  */\n  // renderDoodads(opaque) {\n  //   if (this.doodadsReady) {\n  //     let gl = this.gl;\n  //     let instancedArrays = gl.extensions.instancedArrays;\n  //     let webgl = this.webgl;\n  //     let shader = this.simpleModelShader;\n  //     let attribs = shader.attribs;\n  //     let uniforms = shader.uniforms;\n\n  //     webgl.useShaderProgram(shader);\n\n  //     gl.uniformMatrix4fv(uniforms.u_mvp, false, this.camera.worldProjectionMatrix);\n  //     gl.uniform1i(uniforms.u_texture, 0);\n\n  //     gl.activeTexture(gl.TEXTURE0);\n\n  //     // Enable instancing.\n  //     instancedArrays.vertexAttribDivisorANGLE(attribs.a_instancePosition, 1);\n  //     instancedArrays.vertexAttribDivisorANGLE(attribs.a_instanceRotation, 1);\n  //     instancedArrays.vertexAttribDivisorANGLE(attribs.a_instanceScale, 1);\n\n  //     // Render the dooadads.\n  //     for (let doodad of this.doodads) {\n  //       if (opaque) {\n  //         doodad.renderOpaque(gl, instancedArrays, uniforms, attribs);\n  //       } else {\n  //         doodad.renderTranslucent(gl, instancedArrays, uniforms, attribs);\n  //       }\n  //     }\n\n  //     // Render the terrain doodads.\n  //     for (let doodad of this.terrainDoodads) {\n  //       if (opaque) {\n  //         doodad.renderOpaque(gl, instancedArrays, uniforms, attribs);\n  //       } else {\n  //         doodad.renderTranslucent(gl, instancedArrays, uniforms, attribs);\n  //       }\n  //     }\n\n  //     // Disable instancing.\n  //     instancedArrays.vertexAttribDivisorANGLE(attribs.a_instancePosition, 0);\n  //     instancedArrays.vertexAttribDivisorANGLE(attribs.a_instanceRotation, 0);\n  //     instancedArrays.vertexAttribDivisorANGLE(attribs.a_instanceScale, 0);\n  //   }\n  // }\n\n  /**\n   * Render the map.\n   */\n  render() {\n    if (this.anyReady) {\n      this.gl.viewport(...this.camera.rect);\n\n      this.renderGround();\n      this.renderCliffs();\n      // this.renderDoodads(true);\n      super.renderOpaque();\n      // this.renderDoodads(false);\n      this.renderUberSplats();\n      this.renderWater();\n      super.renderTranslucent();\n    }\n  }\n\n  /**\n   * Update the map.\n   */\n  update() {\n    if (this.anyReady) {\n      if (this.waterTextures) {\n        this.waterIndex += this.waterIncreasePerFrame;\n        if (this.waterIndex >= this.waterTextures.length) {\n          this.waterIndex = 0;\n        }\n      }\n\n      super.update();\n    }\n  }\n\n  /**\n   * @param {*} buffer \n   */\n  async loadMap(buffer) {\n    // Readonly mode to optimize memory usage.\n    this.mapMpq = new War3Map(buffer, true);\n\n    let wc3PathSolver = this.wc3PathSolver;\n\n    let w3i = new War3MapW3i(this.mapMpq.get('war3map.w3i').arrayBuffer());\n    this.w3i = w3i;\n    this.tileset = w3i.tileset;\n    this.editorVersion = w3i.editorVersion;\n    this.mapBounds = w3i.cameraBoundsComplements;\n    this.mapFlags = w3i.flags;\n\n    this.emit('maploaded');\n\n    this.mapPathSolver = (path) => {\n      // MPQ paths have backwards slashes...always? Don't know.\n      //let mpqPath = path.replace(/\\//g, '\\\\');\n\n      // If the file is in the map, return it.\n      // Otherwise, if it's in the tileset MPQ, return it from there.\n      //let file = this.mapMpq.get(mpqPath);\n      //if (file) {\n      //  return [file.arrayBuffer(), path.substr(path.lastIndexOf('.')), false];\n      //}\n\n      // Try to get the file from the game MPQs.\n      return wc3PathSolver(path, this.tileset);\n    };\n\n    let w3e = new War3MapW3e(this.mapMpq.get('war3map.w3e').arrayBuffer());\n\n    this.corners = w3e.corners;\n    this.centerOffset = w3e.centerOffset;\n    this.mapSize = w3e.mapSize;\n\n    this.calculateRamps();\n\n    const source = this.mapMpq.get('war3map.doo');\n    if (!source) {\n      return;\n    }\n    this.doodads = new War3MapDoo(source.arrayBuffer());\n\n    this.emit('tilesetloaded');\n\n    if (this.terrainCliffsAndWaterLoaded) {\n      this.loadTerrainCliffsAndWater(w3e);\n    } else {\n      this.once('terrainloaded', () => this.loadTerrainCliffsAndWater(w3e));\n    }\n\n    let doodadsLoaded, unitsLoaded;\n\n    this.shadows = [];\n    this.shadowTextures = {};\n\n    if (this.doodadsAndDestructiblesLoaded) {\n      this.loadDoodadsAndDestructibles();\n      doodadsLoaded = Promise.resolve();\n    } else {\n      doodadsLoaded = new Promise((resolve, reject) => {\n        this.once('doodadsloaded', () => {\n          this.loadDoodadsAndDestructibles()\n          resolve();\n        });\n      });\n    }\n\n    if (this.unitsAndItemsLoaded) {\n      this.loadUnitsAndItems();\n      unitsLoaded = Promise.resolve();\n    } else {\n      unitsLoaded = new Promise((resolve, reject) => {\n        this.once('unitsloaded', () => {\n          this.loadUnitsAndItems();\n          resolve();\n        });\n      });\n    }\n    this.loadGameUI();\n    // Promise.all([doodadsLoaded, unitsLoaded]).then(() => {\n    //   this.initShadows();\n    //   this.loadGameScripts();\n    // });\n  }\n\n\n\n  async loadGameScripts() {\n    return await Promise.all(['Scripts\\\\common.j', 'Scripts\\\\Blizzard.j']\n      .map(id => this.load(id).whenLoaded()));\n  }\n  async loadGameUI() {\n    return await Promise.all([\"UI\\\\FrameDef\\\\FrameDef.toc\"]\n      .map(id => this.load(id).whenLoaded()));\n  }\n\n  async runMapScript() {\n    // let [commonj, blizzardj] = await this.loadGameScripts();\n    // this.vm = new JassRuntime(this);\n    // const contents = await this.loadPlain(\"UI\\\\FrameDef\\\\FrameDef.toc\");\n    // const fdfs = contents.split(\"\\n\").filter((v) => v.length > 0);\n    // fdfs.forEach((fdf) => {\n    //   if (this.vm.natives.loadedFdfs.has(fdf.toLowerCase())) return;\n    //   this.vm.natives.loadedFdfs.add(fdf.toLowerCase());\n    //   return this.app.loadPlain(fdf).then(contents => loadFdf(this.app.vm, contents))\n    // });\n    // await this.vm.natives.BlzLoadTOCFile(\"UI\\\\FrameDef\\\\FrameDef.toc\");\n    // await vm.load(commonj, 'commonj.j');\n    // await vm.load(blizzardj, 'blizzardj.j');\n    // const buffer = this.mapMpq.getScript();\n    // await vm.load(buffer, 'war3map.j');\n    // console.log('jassvm', \"Enter vm::config.\")\n    // await vm.config()\n    // console.log('jassvm', \"Exit vm::config.\")\n    // console.log('jassvm', \"Enter vm::main.\")\n    // await vm.main();\n    // console.log('jassvm', \"Exit vm::main.\")\n  }\n\n  async loadPlain(name, type = 'text') {\n    const response = await fetch(cache.binary(name));\n    return await (response.ok ? response[type]() : Promise.reject());\n  }\n\n  /**\n   * \n   * @param {*} modifications \n   */\n  loadDoodadsAndDestructibles() {\n    let scene = this.scene;\n    let doo = this.doodads;\n\n    // Collect the doodad and destructible data.\n    for (let doodad of doo.doodads) {\n      let row = this.doodadsData.find(row => row.id === doodad.id);\n      if (!row) continue;\n      let type = row.type;\n      row = row.data;\n      let file = row.file;\n      let numVar = parseInt(row.numvar || \"0\");\n\n      if (file.endsWith('.mdl')) {\n        file = file.slice(0, -4);\n      }\n\n      let fileVar = file;\n\n      file += '.mdx';\n\n      if (numVar > 1) {\n        fileVar += Math.min(doodad.variation, numVar - 1);\n      }\n\n      fileVar += '.mdx';\n\n      let color = [255, 255, 255];\n\n      if (type === 'destructible') {\n        color[0] = parseInt(row.colorr);\n        color[1] = parseInt(row.colorg);\n        color[2] = parseInt(row.colorb);\n      }\n\n      if (type === 'destructible' && row.shadow && row.shadow !== \"_\") {\n        this.addShadow(row.shadow, doodad.location[0], doodad.location[1]);\n      }\n\n      // First see if the model is local.\n      // Doodads refering to local models may have invalid variations, so if the variation doesn't exist, try without a variation.\n      let mpqFile = this.mapMpq.get(fileVar) || this.mapMpq.get(file);\n      let model;\n\n      if (mpqFile) {\n        model = this.load(mpqFile.name);\n      } else {\n        model = this.load(fileVar);\n      }\n\n      model.whenLoaded().then(() => {\n        let instance = model.addInstance();\n        if (row.texfile) {\n          const repl = model.replaceables.indexOf(parseInt(row.texid || \"0\"));\n          if (repl >= 0) {\n            let tex = row.texfile;\n            if (tex.lastIndexOf('.') <= Math.max(tex.lastIndexOf('/'), tex.lastIndexOf('\\\\'))) {\n              tex += '.blp';\n            }\n            instance.setTexture(model.textures[repl], this.load(tex));\n          }\n        }\n        instance.move(doodad.location);\n        instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, doodad.angle));\n        instance.scale(doodad.scale);\n        instance.setScene(scene);\n        if (!this.inPlayableArea(doodad.location[0], doodad.location[1])) {\n          color[0] = Math.round(color[0] * 51 / 255);\n          color[1] = Math.round(color[1] * 51 / 255);\n          color[2] = Math.round(color[2] * 51 / 255);\n        }\n        instance.setVertexColor(color);\n\n        standOnRepeat(instance);\n      });\n\n    }\n\n    this.doodadsReady = true;\n    this.anyReady = true;\n  }\n\n  /**\n   * \n   * @param {*} modifications \n   */\n  loadUnitsAndItems(modifications) {\n    const source = this.mapMpq.get('war3mapUnits.doo');\n    if (!source) {\n      return;\n    }\n    let unitsDoo = new War3MapUnitsDoo(source.arrayBuffer());\n    let scene = this.scene;\n    let splats = {};\n\n    // Collect the units and items data.\n    for (let unit of unitsDoo.units) {\n      let path;\n\n      // Hardcoded?\n      let location = unit.location;\n      let scale = unit.scale;\n      let teamColor = unit.player;\n      let animProps = \"\";\n      // fix team colors for older versions\n      if (this.editorVersion < 0x17A8 && teamColor >= 12) {\n        teamColor += 12;\n      }\n      let row = null;\n      let color = [255, 255, 255];\n\n      if (unit.id === 'sloc') {\n        path = 'Objects\\\\StartLocation\\\\StartLocation.mdx';\n      } else {\n        row = this.unitsData.find(row => row.id === unit.id);\n        if (!row) continue;\n        const type = row.type;\n        row = row.data;\n\n        path = row.file;\n\n        if (path.endsWith('.mdl')) {\n          path = path.slice(0, -4);\n        }\n\n        scale = vec3.clone(unit.scale);\n        vec3.scale(scale, scale, row.modelscale);\n\n        let rowTeamColor = row.teamcolor && parseInt(row.teamcolor);\n        if (row.teamcolor && rowTeamColor >= 0) {\n          teamColor = rowTeamColor;\n        }\n\n        if (type === 'unit') {\n          color[0] = parseInt(row.red);\n          color[1] = parseInt(row.green);\n          color[2] = parseInt(row.blue);\n        } else if (type === 'item') {\n          color[0] = parseInt(row.colorr);\n          color[1] = parseInt(row.colorg);\n          color[2] = parseInt(row.colorb);\n        }\n\n        let rowMoveHeight = row.moveheight && parseFloat(row.moveheight);\n        if (rowMoveHeight) {\n          location = vec3.clone(unit.location);\n          location[2] += rowMoveHeight;\n        }\n\n        path += '.mdx';\n\n        let splat = row.ubersplat && this.uberSplatData.getRow(row.ubersplat);\n        if (splat) {\n          let texture = `${splat.Dir}\\\\${splat.file}.blp`;\n          if (!splats[texture]) {\n            splats[texture] = { locations: [], opacity: 1 };\n          }\n          let x = unit.location[0], y = unit.location[1], s = splat.Scale;\n          splats[texture].locations.push(x - s, y - s, x + s, y + s, 1);\n        }\n\n        if (row.unitshadow && row.unitshadow !== \"_\") {\n          let texture = `ReplaceableTextures\\\\Shadows\\\\${row.unitshadow}.blp`;\n          let shadowX = parseFloat(row.shadowx || \"0\");\n          let shadowY = parseFloat(row.shadowy || \"0\");\n          let shadowW = parseFloat(row.shadoww || \"0\");\n          let shadowH = parseFloat(row.shadowh || \"0\");\n          if (!splats[texture]) {\n            splats[texture] = { locations: [], opacity: 0.5 };\n          }\n          let x = unit.location[0] - shadowX, y = unit.location[1] - shadowY;\n          splats[texture].locations.push(x, y, x + shadowW, y + shadowH, 3);\n        }\n\n        if (row.buildingshadow && row.buildingshadow !== \"_\") {\n          this.addShadow(row.buildingshadow, unit.location[0], unit.location[1]);\n        }\n\n        animProps = row.animprops;\n      }\n\n      if (path) {\n        let model = this.load(path);\n        let instance = model.addInstance();\n\n        //let normal = this.groundNormal([], unit.location[0], unit.location[1]);\n\n        instance.move(location);\n        instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, unit.angle));\n        instance.scale(scale);\n        instance.setTeamColor(teamColor);\n        instance.setScene(scene);\n        if (!this.inPlayableArea(location[0], location[1])) {\n          color[0] = Math.round(color[0] * 51 / 255);\n          color[1] = Math.round(color[1] * 51 / 255);\n          color[2] = Math.round(color[2] * 51 / 255);\n        }\n        instance.setVertexColor(color);\n\n        if (row) {\n          this.units.push({ unit, instance, location, radius: parseFloat(row.scale || \"0\") * 36 });\n        }\n\n        standOnRepeat(instance, animProps);\n      } else {\n        console.log('Unknown unit ID', unit.id, unit)\n      }\n    }\n    this.unitsReady = true;\n    this.anyReady = true;\n    this.createUberSplatModes(splats);\n  }\n  createUberSplatModes(splats) {\n    let splatPromises = Object.entries(splats).map((splat) => {\n      let path = splat[0];\n      let { locations, opacity } = splat[1];\n\n      return this.load(path).whenLoaded()\n        .then((texture) => {\n          let splat = new SplatModel(this.gl, path, texture, locations, this.centerOffset);\n          splat.color[3] = opacity;\n          return splat;\n        });\n    });\n\n    Promise.all(splatPromises).then(models => {\n      this.uberSplatModels = models;\n      this.uberSplatsReady = true;\n    });\n  }\n\n  createUnit(id, x, y, face) {\n    const source = this.mapMpq.get('war3mapUnits.doo');\n    if (!source) {\n      return;\n    }\n    let unitsDoo = new War3MapUnitsDoo(source.arrayBuffer());\n    let scene = this.scene;\n    let splats = this.splats || {};\n    let unitInst = {};\n    // Collect the units and items data.\n    for (let unit of unitsDoo.units) {\n      if (unit.id !== id) {\n        continue;\n      }\n      let path;\n\n      // Hardcoded?\n      let location = vec3.fromValues(x, y, unit.location.z);\n      let scale = unit.scale;\n      let teamColor = unit.player;\n      let animProps = \"\";\n      // fix team colors for older versions\n      if (this.editorVersion < 0x17A8 && teamColor >= 12) {\n        teamColor += 12;\n      }\n      let row = null;\n      let color = [255, 255, 255];\n\n      if (unit.id === 'sloc') {\n        path = 'Objects\\\\StartLocation\\\\StartLocation.mdx';\n      } else {\n        row = this.unitsData.find(row => row.id === unit.id);\n        if (!row) continue;\n        const type = row.type;\n        row = row.data;\n\n        path = row.file;\n\n        if (path.endsWith('.mdl')) {\n          path = path.slice(0, -4);\n        }\n\n        scale = vec3.clone(unit.scale);\n        vec3.scale(scale, scale, row.modelscale);\n\n        let rowTeamColor = row.teamcolor && parseInt(row.teamcolor);\n        if (row.teamcolor && rowTeamColor >= 0) {\n          teamColor = rowTeamColor;\n        }\n\n        if (type === 'unit') {\n          color[0] = parseInt(row.red);\n          color[1] = parseInt(row.green);\n          color[2] = parseInt(row.blue);\n        } else if (type === 'item') {\n          color[0] = parseInt(row.colorr);\n          color[1] = parseInt(row.colorg);\n          color[2] = parseInt(row.colorb);\n        }\n\n        let rowMoveHeight = row.moveheight && parseFloat(row.moveheight);\n        if (rowMoveHeight) {\n          location = vec3.clone(unit.location);\n          location[2] += rowMoveHeight;\n        }\n\n        path += '.mdx';\n\n        let splat = row.ubersplat && this.uberSplatData.getRow(row.ubersplat);\n        if (splat) {\n          let texture = `${splat.Dir}\\\\${splat.file}.blp`;\n          if (!splats[texture]) {\n            splats[texture] = { locations: [], opacity: 1 };\n          }\n          let x = unit.location[0], y = unit.location[1], s = splat.Scale;\n          splats[texture].locations.push(x - s, y - s, x + s, y + s, 1);\n        }\n\n        if (row.unitshadow && row.unitshadow !== \"_\") {\n          let texture = `ReplaceableTextures\\\\Shadows\\\\${row.unitshadow}.blp`;\n          let shadowX = parseFloat(row.shadowx || \"0\");\n          let shadowY = parseFloat(row.shadowy || \"0\");\n          let shadowW = parseFloat(row.shadoww || \"0\");\n          let shadowH = parseFloat(row.shadowh || \"0\");\n          if (!splats[texture]) {\n            splats[texture] = { locations: [], opacity: 0.5 };\n          }\n          let x = unit.location[0] - shadowX, y = unit.location[1] - shadowY;\n          // todo: How to update when unit removed?\n          splats[texture].locations.push(x, y, x + shadowW, y + shadowH, 3);\n        }\n\n        if (row.buildingshadow && row.buildingshadow !== \"_\") {\n          this.addShadow(row.buildingshadow, unit.location[0], unit.location[1]);\n        }\n\n        animProps = row.animprops;\n      }\n\n      if (path) {\n        let model = this.load(path);\n        let instance = model.addInstance();\n        //let normal = this.groundNormal([], unit.location[0], unit.location[1]);\n\n        instance.move(location);\n        instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, unit.angle));\n        instance.scale(scale);\n        instance.setTeamColor(teamColor);\n        instance.setScene(scene);\n        if (!this.inPlayableArea(location[0], location[1])) {\n          color[0] = Math.round(color[0] * 51 / 255);\n          color[1] = Math.round(color[1] * 51 / 255);\n          color[2] = Math.round(color[2] * 51 / 255);\n        }\n        instance.setVertexColor(color);\n        if (row) {\n          unitInst = { unit, instance, location, radius: parseFloat(row.scale || \"0\") * 36 };\n          this.units.push(unitInst);\n        }\n\n        standOnRepeat(instance, animProps);\n      } else {\n        console.log('Unknown unit ID', unit.id, unit)\n      }\n    }\n    if (unitInst) {\n      this.anyReady = true;\n      // this.createUberSplatModes();\n      // let ubsModels = this.uberSplatModels || [];\n      // let splatPromises = Object.entries(splats).map((splat) => {\n      //   let path = splat[0];\n      //   let { locations, opacity } = splat[1];\n      //   let idx = ubsModels.findIndex(x => x.path == path);\n      //   if (idx != -1) {\n      //     locations = locations.concat(ubsModels[idx].locations);\n      //   }\n      //   return this.load(path)\n      //     .then((texture) => {\n      //       let splat = new SplatModel(this.gl, path, texture, locations, this.centerOffset);\n      //       splat.color[3] = opacity;\n      //       return splat;\n      //     }).then((model) => {\n      //       ubsModels.push(model);\n      //       if (idx != -1)\n      //         ubsModels.splice(idx, 1)\n      //     });\n      // });\n      // Promise.all(splatPromises).then(() => {\n      //   this.uberSplatModels = ubsModels;\n      //   this.uberSplatsReady = true;\n      // })\n    }\n    return unitInst;\n  }\n\n  /**\n   *\n   */\n  async loadTerrainCliffsAndWater(w3e) {\n    let tileset = w3e.tileset;\n\n    this.tilesets = [];\n    this.tilesetTextures = [];\n\n    for (let groundTileset of w3e.groundTilesets) {\n      let row = this.terrainData.getRow(groundTileset);\n      if (!row) {\n        continue;\n      }\n\n      this.tilesets.push(row);\n      this.tilesetTextures.push(this.load(`${row.dir}\\\\${row.file}.blp`));\n    }\n\n    let blights = {\n      A: 'Ashen',\n      B: 'Barrens',\n      C: 'Felwood',\n      D: 'Cave',\n      F: 'Lordf',\n      G: 'Dungeon',\n      I: 'Ice',\n      J: 'DRuins',\n      K: 'Citadel',\n      L: 'Lords',\n      N: 'North',\n      O: 'Outland',\n      Q: 'VillageFall',\n      V: 'Village',\n      W: 'Lordw',\n      X: 'Village',\n      Y: 'Village',\n      Z: 'Ruins',\n    };\n\n    this.blightTextureIndex = this.tilesetTextures.length;\n    this.tilesetTextures.push(this.load(`TerrainArt\\\\Blight\\\\${blights[tileset]}_Blight.blp`));\n\n    this.cliffTilesets = [];\n    this.cliffTextures = [];\n\n    for (let cliffTileset of w3e.cliffTilesets) {\n      let row = this.cliffTypesData.getRow(cliffTileset);\n      if (!row) {\n        continue;\n      }\n\n      this.cliffTilesets.push(row);\n      this.cliffTextures.push(this.load(`${row.texDir}\\\\${row.texFile}.blp`));\n    }\n\n    let waterRow = this.waterData.getRow(`${tileset}Sha`);\n\n    this.waterHeightOffset = waterRow.height;\n    this.waterIncreasePerFrame = waterRow.texRate / 60;\n    this.waterTextures = [];\n    this.maxDeepColor = new Float32Array([waterRow.Dmax_R, waterRow.Dmax_G, waterRow.Dmax_B, waterRow.Dmax_A]);\n    this.minDeepColor = new Float32Array([waterRow.Dmin_R, waterRow.Dmin_G, waterRow.Dmin_B, waterRow.Dmin_A]);\n    this.maxShallowColor = new Float32Array([waterRow.Smax_R, waterRow.Smax_G, waterRow.Smax_B, waterRow.Smax_A]);\n    this.minShallowColor = new Float32Array([waterRow.Smin_R, waterRow.Smin_G, waterRow.Smin_B, waterRow.Smin_A]);\n\n    for (let i = 0, l = waterRow.numTex; i < l; i++) {\n      this.waterTextures.push(this.load(`${waterRow.texFile}${i < 10 ? '0' : ''}${i}.blp`));\n    }\n    await whenLoaded([...this.tilesetTextures, ...this.waterTextures]);\n\n    let gl = this.gl;\n\n    this.createTilesetsAndWaterTextures();\n\n    let corners = w3e.corners;\n    let [columns, rows] = this.mapSize;\n    let centerOffset = this.centerOffset;\n    let instanceCount = (columns - 1) * (rows - 1);\n    let cliffHeights = new Float32Array(columns * rows);\n    let cornerHeights = new Float32Array(columns * rows);\n    let waterHeights = new Float32Array(columns * rows);\n    let cornerTextures = new Uint8Array(instanceCount * 4);\n    let cornerVariations = new Uint8Array(instanceCount * 4);\n    let waterFlags = new Uint8Array(instanceCount);\n    let instance = 0;\n    let cliffs = {};\n\n    this.columns = columns - 1;\n    this.rows = rows - 1;\n\n    let cliffPathTex = {};\n    for (let doodad of this.doodads.terrainDoodads) {\n      let row = this.terrainObjects.find(row => row.id === doodad.id);\n      if (!row) continue;\n      row = row.data;\n      if (!cliffPathTex[row.pathtex]) {\n        cliffPathTex[row.pathtex] = this.load(row.pathtex);\n      }\n    }\n    await whenLoaded(Object.values(cliffPathTex));\n    for (let doodad of this.doodads.terrainDoodads) {\n      let row = this.terrainObjects.find(row => row.id === doodad.id);\n      if (!row) continue;\n      row = row.data;\n      let pathTex = cliffPathTex[row.pathtex];\n      if (!pathTex || !pathTex.imageData) {\n        continue;\n      }\n      let path = row.file + \".mdx\";\n      if (!cliffs[path]) {\n        cliffs[path] = { locations: [] };\n      }\n      let [x, y] = doodad.location;\n      let w = pathTex.originalData.width >> 2, h = pathTex.originalData.height >> 2;\n      for (let i = 0; i < h; ++i) {\n        for (let j = 0; j < w; ++j) {\n          corners[y + i][x + j].rampType = -1;\n        }\n      }\n      cliffs[path].locations.push((x + w / 2) * 128.0 + centerOffset[0], (y + h / 2) * 128.0 + centerOffset[1], (corners[y][x].layerHeight - 2) * 128.0);\n    }\n\n    for (let y = 0; y < rows; y++) {\n      for (let x = 0; x < columns; x++) {\n        let bottomLeft = corners[y][x];\n        let index = y * columns + x;\n\n        cliffHeights[index] = bottomLeft.groundHeight;\n        cornerHeights[index] = bottomLeft.groundHeight + bottomLeft.layerHeight + (bottomLeft.rampAdjust || 0) - 2;\n        waterHeights[index] = bottomLeft.waterHeight;\n\n        bottomLeft.depth = bottomLeft.water ? this.waterHeightOffset + bottomLeft.waterHeight - cornerHeights[index] : 0;\n\n        if (y < rows - 1 && x < columns - 1) {\n          // Water can be used with cliffs and normal corners, so store water state regardless.\n          waterFlags[instance] = this.isWater(x, y);\n\n          // Is this a cliff, or a normal corner?\n          if (bottomLeft.rampType) {\n            if (bottomLeft.rampType > 0) {\n              let cliffTexture = bottomLeft.cliffTexture;\n              if (cliffTexture === 15) {\n                cliffTexture = 1;\n              }\n              let cliffRow = this.cliffTilesets[cliffTexture];\n              let dir = cliffRow.rampModelDir;\n              let path = `Doodads\\\\Terrain\\\\${dir}\\\\${dir}${bottomLeft.rampName}0.mdx`;\n\n              let base = bottomLeft.layerHeight;\n              if (bottomLeft.cliffType === 1) {\n                base = Math.min(base, corners[y + 2][x].layerHeight, corners[y][x + 1].layerHeight, corners[y + 2][x + 1].layerHeight);\n              } else {\n                base = Math.min(base, corners[y + 1][x].layerHeight, corners[y][x + 2].layerHeight, corners[y + 1][x + 2].layerHeight);\n              }\n\n              if (!cliffs[path]) {\n                cliffs[path] = { locations: [], textures: [] };\n              }\n              cliffs[path].locations.push(x * 128 + centerOffset[0], y * 128 + centerOffset[1], (base - 2) * 128);\n              cliffs[path].textures.push(cliffTexture);\n            }\n          } else if (this.isCliff(x, y)) {\n            let bottomLeftLayer = bottomLeft.layerHeight;\n            let bottomRightLayer = corners[y][x + 1].layerHeight;\n            let topLeftLayer = corners[y + 1][x].layerHeight;\n            let topRightLayer = corners[y + 1][x + 1].layerHeight;\n            let base = Math.min(bottomLeftLayer, bottomRightLayer, topLeftLayer, topRightLayer);\n            let fileName = this.cliffFileName(bottomLeftLayer, bottomRightLayer, topLeftLayer, topRightLayer, base);\n\n            if (fileName !== 'AAAA') {\n              let cliffTexture = bottomLeft.cliffTexture;\n\n              // ?\n              if (cliffTexture === 15) {\n                cliffTexture = 1;\n              }\n\n              let cliffRow = this.cliffTilesets[cliffTexture];\n              let dir = cliffRow.cliffModelDir;\n              let path = `Doodads\\\\Terrain\\\\${dir}\\\\${dir}${fileName}${getCliffVariation(dir, fileName, bottomLeft.cliffVariation)}.mdx`;\n\n              if (!cliffs[path]) {\n                cliffs[path] = { locations: [], textures: [] };\n              }\n\n              cliffs[path].locations.push(x * 128 + centerOffset[0], y * 128 + centerOffset[1], (base - 2) * 128);\n              cliffs[path].textures.push(cliffTexture);\n            }\n          } else {\n            let bottomLeftTexture = this.cornerTexture(x, y);\n            let bottomRightTexture = this.cornerTexture(x + 1, y);\n            let topLeftTexture = this.cornerTexture(x, y + 1);\n            let topRightTexture = this.cornerTexture(x + 1, y + 1);\n            let textures = unique([bottomLeftTexture, bottomRightTexture, topLeftTexture, topRightTexture]).sort();\n\n            cornerTextures[instance * 4] = textures[0] + 1;\n            cornerVariations[instance * 4] = this.getVariation(textures[0], bottomLeft.groundVariation);\n\n            textures.shift();\n\n            for (let i = 0, l = textures.length; i < l; i++) {\n              let texture = textures[i];\n              let bitset = 0;\n\n              if (bottomRightTexture === texture) {\n                bitset |= 0b0001;\n              }\n\n              if (bottomLeftTexture === texture) {\n                bitset |= 0b0010;\n              }\n\n              if (topRightTexture === texture) {\n                bitset |= 0b0100;\n              }\n\n              if (topLeftTexture === texture) {\n                bitset |= 0b1000;\n              }\n\n              cornerTextures[instance * 4 + 1 + i] = texture + 1;\n              cornerVariations[instance * 4 + 1 + i] = bitset;\n            }\n          }\n\n          instance += 1;\n        }\n      }\n    }\n\n    let vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), gl.STATIC_DRAW);\n\n    let faceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, faceBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint8Array([0, 1, 2, 1, 3, 2]), gl.STATIC_DRAW);\n\n    let cliffHeightMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, cliffHeightMap);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.R32F, columns, rows, 0, gl.RED, gl.FLOAT, cliffHeights);\n\n    let heightMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, heightMap);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.R32F, columns, rows, 0, gl.RED, gl.FLOAT, cornerHeights);\n\n    let waterHeightMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, waterHeightMap);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.R32F, columns, rows, 0, gl.RED, gl.FLOAT, waterHeights);\n\n    let instanceBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, instanceBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(instanceCount).map((currentValue, index, array) => index), gl.STATIC_DRAW);\n\n    let textureBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, textureBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, cornerTextures, gl.STATIC_DRAW);\n\n    let variationBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, variationBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, cornerVariations, gl.STATIC_DRAW);\n\n    let waterBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, waterBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, waterFlags, gl.STATIC_DRAW);\n\n    let heightMapSize = new Float32Array([1 / columns, 1 / rows]);\n\n    this.terrainRenderData = {\n      rows,\n      columns,\n      centerOffset,\n      vertexBuffer,\n      faceBuffer,\n      heightMap,\n      instanceBuffer,\n      instanceCount,\n      cornerTextures,\n      textureBuffer,\n      variationBuffer,\n      heightMapSize,\n      cliffHeightMap,\n      waterHeightMap,\n      waterBuffer,\n    };\n\n    this.terrainReady = true;\n    this.anyReady = true;\n\n    this.createWaves();\n\n    let cliffPromises = Object.entries(cliffs).map((cliff) => {\n      let path = cliff[0];\n      let { locations, textures } = cliff[1];\n\n      return this.loadGeneric(this.mapPathSolver(path)[0], 'arrayBuffer', undefined, path)\n        .whenLoaded()\n        .then((resource) => {\n          return new TerrainModel(gl, resource.data, locations, textures, this);\n        });\n    });\n\n    this.cliffModels = await Promise.all(cliffPromises);\n    this.cliffModels.sort((a, b) => !a.textures > !b.textures);\n    this.cliffsReady = true;\n  }\n\n  calculateRamps() {\n    let corners = this.corners;\n    let [columns, rows] = this.mapSize;\n\n    // There are no C or X ramps because they're not supported in city tileset\n    let ramps = [\n      \"AAHL\",\n      \"AALH\",\n      \"ABHL\",\n      \"AHLA\",\n      \"ALHA\",\n      \"ALHB\",\n      \"BALH\",\n      \"BHLA\",\n      \"HAAL\",\n      \"HBAL\",\n      \"HLAA\",\n      \"HLAB\",\n      \"LAAH\",\n      \"LABH\",\n      \"LHAA\",\n      \"LHBA\",\n    ];\n\n    // Adjust terrain height inside ramps (set rampAdjust)\n    for (let y = 1; y < rows - 1; ++y) {\n      for (let x = 1; x < columns - 1; ++x) {\n        let o = corners[y][x];\n        if (!o.ramp) continue;\n        let a = corners[y - 1][x - 1];\n        let b = corners[y][x - 1];\n        let c = corners[y + 1][x - 1];\n        let d = corners[y + 1][x];\n        let e = corners[y + 1][x + 1];\n        let f = corners[y][x + 1];\n        let g = corners[y - 1][x + 1];\n        let h = corners[y - 1][x];\n        let base = o.layerHeight;\n        if ((b.ramp && f.ramp) || (d.ramp && h.ramp)) {\n          let adjust = 0;\n          if (b.ramp && f.ramp) {\n            adjust = Math.max(adjust, (b.layerHeight + f.layerHeight) / 2 - base);\n          }\n          if (d.ramp && h.ramp) {\n            adjust = Math.max(adjust, (d.layerHeight + h.layerHeight) / 2 - base);\n          }\n          if (a.ramp && e.ramp) {\n            adjust = Math.max(adjust, ((a.layerHeight + e.layerHeight) / 2 - base) / 2);\n          }\n          if (c.ramp && g.ramp) {\n            adjust = Math.max(adjust, ((c.layerHeight + g.layerHeight) / 2 - base) / 2);\n          }\n          o.rampAdjust = adjust;\n        }\n      }\n    }\n\n    // Calculate ramp tiles\n    for (let y = 0; y < rows - 1; ++y) {\n      for (let x = 0; x < columns - 1; ++x) {\n        let a = corners[y][x];\n        let b = corners[y + 1][x];\n        let c = corners[y][x + 1];\n        let d = corners[y + 1][x + 1];\n        if (!a.rampType && y < rows - 2) {\n          let e = corners[y + 2][x];\n          let f = corners[y + 2][x + 1];\n          let ae = Math.min(a.layerHeight, e.layerHeight), cf = Math.min(c.layerHeight, f.layerHeight);\n          if (b.layerHeight === ae && d.layerHeight === cf) {\n            let base = Math.min(ae, cf);\n            if (a.ramp === b.ramp && a.ramp === e.ramp && c.ramp === d.ramp && c.ramp === f.ramp && a.ramp !== c.ramp) {\n              let name = this.rampFileName(e, f, c, a, base);\n              if (ramps.includes(name)) {\n                a.rampName = name;\n                a.rampType = 1;\n                b.rampType = -1;\n              }\n            }\n          }\n        }\n        if (!a.rampType && x < columns - 2) {\n          let e = corners[y][x + 2];\n          let f = corners[y + 1][x + 2];\n          let ae = Math.min(a.layerHeight, e.layerHeight), bf = Math.min(b.layerHeight, f.layerHeight);\n          if (c.layerHeight === ae && d.layerHeight === bf) {\n            let base = Math.min(ae, bf);\n            if (a.ramp === c.ramp && a.ramp === e.ramp && b.ramp === d.ramp && b.ramp === f.ramp && a.ramp !== b.ramp) {\n              let name = this.rampFileName(b, f, e, a, base);\n              if (ramps.includes(name)) {\n                a.rampName = name;\n                a.rampType = 2;\n                c.rampType = -1;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Calculate cliff tiles\n    for (let y = 0; y < rows - 1; ++y) {\n      for (let x = 0; x < columns - 1; ++x) {\n        let a = corners[y][x];\n        let b = corners[y + 1][x];\n        let c = corners[y][x + 1];\n        let d = corners[y + 1][x + 1];\n        if (a.rampAdjust || b.rampAdjust || c.rampAdjust || d.rampAdjust) {\n          continue;\n        }\n        let base = a.layerHeight;\n        if (b.layerHeight !== base || c.layerHeight !== base || d.layerHeight !== base) {\n          a.cliff = true;\n        }\n      }\n    }\n\n    // Fix ramp cliffTexture\n    for (let y = 0; y < rows - 1; ++y) {\n      for (let x = 0; x < columns - 1; ++x) {\n        let a = corners[y][x], b;\n        if (a.rampType && a.rampType > 0) {\n          let x1 = x + 1, y1 = y + 1;\n          if (a.rampType === 1) {\n            b = corners[y + 1][x];\n            y1 = y + 2;\n          } else {\n            b = corners[y][x + 1];\n            x1 = x + 2;\n          }\n          let x0 = Math.max(0, x - 1), y0 = Math.max(0, y - 1);\n          x1 = Math.min(x1, columns - 1);\n          y1 = Math.min(y1, rows - 1);\n          let tex = null;\n          for (let ty = y0; ty <= y1 && tex == null; ++ty) {\n            for (let tx = x0; tx <= x1; ++tx) {\n              let tile = corners[ty][tx];\n              if (tile.cliff && !tile.rampType) {\n                tex = tile.cliffTexture;\n                break;\n              }\n            }\n          }\n          if (tex != null) {\n            a.cliffTexture = b.cliffTexture = tex;\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {number} bottomLeftLayer\n   * @param {number} bottomRightLayer\n   * @param {number} topLeftLayer\n   * @param {number} topRightLayer\n   * @param {number} base\n   * @return {string}\n   */\n  cliffFileName(bottomLeftLayer, bottomRightLayer, topLeftLayer, topRightLayer, base) {\n    return String.fromCharCode(65 + topLeftLayer - base) +\n      String.fromCharCode(65 + topRightLayer - base) +\n      String.fromCharCode(65 + bottomRightLayer - base) +\n      String.fromCharCode(65 + bottomLeftLayer - base);\n  }\n\n  rampFileName(a, b, c, d, base) {\n    let ah = a.layerHeight - base, bh = b.layerHeight - base, ch = c.layerHeight - base, dh = d.layerHeight - base;\n    if (ah > 2 || bh > 2 || ch > 2 || dh > 2) {\n      return \"\";\n    }\n    let ramp = \"LHX\", cliff = \"ABC\";\n    return (a.ramp ? ramp : cliff)[ah] + (b.ramp ? ramp : cliff)[bh] + (c.ramp ? ramp : cliff)[ch] + (d.ramp ? ramp : cliff)[dh];\n  }\n\n  /**\n   * Creates a shared texture that holds all of the tileset textures.\n   * Each tileset is flattend to a single row of tiles, such that indices 0-15 are the normal part, and indices 16-31 are the extended part.\n   */\n  createTilesetsAndWaterTextures() {\n    let tilesets = this.tilesetTextures;\n    let tilesetsCount = tilesets.length;\n    let canvas = document.createElement('canvas');\n    let ctx = canvas.getContext('2d');\n\n    canvas.width = 2048;\n    canvas.height = 64 * (tilesetsCount + 1); // 1 is added for a black tileset, to remove branches from the fragment shader, at the cost of 512Kb.\n\n    for (let tileset = 0; tileset < tilesetsCount; tileset++) {\n      let imageData = tilesets[tileset].imageData;\n      if (!imageData) {\n        continue;\n      }\n\n      for (let variation = 0; variation < 16; variation++) {\n        let x = (variation % 4) * 64;\n        let y = ((variation / 4) | 0) * 64;\n\n        ctx.putImageData(imageData, variation * 64 - x, (tileset + 1) * 64 - y, x, y, 64, 64);\n      }\n\n      if (imageData.width === 512) {\n        for (let variation = 0; variation < 16; variation++) {\n          let x = 256 + (variation % 4) * 64;\n          let y = ((variation / 4) | 0) * 64;\n\n          ctx.putImageData(imageData, 1024 + variation * 64 - x, (tileset + 1) * 64 - y, x, y, 64, 64);\n        }\n      }\n    }\n\n    let gl = this.gl;\n    let texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n\n    this.tilesetsTexture = texture;\n\n    canvas.height = 128 * 3; // up to 48 frames.\n\n    let waterTextures = this.waterTextures;\n\n    for (let i = 0, l = waterTextures.length; i < l; i++) {\n      let x = i % 16;\n      let y = (i / 16) | 0;\n\n      ctx.putImageData(waterTextures[i].imageData, x * 128, y * 128);\n    }\n\n    let waterTexture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, waterTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n\n    this.waterTexture = waterTexture;\n  }\n\n  /**\n   * @param {number} groundTexture\n   * @param {number} variation\n   * @return {number}\n   */\n  getVariation(groundTexture, variation) {\n    let texture = this.tilesetTextures[groundTexture];\n\n    // Extended?\n    if (texture.width > texture.height) {\n      if (variation < 16) {\n        return 16 + variation;\n      } else if (variation === 16) {\n        return 15;\n      } else {\n        return 0;\n      }\n    } else {\n      if (variation === 0) {\n        return 0;\n      } else {\n        return 15;\n      }\n    }\n  }\n\n  /**\n   * Is the corner at the given column and row a cliff?\n   *\n   * @param {number} column\n   * @param {number} row\n   * @return {boolean}\n   */\n  isCliff(column, row) {\n    return !!this.corners[row][column].cliff;\n  }\n\n  /**\n   * Is the tile at the given column and row water?\n   *\n   * @param {number} column\n   * @param {number} row\n   * @return {boolean}\n   */\n  isWater(column, row) {\n    let corners = this.corners;\n\n    return corners[row][column].water || corners[row][column + 1].water || corners[row + 1][column].water || corners[row + 1][column + 1].water;\n  }\n\n  /**\n   * Given a cliff index, get its ground texture index.\n   * This is an index into the tilset textures.\n   *\n   * @param {number} whichCliff\n   * @return {number}\n   */\n  cliffGroundIndex(whichCliff) {\n    let whichTileset = this.cliffTilesets[whichCliff].groundTile;\n    let tilesets = this.tilesets;\n\n    for (let i = 0, l = tilesets.length; i < l; i++) {\n      if (tilesets[i].tileID === whichTileset) {\n        return i;\n      }\n    }\n  }\n\n  /**\n   * Get the ground texture of a corner, whether it's normal ground, a cliff, or a blighted corner.\n   *\n   * @param {number} column\n   * @param {number} row\n   * @return {number}\n   */\n  cornerTexture(column, row) {\n    let corners = this.corners;\n    let columns = this.columns;\n    let rows = this.rows;\n\n    for (let y = -1; y < 1; y++) {\n      for (let x = -1; x < 1; x++) {\n        if (column + x > 0 && column + x < columns - 1 && row + y > 0 && row + y < rows - 1) {\n          let corner = corners[row + y][column + x];\n          if (this.isCliff(column + x, row + y) || corner.rampType) {\n            let texture = corner.cliffTexture;\n\n            if (texture === 15) {\n              texture = 1;\n            }\n\n            return this.cliffGroundIndex(texture);\n          }\n        }\n      }\n    }\n\n    let corner = corners[row][column];\n\n    // Is this corner blighted?\n    if (corner.blight) {\n      return this.blightTextureIndex;\n    }\n\n    return corner.groundTexture;\n  }\n\n  load(src) {\n    return super.load(src, this.mapPathSolver);\n  }\n\n  /**\n   * \n   * @param {*} dataMap \n   * @param {*} metadataMap \n   * @param {*} modificationFile \n   */\n  applyModificationFile(dataMap, metadataMap, modificationFile) {\n    if (modificationFile) {\n      // Modifications to built-in objects\n      this.applyModificationTable(dataMap, metadataMap, modificationFile.originalTable);\n\n      // Declarations of user-defined objects\n      this.applyModificationTable(dataMap, metadataMap, modificationFile.customTable);\n    }\n  }\n\n  /**\n   * \n   * @param {*} dataMap \n   * @param {*} metadataMap \n   * @param {*} modificationTable \n   */\n  applyModificationTable(dataMap, metadataMap, modificationTable) {\n    for (let modificationObject of modificationTable.objects) {\n      let row = dataMap.getRow(modificationObject.oldId);\n      let newId = modificationObject.newId;\n\n      // If this is a custom object, and it's not in the mapped data, copy the standard object.\n      if (modificationObject.newId !== '' && !dataMap.getRow(newId)) {\n        dataMap.setRow(modificationObject.newId, row = { ...row });\n      }\n\n      for (let modification of modificationObject.modifications) {\n        let metadata = metadataMap.getRow(modification.id);\n\n        if (metadata) {\n          row[metadata.field] = modification.value;\n        } else {\n          console.warn('Unknown modification ID', modification.id);\n        }\n      }\n    }\n  }\n\n  /**\n   * \n   * @param {Float32Array} out\n   * @param {number} x\n   * @param {number} y\n   * @return {out}\n   */\n  groundNormal(out, x, y) {\n    let centerOffset = this.centerOffset;\n    let mapSize = this.mapSize;\n\n    x = (x - centerOffset[0]) / 128;\n    y = (y - centerOffset[1]) / 128;\n\n    let cellX = x | 0;\n    let cellY = y | 0;\n\n    // See if this coordinate is in the map\n    if (cellX >= 0 && cellX < mapSize[0] - 1 && cellY >= 0 && cellY < mapSize[1] - 1) {\n      // See http://gamedev.stackexchange.com/a/24574\n      let corners = this.corners;\n      let bottomLeft = corners[cellY][cellX].groundHeight;\n      let bottomRight = corners[cellY][cellX + 1].groundHeight;\n      let topLeft = corners[cellY + 1][cellX].groundHeight;\n      let topRight = corners[cellY + 1][cellX + 1].groundHeight;\n      let sqX = x - cellX;\n      let sqY = y - cellY;\n\n      if (sqX + sqY < 1) {\n        vec3.set(normalHeap1, 1, 0, bottomRight - bottomLeft);\n        vec3.set(normalHeap2, 0, 1, topLeft - bottomLeft);\n      } else {\n        vec3.set(normalHeap1, -1, 0, topRight - topLeft);\n        vec3.set(normalHeap2, 0, 1, topRight - bottomRight);\n      }\n\n      vec3.normalize(out, vec3.cross(out, normalHeap1, normalHeap2));\n    } else {\n      vec3.set(out, 0, 0, 1);\n    }\n\n    return out;\n  }\n\n  heightAt(x, y) {\n    let centerOffset = this.centerOffset;\n    let mapSize = this.mapSize;\n\n    x = (x - centerOffset[0]) / 128;\n    y = (y - centerOffset[1]) / 128;\n\n    let cellX = x | 0;\n    let cellY = y | 0;\n\n    if (cellX >= 0 && cellX < mapSize[0] - 1 && cellY >= 0 && cellY < mapSize[1] - 1) {\n      let corners = this.corners;\n      const ht = c => c.groundHeight + c.layerHeight - 2;\n      let bottomLeft = ht(corners[cellY][cellX]);\n      let bottomRight = ht(corners[cellY][cellX + 1]);\n      let topLeft = ht(corners[cellY + 1][cellX]);\n      let topRight = ht(corners[cellY + 1][cellX + 1]);\n      let sqX = x - cellX;\n      let sqY = y - cellY;\n      let height;\n\n      if (sqX + sqY < 1) {\n        height = bottomLeft + (bottomRight - bottomLeft) * sqX + (topLeft - bottomLeft) * sqY;\n      } else {\n        height = topRight + (bottomRight - topRight) * (1 - sqY) + (topLeft - topRight) * (1 - sqX);\n      }\n\n      return height * 128;\n    }\n\n    return 0;\n  }\n\n  inPlayableArea(x, y) {\n    x = (x - this.centerOffset[0]) / 128.0;\n    y = (y - this.centerOffset[1]) / 128.0;\n    if (x < this.mapBounds[0]) return false;\n    if (x >= this.mapSize[0] - this.mapBounds[1] - 1) return false;\n    if (y < this.mapBounds[2]) return false;\n    if (y >= this.mapSize[1] - this.mapBounds[3] - 1) return false;\n    return !this.corners[Math.floor(y)][Math.floor(x)].boundary;\n  }\n\n  addShadow(file, x, y) {\n    if (!this.shadows[file]) {\n      let path = `ReplaceableTextures\\\\Shadows\\\\${file}.blp`;\n      this.shadows[file] = [];\n      this.shadowTextures[file] = this.load(path);\n    }\n    this.shadows[file].push({ x, y });\n  }\n\n  async initShadows() {\n    await whenLoaded(Object.values(this.shadowTextures));\n\n    let gl = this.gl;\n    let centerOffset = this.centerOffset;\n    let [columns, rows] = this.mapSize;\n    columns = (columns - 1) * 4;\n    rows = (rows - 1) * 4;\n\n    const shadowSize = columns * rows;\n    const shadowData = new Uint8Array(columns * rows);\n    const source = this.mapMpq.get('war3map.shd');\n    if (source) {\n      let buffer = source.arrayBuffer();\n      if (buffer.byteLength >= shadowSize) {\n        buffer = new Uint8Array(buffer);\n        for (let i = 0; i < shadowSize; ++i) {\n          shadowData[i] = buffer[i] / 2;\n        }\n      }\n    }\n\n    for (let [file, texture] of Object.entries(this.shadowTextures)) {\n      if (!texture.originalData) {\n        continue;\n      }\n      let { data, width, height } = texture.originalData;\n      let ox = Math.round(width * 0.3), oy = Math.round(height * 0.7);\n\n      for (let location of this.shadows[file]) {\n        let x0 = Math.floor((location.x - centerOffset[0]) / 32.0) - ox;\n        let y0 = Math.floor((location.y - centerOffset[1]) / 32.0) + oy;\n        for (let y = 0; y < height; ++y) {\n          if (y0 - y < 0 || y0 - y >= rows) {\n            continue;\n          }\n          for (let x = 0; x < width; ++x) {\n            if (x0 + x < 0 || x0 + x >= columns) {\n              continue;\n            }\n            if (data[(y * width + x) * 4 + 3]) {\n              shadowData[(y0 - y) * columns + x0 + x] = 128;\n            }\n          }\n        }\n      }\n    }\n\n    const outsideArea = 204;\n    let x0 = this.mapBounds[0] * 4, x1 = (this.mapSize[0] - this.mapBounds[1] - 1) * 4,\n      y0 = this.mapBounds[2] * 4, y1 = (this.mapSize[1] - this.mapBounds[3] - 1) * 4;\n    for (let y = y0; y < y1; ++y) {\n      for (let x = x0; x < x1; ++x) {\n        let c = this.corners[y >> 2][x >> 2];\n        if (c.boundary) {\n          shadowData[y * columns + x] = outsideArea;\n        }\n      }\n    }\n    for (let y = 0; y < rows; ++y) {\n      for (let x = 0; x < x0; ++x) {\n        shadowData[y * columns + x] = outsideArea;\n      }\n      for (let x = x1; x < columns; ++x) {\n        shadowData[y * columns + x] = outsideArea;\n      }\n    }\n    for (let x = x0; x < x1; ++x) {\n      for (let y = 0; y < y0; ++y) {\n        shadowData[y * columns + x] = outsideArea;\n      }\n      for (let y = y1; y < rows; ++y) {\n        shadowData[y * columns + x] = outsideArea;\n      }\n    }\n\n    let shadowMap = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, shadowMap);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.R8, columns, rows, 0, gl.RED, gl.UNSIGNED_BYTE, shadowData);\n    this.shadowMap = shadowMap;\n\n    this.shadowsReady = true;\n  }\n\n  createWaves() {\n    let [columns, rows] = this.mapSize;\n    let corners = this.corners;\n    let wavesDepth = 25 / 128;\n    let centerOffset = this.centerOffset;\n    let waterRow = this.waterData.getRow(`${this.tileset}Sha`);\n\n    let wavesCliff = (this.mapFlags & 0x0800);\n    let wavesRolling = (this.mapFlags & 0x1000);\n\n    let shoreline = `${waterRow.shoreDir}\\\\${waterRow.shoreSFile}\\\\${waterRow.shoreSFile}0.mdx`;\n    let outsideCorner = `${waterRow.shoreDir}\\\\${waterRow.shoreOCFile}\\\\${waterRow.shoreOCFile}0.mdx`;\n    let insideCorner = `${waterRow.shoreDir}\\\\${waterRow.shoreICFile}\\\\${waterRow.shoreICFile}0.mdx`;\n\n    let rotation = (a, b, c) => {\n      if (a) return -3 * Math.PI / 4;\n      if (b) return -Math.PI / 4;\n      if (c) return Math.PI / 4;\n      return 3 * Math.PI / 4;\n    };\n    let rotation2 = (a, b, c, d) => {\n      if (a && b) return -Math.PI / 2;\n      if (b && c) return 0;\n      if (c && d) return Math.PI / 2;\n      if (a && d) return Math.PI;\n      return null;\n    };\n\n    let location = new Float32Array(3);\n    let models = {};\n\n    let addInstance = (path, rotation) => {\n      if (!models[path]) {\n        models[path] = this.load(path);\n      }\n      let instance = models[path].addInstance();\n      instance.move(location);\n      instance.rotateLocal(quat.setAxisAngle(quat.create(), VEC3_UNIT_Z, rotation));\n      instance.setScene(this.scene);\n      if (!this.inPlayableArea(location[0], location[1])) {\n        instance.setVertexColor([51, 51, 51]);\n      }\n      standOnRepeat(instance);\n    };\n\n    for (let y = 0; y < rows - 1; ++y) {\n      for (let x = 0; x < columns - 1; ++x) {\n        let a = corners[y][x], b = corners[y][x + 1], c = corners[y + 1][x + 1], d = corners[y + 1][x];\n        if (a.water || b.water || c.water || c.water) {\n          let isCliff = (a.layerHeight !== b.layerHeight || a.layerHeight !== c.layerHeight || a.layerHeight !== d.layerHeight);\n          if (isCliff && !wavesCliff) {\n            continue;\n          }\n          if (!isCliff && !wavesRolling) {\n            continue;\n          }\n          let ad = (a.depth > wavesDepth ? 1 : 0);\n          let bd = (b.depth > wavesDepth ? 1 : 0);\n          let cd = (c.depth > wavesDepth ? 1 : 0);\n          let dd = (d.depth > wavesDepth ? 1 : 0);\n          let count = (ad + bd + cd + dd);\n          location[0] = x * 128.0 + centerOffset[0] + 64.0;\n          location[1] = y * 128.0 + centerOffset[1] + 64.0;\n          location[2] = ((a.waterHeight + b.waterHeight + c.waterHeight + d.waterHeight) / 4.0 + this.waterHeightOffset) * 128.0 + 1.0;\n          if (count === 1) {\n            addInstance(insideCorner, rotation(ad, bd, cd, dd));\n          } else if (count === 2) {\n            let rot = rotation2(ad, bd, cd, dd);\n            if (rot != null) {\n              addInstance(shoreline, rot);\n            }\n          } else if (count === 3) {\n            addInstance(outsideCorner, rotation(!ad, !bd, !cd, !dd) + Math.PI);\n          }\n        }\n      }\n    }\n  }\n\n  deselect() {\n    if (this.selModels && this.selModels.length) {\n      this.selModels.forEach(model => {\n        let idx = this.uberSplatModels.indexOf(model);\n        if (idx >= 0) {\n          this.uberSplatModels.splice(idx, 1);\n        }\n      });\n      this.selModels = [];\n    }\n    this.selected = [];\n  }\n\n  doSelectUnits(units) {\n    this.deselect();\n    if (!units.length) {\n      return;\n    }\n\n    let splats = {};\n\n    this.selected = units.filter(({ unit }) => {\n      let row = this.unitsData.find(row => row.id === unit.id);\n      if (!row) return false;\n      row = row.data;\n      let selScale = parseFloat(row.scale || \"0\");\n      if (!selScale) return false;\n\n      let radius = 36 * selScale, path;\n      if (radius < 100) {\n        path = 'ReplaceableTextures\\\\Selection\\\\SelectionCircleSmall.blp';\n      } if (radius < 300) {\n        path = 'ReplaceableTextures\\\\Selection\\\\SelectionCircleMed.blp';\n      } else {\n        path = 'ReplaceableTextures\\\\Selection\\\\SelectionCircleLarge.blp';\n      }\n      if (!splats[path]) {\n        splats[path] = [];\n      }\n      let [x, y] = unit.location;\n      let z = parseFloat(row.selZ || \"0\");\n      splats[path].push(x - radius, y - radius, x + radius, y + radius, z + 5);\n\n      return true;\n    });\n\n    let models = this.selModels = [];\n    Object.entries(splats).forEach(([path, locations]) => {\n      this.load(path).whenLoaded()\n        .then(tex => {\n          if (this.selModels !== models) return;\n          let model = new SplatModel(this.gl, path, tex, locations, this.centerOffset);\n          model.color = [0, 1, 0, 1];\n          this.selModels.push(model);\n          this.uberSplatModels.push(model);\n        });\n    });\n  }\n\n  selectUnit(x, y, toggle) {\n    let ray = new Float32Array(6);\n    this.camera.screenToWorldRay(ray, [x, y]);\n    let dir = normalHeap1;\n    dir[0] = ray[3] - ray[0];\n    dir[1] = ray[4] - ray[1];\n    dir[2] = ray[5] - ray[2];\n    vec3.normalize(dir, dir);\n    let eMid = vec3.create(), eSize = vec3.create(), rDir = vec3.create();\n\n    let entity = null;\n    let entDist = 1e+6;\n    this.units.forEach(ent => {\n      let { location, radius } = ent;\n      vec3.set(eMid, 0, 0, radius / 2);\n      vec3.set(eSize, radius, radius, radius);\n\n      vec3.add(eMid, eMid, location);\n      vec3.sub(eMid, eMid, ray);\n      vec3.div(eMid, eMid, eSize);\n      vec3.div(rDir, dir, eSize);\n      let dlen = vec3.sqrLen(rDir);\n\n      let dp = Math.max(0, vec3.dot(rDir, eMid)) / dlen;\n      if (dp > entDist) return;\n      vec3.scale(rDir, rDir, dp);\n      if (vec3.sqrDist(rDir, eMid) < 1.0) {\n        entity = ent;\n        entDist = dp;\n      }\n    });\n    let sel = [];\n    if (entity) {\n      if (toggle) {\n        sel = this.selected.slice();\n        const idx = sel.indexOf(entity);\n        if (idx >= 0) {\n          sel.splice(idx, 1);\n        } else {\n          sel.push(entity);\n        }\n      } else {\n        sel = [entity];\n      }\n    }\n    this.doSelectUnits(sel);\n    return sel;\n  }\n\n  selectUnits(x0, y0, x1, y1) {\n    let sp = new Float32Array(2);\n    let sel = this.units.filter(ent => {\n      let { unit } = ent;\n      let row = this.unitsData.find(row => row.id === unit.id);\n      if (!row) return false;\n      row = row.data;\n      let [x, y] = unit.location;\n      let z = parseFloat(row.selZ || \"0\") + this.heightAt(x, y);\n      this.camera.worldToScreen(sp, [x, y, z]);\n      if (sp[0] >= x0 && sp[0] < x1 && sp[1] >= y0 && sp[1] < y1) {\n        return true;\n      }\n      return false;\n    });\n    this.doSelectUnits(sel);\n    return sel;\n  }\n}\n\n/*\n  */\n","import MapViewer from './viewer';\n\nexport default {\n  MapViewer,\n};\n","import parsers from './parsers';\nimport viewer from './viewer';\n\nexport default {\n  version: '4.5.8',\n  parsers,\n  viewer,\n};\n","import * as glMatrix from 'gl-matrix';\nimport ModelViewer from './viewer';\nimport Scene from './scene';\nimport Camera from './camera';\nimport handlers from './handlers';\n\nexport default {\n  glMatrix,\n  ModelViewer,\n  Scene,\n  Camera,\n  handlers,\n};\n","import geo from './geo';\nimport mdx from './mdx';\nimport imagetexture from './imagetexture';\nimport w3x from './w3x';\nimport toc from './toc';\nimport jass from './jass';\n\nexport default {\n  geo,\n  mdx,\n  imagetexture,\n  w3x,\n  toc,\n  jass\n};\n","import React from 'react';\nimport ModelViewer from 'mdx';\nimport { vec3, mat4 } from 'gl-matrix';\nimport { AutoSizer } from 'react-virtualized';\nimport AppCache from 'data/cache';\nimport pathHash from 'data/hash';\n\nconst v3pos = vec3.create(), v3dir = vec3.create(), v3up = vec3.create(), v3sub = vec3.create();\nconst m4rot = mat4.create();\nconst f32rot = new Float32Array(1);\n\nconst TeamColors = [\n  \"Red\",\n  \"Blue\",\n  \"Teal\",\n  \"Purple\",\n  \"Yellow\",\n  \"Orange\",\n  \"Green\",\n  \"Pink\",\n  \"Gray\",\n  \"Light Blue\",\n  \"Dark Green\",\n  \"Brown\",\n  \"Maroon\",\n  \"Navy\",\n  \"Turquoise\",\n  \"Violet\",\n  \"Wheat\",\n  \"Peach\",\n  \"Mint\",\n  \"Lavender\",\n  \"Coal\",\n  \"Snow\",\n  \"Emerald\",\n  \"Peanut\",\n  \"Black\",\n];\n\nexport default class FileModelView extends React.PureComponent {\n  state = {\n    objects: [],\n    errors: [],\n    current: 0,\n    teamColor: 0\n  }\n\n  static contextType = AppCache.DataContext;\n\n  yaw = -Math.PI / 2;\n  pitch = -Math.PI / 4;\n  distance = 400;\n  center = vec3.create();\n  minDistance = 8;\n  maxDistance = 3000;\n\n  freeCamera() {\n    if (this.scene) {\n      this.scene.camera.setRotationAroundAngles(this.yaw, this.pitch, this.center, this.distance);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.frame) {\n      cancelAnimationFrame(this.frame);\n      delete this.frame;\n    }\n    this.removeEvents();\n  }\n\n  onMouseDown = e => {\n    document.addEventListener(\"mousemove\", this.onMouseMove, true);\n    document.addEventListener(\"mouseup\", this.onMouseUp, true);\n    this.dragPos = {x: e.clientX, y: e.clientY};\n    e.preventDefault();\n  }\n  onMouseMove = e => {\n    if (this.dragPos && this.canvas) {\n      const dx = e.clientX - this.dragPos.x,\n        dy = e.clientY - this.dragPos.y;\n      const dim = (this.canvas.width + this.canvas.height) / 2;\n      this.yaw += dx * 2 * Math.PI / dim;\n      this.pitch += dy * 2 * Math.PI / dim;\n      while (this.yaw > Math.PI) {\n        this.yaw -= Math.PI * 2;\n      }\n      while (this.yaw < -Math.PI) {\n        this.yaw += Math.PI * 2;\n      }\n      this.pitch = Math.min(this.pitch, 0);\n      this.pitch = Math.max(this.pitch, -Math.PI);\n      this.dragPos = {x: e.clientX, y: e.clientY};\n\n      this.setCamera({target: {value: -1}});\n    }\n    e.preventDefault();\n  }\n  onMouseUp = e => {\n    delete this.dragPos;\n    this.removeEvents();\n    e.preventDefault();\n  }\n  onMouseWheel = e => {\n    if (e.deltaY > 0) {\n      this.distance = Math.min(this.distance * 1.2, this.maxDistance);\n    } else {\n      this.distance = Math.max(this.distance / 1.2, this.minDistance);\n    }\n    this.setCamera({target: {value: -1}});\n  }\n\n  removeEvents() {\n    document.removeEventListener(\"mousemove\", this.onMouseMove, true);\n    document.removeEventListener(\"mouseup\", this.onMouseUp, true);\n  }\n\n  setObject = e => {\n    let index = parseInt(e.target.value, 10);\n    if (isNaN(index)) index = 0;\n    this.setState(state => {\n      if (index !== state.current && state.objects[index]) {\n        this.scene.removeInstance(state.objects[state.current].instance);\n        this.scene.addInstance(state.objects[index].instance);\n        return {current: index};\n      }\n    });\n  }\n\n  setSequence = e => {\n    let seq = parseInt(e.target.value, 10);\n    if (isNaN(seq)) seq = -1;\n    this.setState(state => {\n      const obj = state.objects[state.current];\n      if (obj && obj.sequence !== seq) {\n        obj.instance.setSequence(seq);\n        const objects = state.objects.slice();\n        objects[state.current] = {...obj, sequence: seq};\n        return {objects};\n      }\n    });\n  }\n\n  setCamera = e => {\n    let cam = parseInt(e.target.value, 10);\n    if (isNaN(cam)) cam = -1;\n    this.setState(state => {\n      const obj = state.objects[state.current];\n      if (obj && obj.camera !== cam) {\n        const objects = state.objects.slice();\n        objects[state.current] = {...obj, camera: cam};\n        return {objects};\n      }\n    });\n  }\n\n  setTeamColor = e => {\n    let color = parseInt(e.target.value, 10);\n    if (isNaN(color)) color = 0;\n    this.setState({teamColor: color}, () => {\n      this.state.objects.forEach(obj => obj.instance.setTeamColor(color));\n    });\n  }\n\n  animate = ts => {\n    this.frame = requestAnimationFrame(this.animate);\n    this.scene.camera.viewport([0, 0, this.canvas.width, this.canvas.height]);\n\n    const object = this.state.objects[this.state.current];\n    const cam = object && object.model.cameras[object.camera];\n    if (cam) {\n      cam.getPositionTranslation(v3pos, object.instance);\n      cam.getTargetTranslation(v3dir, object.instance);\n      cam.getRotation(f32rot, object.instance);\n      vec3.sub(v3sub, v3dir, v3pos);\n      vec3.normalize(v3sub, v3sub);\n      mat4.fromRotation(m4rot, f32rot[0], v3sub);\n      vec3.set(v3up, 0, 0, 1);\n      vec3.transformMat4(v3up, v3up, m4rot);\n      const aspect = this.canvas.width / this.canvas.height;\n      const vFov = Math.atan(Math.tan(cam.fieldOfView / 2) / aspect) * 2;\n      this.scene.camera.perspective(vFov, aspect, cam.nearClippingPlane, cam.farClippingPlane);\n      this.scene.camera.moveToAndFace(v3pos, v3dir, v3up);\n    } else {\n      this.scene.camera.perspective(Math.PI / 4, this.canvas.width / this.canvas.height, this.minDistance, this.maxDistance);\n      this.freeCamera();\n    }\n\n    this.viewer.updateAndRender();\n  }\n\n  modelLoaded(model, index) {\n    if (!model.ok) {\n      return;\n    }\n    this.setState(state => {\n      const instance = model.addInstance();\n      index = Math.min(index, state.objects.length);\n      if (index === state.current) {\n        if (state.objects[index]) {\n          this.scene.removeInstance(state.objects[index].instance);\n        }\n        this.scene.addInstance(instance);\n        if (model.bounds && model.bounds.radius > 0.05) {\n          this.minDistance = Math.min(500, model.bounds.radius * 0.2);\n          this.maxDistance = this.minDistance * 1000;\n          this.distance = this.minDistance * 10;\n        }\n      }\n      instance.setTeamColor(state.teamColor);\n      if (model.sequences.length > 0) {\n        instance.setSequence(0);\n      }\n      instance.setSequenceLoopMode(2);\n      const objects = [...state.objects];\n      objects.splice(index, 0, {\n        model,\n        instance,\n        sequence: model.sequences.length ? 0 : -1,\n        camera: model.cameras.length ? 0 : -1,\n      });\n      return {objects};\n    });\n  }\n\n  componentDidMount() {\n    if (!this.canvas) {\n      return;\n    }\n    const canvas = this.canvas;\n    this.viewer = new ModelViewer.viewer.ModelViewer(canvas);\n    this.viewer.gl.clearColor(0.3, 0.3, 0.3, 1);\n    this.viewer.on('error', (target, error, reason) => {\n      if (error === \"FailedToFetch\") {\n        if (target.isPortrait) {\n          return;\n        }\n        this.setState(({errors}) => ({errors: [...errors, `Failed to load ${target.path}`]}));\n      }\n    });\n    this.scene = this.viewer.addScene();\n    this.viewer.addHandler(ModelViewer.viewer.handlers.mdx);\n\n    const data = this.context;\n\n    const hash = (this.props.path ? pathHash(this.props.path) : this.props.id);\n\n    const resolvePath = path => {\n      const ext = typeof path === \"string\" ? path.substr(path.lastIndexOf(\".\")).toLowerCase() : \".mdx\";\n      if ([\".blp\", \".dds\", \".gif\", \".jpg\", \".jpeg\", \".png\", \".tga\"].indexOf(ext) >= 0) {\n        return [data.image(path), \".png\", true];\n      } else {\n        const bin = data.binary(path);\n        if (bin) {\n          return [bin.data.buffer, ext, false];\n        } else {\n          return [data.cache.binary(path), ext, true];\n        }\n      }\n    };\n\n    this.viewer.load(hash, resolvePath).then(model => this.modelLoaded(model, 0));\n    if (this.props.path) {\n      const portrait = this.props.path.replace(/\\.mdx$/i, \"_portrait.mdx\");\n      const model = this.viewer.load(portrait, resolvePath);\n      model.isPortrait = true;\n      model.then(model => this.modelLoaded(model, 1));\n    }\n\n    this.frame = requestAnimationFrame(this.animate);\n  }\n\n  render() {\n    const { errors, objects, current, teamColor } = this.state;\n    const object = objects[current];\n    return (\n      <div className=\"FileModel\">\n        <AutoSizer>\n          {({width, height}) => (\n            <canvas\n            onMouseDown={this.onMouseDown}\n            onWheel={this.onMouseWheel}\n            ref={n => this.canvas = n}\n            width={Math.max(width, 100)}\n            height={Math.max(height, 100)}\n            />\n          )}\n        </AutoSizer>\n        <ul className=\"log\">\n          {errors.map((err, idx) => <li key={idx} className=\"error\">{err}</li>)}\n        </ul>\n        <div className=\"credits\">\n          Model viewer by <a href=\"https://github.com/flowtsohg/mdx-m3-viewer\">flowtsohg@github</a>\n        </div>\n        {objects.length > 0 && (\n          <div className=\"controls\">\n            {objects.length > 1 && <label>Model:\n              <select value={current} onChange={this.setObject}>\n                {objects.map((obj, i) => <option key={i} value={i}>{obj.model.name}</option>)}\n              </select>\n            </label>}\n            {object != null && <label>Animation:\n              <select value={object.sequence} onChange={this.setSequence}>\n                <option value={-1}>None</option>\n                {object.model.sequences.map((seq, i) => <option key={i} value={i}>{seq.name}</option>)}\n              </select>\n            </label>}\n            {object != null && object.model.cameras.length > 0 && <label>Camera:\n              <select value={object.camera} onChange={this.setCamera}>\n                <option value={-1}>Free</option>\n                {object.model.cameras.map((cam, i) => <option key={i} value={i}>{cam.name}</option>)}\n              </select>\n            </label>}\n            <label>Team Color:\n              <select value={teamColor} onChange={this.setTeamColor}>\n                {TeamColors.map((name, i) => <option key={i} value={i}>{name}</option>)}\n              </select>\n            </label>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport pathHash, { makeUid } from 'data/hash';\nimport FileModelView from 'files/FileModel';\nimport AppCache from 'data/cache';\nimport keycode from 'keycode';\n\nexport default class ObjectModel extends React.Component {\n  state = {show: false};\n  static contextType = AppCache.DataContext;\n\n  show = e => {\n    this.setState({show: true});\n    e.preventDefault();\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.onKeyDown, true);\n  }\n\n  setPopup = node => {\n    this.popup = node;\n    if (node) {\n      document.addEventListener(\"keydown\", this.onKeyDown, true);\n    } else {\n      document.removeEventListener(\"keydown\", this.onKeyDown, true);\n    }\n  }\n\n  onKeyDown = e => {\n    switch (e.which) {\n    case keycode.codes.esc:\n      this.setState({show: false});\n      break;\n    default:\n    }\n  }\n\n  onMouseDown = e => {\n    if (e.target === this.popup) {\n      this.setState({show: false});\n    }\n  }\n\n  render() {\n    let path = this.props.path;\n    const data = this.context;\n    if (path === \"\" || path === \"_\" || path === \"-\") {\n      return path;\n    }\n    const m = path.match(/^(.*)(\\.\\w+)$/);\n    if (!m) {\n      path += \".mdx\";\n    } else if (m[2] !== \".mdx\") {\n      path = m[1] + \".mdx\";\n    }\n    const hash = pathHash(path);\n    const uid = makeUid(hash);\n\n    return (\n      <React.Fragment>\n        {this.state.show && ReactDOM.createPortal(\n          <div className=\"ObjectModel\" onMouseDown={this.onMouseDown} ref={this.setPopup}>\n            <div>\n              <FileModelView path={path}/>\n            </div>\n          </div>,\n          document.body\n        )}\n        <a href={`/${data.id}/files/${uid}`} onClick={this.show}>{path}</a>\n      </React.Fragment>\n    );\n  }\n}\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { BuildCtx, ObjectIcon, TileSets, DestructableCategory, DoodadCategory, TechList } from './ObjectCtx';\nimport { Popover, OverlayTrigger } from 'react-bootstrap';\nimport ObjectTooltip from './Tooltip';\nimport classNames from 'classnames';\nimport AppCache from 'data/cache';\nimport tagString from 'data/tagString';\nimport ObjectModel from './ObjectModel';\n\nconst ObjectLink = ({object}) => (\n  <BuildCtx.Consumer>\n    {build => <ObjectTooltip id={object.id}><Link to={`/${build}/${object.type}/${object.id}`}><ObjectIcon object={object}/>{object.name}</Link></ObjectTooltip>}\n  </BuildCtx.Consumer>\n);\n\nconst ObjectLinkRaw = ({object}) => (\n  <BuildCtx.Consumer>\n    {build => <ObjectTooltip id={object.id}><Link to={`/${build}/${object.type}/${object.id}`}>{object.id}</Link></ObjectTooltip>}\n  </BuildCtx.Consumer>\n);\n\nclass StringPopupCell extends React.PureComponent {\n  state = {popup: null};\n\n  onMouseOver = e => {\n    const rect = e.target.getBoundingClientRect();\n    const height = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n    if (rect.top + rect.bottom > height) {\n      this.setState({popup: \"top\"});\n    } else {\n      this.setState({popup: \"bottom\"});\n    }\n  }\n  onMouseOut = () => {\n    this.setState({popup: null});\n  }\n\n  render() {\n    const {children, tooltip} = this.props;\n    const {popup} = this.state;\n\n    return popup ? (\n      <td className={classNames(\"popupStringCell\", popup)} onMouseEnter={this.onMouseOver} onMouseLeave={this.onMouseOut}>\n        {tooltip}\n        {children}\n      </td>\n    ) : (\n      <td onMouseEnter={this.onMouseOver} onMouseLeave={this.onMouseOut}>{children}</td>\n    );\n  }\n}\n\nexport class PopupCell extends React.PureComponent {\n  state = {popup: false};\n\n  onMouseOver = e => {\n    if (e.target.scrollWidth >= e.target.offsetWidth) {\n      if (e.target.closest(\".ObjectModel\")) {\n        return;\n      }\n      this.setState({popup: true});\n    }\n  }\n  onMouseOut = () => {\n    this.setState({popup: false});\n  }\n\n  render() {\n    const {children} = this.props;\n    const {popup} = this.state;\n\n    return popup ? (\n      <td className=\"popupCell\" onMouseEnter={this.onMouseOver} onMouseLeave={this.onMouseOut}>\n        <div>{children}</div>#\n      </td>\n    ) : (\n      <td onMouseEnter={this.onMouseOver} onMouseLeave={this.onMouseOut}>{children}</td>\n    );\n  }\n}\n\nconst StringPopup = ({value, data}) => {\n  const result = tagString(value, data);\n  return <div>{result}</div>;\n};\n\nfunction formatString(str, data) {\n  if (str.match(/<.*>|\\|[crn]/i)) {\n    return (\n      <StringPopupCell tooltip={<StringPopup value={str} data={data}/>}>\n        {str}\n      </StringPopupCell>\n    );\n  } else {\n    return <PopupCell>{str}</PopupCell>;\n  }\n}\n\nclass StringIconPopup extends React.Component {\n  state = {visible: false};\n  onLoad = () => this.setState({visible: true});\n\n  render() {\n    const {path, cache, className, ...props} = this.props;\n    const image = cache.image(path);\n    if (image == null) {\n      return null;\n    }\n    return (\n      <Popover id=\"icon-preview\" {...props} className={classNames(className, {loading: !this.state.visible})}>\n        <img src={image} onLoad={this.onLoad} alt=\"icon\"/>\n      </Popover>\n    );\n  }\n}\n\nconst StringIcon = ({path}) => (\n  <AppCache.DataContext.Consumer>\n    {cache => {\n      const icon = cache.iconByName(path);\n      return (\n        <OverlayTrigger placement=\"top\" overlay={<StringIconPopup path={path} cache={cache}/>}>\n          <span>\n            {icon != null && <span className=\"Icon\" style={icon}/>}\n            {path}\n          </span>\n        </OverlayTrigger>\n      );\n    }}\n  </AppCache.DataContext.Consumer>\n);\n\nconst ObjectSubValue = ({value, meta, data}) => {\n  if (meta.type.indexOf(\"Flags\") >= 0) {\n    debugger;\n  }\n  let type = meta.type;\n  if (type === \"lightningList\") {\n    type = \"lightningEffect\";\n  }\n  if (data.types[type]) {\n    if (!value || value === \"_\") return \"None\";\n    return data.types[type][value] || \"value\";\n  }\n  switch (type) {\n  case \"bool\": return parseInt(value, 10) ? \"True\" : \"False\";\n  case \"string\": return value === \"_\" ? \"\" : value;\n  case \"char\": return value;\n  case \"int\": return parseInt(value, 10) || 0;\n  case \"real\":\n  case \"unreal\": return (parseFloat(value) || 0).toFixed(meta.stringExt || 2);\n  case \"destructableCategory\": return DestructableCategory[value] || value;\n  case \"tilesetList\": return TileSets[value] || value;\n  case \"doodadCategory\": return DoodadCategory[value] || value;\n\n  case \"techList\":\n    if (TechList[value]) return TechList[value];\n    // fall through\n  case \"buffCode\": case \"buffList\":\n  case \"effectCode\": case \"effectList\":\n  case \"unitCode\": case \"unitList\":\n  case \"abilCode\": case \"abilityList\": case \"heroAbilityList\":\n  case \"itemCode\": case \"itemList\":\n  case \"upgradeCode\": case \"upgradeList\":\n    if (value === \"_\") return \"\";\n    const obj = data.objects.find(obj => obj.id === value);\n    return obj ? <ObjectLink object={obj}/> : value;\n  case \"icon\":\n    return <StringIcon path={value}/>;\n  case \"model\":\n    return <ObjectModel path={value}/>;\n  default:\n    return value !== \"_\" && (value || \"None\");\n  }\n};\n\nconst ObjectSubValueRaw = ({value, meta, data}) => {\n  let type = meta.type;\n  switch (type) {\n  case \"int\": return parseInt(value, 10) || 0;\n  case \"real\":\n  case \"unreal\": return (parseFloat(value) || 0).toFixed(meta.stringExt || 2);\n  case \"techList\":\n  case \"buffCode\": case \"buffList\":\n  case \"effectCode\": case \"effectList\":\n  case \"unitCode\": case \"unitList\":\n  case \"abilCode\": case \"abilityList\": case \"heroAbilityList\":\n  case \"itemCode\": case \"itemList\":\n  case \"upgradeCode\": case \"upgradeList\":\n    const obj = data.objects.find(obj => obj.id === value);\n    return obj ? <ObjectLinkRaw object={obj}/> : value;\n  default:\n    return value;\n  }\n};\n\nexport const ObjectValue = ({value, meta, data, rawNames}) => {\n  const SubValue = rawNames ? ObjectSubValueRaw : ObjectSubValue;\n  if (meta.type.indexOf(\"List\") >= 0) {\n    if (value === \"_\") {\n      return <PopupCell>{rawNames ? value : \"\"}</PopupCell>;\n    }\n    if (value === \"\") return <PopupCell/>;\n    const list = [];\n    value.split(\",\").forEach((part, index) => {\n      if (list.length) list.push(rawNames ? \",\" : \", \");\n      list.push(<SubValue value={part} meta={meta} data={data} key={index}/>);\n    });\n    return <PopupCell>{list}</PopupCell>;\n  } else if (meta.type.indexOf(\"Flags\") >= 0 && !rawNames) {\n    const list = [];\n    const iValue = parseInt(value, 10);\n    for (let flag = 0; flag < 31 && (1 << flag) <= iValue; ++flag) {\n      if ((1 << flag) & iValue) {\n        if (list.length) list.push(rawNames ? \",\" : \", \");\n        list.push(<SubValue value={flag} meta={meta} data={data} key={flag}/>);\n      }\n    }\n    return <PopupCell>{list}</PopupCell>;\n  } else if (meta.type === \"string\") {\n    if (!rawNames && value === \"_\") value = \"\";\n    return formatString(value, data);\n  } else {\n    return <PopupCell><SubValue value={value} meta={meta} data={data}/></PopupCell>;\n  }\n};\n","import React from 'react';\nimport { RawNames, IdCtx, listObjectData } from './ObjectCtx';\nimport Panel from 'react-flex-panel';\nimport classNames from 'classnames';\n\nimport Title from 'data/title';\nimport { ObjectValue, PopupCell } from './ObjectValue';\n\nconst ObjectDataBodyEx = ({object, data, rawNames}) => {\n  const rows = [];\n  listObjectData(object, data, rawNames, (key, name, value, meta) => {\n    rows.push(\n      <tr key={key}>\n        <PopupCell>{name}</PopupCell>\n        <ObjectValue value={value} meta={meta} data={data} rawNames={rawNames}/>\n      </tr>\n    );\n  });\n\n  return (\n    <tbody>\n      {rows}\n    </tbody>\n  );\n};\n\nconst ObjectDataBody = props => (\n  <RawNames.Consumer>\n    {rawNames => <ObjectDataBodyEx {...props} rawNames={rawNames}/>}\n  </RawNames.Consumer>\n);\n\nclass DragHandle extends React.Component {\n  removeListeners() {\n    document.removeEventListener(\"mousemove\", this.onMouseMove, true);\n    document.removeEventListener(\"mouseup\", this.onMouseUp, true);\n  }\n  componentWillUnmount() {\n    this.removeListeners();\n  }\n\n  state = {};\n\n  onMouseDown = (e) => {\n    this.setState({dragPos: e.clientX - this.props.pos});\n    document.addEventListener(\"mousemove\", this.onMouseMove, true);\n    document.addEventListener(\"mouseup\", this.onMouseUp, true);\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  onMouseMove = (e) => {\n    const { dragPos } = this.state;\n    if ((e.buttons & 1) && dragPos != null) {\n      this.props.onChange(e.clientX - dragPos);\n      e.preventDefault();\n      e.stopPropagation();\n    } else {\n      this.onMouseUp(e);\n    }\n  }\n  onMouseUp = (e) => {\n    this.setState({dragPos: null});\n    this.removeListeners();\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  render() {\n    const {pos} = this.props;\n    return <div className=\"drag-handle\" style={{left: pos}} onMouseDown={this.onMouseDown}/>;\n  }\n}\n\nexport class ObjectData extends React.Component {\n  state = {sliderPos: 300};\n\n  static contextType = IdCtx;\n\n  setSliderPos = sliderPos => {\n    sliderPos = Math.max(50, sliderPos);\n    if (this.table_) {\n      sliderPos = Math.min(this.table_.offsetWidth - 50, sliderPos);\n    }\n    this.setState({sliderPos});\n    return sliderPos;\n  }\n\n  setRef = e => this.table_ = e;\n\n  render() {\n    const {data, className, ...props} = this.props;\n    const {sliderPos} = this.state;\n    const id = this.context;\n    const object = data.objects.find(obj => obj.id === id);\n    if (!object) {\n      return (\n        <Panel className={classNames(className, \"ObjectData\")} {...props}>\n          <div><span className=\"no-results\">{id ? \"Object not found.\" : \"Select an object from the list.\"}</span></div>\n        </Panel>\n      );\n    }\n\n    return (\n      <Panel className={classNames(className, \"ObjectData\")} {...props}>\n        <DragHandle pos={sliderPos} onChange={this.setSliderPos}/>\n        <Title title={object.name}/>\n        <div className=\"nonscrollable\">\n          <table>\n            <thead>\n              <tr>\n                <th width={sliderPos}>Name</th>\n                <th>Value</th>\n              </tr>\n            </thead>\n          </table>\n        </div>\n        <div className=\"scrollable\">\n          <table ref={this.setRef}>\n            <thead>\n              <tr>\n                <th width={sliderPos}>Name</th>\n                <th>Value</th>\n              </tr>\n            </thead>\n            <ObjectDataBody object={object} data={data}/>\n          </table>\n        </div>\n      </Panel>\n    );\n  }\n}\n","import React from 'react';\nimport { Route } from 'react-router-dom';\nimport { RawNames, RawNamesSwitch, BuildCtx, TypeCtx, IdCtx } from './ObjectCtx';\n\nimport Panel from 'react-flex-panel';\nimport { withAsync } from 'utils';\nimport AppCache from 'data/cache';\nimport Options from 'data/options';\n\nimport { ObjectList } from './ObjectList';\nimport { ObjectData } from './ObjectData';\n\nimport './ObjectView.scss';\n\nclass ObjectViewComponent extends React.Component {\n  static contextType = Options.Context;\n\n  setRawNames = () => this.context.update(\"rawNames\", !this.context.rawNames);\n\n  render() {\n    const {match: {params: {build, type, id}}, data} = this.props;\n    return (\n      <RawNames.Provider value={!!this.context.rawNames}>\n        <RawNamesSwitch.Provider value={this.setRawNames}>\n          <BuildCtx.Provider value={build}>\n            <TypeCtx.Provider value={type}>\n              <IdCtx.Provider value={id}>\n                <div className=\"ObjectView\">\n                  <Panel cols>\n                    <ObjectList size={300} minSize={100} resizable className=\"LeftPanel\" data={data} type={type} id={id} key={type}/>\n                    <ObjectData minSize={100} className=\"RightPanel\" data={data}/>\n                  </Panel>\n                </div>\n              </IdCtx.Provider>\n            </TypeCtx.Provider>\n          </BuildCtx.Provider>\n        </RawNamesSwitch.Provider>\n      </RawNames.Provider>\n    );\n  }\n}\n\nconst ObjectViewInner = withAsync({\n  data: ({match}, cache) => cache.objects()\n}, ObjectViewComponent, undefined, undefined);\n\nObjectViewInner.contextType = AppCache.DataContext;\n\nexport const ObjectView = () => <Route path={`/:build/:type/:id?`} component={ObjectViewInner}/>;\n","import React from 'react';\nexport const IdCtx = React.createContext(null);\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport classNames from 'classnames';\nimport { FormControl } from 'react-bootstrap';\nimport { AutoSizer, List } from 'react-virtualized';\nimport pathHash, { makeUid, parseUid, equalUid } from 'data/hash';\nimport { IdCtx } from './FileCtx';\nimport AppCache from 'data/cache';\nimport { withAsync } from 'utils';\n\nimport Panel from 'react-flex-panel';\n\nconst processFiles = (listfile, imExt) => {\n  const root = {\n    name: \"\",\n    dirs: {},\n    files: []\n  };\n  const names = listfile.split(\"\\n\").filter(n => n.length > 0);\n  names.forEach(path => {\n    const p = path.split(/[\\\\/:]/);\n    let cd = root;\n    for (let i = 0; i < p.length - 1; ++i) {\n      const pl = p[i].toLowerCase();\n      if (!cd.dirs[pl]) {\n        cd.dirs[pl] = {\n          name: p[i],\n          dirs: {},\n          files: []\n        };\n      }\n      cd = cd.dirs[pl];\n    }\n    const unk = path.match(/^Unknown\\\\([0-9A-F]{16})/);\n    const ext = path.match(/\\.(\\w{1,3})$/);\n    cd.files.push({\n      name: p[p.length - 1],\n      path,\n      key: unk ? parseUid(unk[1]) : pathHash(path, imExt),\n      ext: ext ? ext[1].toLowerCase() : \"unknown\",\n    });\n  });\n  const files = [];\n  const nameCompare = (a, b) => a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n  const process = dir => {\n    dir.dirs = Object.values(dir.dirs).sort(nameCompare);\n    dir.dirs.forEach(sub => process(sub));\n    dir.files.sort(nameCompare);\n    files.push(...dir.files);\n  };\n  process(root);\n  return { root, files };\n}\n\nconst FileLink = ({ file }) => (\n  <AppCache.DataContext.Consumer>\n    {data => (\n      <IdCtx.Consumer>\n        {id => (\n          <Link to={`/${data.id}/files/${makeUid(file.key)}`}\n            className={classNames(\"ObjectLink\", { searched: file.searched, selected: equalUid(id, file.key) })}>\n            <span className={\"Icon file-icon file-\" + file.ext} />\n            <span className=\"ObjectName\">{file.name}</span>\n          </Link>\n        )}\n      </IdCtx.Consumer>\n    )}\n  </AppCache.DataContext.Consumer>\n);\n\nclass FileItem {\n  constructor(file, parent) {\n    this.file = file;\n    this.file.parent = this;\n    this.parent = parent;\n    this.file.upSearchVisit = (fn) => {\n      fn(this.file);\n      this.upSearchVisit(fn);\n    }\n  }\n  height = 1;\n  render() {\n    return <FileLink file={this.file} />;\n  }\n  renderLine(index) {\n    return this.render();\n  }\n  upSearchVisit(fn) {\n    fn(this);\n    this.parent && this.parent.upSearchVisit(fn);\n  }\n  downSearchVisit(fn) {\n    fn(this);\n    fn(this.file);\n  }\n}\n\nclass FileDirectory {\n  constructor(dir, parent) {\n    this.parent = parent;\n    this.level = (parent ? parent.level + 1 : 0);\n    this.title = dir.name || '__ROOT__';\n    this.count = dir.files.length;\n    this.dirs = {};\n    this.children = [];\n    dir.dirs.forEach(subDir => {\n      const sub = new FileDirectory(subDir, this);\n      this.children.push(sub);\n      this.dirs[subDir.name.toLowerCase()] = sub;\n      this.count += sub.count;\n    });\n    dir.files.forEach(subFile => {\n      this.children.push(new FileItem(subFile, this));\n    });\n    this.openHeight = parent ? 1 : 0;\n    this.children.forEach(c => {\n      c.top = this.openHeight;\n      this.openHeight += c.height;\n    });\n    if (!parent) {\n      this.expanded = true;\n    } else {\n      this.expanded = false;\n    }\n    this.searched = false;\n  }\n  upSearchVisit(fn) {\n    fn(this);\n    this.parent && this.parent.upSearchVisit(fn);\n  }\n  downSearchVisit(fn) {\n    fn(this);\n    this.children.forEach(x => x.downSearchVisit(fn));\n  }\n  modHeight(delta, child) {\n    let index = child ? this.children.indexOf(child) : -1;\n    if (index >= 0) {\n      while (++index < this.children.length) {\n        this.children[index].top += delta;\n      }\n    }\n    this.openHeight += delta;\n    if (this.parent && this.expanded) {\n      this.parent.modHeight(delta, this);\n    } else if (this.onResize) {\n      this.onResize(this.height);\n    }\n  }\n\n  get height() {\n    return this.expanded ? this.openHeight : 1;\n  }\n\n  expandFile(file, parts) {\n    if (!parts) {\n      parts = file.path.split(/[\\\\/]/);\n    }\n    if (parts.length > 1) {\n      const name = parts[0].toLowerCase();\n      const sub = this.dirs[name];\n      if (sub) {\n        sub.expand();\n        return sub.expandFile(file, parts.slice(1)) + sub.top;\n      }\n    } else {\n      const sub = this.children.find(obj => obj.file === file);\n      if (sub) {\n        return sub.top;\n      }\n    }\n    return 0;\n  }\n\n  expand() {\n    if (!this.expanded && this.count > 0) {\n      this.expanded = true;\n      if (this.parent) {\n        this.parent.modHeight(this.openHeight - 1, this);\n      }\n    }\n  }\n\n  collapse() {\n    if (this.expanded && this.parent) {\n      this.expanded = false;\n      this.parent.modHeight(1 - this.openHeight, this);\n    }\n  }\n\n  toggle = () => {\n    if (this.expanded) {\n      this.collapse();\n    } else {\n      this.expand();\n    }\n  }\n\n  render() {\n    if (!this.parent) {\n      return <span>no-parent-dir</span>;\n    }\n    return (\n      <div onClick={this.preSelect} className={classNames(\"ObjectGroup\", { expanded: this.expanded, searched: this.searched })}>\n        <span className=\"toggle\" onClick={this.toggle} />\n        <span onDoubleClick={this.toggle}><span className=\"Icon\" />\n          <span className='title'>\n            {this.title}\n          </span>\n        </span>\n      </div>\n    );\n  }\n  firstLevelNode(index) {\n    if (this.expanded) {\n      let left = 0, right = this.children.length - 1;\n      while (left < right) {\n        const mid = (left + right + 1) >> 1;\n        if (this.children[mid].top > index) {\n          right = mid - 1;\n        } else {\n          left = mid;\n        }\n      }\n      return this.children[left];\n    }\n    return null;\n  }\n  renderLine(index) {\n    if (this.parent && !index) {\n      return this.render();\n    }\n    if (this.expanded) {\n      let left = 0, right = this.children.length - 1;\n      while (left < right) {\n        const mid = (left + right + 1) >> 1;\n        if (this.children[mid].top > index) {\n          right = mid - 1;\n        } else {\n          left = mid;\n        }\n      }\n      const child = this.children[left];\n      const subIndex = index - this.children[left].top;\n      const line = this.children[left].renderLine(subIndex);\n      let lineStyle = null;\n      if (this.parent) {\n        if (left < this.children.length - 1) {\n          if (subIndex === 0) {\n            lineStyle = \"tLine\";\n          } else {\n            lineStyle = \"line\";\n          }\n        } else if (subIndex === 0) {\n          lineStyle = \"halfLine\";\n        }\n      }\n      return (\n        <div className={classNames(\"indent\", lineStyle, { searched: child.searched })}>\n          {line}\n        </div>\n      );\n    }\n  }\n}\n\nclass FileListInner extends React.PureComponent {\n  state = { search: \"\", searchResults: null, searched: false };\n\n  constructor(props) {\n    super(props);\n\n    const res = processFiles(props.listFile, !props.isMap);\n    this.files = res.files;\n    this.root = new FileDirectory(res.root);\n    this.root.onResize = this.onResize;\n  }\n  onSearchKeyDown = (e) => {\n    if (e.which === 27) {\n      this.setState({ search: \"\", searchResults: null });\n      this.stateChanged = true;\n    }\n  }\n  onSearch = (e) => {\n    const search = e.target.value.trim();\n    let found = [];\n    let hasSearchResult = false;\n    //reset\n    this.root.downSearchVisit(node => node.searched = false);\n    if (search !== '' && this.files) {\n      const re = new RegExp(search.replace(/[|\\\\{}()[\\]^$+*?.]/g, \"\\\\$&\"), \"i\");\n      this.files.forEach((file, i) => {\n        let searched = !!file.path.match(re);\n        file.upSearchVisit((node) => {\n          node.searched = node.searched || searched;\n          if (node.searched) {\n            hasSearchResult = true;\n          }\n        })\n      });\n      this.setState({ search: e.target.value, searchResults: found, searched: hasSearchResult });\n    }\n    else {\n      this.root.downSearchVisit(node => node.searched = false);\n      this.setState({ search: e.target.value, searchResults: null, searched: hasSearchResult });\n    }\n     // console.log('forceUpdateGrid')\n     if (this._list) {\n      this._list.forceUpdateGrid();\n    }\n    this.stateChanged = true;\n  }\n\n  onResize = () => {\n    this.forceUpdate();\n  }\n  rowRenderer = ({ index, ...options }) => {\n\n    const { key, style } = options;\n    // const node = this.root.children[index];\n\n    const flNode = this.root.firstLevelNode(index);\n    return (\n      <div className={classNames(\"TreeRow\", { searched: flNode && flNode.searched })} key={key} style={style}>\n        {this.root.renderLine(index)}\n      </div>\n    );\n  }\n  rowRendererSearch = ({ index, ...options }) => {\n    const { key } = options;\n    return (\n      <div className={\"TreeRow\"} key={key}>\n        {this.root.renderLine(index)}\n      </div>\n    );\n  }\n  render() {\n    const { listFile, id, className, isMap, ...props } = this.props;\n    const { search, searchResults, searched } = this.state;\n\n    if (!this.root) {\n      return null;\n    }\n\n    if (!searchResults && !equalUid(this.root._id, id)) {\n      const file = this.files && this.files.find(obj => equalUid(obj.key, id));\n      if (file) {\n        this.root.onResize = null;\n        const index = this.root.expandFile(file);\n        this.root.onResize = this.onResize;\n        this.root._id = id;\n        setTimeout(() => {\n          if (this._list) {\n            this._list.scrollToRow(index);\n          }\n        });\n      }\n    }\n    return (\n      <Panel ref={\n        node=>this._panel=node\n      } className={classNames(className, \"ObjectList\")} {...props}>\n        <div className=\"search-box\">\n          <FormControl type=\"text\" value={search} placeholder=\"Search\" onKeyDown={this.onSearchKeyDown} onChange={this.onSearch} />\n        </div>\n        <div className={classNames(\"ObjectListItems\", searched)}>\n          <AutoSizer>\n            {({ width, height }) => (\n              <List className=\"ObjectLines\"\n                ref={node => this._list = node}\n                width={width}\n                height={height}\n                rowCount={this.root.height}\n                rowHeight={18}\n                rowRenderer={this.rowRenderer}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      </Panel>\n    );\n  }\n}\n\nconst EmptyPanel = ({ id, listFile, className, ...props }) => <Panel className={classNames(className, \"ObjectList\")} {...props} />;\n\nexport const FileList = withAsync({\n  listFile: ({ data }) => data.listFile(),\n}, ({ data, ...props }) => <FileListInner key={data.id} isMap={data.isMap} {...props} />, EmptyPanel, EmptyPanel);\n","import React from 'react';\nimport { Table, Column, AutoSizer } from 'react-virtualized';\nimport 'react-virtualized/styles.css'; // 引入样式  \nconst Cell = ({ value, comment }) => {\n  comment = comment && comment.replace(\"\\x1b\", \"\\n\");\n  const content = value == null || value === \"\" ? '' : value.toString();\n  return <div title={comment || content}>{content}</div>;\n}\n\nexport default class FileSlkView extends React.PureComponent {\n  rowGetter = ({ index }) => {\n    return this.props.data.rows[index];\n  };\n\n  getColumnWidth = ({ index }) => {\n    return 500;\n  };\n\n  renderColumns() {\n    const { data } = this.props;\n    // 确保只渲染指定数量的列\n    return Array.from({ length: data.cols }, (_, index) => (\n      <Column className={'col-' + index}\n        key={index}\n        width={this.getColumnWidth({ index })}\n        dataKey={String(index)}\n        cellRenderer={({ cellData, rowIndex }) => (\n          <Cell\n            value={cellData}\n            comment={data.comments && data.comments[rowIndex] && data.comments[rowIndex][index]}\n          />\n        )}\n      />\n    ));\n  }\n\n  render() {\n    const { data, style } = this.props;\n\n    // 确保有数据且cols为有效数值才渲染\n    if (!data || !data.rows || !Number.isInteger(data.cols) || data.cols <= 0) return null;\n\n    const tableWidth = data.cols * 50; // 基于正确的cols计算总宽度\n    return (\n      <div className=\"FileSlk\">\n        <AutoSizer>\n          {({ width, height }) => (\n            <Table\n              style={style}\n              width={tableWidth}\n              height={height - 22} // 可视区域高度，根据需要调整\n              rowHeight={23} // 自定义每行的高度\n              rowGetter={this.rowGetter}\n              rowCount={data.rows.length}\n              overscanRowCount={5} // 预加载行数，可优化滚动性能\n            >\n              {this.renderColumns()}\n            </Table>\n          )}\n        </AutoSizer>\n      </div>\n    );\n  }\n}","import React from 'react';\nimport { AutoSizer, List } from 'react-virtualized';\n\nexport default class FileHexView extends React.PureComponent {\n  state = {\n    foo: parseInt(\"foo\", 10),\n    bar: undefined,\n  }\n\n  onSearch = (text, dir) => {\n    if (this._list) {\n      return this._list.search(text, dir);\n    } else {\n      return null;\n    }\n  }\n\n  get digits() {\n    const length = this.props.data.length;\n    let numDigits = 4;\n    while ((1 << (numDigits * 4)) <= length) {\n      ++numDigits;\n    }\n    return numDigits;\n  }\n\n  rowRenderer = ({index, ...options}) => {\n    const {key, style} = options;\n    const offset = index * 16;\n    const digits = this.digits;\n    const row = [...this.props.data.subarray(offset, offset + 16)];\n    const dot = \".\".charCodeAt(0);\n    return (\n      <div className=\"HexRow\" key={key} style={style}>\n        <span className=\"offset\">{offset.toString(16).padStart(digits, '0')}</span>\n        <span className=\"hex\">\n          {row.map((byte, i) => <span key={i}>{byte.toString(16).padStart(2, '0')}</span>)}\n          {row.length < 16 && [...Array(16 - row.length)].map((nil, i) => <span key={i} className=\"padding\">{\"  \"}</span>)}\n        </span>\n        <span className=\"ascii\">\n          {String.fromCharCode(...row.map(byte => byte >= 32 && byte <= 126 ? byte : dot))}\n        </span>\n      </div>\n    );\n  }\n\n  render() {\n    const { data } = this.props;\n    return (\n      <AutoSizer>\n        {({width, height}) => (\n          <List className=\"HexLines\"\n                width={width}\n                height={height}\n                rowCount={Math.ceil(data.length / 16)}\n                rowHeight={19}\n                rowRenderer={this.rowRenderer}\n            />\n        )}\n      </AutoSizer>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport classNames from 'classnames';\nimport { List, defaultCellRangeRenderer } from 'react-virtualized';\nimport { createChainedFunction, replaceReact } from 'utils';\n\nimport './TextView.scss';\n\nfunction makeRegex(str) {\n  str = str.replace(/[-[\\]/{}()*+?.\\\\^$|]/g, \"\\\\$&\");\n  return new RegExp(\"(\" + str + \")\", \"ig\");\n}\n\nfunction getChildIndex(node, child) {\n  for (let i = 0; i < node.childNodes.length; ++i) {\n    if (node.childNodes[i] === child) {\n      return i;\n    }\n  }\n  return -1;\n}\nfunction getChildrenLength(node, count) {\n  if (count >= node.childNodes.length) return node.textContent.length;\n  let length = 0;\n  for (let i = 0; i < count; ++i) {\n    length += node.childNodes[i].textContent.length;\n  }\n  return length;\n}\nfunction getNodeOffset(node, anchor, anchorOffset) {\n  let offset = 0;\n  if (anchor.childNodes.length) {\n    offset = getChildrenLength(anchor, anchorOffset);\n  } else {\n    offset = anchorOffset;\n  }\n  while (anchor && anchor !== node) {\n    const parent = anchor.parentElement || anchor.parentNode;\n    offset += getChildrenLength(parent, getChildIndex(parent, anchor));\n    anchor = parent;\n  }\n  if (anchor !== node) return 0;\n  return offset;\n}\nfunction findNodeOffset(node, offset) {\n  if (!node.childNodes.length) return {node, offset: Math.min(node.textContent.length, offset)};\n  for (let i = 0; i < node.childNodes.length; ++i) {\n    const length = node.childNodes[i].textContent.length;\n    if (offset < length || i === node.childNodes.length - 1) {\n      return findNodeOffset(node.childNodes[i], offset);\n    }\n    offset -= length;\n  }\n  return {node, offset: 0};\n}\n\nfunction findMatches(text, regex, current, lineIndex) {\n  let match;\n  const matches = [];\n  while ((match = regex.exec(text))) {\n    matches.push({\n      index: match.index,\n      length: match[0].length,\n      className: (current && current.line === lineIndex && current.offset === match.index ? \"match-current\" : \"match\")\n    });\n  }\n  return matches;\n}\nfunction highlightMatches(text, matches, offset) {\n  const result = [];\n  let prev = 0;\n  matches.forEach(m => {\n    const start = Math.max(m.index - offset, 0), end = Math.min(m.index + m.length - offset, text.length);\n    if (end <= start) return;\n    if (start > prev) result.push(text.substring(prev, start));\n    result.push(<span className={m.className} key={m.index}>{text.substring(start, end)}</span>);\n    prev = end;\n  });\n  if (prev < text.length) {\n    result.push(text.substring(prev));\n  }\n  if (result.length === 1) {\n    return result[0];\n  }\n  return result;\n}\n\nexport default class TextView extends React.Component {\n  state = {\n    searchText: \"\",\n    searchMatches: [],\n  }\n  selection = {}\n\n  componentDidMount() {\n    document.addEventListener(\"copy\", this.onCopy);\n    document.addEventListener(\"selectionchange\", this.onSelect);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"copy\", this.onCopy);\n    document.removeEventListener(\"selectionchange\", this.onSelect);\n  }\n\n  search(text, direction) {\n    const searchMatch = this.state.searchMatch;\n    let allMatches = [], nextPos = null, found = null, result = null;\n    if (text.trim()) {\n      if (text === this.state.searchText) {\n        allMatches = this.state.searchMatches;\n      } else {\n        const textLower = text.toLowerCase();\n        this.props.lines.forEach((line, index) => {\n          let offset = 0, next;\n          const lineLower = line.toLowerCase();\n          while ((next = lineLower.indexOf(textLower, offset)) !== -1) {\n            allMatches.push({line: index, offset: next});\n            offset = next + textLower.length;\n          }\n        });\n      }\n      let curMatch = -1;\n      if (direction !== -1) {\n        const origin = (direction === 1 && searchMatch ?\n          {line: searchMatch.line, offset: searchMatch.offset + 1} :\n          this.selection.searchPos || {line: 0, offset: 0}\n        );\n        curMatch = allMatches.findIndex(m => m.line > origin.line || (m.line === origin.line && m.offset >= origin.offset));\n        if (curMatch < 0 && allMatches.length) curMatch = 0;\n      } else {\n        const origin = (searchMatch ? {line: searchMatch.line, offset: searchMatch.offset - 1} :\n          this.selection.searchPos || {line: 0, offset: 0}\n        );\n        allMatches.forEach((m, index) => {\n          if (m.line > origin.line || (m.line === origin.line && m.offset > origin.offset)) return;\n          curMatch = index;\n        });\n        if (curMatch < 0 && allMatches.length) curMatch = allMatches.length - 1;\n      }\n      nextPos = allMatches[curMatch];\n      found = nextPos && nextPos.line;\n      result = {pos: curMatch, count: allMatches.length};\n    }\n    if (this._list) {\n      this._list.forceUpdateGrid();\n    }\n    this.setState({\n      searchText: text,\n      searchMatch: nextPos,\n      searchRegex: text && text.trim() ? makeRegex(text) : null,\n      searchMatches: allMatches,\n    }, () => {\n      if (found && this._list) this._list.scrollToRow(found);      \n    });\n    return result;\n  }\n\n  nodeToPos2(node, offset) {\n    return this.nodeToPos({node, offset});\n  }\n  nodeToPos(data) {\n    if (!data || !this._node) return;\n    const {node, offset} = data;\n    if (!this._node.contains(node)) return;\n    if (node === this._firstLine) {\n      const lines = this._node.querySelectorAll(\".line\");\n      if (!lines.length) return;\n      const firstLine = parseInt(lines[0].getAttribute(\"data-line-number\"), 10) - 1;\n      return {line: firstLine, offset: 0};\n    }\n    if (node === this._lastLine) {\n      const lines = this._node.querySelectorAll(\".line\");\n      if (!lines.length) return;\n      const lastLine = parseInt(lines[lines.length - 1].getAttribute(\"data-line-number\"), 10) - 1;\n      return {line: lastLine, offset: lines[lines.length - 1].parentElement.textContent.length - 1};\n    }\n    let line = node;\n    while (line && line !== this._node && (!line.classList || !line.classList.contains(\"TextLine\"))) {\n      line = line.parentElement || line.parentNode;\n    }\n    if (!line || !line.classList || !line.classList.contains(\"TextLine\")) return;\n    const lineNode = line.querySelector(\".line\");\n    if (!lineNode) return;\n    const lineIndex = parseInt(lineNode.getAttribute(\"data-line-number\"), 10);\n    return {line: lineIndex - 1, offset: getNodeOffset(line, node, offset)};\n  }\n  posToNode2(line, offset) {\n    return this.posToNode({line, offset});\n  }\n  posToNode(data) {\n    if (!data || !this._node) return;\n    const {line, offset} = data;\n    let lineNode = this._node.querySelector(`.line[data-line-number=\"${line + 1}\"]`);\n    if (!lineNode) {\n      const lines = this._node.querySelectorAll(\".line\");\n      if (!lines.length) return;\n      const firstLine = parseInt(lines[0].getAttribute(\"data-line-number\"), 10) - 1;\n      if (line < firstLine && this._firstLine) {\n        return {node: this._firstLine, offset: 0};\n      }\n      const lastLine = parseInt(lines[lines.length - 1].getAttribute(\"data-line-number\"), 10) - 1;\n      if (line > lastLine && this._lastLine) {\n        return {node: this._lastLine, offset: 0};\n      }\n      return;\n    }\n\n    lineNode = lineNode.parentElement;\n    return findNodeOffset(lineNode, offset);\n  }\n  \n  onCopy = () => {\n    if (!this._node) return;\n    const selection = window.getSelection();\n    const tempNodes = [];\n    const ts = this.selection;\n    const anchorPos = this.nodeToPos2(selection.anchorNode, selection.anchorOffset);\n    const focusPos = this.nodeToPos2(selection.focusNode, selection.focusOffset);\n    if (ts.anchorPos && ts.focusPos && anchorPos && focusPos) {\n      const tsBegin = (ts.anchorPos.line < ts.focusPos.line ? ts.anchorPos : ts.focusPos);\n      const tsEnd = (ts.anchorPos.line < ts.focusPos.line ? ts.focusPos : ts.anchorPos);\n      const csBeginNode = (anchorPos.line < focusPos.line ? selection.anchorNode : selection.focusNode);\n      const csBegin = (anchorPos.line < focusPos.line ? anchorPos : focusPos);\n      const csEndNode = (anchorPos.line < focusPos.line ? selection.focusNode : selection.anchorNode);\n      const csEnd = (anchorPos.line < focusPos.line ? focusPos : anchorPos);\n      const raw = this.props.lines;\n      if (tsBegin.line < csBegin.line && csBeginNode.nodeType === 1) {\n        const lines = [];\n        for (let i = tsBegin.line; i <= csBegin.line; ++i) {\n          let line = raw[i];\n          if (!line) continue;\n          if (i === tsBegin.line) line = line.substr(tsBegin.offset);\n          else if (i === csBegin.line) line = line.substr(0, csBegin.offset);\n          lines.push(line);\n        }\n        const prepend = lines.join(\"\\n\");\n        if (prepend.length) {\n          const tempNode = document.createElement(\"span\");\n          tempNode.style.position = \"absolute\";\n          tempNode.style.left = \"-10000px\";\n          tempNode.style.top = \"-10000px\";\n          tempNode.style.fontSize = \"0\";\n          tempNode.style.whiteSpace = \"pre\";\n          tempNode.innerText = prepend;\n          tempNodes.push(tempNode);\n          csBeginNode.appendChild(tempNode);\n        }\n      }\n      if (tsEnd.line > csEnd.line && csEndNode.nodeType === 1) {\n        const lines = [];\n        for (let i = csEnd.line + 1; i <= tsEnd.line; ++i) {\n          let line = raw[i];\n          if (!line) continue;\n          if (i === csEnd.line) line = line.substr(csEnd.offset);\n          else if (i === tsEnd.line) line = line.substr(0, tsEnd.offset);\n          lines.push(line);\n        }\n        const append = lines.join(\"\\n\");\n        if (append.length) {\n          const tempNode = document.createElement(\"span\");\n          tempNode.style.position = \"absolute\";\n          tempNode.style.left = \"-10000px\";\n          tempNode.style.top = \"-10000px\";\n          tempNode.style.fontSize = \"0\";\n          tempNode.style.whiteSpace = \"pre\";\n          tempNode.innerText = append;\n          tempNodes.push(tempNode);\n          csEndNode.parentElement.insertBefore(tempNode, csEndNode);\n        }\n      }\n    }\n    if (tempNodes.length) {\n      window.setTimeout(() => {\n        tempNodes.forEach(node => node.parentNode.removeChild(node));\n      }, 100);\n    }\n  }\n  \n  onSelect = () => {\n    if (this.suppressSelect || !this.selection || !this._node) return;\n    const selection = window.getSelection();\n    const ts = this.selection;\n\n    const badNode = node => {\n      let line = node;\n      while (line && line !== this._node && line !== this._firstLine &&\n          line !== this._lastLine && (!line.classList || !line.classList.contains(\"TextLine\"))) {\n        line = line.parentElement || line.parentNode;\n      }\n      if (line === this._firstLine || line === this._lastLine) return false;\n      return !line.classList || !line.classList.contains(\"TextLine\");\n    };\n\n    if (!selection.anchorNode || !this._node.contains(selection.anchorNode)) {\n      ts.anchorPos = null;\n    } else if (!badNode(selection.anchorNode)) {\n      const p2n = this.posToNode(ts.anchorPos);\n      const tsPos = this.nodeToPos(p2n);\n      const csPos = this.nodeToPos2(selection.anchorNode, selection.anchorOffset);\n      if (tsPos && csPos && tsPos.line === csPos.line && tsPos.offset === csPos.offset) {\n        selection.setBaseAndExtent(p2n.node, p2n.offset, selection.focusNode, selection.focusOffset);\n      } else {\n        ts.anchorPos = csPos;\n        ts.searchPos = csPos;\n      }\n    }\n\n    if (!selection.focusNode || !this._node.contains(selection.focusNode)) {\n      ts.focusPos = null;\n    } else if (!badNode(selection.focusNode)) {\n      const tsPos = this.nodeToPos(this.posToNode(ts.focusPos));\n      const csPos = this.nodeToPos2(selection.focusNode, selection.focusOffset);\n      if (tsPos && csPos && tsPos.line === csPos.line && tsPos.offset === csPos.offset) {\n        // do nothing\n      } else {\n        ts.focusPos = csPos;\n      }\n    }\n  }\n  selectRange(fromPos, toPos) {\n    const selection = window.getSelection();\n    const from = this.posToNode(fromPos);\n    const to = this.posToNode(toPos);\n    selection.setBaseAndExtent(\n      from ? from.node : selection.anchorNode,\n      from ? from.offset : selection.anchorOffset,\n      to ? to.node : selection.focusNode,\n      to ? to.offset : selection.focusOffset\n    );\n    this.selection.anchorPos = fromPos;\n    this.selection.searchPos = fromPos;\n    this.selection.focusPos = toPos;\n  }\n  onScroll = ({scrollTop}) => {\n    const ts = this.selection;\n    if (!ts || !ts.anchorPos || !ts.focusPos) return;\n    this.suppressSelect = true;\n    this.selectRange(ts.anchorPos, ts.focusPos);\n    if (this.unsuppress) clearTimeout(this.unsuppress);\n    this.unsuppress = setTimeout(() => {\n      this.suppressSelect = false;\n      delete this.unsuppress;\n    }, 100);\n  }\n\n  cellRangeRenderer = (props) => {\n    const children = defaultCellRangeRenderer(props);\n    children.unshift(<div key=\"first-line\" className=\"fake-line\" ref={node => this._firstLine = node}><span/></div>);\n    children.push(<div key=\"last-line\" className=\"fake-line\" ref={node => this._lastLine = node}><span/></div>);\n    return children;\n  }\n\n  rowRenderer = ({index, key, style}) => {\n    const { highlightExpr, highlightFunc } = this.props;\n    if (this.props.padding) {\n      if (index === 0 || index > this.props.lines.length) {\n        return null;\n      } else {\n        index -= 1;\n      }\n    }\n    const search = this.state.searchRegex;\n    let line = this.props.lines[index];\n    const matches = search && findMatches(line, search, this.state.searchMatch, index);\n    if (highlightExpr && highlightFunc) {\n      line = replaceReact(line, highlightExpr, match => {\n        let str = match[0];\n        if (matches) {\n          str = highlightMatches(match[0], matches, match.index);\n        }\n        return highlightFunc(str, match);\n      }, (start, end) => {\n        let str = line.substring(start, end);\n        if (matches) {\n          str = highlightMatches(str, matches, start);\n        }\n        return str;\n      });\n    } else if (matches) {\n      line = highlightMatches(line, matches, 0);\n    }\n    return (\n      <div className=\"TextLine\" key={key} style={style}>\n        <span className=\"line\" data-line-number={index + 1}/>\n        {line}{\"\\n\"}\n        <span className=\"eol\"/>\n      </div>\n    );\n  }\n\n  rowMeasure = ({index}) => {\n    if (this.props.padding) {\n      if (index === 0 || index > this.props.lines.length) {\n        return this.props.padding;\n      } else {\n        index -= 1;\n      }\n    }\n    return this.props.heights[index];\n  }\n\n  componentDidUpdate() {\n    if (this._lines !== this.props.lines) {\n      this._list.recomputeRowHeights();\n      this._lines = this.props.lines;\n      this.selection = {};\n    }\n  }\n\n  setScroll = scrollTop => {\n    if (this._list) {\n      this._list.scrollToPosition(scrollTop);\n    } else {\n      this._scrollTop = scrollTop;\n    }\n  }\n  setList = e => {\n    this._list = e;\n    this._node = ReactDOM.findDOMNode(e);\n    if (this._scrollTop != null) {\n      this._list.scrollToPosition(this._scrollTop);\n      delete this._scrollTop;\n    }\n  }\n\n  render() {\n    const {\n      className,\n      onScroll,\n      heights,\n      lines,\n      highlightExpr,\n      highlightFunc,\n      padding,\n      ...props\n    } = this.props;\n    let count = lines.length + (padding ? 2 : 0);\n    if (this._heights !== heights) {\n      this._heights = heights;\n      this._avgHeight = heights.reduce((sum, h) => sum + h, (padding || 0) * 2) / count;\n    }\n    return <List\n      className={classNames(className, \"TextView\")}\n      ref={this.setList}\n      rowCount={count}\n      estimatedRowSize={this._avgHeight}\n      onScroll={createChainedFunction(this.onScroll, onScroll)}\n      cellRangeRenderer={this.cellRangeRenderer}\n      rowHeight={this.rowMeasure}\n      rowRenderer={this.rowRenderer}\n      {...props}\n    />;\n  }\n}\n","import React from 'react';\n\nconst makeRegex = (str, middle) => {\n  const prefix = (middle && !str.match(/^\\s/) ? \"\" : \"\\\\b\") + \"(\";\n  const suffix = \")\" + (str.match(/\\s$/) ? \"\\\\b\" : \"\");\n  str = str.trim().replace(/[-[\\]/{}()*+?.\\\\^$|]/g, \"\\\\$&\");\n  if (!str) return;\n  return new RegExp(prefix + str + suffix, \"i\");\n};\nconst underlinerFunc = (value, regex) => {\n  let found = false;\n  return value.split(regex).map((str, index) => {\n    if (!found && str.match(regex)) {\n      found = true;\n      return <u key={index}>{str}</u>;\n    } else {\n      return str;\n    }\n  });\n};\n\nfunction replaceReact(text, regex, func, plain) {\n  const result = [];\n  let prev = 0, match;\n  if (!plain) {\n    plain = (start, end) => text.substring(start, end);\n  }\n  const append = val => {\n    if (val == null) {\n      return;\n    } else if (typeof val === \"string\" && result.length && typeof result[result.length - 1] === \"string\") {\n      result[result.length - 1] += val;\n    } else {\n      result.push(val);\n    }\n  }\n  while ((match = regex.exec(text))) {\n    if (match.index > prev) {\n      append(plain(prev, match.index));\n    }\n    const element = func(match);\n    if (React.isValidElement(element)) {\n      append(React.cloneElement(element, {key: match.index}));\n    } else {\n      append(element);\n    }\n    prev = match.index + match[0].length;\n  }\n  if (prev < text.length) {\n    append(plain(prev, text.length));\n  }\n  return result;\n}\n\nexport { makeRegex, underlinerFunc, replaceReact };\n","import React from 'react';\nimport { AutoSizer } from 'react-virtualized';\nimport { SearchBox } from 'utils';\nimport TextView from 'text/TextView';\n\nexport default class FileTextView extends React.PureComponent {\n  onSearch = (text, dir) => {\n    if (this._list) {\n      return this._list.search(text, dir);\n    } else {\n      return null;\n    }\n  }\n\n  render() {\n    const { lines, heights } = this.props;\n    return (\n      <React.Fragment>\n        <SearchBox onSearch={this.onSearch}/>\n        <AutoSizer>\n          {({width, height}) => (\n            <TextView ref={e => this._list = e}\n                      width={width}\n                      height={height}\n                      lines={lines}\n                      heights={heights}\n                      padding={6}/>\n          )}\n        </AutoSizer>\n      </React.Fragment>\n    );\n  }\n}\n","import React from 'react';\n\nconst imageInfo = data => {\n  const view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n  if (view.getUint32(0, false) === 0x424C5031) { // BLP1\n    return {\n      format: \"BLP\",\n      width: view.getUint32(12, true),\n      height: view.getUint32(16, true),\n    };\n  } else if (view.getUint32(0, false) === 0x424C5032) { // BLP2\n    return {\n      format: \"BLP v2\",\n      width: view.getUint32(12, true),\n      height: view.getUint32(16, true),\n    };\n  } else if (view.getUint32(0, false) === 0x44445320) { // DDS\n    return {\n      format: \"DDS\",\n      width: view.getUint32(16, true),\n      height: view.getUint32(12, true),\n    };\n  } else if (view.getUint32(0, false) === 0x47494638 && (data[4] === 0x37 || data[4] === 0x39) && data[5] === 0x61) { // GIF87a / GIF89a\n    const bpp = 1 + 7 & data[10];\n    const hdrPos = 13 + 3 * bpp;\n    return {\n      format: \"GIF\",\n      width: view.getInt16(hdrPos + 5, true),\n      height: view.getInt16(hdrPos + 7, true),\n    };\n  } else if (view.getUint32(0, false) === 0x89504E47 && view.getUint32(4, false) === 0x0D0A1A0A) { // PNG\n    return {\n      format: \"PNG\",\n      width: view.getUint32(16, false),\n      height: view.getUint32(20, false),\n    };\n  } else if (data[0] === 0xFF && data[1] === 0xD8 && data[2] === 0xFF && data[data.length - 2] === 0xFF && data[data.length - 1] === 0xD9) {\n    return {\n      format: \"JPG\",\n      width: \"?\",\n      height: \"?\",\n    };\n  } else { // TGA ?\n    return {\n      format: \"TGA\",\n      width: view.getInt16(12, true),\n      height: view.getInt16(14, true),\n    };\n  }\n};\n\nexport default class FileImageView extends React.PureComponent {\n  render() {\n    const { data, image, name } = this.props;\n    const info = data && imageInfo(data);\n    return (\n      <div>\n        {info != null && <div>{info.width}x{info.height} ({info.format})</div>}\n        <div>\n          <img src={image} alt={name || \"Extracted\"}/>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nexport default class FileAudioView extends React.PureComponent {\n  render() {\n    const { audio } = this.props;\n    return (\n      <div>\n        <audio controls controlsList=\"nodownload\" src={audio}/>\n      </div>\n    );\n  }\n}\n","export default function parseKeywords(meta) {\n  const out = {};\n\n  out[\"globals\"] = \"jkey\";\n  out[\"endglobals\"] = \"jkey\";\n  out[\"local\"] = \"jkey\";\n  out[\"type\"] = \"jkey\";\n  out[\"constant\"] = \"jkey\";\n  out[\"native\"] = \"jkey\";\n  out[\"function\"] = \"jkey\";\n  out[\"takes\"] = \"jkey\";\n  out[\"returns\"] = \"jkey\";\n  out[\"endfunction\"] = \"jkey\";\n  out[\"return\"] = \"jkey\";\n  out[\"set\"] = \"jkey\";\n  out[\"call\"] = \"jkey\";\n  out[\"if\"] = \"jkey\";\n  out[\"then\"] = \"jkey\";\n  out[\"endif\"] = \"jkey\";\n  out[\"else\"] = \"jkey\";\n  out[\"elseif\"] = \"jkey\";\n  out[\"loop\"] = \"jkey\";\n  out[\"endloop\"] = \"jkey\";\n  out[\"exitwhen\"] = \"jkey\";\n  out[\"or\"] = \"jkey\";\n  out[\"and\"] = \"jkey\";\n  out[\"not\"] = \"jkey\";\n\n  out[\"array\"] = \"jtyp\";\n  out[\"integer\"] = \"jtyp\";\n  out[\"real\"] = \"jtyp\";\n  out[\"string\"] = \"jtyp\";\n  out[\"boolean\"] = \"jtyp\";\n  out[\"code\"] = \"jtyp\";\n  out[\"handle\"] = \"jtyp\";\n  out[\"nothing\"] = \"jtyp\";\n\n  out[\"null\"] = \"jcon\";\n\n  const common = (meta.loadFile(\"Scripts\\\\common.j\") || \"\").split(/[\\r\\n]/);\n  const commonRe = /^\\s*(?:constant\\s+)?(\\w+)\\s+(?:array\\s+)?(\\w+)\\b/;\n  common.forEach(line => {\n    const m = line.match(commonRe);\n    if (m) {\n      if (m[1] === \"native\") {\n        out[m[2]] = \"jnat\";\n      } else if (m[1] === \"type\") {\n        out[m[2]] = \"jtyp\";\n      } else {\n        out[m[2]] = \"jcon\";\n      }\n    }\n  });\n\n  const blizzard = (meta.loadFile(\"Scripts\\\\Blizzard.j\") || \"\").split(/[\\r\\n]/);\n  let inFunc = false, inGlob = false;\n  blizzard.forEach(line => {\n    let m;\n    if (inFunc) {\n      if (line.match(/^\\s*endfunction\\b/)) {\n        inFunc = false;\n      }\n    } else if ((m = line.match(/^\\s*(globals|endglobals)\\b/))) {\n      inGlob = (m[1] === \"globals\");\n    } else if (inGlob) {\n      if ((m = line.match(/^\\s*(?:constant\\s+)?\\w+\\s+(?:array\\s+)?(\\w+)\\b/))) {\n        out[m[1]] = \"jcon\";\n      }\n    } else {\n      if ((m = line.match(/^\\s*(?:constant\\s+)?function\\s+(\\w+)\\b/))) {\n        out[m[1]] = \"jbjf\";\n      }\n    }\n  });\n\n  return out;\n}\n","import React from 'react';\nimport { AutoSizer } from 'react-virtualized';\nimport { SearchBox } from 'utils';\nimport TextView from 'text/TextView';\nimport AppCache from 'data/cache';\nimport { withAsync } from 'utils';\nimport parseKeywords from 'jass/keywords';\n\nconst tokenRe = /([a-z_]\\w*)|(0x[0-9a-z]+|\\d+\\.?|\\d*\\.\\d+)|('[^'\\\\]*(?:\\\\.[^'\\\\]*)*')|(\"[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*\")|(\\/\\/.*)/gi;\nconst RowHeight = 16;\n\nclass FileJassInner extends React.PureComponent {\n  onSearch = (text, dir) => this._list ? this._list.search(text, dir) : null;\n\n  constructor(props) {\n    super(props);\n    this.keywords = parseKeywords(props.meta);\n  }\n\n  tokenFunc = (text, [all, id, num, chr, str, com]) => {\n    if (id) {\n      const kw = this.keywords[id];\n      if (kw) {\n        return <span className={kw}>{text}</span>;\n      } else {\n        return text;\n      }\n    } else if (num) {\n      return <span className=\"jnum\">{text}</span>;\n    } else if (chr) {\n      return <span className=\"jchr\">{text}</span>;\n    } else if (str) {\n      return <span className=\"jstr\">{text}</span>;\n    } else if (com) {\n      return <span className=\"jcom\">{text}</span>;\n    } else {\n      return text;\n    }\n  };\n  \n  render() {\n    const {lines} = this.props;\n    const heights = lines.map(line => line.split(\"\\n\").length * RowHeight);\n    return (\n      <React.Fragment>\n        <SearchBox onSearch={this.onSearch}/>\n        <AutoSizer>\n          {({width, height}) => (\n            <TextView ref={e => this._list = e}\n                    className=\"JassColors\"\n                    width={width}\n                    height={height}\n                    lines={lines}\n                    heights={heights}\n                    highlightExpr={tokenRe}\n                    highlightFunc={this.tokenFunc}/>\n          )}\n        </AutoSizer>\n      </React.Fragment>\n    );\n  }\n}\n\nconst FileJassView = withAsync({\n  meta: (props, context) => context.meta(),\n}, FileJassInner, undefined, undefined);\nFileJassView.contextType = AppCache.Context;\n\nexport default FileJassView;\n","import React from 'react';\nimport classNames from 'classnames';\nimport pathHash, { makeUid, parseUid, equalUid } from 'data/hash';\nimport { downloadBlob } from 'utils';\nimport SlkFile from 'mdx/parsers/slk/file';\nimport encoding from 'text-encoding';\nimport Title from 'data/title';\nimport { ObjectInspector } from 'react-inspector';\nimport FileSlkView from './FileSlk2';\nimport FileHexView from './FileHex';\nimport FileTextView from './FileText';\nimport FileImageView from './FileImage';\nimport FileAudioView from './FileAudio';\nimport FileModelView from './FileModel';\nimport FileJassView from './FileJass';\n\nimport Formats from 'mdx/parsers/w3x';\nimport ObjectPreviewEx from './ObjectPreviewEx';\n\nconst gameFileTypes = {\n  \"war3map.doo\": Formats.doo.File,\n  \"war3map.imp\": Formats.imp.File,\n  \"war3map.mmp\": Formats.mmp.File,\n  \"war3map.shd\": Formats.shd.File,\n  \"war3mapUnits.doo\": Formats.unitsdoo.File,\n  \"war3map.w3c\": Formats.w3c.File,\n  \"war3map.w3d\": Formats.w3d.File,\n  \"war3map.w3e\": Formats.w3e.File,\n  \"war3map.w3f\": Formats.w3f.File,\n  \"war3map.w3i\": Formats.w3i.File,\n  \"war3map.w3o\": Formats.w3o.File,\n  \"war3map.w3r\": Formats.w3r.File,\n  \"war3map.w3s\": Formats.w3s.File,\n  \"war3map.w3u\": Formats.w3u.File,\n  \"war3map.wct\": Formats.wct.File,\n  \"war3map.wpm\": Formats.wpm.File,\n  \"war3map.wtg\": Formats.wtg.File,\n  \"war3map.wts\": Formats.wts.File,\n};\n\n// const nodeRenderer = ({ depth, name, data, isNonenumerable, expanded }) => {\n//   if (depth === 0) {\n//     if (typeof name === 'string') {\n//       return (\n//         <span>\n//           <span>{name}</span>\n//           <span>: </span>\n//           <ObjectPreviewEx data={data} />\n//         </span>\n//       );\n//     } else {\n//       return <ObjectPreviewEx data={data} />;\n//     }\n//   } else {\n//     // return <ObjectLabel name={name} data={data} isNonenumerable={isNonenumerable} />;\n//     return <span>{name}</span>\n//   }\n// };\n\nexport class FileData extends React.Component {\n  constructor(props) {\n    super(props);\n    const { id, data } = this.props;\n    const state = { panel: \"hex\" };\n    const file = data && data.archive && data.archive.loadBinary(id);\n    if (file) {\n      this.binary = file.data;\n      this.flags = file.flags;\n      if (this.flags & 1) {\n        const text = new encoding.TextDecoder().decode(this.binary);\n        const lines = text.split(/\\r\\n?|\\n/);\n        if (this.isJass()) {\n          this.jass = lines;\n          state.panel = \"jass\";\n        } else {\n          this.text = [];\n          const maxLength = 2048;\n          lines.forEach(line => {\n            if (line.length > maxLength) {\n              for (let i = 0; i < line.length; i += maxLength) {\n                this.text.push(line.substr(i, maxLength));\n              }\n            } else {\n              this.text.push(line);\n            }\n          });\n          this.textHeights = this.text.map(() => 16);\n          state.panel = \"text\";\n\n          try {\n            this.slk = new SlkFile(text);\n            state.panel = \"slk\";\n          } catch (e) {\n          }\n        }\n      }\n      if (this.flags & 6) {\n        const blob = new Blob([this.binary], { type: (this.flags & 4) ? \"audio/mpeg\" : \"audio/wav\" });\n        this.audio = URL.createObjectURL(blob);\n        state.panel = \"audio\";\n      }\n      if (this.flags & 8) {\n        state.panel = \"model\";\n      }\n      this.image = data.archive.loadImage(id);\n      if (this.image) {\n        state.panel = \"image\";\n      }\n      const name = this.getName();\n      if (gameFileTypes[name]) {\n        try {\n          this.data = new gameFileTypes[name](this.binary.buffer);\n          state.panel = \"data\";\n        } catch (e) {\n          console.error(name,'Unable to decoding map content. ',e);\n        }\n      }\n    }\n    this.state = state;\n  }\n\n  makePanel(name, title) {\n    return <li key={name} className={classNames(\"tab-button\", { \"active\": this.state.panel === name })}\n      onClick={() => this.setState({ panel: name })}>{title}</li>;\n  }\n\n\n  renderPane() {\n    const { panel } = this.state;\n    switch (panel) {\n      case \"hex\": return <FileHexView data={this.binary} />;\n      case \"slk\": return <FileSlkView data={this.slk} />;\n      case \"text\": return <FileTextView lines={this.text} heights={this.textHeights} />;\n      case \"jass\": return <FileJassView lines={this.jass} />;\n      case \"audio\": return <FileAudioView audio={this.audio} />;\n      case \"model\": return <FileModelView id={this.props.id} />;\n      case \"image\": return <FileImageView data={this.binary} image={this.image} />;\n      case \"data\":\n        console.log(this.data)\n        return <ObjectInspector expandLevel={1} data={this.data} />;\n      // case \"data\": throw Error('missing component')\n      default: return null;\n    }\n  }\n\n  getName() {\n    let { data, id } = this.props;\n    if (this.name) {\n      return this.name;\n    }\n    const listfile = data.file(\"listfile.txt\");\n    if (listfile) {\n      const names = listfile.split(\"\\n\").filter(n => n.length > 0);\n      const name = names.find(path => {\n        const unk = path.match(/^Unknown\\\\([0-9A-F]{16})/);\n        const key = unk ? parseUid(unk[1]) : pathHash(path);\n        return equalUid(key, id);\n      });\n      if (name != null) {\n        const parts = name.split(/[\\\\/]/);\n        return this.name = parts[parts.length - 1];\n      }\n    }\n    return this.name = makeUid(id);\n  }\n\n  isJass() {\n    const name = this.getName();\n    if (name && name.match(/\\.j$/i)) {\n      return true;\n    }\n    const id = this.props.id;\n    return equalUid(pathHash('war3map.j'), id) || equalUid(pathHash('Scripts/war3map.j'), id);\n  }\n\n  onDownload = () => {\n    const blob = new Blob([this.binary], { type: \"application/octet-stream\" });\n    downloadBlob(blob, this.getName());\n  }\n\n  render() {\n    if (!this.binary) {\n      return null;\n    }\n\n    return (\n      <div className=\"FileData\">\n        <Title title={this.getName()} />\n        <ul className=\"tab-line\">\n          <li key=\"dl\" className=\"tab-xbutton\" onClick={this.onDownload}>Download <span glyph=\"download-alt\" /></li>\n          {this.makePanel(\"hex\", \"Hex\")}\n          {this.text != null && this.makePanel(\"text\", \"Text\")}\n          {this.jass != null && this.makePanel(\"jass\", \"JASS\")}\n          {this.slk != null && this.makePanel(\"slk\", \"SLK\")}\n          {this.audio != null && this.makePanel(\"audio\", \"Audio\")}\n          {(this.flags & 8) !== 0 && this.makePanel(\"model\", \"Model\")}\n          {this.image != null && this.makePanel(\"image\", \"Image\")}\n          {this.data != null && this.makePanel(\"data\", \"Data\")}\n        </ul>\n        <div className={classNames(\"tab-pane\", this.state.panel)}>\n          {this.renderPane()}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nconst Cell = ({type: Type, value, comment}) => {\n  comment = comment && comment.replace(\"\\x1b\", \"\\n\");\n  const cell = value == null || value == \"\" ? <Type title={comment}>&nbsp;</Type> : <Type title={comment}>{value.toString()}</Type>;\n  return cell;\n}\n\nexport default class FileSlkView extends React.PureComponent {\n  render() {\n    const { data } = this.props;\n    const iotaX = [...Array(data.cols)].map((_, i) => i);\n    const iotaY = [...data.rows].map((_, i) => i);\n    return (\n      <div className=\"FileSlk\">\n        <table>\n          {data.rows.length >= 1 && <thead>\n            <tr>\n              {iotaX.map(i => <Cell type=\"th\" key={i} value={data.rows[0][i] || \"\"} comment={data.comments && data.comments[0] && data.comments[0][i]}/>)}\n            </tr>\n          </thead>}\n          <tbody>\n            {iotaY.filter(i => i > 0).map(i => (\n              <tr key={i}>\n                {iotaX.map(j => <Cell type=\"td\" key={j} value={data.rows[i] ? data.rows[i][j] : undefined}\n                  comment={data.comments && data.comments[i] && data.comments[i][j]}/>)}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport classNames from 'classnames';\nimport pathHash, { parseUid, equalUid } from 'data/hash';\n\nimport { downloadBlob, withAsync } from 'utils';\nimport SlkFile from 'mdx/parsers/slk/file';\nimport encoding from 'text-encoding';\nimport Title from 'data/title';\n\nimport FileSlkView from './FileSlk';\nimport FileHexView from './FileHex';\nimport FileTextView from './FileText';\nimport FileImageView from './FileImage';\nimport FileModelView from './FileModel';\nimport FileJassView from './FileJass';\n\nconst GameFileImage = ({image, name}) => (\n  <div className=\"FileData\">\n    <ul className=\"tab-line\">\n      <li className=\"tab-button active\">Image</li>\n    </ul>\n    <div className=\"tab-pane image\">\n      <FileImageView image={image} name={name}/>\n    </div>\n  </div>\n);\n\nclass GameFileInner extends React.Component {\n  constructor(props) {\n    super(props);\n    const {name, data} = props;\n\n    const state = {panel: \"hex\"};\n\n    const ext = name.substr(name.lastIndexOf(\".\")).toLowerCase();\n    if (ext === \".mdx\") {\n      this.model = true;\n      state.panel = \"model\";\n    } else if (ext === \".j\") {\n      const text = new encoding.TextDecoder().decode(data);\n      this.jass = text.split(/\\r\\n?|\\n/);\n      state.panel = \"jass\";\n    } else if (ext === \".txt\" || ext === \".slk\" || ext=='.fdf' || ext=='.toc') {\n      const text = new encoding.TextDecoder().decode(data);\n      const lines = text.split(/\\r\\n?|\\n/);\n      this.text = [];\n      const maxLength = 2048;\n      lines.forEach(line => {\n        if (line.length > maxLength) {\n          for (let i = 0; i < line.length; i += maxLength) {\n            this.text.push(line.substr(i, maxLength));\n          }\n        } else {\n          this.text.push(line);\n        }\n      });\n      this.textHeights = this.text.map(() => 16);\n      state.panel = \"text\";\n      if (ext === \".slk\") {\n        try {\n          this.slk = new SlkFile(text);\n          state.panel = \"slk\";\n        } catch (e) {\n        }\n      }\n    }\n    this.state = state;\n  }\n\n  makePanel(name, title) {\n    return <li key={name} className={classNames(\"tab-button\", {\"active\": this.state.panel === name})}\n      onClick={() => this.setState({panel: name})}>{title}</li>;\n  }\n\n\n  renderPane() {\n    const { panel } = this.state;\n    switch (panel) {\n    case \"hex\": return <FileHexView data={this.props.data}/>;\n    case \"text\": return <FileTextView lines={this.text} heights={this.textHeights}/>;\n    case \"jass\": return <FileJassView lines={this.jass}/>;\n    case \"model\": return <FileModelView id={this.props.id}/>;\n    case \"slk\": return <FileSlkView data={this.slk}/>;\n    default: return null;\n    }\n  }\n\n  onDownload = () => {\n    const blob = new Blob([this.props.data], {type: \"application/octet-stream\"});\n    downloadBlob(blob, this.props.name);\n  }\n\n  render() {\n    return (\n      <div className=\"FileData\">\n        <Title title={this.props.name}/>\n        <ul className=\"tab-line\">\n          <li key=\"dl\" className=\"tab-xbutton\" onClick={this.onDownload}>Download <span glyph=\"download-alt\"/></li>\n          {this.makePanel(\"hex\", \"Hex\")}\n          {this.text != null && this.makePanel(\"text\", \"Text\")}\n          {this.jass != null && this.makePanel(\"jass\", \"JASS\")}\n          {this.slk != null && this.makePanel(\"slk\", \"SLK\")}\n          {!!this.model && this.makePanel(\"model\", \"Model\")}\n        </ul>\n        <div className={classNames(\"tab-pane\", this.state.panel)}>\n          {this.renderPane()}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst GameFileLoader = withAsync({\n  data: ({data}) => data,\n}, GameFileInner, undefined, undefined);\n\nclass GameFileDataFinder extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const {id, data, listFile} = this.props;\n\n    const names = listFile.split(\"\\n\").filter(n => n.length > 0);\n    this.name = names.find(path => {\n      const unk = path.match(/^Unknown\\\\([0-9A-F]{16})/);\n      const key = unk ? parseUid(unk[1]) : pathHash(path, true);\n      return equalUid(key, id);\n    });\n    if (this.name != null) {\n      this.name = this.name.split(/[\\\\/]/).pop();\n      const ext = this.name.substr(this.name.lastIndexOf(\".\")).toLowerCase();\n\n      if ([\".blp\", \".dds\", \".gif\", \".jpg\", \".jpeg\", \".png\", \".tga\"].indexOf(ext) >= 0) {\n        this.image = data.image(id);\n      } else {\n        this.data = fetch(data.cache.binary(id))\n          .then(response => response.ok ? response.arrayBuffer() : Promise.reject())\n          .then(ab => new Uint8Array(ab));\n      }\n    }\n  }\n  render() {\n    const { data, id } = this.props;\n    if (this.image) {\n      return <GameFileImage image={this.image} name={this.name}/>;\n    } else if (this.data) {\n      return <GameFileLoader data={this.data} name={this.name} id={id}/>;\n    } else {\n      return <span className=\"message\">File not found</span>;\n    }\n  }\n}\n\nexport const GameFileData = withAsync({\n  listFile: ({data}) => data.listFile(),\n}, GameFileDataFinder, undefined, undefined);\n","import React from 'react';\nimport { Route } from 'react-router-dom';\nimport { IdCtx } from './FileCtx';\n\nimport Panel from 'react-flex-panel';\nimport AppCache from 'data/cache';\n\nimport { parseUid } from 'data/hash';\n\nimport { FileList } from './FileList';\nimport { FileData } from './FileData';\nimport { GameFileData } from './GameFileData';\n\nimport './FileView.scss';\n\nclass FileViewComponent extends React.Component {\n  static contextType = AppCache.DataContext;\n\n  render() {\n    const data = this.context;\n    const uid = this.props.match.params.id;\n    const key = uid == null ? null : parseUid(uid);\n    return (\n      <IdCtx.Provider value={key}>\n        <div className=\"FileView\">\n          <Panel cols>\n            <FileList size={300} minSize={100} resizable className=\"LeftPanel\" data={data} id={key}/>\n            <Panel className=\"RightPanel\" minSize={100}>\n              {key == null ? (\n                <span className=\"message\">Select a file to view its contents</span>\n              ) : (data.hasFile(key) ? (\n                <FileData data={data} id={key} key={uid}/>\n              ) : (data.archive ? (\n                <span className=\"message\">File not found</span>\n              ) : (\n                <GameFileData data={data} id={key} key={uid}/>\n              )))}\n            </Panel>\n          </Panel>\n        </div>\n      </IdCtx.Provider>\n    );\n  }\n}\n\nexport const FileView = () => <Route path={`/:build/files/:id?`} component={FileViewComponent}/>;\n","import React from 'react';\nimport AppCache from 'data/cache';\nimport tagString from 'data/tagString';\n\nexport default class MapHome extends React.Component {\n  static contextType = AppCache.DataContext;\n\n  render() {\n    const data = this.context;\n    let info = data.file(\"info.json\");\n    if (info) {\n      info = JSON.parse(info);\n    }\n    let image = null;\n    if (data.archive) {\n      image = data.archive.loadImage(\"war3mapPreview.tga\");\n      if (!image) {\n        image = data.archive.loadImage(\"war3mapMap.blp\");\n      }\n    }\n    return (\n      <div className=\"HomePage\">\n        <h3>{data.core ? \"Warcraft III Patch \" : \"\"}{data.name}</h3>\n        {info != null && (\n          <ul className=\"mapInfo\">\n            <li><b>Name:</b> <span>{tagString(info.name)}</span></li>\n            <li><b>Suggested Players:</b> <span>{tagString(info.players)}</span></li>\n            <li><b>Description:</b> <span>{tagString(info.description)}</span></li>\n            <li><b>Author:</b> <span>{tagString(info.author)}</span></li>\n            <li>\n              {image != null && <img src={image} alt=\"Map preview\" />}\n            </li>\n          </ul>\n        )}\n\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport keycode from 'keycode';\nimport { Link } from 'react-router-dom';\nimport { Navbar, Nav, NavItem, FormGroup, Popover } from 'react-bootstrap';\nimport { AutoSizer } from 'react-virtualized';\nimport AppCache from 'data/cache';\nimport Options from 'data/options';\nimport { withAsync, OverlayNav, ScrollSaver, downloadBlob } from 'utils';\nimport parseKeywords from './keywords';\nimport encoding from 'text-encoding';\n\nimport TextView from 'text/TextView';\n\nimport './JassView.scss';\n\nconst tokenRe = /([a-z_]\\w*)|(0x[0-9a-z]+|\\d+\\.?|\\d*\\.\\d+)|('[^'\\\\]*(?:\\\\.[^'\\\\]*)*')|(\"[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*\")|(\\/\\/.*)/gi;\n\nconst RowHeight = 16;\n\nconst numOption = (setter, key, e) => {\n  const val = parseInt(e.target.value, 10);\n  if (!isNaN(val)) {\n    setter(key, val);\n  }\n}\n\nconst JassOptions = ({options, setOption, ...props}) => {\n  const flag = name => <input type=\"checkbox\" checked={!!options[name]} onChange={e => setOption(name, e.target.checked ? 1 : 0)}/>;\n  const number = name => <input type=\"number\" min={1} max={10} step={1} value={options[name]} onChange={e => numOption(setOption, name, e)}/>;\n  return (\n    <Popover id=\"jass-options\" {...props}>\n      <form>\n        <label>{flag(\"indentFlag\")} Auto Indent</label>\n        {!!options.indentFlag && (\n          <label className=\"indent\">Amount {number(\"indent\")}</label>\n        )}\n        <label>{flag(\"restoreInt\")} Restore numbers</label>\n        <label>{flag(\"restoreId\")} Restore object IDs</label>\n        <label>{flag(\"insertLines\")} Insert blank lines</label>\n        <label>{flag(\"restoreStrings\")} Restore trigger strings</label>\n        <label>{flag(\"renameFunctionsFlag\")} Rename functions</label>\n        {!!options.renameFunctionsFlag && (\n          <label className=\"indent\">Max length {number(\"renameFunctions\")}</label>\n        )}\n        <label>{flag(\"renameGlobalsFlag\")} Rename globals</label>\n        {!!options.renameGlobalsFlag && (\n          <label className=\"indent\">Max length {number(\"renameGlobals\")}</label>\n        )}\n        <label>{flag(\"renameLocalsFlag\")} Rename locals</label>\n        {!!options.renameLocalsFlag && (\n          <label className=\"indent\">Max length {number(\"renameLocals\")}</label>\n        )}\n        <label>{flag(\"inlineFunctions\")} Inline one-line functions</label>\n        <label>{flag(\"getObjectName\")} Restore getObjectName strings</label>\n      </form>\n    </Popover>\n  );\n}\n\nclass JassViewer extends React.Component {\n  state = {\n    searchResults: null,\n    searchText: \"\",\n  }\n\n  search(text, dir) {\n    this.setState({\n      searchText: text,\n      searchResults: this._list ? this._list.search(text, dir) : null,\n    });\n  }\n  \n  findPrev = () => this.search(this.state.searchText, -1);\n  findNext = () => this.search(this.state.searchText, 1);\n  onSearchChange = e => this.search(e.target.value, 0);\n  onSearchKeyDown = e => {\n    switch (e.which) {\n    case keycode.codes.enter:\n      this.search(this.state.searchText, 1);\n      e.preventDefault();\n      break;\n    case keycode.codes.esc:\n      this.search(\"\", 0);\n      e.preventDefault();\n      break;\n    default:\n    }\n  }\n  onKeyDown = e => {\n    const { searchText } = this.state;\n    switch (e.which) {\n    case keycode.codes.f3:\n      if (e.shiftKey) {\n        this.search(searchText, -1);\n      } else {\n        this.search(searchText, 1);\n      }\n      if (this._search) {\n        this._search.focus();\n        this._search.select();\n      }\n      e.preventDefault();\n      break;\n    case keycode.codes.f:\n      if (e.ctrlKey && this._search) {\n        this._search.focus();\n        this._search.select();\n        e.preventDefault();\n      }\n      break;\n    default:\n    }\n  }\n\n  tokenFunc = (text, [all, id, num, chr, str, com]) => {\n    const { data, keywords, objects } = this.props;\n    if (id) {\n      const kw = keywords[id];\n      if (kw) {\n        return <span className={kw}>{text}</span>;\n      } else {\n        return text;\n      }\n    } else if (num) {\n      return <span className=\"jnum\">{text}</span>;\n    } else if (chr) {\n      const m = chr.match(/^'(.*)'$/);\n      const obj = m && objects.objects.find(o => o.id === m[1]);\n      const elt = <span className=\"jchr\">{text}</span>;\n      if (obj) {\n        return (\n          <Link to={`/${data.id}/${obj.type}/${obj.id}`} title={obj.name}>\n            {elt}\n          </Link>\n        );\n      } else {\n        return elt;\n      }\n    } else if (str) {\n      return <span className=\"jstr\">{text}</span>;\n    } else if (com) {\n      return <span className=\"jcom\">{text}</span>;\n    } else {\n      return text;\n    }\n  };\n\n  onDownload = () => {\n    const text = this.props.lines.join(\"\\n\").replace(\"\\n\", \"\\r\\n\");\n    const encoded = new encoding.TextEncoder().encode(text);\n    const blob = new Blob([encoded], {type: \"text/plain\"});\n    downloadBlob(blob, \"war3map.j\");\n  }\n\n  setScroll = scrollTop => {\n    if (this._list) {\n      this._list.setScroll(scrollTop);\n    } else {\n      this._scrollTop = scrollTop;\n    }\n  }\n  setList = e => {\n    this._list = e;\n    if (this._scrollTop != null) {\n      this._list.setScroll(this._scrollTop);\n      delete this._scrollTop;\n    }\n  }\n\n  render() {\n    const { lines, heights, options, setOption } = this.props;\n    const { searchResults, searchText } = this.state;\n    const results = searchResults && searchResults.count;\n    return (\n      <div className=\"JassView\" onKeyDown={this.onKeyDown}>\n        <Navbar fluid=\"true\" className=\"JassHeader\">\n          <Nav>\n            <NavItem event-key=\"source\" onClick={this.onDownload}>\n              Download <span glyph=\"download-alt\"/>\n            </NavItem>\n            <OverlayNav trigger=\"click\" rootClose placement=\"bottom\" overlay={<JassOptions options={options} setOption={setOption}/>}>\n              <NavItem event-key=\"format\">\n                Formatting\n              </NavItem>\n            </OverlayNav>\n          </Nav>\n          <Navbar.Form pullLeft>\n            <FormGroup>\n              <div className=\"form-control\">\n                <input type=\"text\"\n                       placeholder=\"Search\"\n                       ref={node => this._search = node}\n                       value={searchText}\n                       onChange={this.onSearchChange}\n                       onKeyDown={this.onSearchKeyDown}/>\n                {!!searchResults && <span className=\"search-tag\">{(searchResults.pos + 1) + \"/\" + searchResults.count}</span>}\n                <button disabled={!results} onClick={this.findPrev} title=\"Previous\"><span glyph=\"chevron-up\"/></button>\n                <button disabled={!results} onClick={this.findNext} title=\"Next\"><span glyph=\"chevron-down\"/></button>\n              </div>\n            </FormGroup>\n          </Navbar.Form>\n        </Navbar>\n        <ScrollSaver onRef={e => this._saver = e} callback={this.setScroll}/>\n        <div className=\"JassSource\" ref={node => this._node = node}>\n          <AutoSizer>\n            {({width, height}) => (\n              <TextView\n                    className=\"JassLines\"\n                    ref={this.setList}\n                    width={width}\n                    height={height}\n                    lines={lines}\n                    heights={heights}\n                    onScroll={this.onScroll}\n                    highlightExpr={tokenRe}\n                    highlightFunc={this.tokenFunc}/>\n            )}\n          </AutoSizer>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst JassViewerWithData = withAsync({\n  objects: ({data}) => data.objects(),\n}, JassViewer, undefined, undefined);\n\nclass JassViewParser extends React.PureComponent {\n  static contextType = AppCache.DataContext;\n\n  render() {\n    const {options, setOption, meta} = this.props;\n    const data = this.context;\n    const {indentFlag, renameGlobalsFlag, renameFunctionsFlag, renameLocalsFlag, ...realOptions} = options;\n    if (!indentFlag) realOptions.indent = 0;\n    if (!renameGlobalsFlag) realOptions.renameGlobals = 0;\n    if (!renameFunctionsFlag) realOptions.renameFunctions = 0;\n    if (!renameLocalsFlag) realOptions.renameLocals = 0;\n    const lines = data.jass(realOptions);\n    const heights = lines.map(line => line.split(\"\\n\").length * RowHeight);\n    const keywords = parseKeywords(meta);\n\n    return <JassViewerWithData keywords={keywords} data={data} lines={lines} heights={heights} options={options} setOption={setOption}/>;\n  }\n}\n\nclass JassViewInner extends React.Component {\n  static defaultState = {\n    indentFlag: true,\n    indent: 2,\n    restoreInt: 1,\n    restoreId: 1,\n    insertLines: 1,\n    restoreStrings: 1,\n    renameGlobalsFlag: true,\n    renameGlobals: 5,\n    renameFunctionsFlag: true,\n    renameFunctions: 5,\n    renameLocalsFlag: true,\n    renameLocals: 5,\n    inlineFunctions: 1,\n    getObjectName: 1,\n  }\n\n  static contextType = Options.Context;\n\n  get options() {\n    return this.context.jassFormatting || JassViewInner.defaultState;\n  }\n\n  setOption = (name, value) => {\n    const opt = {...this.options};\n    opt[name] = value;\n    this.context.update(\"jassFormatting\", opt);\n  }\n\n  render() {\n    return <JassViewParser meta={this.props.meta} options={this.options} setOption={this.setOption}/>;\n  }\n}\n\nconst JassView = withAsync({\n  meta: (props, context) => context.meta(),\n}, JassViewInner, undefined, undefined);\nJassView.contextType = AppCache.Context;\n\nexport default JassView;\n","import React from 'react';\nimport AppCache from 'data/cache';\nimport ModelViewer from 'mdx';\nimport { withAsync } from 'utils';\nimport { AutoSizer } from 'react-virtualized';\n\nimport { vec3 } from 'gl-matrix';\n\nimport { ObjectIcon } from 'objects/ObjectCtx';\nimport ObjectTooltip from 'objects/Tooltip';\nimport pathHash from 'data/hash';\n\n// const v3pos = vec3.create(), v3dir = vec3.create(), v3up = vec3.create(), v3sub = vec3.create();\n// const m4rot = mat4.create();\n// const f32rot = new Float32Array(1);\n\n/*\nYnI3 = level 3 campaign\nrde2\nYiI7 = level 7 permanent\n\nYYI/ = any item any level\nYiI/ = any permanent\nYnI/ = any campaign\n\nYYI5 = any level 5\nYoI5 = 5 misc\nYmI5 = 5 purchasable\nYlI5 = 5 artifact\nYkI5 = 5 power up\nYjI5 = 5 charged\n\n\\0\\0\\0Q = first group\nram3\n\\0\\0\\0\\0 = none\n\n\\0\\1\\0Q = second group, pos 0\n\\2\\0\\0Q = first group, pos 2\n*/\n\nconst itemGroupTypes = {\n  'i': 'Permanent',\n  'n': 'Campaign',\n  'o': 'Miscellaneous',\n  'm': 'Purchasable',\n  'l': 'Artifact',\n  'k': 'PowerUp',\n  'j': 'Charged',\n};\n\nfunction computeDrops(unit, viewer) {\n  const drops = [];\n  function addTable({items}) {\n    const output = [];\n    function addItem(id, chance) {\n      const item = viewer.unitsData.find(unit => unit.id === id);\n      if (item && item.type === \"item\") {\n        output.push({item, chance});\n      } else if (id === '\\0\\0\\0\\0') {\n        return;\n      } else if (id[3] === 'Q') {\n        const tableId = id.charCodeAt(1) + id.charCodeAt(2) * 256;\n        const columnId = id.charCodeAt(0);\n        const table = viewer.w3i.randomUnitTables.find(tbl => tbl.id === tableId);\n        if (table) {\n          table.units.forEach(({chance: chance2, ids}) => {\n            if (ids[columnId]) {\n              addItem(ids[columnId], chance * chance2 / 100);\n            }\n          });\n        }\n      } else if (id[0] === 'Y' && id[2] === 'I') {\n        const type = itemGroupTypes[id[1]];\n        const level = (id[3] === '/' ? -1 : parseInt(id[3]));\n        const items = viewer.unitsData.filter(unit => {\n          if (unit.type === 'item') {\n            if (level >= 0 && parseInt(unit.data.level) !== level) {\n              return false;\n            }\n            if (type && unit.data.class !== type) {\n              return false;\n            }\n            return true;\n          } else {\n            return false;\n          }\n        });\n        output.push({name: `Random ${level >= 0 ? 'Level ' + level : 'Any Level'} ${type ? (type === 'PowerUp' ? 'Power Up Item' : type + ' Item') : 'Item'}`, chance, items});\n      }\n    }\n    items.forEach(({id, chance}) => addItem(id, chance));\n    drops.push(output);\n  }\n  if (unit.droppedItemTable >= 0) {\n    const table = viewer.w3i.randomItemTables.find(tbl => tbl.id === unit.droppedItemTable);\n    if (table) {\n      table.sets.forEach(set => addTable(set));\n    }\n  }\n  unit.droppedItemSets.forEach(set => addTable(set));\n  return drops;\n}\n\nconst DropInfo = ({item}) => {\n  const [expanded, setExpanded] = React.useState(false);\n  const cache = React.useContext(AppCache.DataContext);\n  return (\n    <li>\n      <ObjectTooltip id={item.item && item.item.id}>\n        {item.item ? (\n          <a href={`/${cache.id}/${item.item.type}/${item.item.id}`} target=\"_blank\">\n            <ObjectIcon object={item.item}/>\n            {item.chance.toFixed(0)}% - {item.item.name}\n          </a>\n        ) : (\n          <span>\n            <ObjectIcon object={{'icon': pathHash('ReplaceableTextures\\\\WorldEditUI\\\\Editor-Random-Item.blp')}}/>\n            {item.chance.toFixed(0)}% - {item.name}\n            {item.items != null && item.items.length > 0 && <span className=\"listToggle\" onClick={() => setExpanded(!expanded)}>{expanded ? `(hide list)` : `(${item.items.length} items)`}</span>}\n          </span>\n        )}\n      </ObjectTooltip>\n      {item.items != null && expanded && (\n        <ul className=\"ItemDrop\">\n          {item.items.map(item => (\n            <li key={item.id}>\n              <ObjectTooltip id={item.id}>\n                <a href={`/${cache.id}/${item.type}/${item.id}`} target=\"_blank\">\n                  <ObjectIcon object={item}/> {item.name}\n                </a>\n              </ObjectTooltip>\n            </li>\n          ))}\n        </ul>\n      )}\n    </li>\n  );\n};\n\nclass SelectionWindow extends React.Component {\n  coords = {x: 50, y: 50}\n\n  static contextType = AppCache.DataContext;\n\n  unregisterEvents() {\n    document.removeEventListener('mousemove', this.onMouseMove, true);\n    document.removeEventListener('mouseup', this.onMouseUp, true);\n  }\n  componentWillUnmount() {\n    this.unregisterEvents();\n  }\n\n  onMouseDown = e => {\n    this.pressed = {x: e.clientX, y: e.clientY};\n    document.addEventListener('mousemove', this.onMouseMove, true);\n    document.addEventListener('mouseup', this.onMouseUp, true);\n  }\n  onMouseMove = e => {\n    const dx = e.clientX - this.pressed.x, dy = e.clientY - this.pressed.y;\n    this.coords.x += dx;\n    this.coords.y += dy;\n    if (this.element) {\n      this.element.style.left = this.coords.x + 'px';\n      this.element.style.top = this.coords.y + 'px';\n    }\n    this.pressed = {x: e.clientX, y: e.clientY};\n  }\n  onMouseUp = () => {\n    delete this.pressed;\n    this.unregisterEvents();\n  }\n\n  render() {\n    const { gameData, units, viewer, deselect } = this.props;\n    const cache = this.context;\n    const style = {left: this.coords.x, top: this.coords.y};\n    if (!units.length) {\n      style.display = \"none\";\n    }\n    const misc = gameData.getSection('Misc');\n    const makeXpFunction = (xpTable, xpA, xpB, xpC) => {\n      return function xpFunction(level) {\n        if (level <= 0) {\n          return 0;\n        } if (level <= xpTable.length) {\n          return xpTable[level - 1];\n        } else {\n          return xpA * xpFunction(level - 1) + xpB * level + xpC;\n        }\n      };\n    };\n    const xpFunction = makeXpFunction(\n      misc.get('grantnormalxp').split(',').map(x => parseInt(x)),\n      parseInt(misc.get('grantnormalxpformulaa')),\n      parseInt(misc.get('grantnormalxpformulab')),\n      parseInt(misc.get('grantnormalxpformulac'))\n    );\n    let totalXp = 0;\n    const body = (\n      <ul className=\"Body\">\n        {units.map(({unit}) => {\n          const data = viewer.unitsData.find(row => row.id === unit.id);\n          if (!data) {\n            return null;\n          }\n          let dropDiv = null;\n          const drops = computeDrops(unit, viewer);\n          if (drops) {\n            const makeDrop = table => (\n              <ul className=\"ItemDrop\">\n                {table.map(item =><DropInfo key={item.name} item={item}/>)}\n              </ul>\n            );\n            if (drops.length > 1) {\n              dropDiv = (\n                <ul className=\"ItemDrops\">\n                  {drops.map((table, idx) => (\n                    <li>\n                      <span>Dropped Item Set {idx + 1} (Total Chance: {table.reduce((sum, {chance}) => sum + chance, 0).toFixed(0)}%)</span>\n                      {makeDrop(table)}\n                    </li>\n                  ))}\n                </ul>\n              );\n            } else if (drops.length) {\n              dropDiv = makeDrop(drops[0]);\n            }\n          }\n          let levelDiv = null;\n          const level = parseInt(data.data.level);\n          if (!isNaN(level)) {\n            const xp = xpFunction(level);\n            totalXp += xp;\n            levelDiv = <span>&nbsp;({xp} XP)</span>;\n          }\n          return (\n            <li key={unit.id}>\n              <ObjectTooltip id={unit.id}>\n                <a href={`/${cache.id}/${data.type}/${data.id}`} target=\"_blank\">\n                  <ObjectIcon object={data}/><span className=\"name\">{data.name}</span> {levelDiv}\n                </a>\n              </ObjectTooltip>\n              {dropDiv}\n            </li>\n          );\n        })}\n      </ul>\n    );\n    return (\n      <div className=\"Selection\" style={style} ref={n => this.element = n}>\n        <div className=\"Heading\" onMouseDown={this.onMouseDown}>Selection{totalXp > 0 ? ` (${totalXp} Total XP)` : ''}</div>\n        {body}\n      </div>\n    );\n  }\n}\nconst AsyncSelectionWindow = withAsync({\n  gameData: ({gameData}) => gameData\n}, SelectionWindow);\n\nexport default class MapHome extends React.Component {\n  static contextType = AppCache.DataContext;\n  state = {\n    notifications: [],\n    selection: [],\n  }\n\n  yaw = 0;\n  pitch = -Math.PI / 4;\n  distance = 2000;\n  center = vec3.create();\n  minDistance = 500;\n  maxDistance = 20000;\n\n  constructor(props, context) {\n    super(props, context);\n    const dataPath = \"Units\\\\MiscGame.txt\";\n    if (context.hasFile(dataPath)) {\n      this.gameData = Promise.resolve(context.file(dataPath));\n    } else {\n      this.gameData = fetch(context.cache.binary(dataPath)).then(b => b.text());\n    }\n    this.gameData = this.gameData.then(text => new ModelViewer.parsers.ini.IniFile(text));\n  }\n  \n  componentWillUnmount() {\n    if (this.frame) {\n      cancelAnimationFrame(this.frame);\n      delete this.frame;\n    }\n    this.removeEvents();\n  }\n\n  onContextMenu = e => {\n    e.preventDefault();\n  }\n  onMouseDown = e => {\n    document.addEventListener(\"mousemove\", this.onMouseMove, true);\n    document.addEventListener(\"mouseup\", this.onMouseUp, true);\n    this.dragStart = this.dragPos = {x: e.clientX, y: e.clientY};\n    this.dragButton = (e.ctrlKey ? 2 : (e.shiftKey ? 1 : 0));\n    e.preventDefault();\n  }\n  onMouseMove = e => {\n    if (this.dragPos && this.canvas) {\n      const dx = e.clientX - this.dragPos.x,\n      dy = e.clientY - this.dragPos.y;\n      const dim = (this.canvas.width + this.canvas.height) / 2;\n      if (this.dragButton === 2) {\n        this.yaw += dx * 2 * Math.PI / dim;\n        this.pitch += dy * 2 * Math.PI / dim;\n        while (this.yaw > Math.PI) {\n          this.yaw -= Math.PI * 2;\n        }\n        while (this.yaw < -Math.PI) {\n          this.yaw += Math.PI * 2;\n        }\n        this.pitch = Math.min(this.pitch, 0);\n        this.pitch = Math.max(this.pitch, -Math.PI / 2 + 0.05);\n      } else if (this.dragButton === 1) {\n        let rc = this.canvas.getBoundingClientRect();\n        let x0 = Math.min(this.dragStart.x, this.dragPos.x) - rc.left;\n        let y0 = Math.min(this.dragStart.y, this.dragPos.y) - rc.top;\n        let x1 = Math.max(this.dragStart.x, this.dragPos.x) - rc.left;\n        let y1 = Math.max(this.dragStart.y, this.dragPos.y) - rc.top;\n        if (this.viewer) {\n          this.dragSelection = this.viewer.selectUnits(x0, y0, x1, y1);\n        }\n        if (this.selrect) {\n          this.selrect.style.display = 'block';\n          this.selrect.style.left = `${x0}px`;\n          this.selrect.style.top = `${y0}px`;\n          this.selrect.style.width = `${x1 - x0}px`;\n          this.selrect.style.height = `${y1 - y0}px`;\n        }\n      } else if (this.dragButton === 0) {\n        const vx = vec3.fromValues(-Math.cos(this.yaw), Math.sin(this.yaw), 0);\n        const vy = vec3.fromValues(vx[1], -vx[0], 0);\n        const vel = this.distance / dim;\n        vec3.scaleAndAdd(this.center, this.center, vx, dx * vel);\n        vec3.scaleAndAdd(this.center, this.center, vy, dy * vel);\n      }\n      this.dragPos = {x: e.clientX, y: e.clientY};\n    }\n    e.preventDefault();\n  }\n  onMouseUp = e => {\n    if (this.dragPos && this.viewer) {\n      if (this.dragButton < 2 && Math.abs(this.dragPos.x - this.dragStart.x) < 5 && Math.abs(this.dragPos.y - this.dragStart.y) < 5) {\n        let rc = this.canvas.getBoundingClientRect();\n        let units = this.viewer.selectUnit(e.clientX - rc.left, e.clientY - rc.top, this.dragButton);\n        this.setState({selection: units});\n      }\n      delete this.dragPos;\n    }\n    if (this.dragSelection) {\n      this.setState({selection: this.dragSelection});\n      delete this.dragSelection;\n    }\n    if (this.selrect) {\n      this.selrect.style.display = 'none';\n    }\n    this.removeEvents();\n    e.preventDefault();\n  }\n  onMouseWheel = e => {\n    if (e.deltaY > 0) {\n      this.distance = Math.min(this.distance * 1.2, this.maxDistance);\n    } else {\n      this.distance = Math.max(this.distance / 1.2, this.minDistance);\n    }\n  }\n\n  removeEvents() {\n    document.removeEventListener(\"mousemove\", this.onMouseMove, true);\n    document.removeEventListener(\"mouseup\", this.onMouseUp, true);\n  }\n\n  \n  animate = ts => {\n    // console.log(ts - this.prevTs);\n    this.prevTs = ts;\n    this.frame = requestAnimationFrame(this.animate);\n    this.scene.camera.viewport([0, 0, this.canvas.width, this.canvas.height]);\n\n    if (this.viewer.mapSize) {\n      const size = this.viewer.mapSize, offset = this.viewer.centerOffset;\n      this.center[0] = Math.max(offset[0], Math.min(this.center[0], 128 * size[0] + offset[0]));\n      this.center[1] = Math.max(offset[1], Math.min(this.center[1], 128 * size[1] + offset[1]));\n      if (!this.rOffsets) {\n        this.rOffsets = [];\n        for (let i = 0; i < 32; ++i) {\n          const ang = Math.random() * Math.PI * 2;\n          const dist = Math.random();\n          this.rOffsets.push([Math.cos(ang) * dist, Math.sin(ang) * dist]);\n        }\n      }\n      this.center[2] = 0;\n      this.rOffsets.forEach(([x, y]) => {\n        this.center[2] += this.viewer.heightAt(this.center[0] + x * this.distance / 4, this.center[1] + y * this.distance / 4);\n      });\n      this.center[2] /= this.rOffsets.length;\n    }\n\n    this.scene.camera.perspective(Math.PI / 4, this.canvas.width / this.canvas.height, this.minDistance / 4, this.maxDistance * 2);\n    this.scene.camera.setRotationAroundAngles(this.yaw, this.pitch, this.center, this.distance);\n\n    this.viewer.updateAndRender();\n  }\n\n  componentWillUnmount() {\n    if (this.frame) {\n      cancelAnimationFrame(this.frame);\n      delete this.frame;\n    }\n    this.unmounted = true;\n  }\n\n  addNotification(text, type, expires) {\n    this.setState(({notifications}) => {\n      let line = {text, type};\n      notifications = [...notifications, line];\n      if (expires > 1000) {\n        setTimeout(() => {\n          if (this.unmounted) return;\n          this.setState(({notifications}) => {\n            let idx = notifications.indexOf(line);\n            if (idx >= 0) {\n              notifications = notifications.slice();\n              line = {...line, expiring: true};\n              notifications[idx] = line;\n            }\n            return {notifications};\n          });\n        }, expires - 1000);\n      } else {\n        line.expiring = true;\n      }\n      setTimeout(() => {\n        if (this.unmounted) return;\n        this.setState(({notifications}) => {\n          let idx = notifications.indexOf(line);\n          if (idx >= 0) {\n            notifications = notifications.slice();\n            notifications.splice(idx, 1);\n          }\n          return {notifications};\n        });\n      }, expires);\n      return {notifications};\n    });\n  }\n  \n  componentDidMount() {\n    if (!this.canvas) {\n      return;\n    }\n    const canvas = this.canvas;\n\n    const data = this.context;\n    const resolvePath = (path, tileset) => {\n      const ext = typeof path === \"string\" ? path.substr(path.lastIndexOf(\".\")).toLowerCase() : \".mdx\";\n      if ([\".blp\", \".dds\", \".gif\", \".jpg\", \".jpeg\", \".png\", \".tga\"].indexOf(ext) >= 0) {\n        return [data.image(path, tileset), \".png\", true];\n      } else {\n        const bin = data.binary(path);\n        if (bin) {\n          return [bin.data.buffer, ext, false];\n        } else {\n          return [data.cache.binary(path, tileset), ext, true];\n        }\n      }\n    };\n\n    this.viewer = new ModelViewer.viewer.handlers.w3x.MapViewer(canvas, resolvePath, data);\n    this.viewer.gl.clearColor(0, 0, 0, 1);\n    this.viewer.on('error', (target, error, reason) => {\n      if (error === \"FailedToFetch\") {\n        this.addNotification(`Failed to load ${target.path}`, 'error', 5000);\n      }\n    });\n    this.viewer.on('idle', () => {\n      this.addNotification('Loading complete!', 'success', 5000);\n    });\n    this.scene = this.viewer.scene;\n\n    this.viewer.loadMap(data);\n\n    this.frame = requestAnimationFrame(this.animate);\n  }\n\n  deselect = () => {\n    if (this.viewer) {\n      this.viewer.deselect();\n    }\n    this.setState({selection: []});\n  }\n\n  render() {\n    const { notifications, selection } = this.state;\n    return (\n      <div className=\"ModelPage\">\n        <div className=\"FileModel\">\n          <AutoSizer>\n            {({width, height}) => (\n              <canvas\n              onMouseDown={this.onMouseDown}\n              onContextMenu={this.onContextMenu}\n              onWheel={this.onMouseWheel}\n              ref={n => this.canvas = n}\n              width={Math.max(width, 100)}\n              height={Math.max(height, 100)}\n              />\n            )}\n          </AutoSizer>\n          <div className=\"selRect\" ref={n => this.selrect = n}/>\n          <ul className=\"log\">\n            {notifications.map(({text, type, expiring}, idx) => <li key={idx} className={type + (expiring ? \" expiring\" : \"\")}>{text}</li>)}\n          </ul>\n          <div className=\"credits\">\n            Model viewer by <a href=\"https://github.com/flowtsohg/mdx-m3-viewer\" target=\"_blank\">flowtsohg@github</a>\n          </div>\n          <AsyncSelectionWindow gameData={this.gameData} units={selection} viewer={this.viewer} deselect={this.deselect}/>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport Title from 'data/title';\nimport AppCache from 'data/cache';\n\nimport { ObjectView } from 'objects/ObjectView';\nimport { FileView } from 'files/FileView';\nimport MapHome from './MapHome';\nimport objectTypes from 'objects/types';\nimport JassView from './jass/JassView';\nimport MapView from './MapView';\n\nconst DataView = () => (\n  <AppCache.DataContext.Consumer>\n    {data => {\n      let views = (\n        <Switch>\n          <Route path={`/:build/(${Object.keys(objectTypes).join(\"|\")})`} component={ObjectView}/>\n          <Route path=\"/:build/script\" component={JassView}/>\n          <Route path=\"/:build/map\" component={MapView}/>\n          <Route path=\"/:build/files\" component={FileView}/>\n          <Route path=\"/:build\" exact component={MapHome}/>\n        </Switch>\n      );\n      if (data.isMap) {\n        return (\n          <Title title={data.name}>\n            {views}\n          </Title>\n        )\n      } else {\n        return views;\n      }\n    }}\n  </AppCache.DataContext.Consumer>\n);\n\nexport default DataView;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { FormGroup, FormControl } from 'react-bootstrap';\nimport AppCache from 'data/cache';\nimport { setNotifyComponent } from './notify';\n\nimport './HomePage.scss';\nimport FormFileLabel from 'react-bootstrap/esm/FormFileLabel';\n\nconst MapLink = ({ id, name, desc }) => {\n  name = name && name.replace(/\\|(c[0-9a-fA-F]{6,8}|r)/g, \"\");\n  desc = desc && desc.replace(/\\|(c[0-9a-fA-F]{6,8}|r)/g, \"\");\n  if (desc) {\n    return <Link to={`/${id}`}>{name} <span className=\"desc\">{desc}</span></Link>;\n  } else {\n    return <Link to={`/${id}`}>{name}</Link>;\n  }\n};\n\nclass MapList extends React.Component {\n  state = { collapsed: true }\n  toggle = () => {\n    this.setState(({ collapsed }) => ({ collapsed: !collapsed }));\n  }\n  render() {\n    const { level = 0, name, items, paths, descs, Comp = \"div\" } = this.props;\n    const { collapsed } = this.state;\n    const Header = (level ? \"h4\" : \"h3\");\n    const subLists = {};\n    const freeItems = [];\n    Object.keys(items).forEach(id => {\n      let path = paths[id];\n      if (!path || path.indexOf(\"maps/\") !== 0) {\n        return;\n      }\n      path = path.substr(5).split(\"~\");\n      if (path.length > level + 1) {\n        subLists[path[level]] = (subLists[path[level]] || {});\n        subLists[path[level]][id] = items[id];\n      } else {\n        freeItems.push(id);\n      }\n    });\n    freeItems.sort((a, b) => items[a].localeCompare(items[b]));\n    return (\n      <Comp className={collapsed ? \"collapsed map-list\" : \"map-list\"}>\n        <Header onClick={this.toggle}><span glyph={collapsed ? \"chevron-right\" : \"chevron-down\"} /> {name}</Header>\n        <ul>\n          {Object.keys(subLists).sort().map(sub => <MapList Comp=\"li\" key={sub} level={level + 1} name={sub} items={subLists[sub]} paths={paths} descs={descs} />)}\n          {freeItems.map(id => <li key={id}><MapLink id={id} name={items[id]} desc={paths[id].match(/campaign/i) ? descs[id] : null} /></li>)}\n        </ul>\n      </Comp>\n    );\n  }\n}\n\nexport default class HomePage extends React.Component {\n  static contextType = AppCache.Context;\n  state = { message: null, messageType: \"info\" }\n\n  setNotification(message, messageType) {\n    this.setState({ message, messageType });\n  }\n\n  componentDidMount() {\n    setNotifyComponent(this);\n  }\n  componentWillUnmount() {\n    setNotifyComponent(null);\n  }\n\n  parseFile = e => {\n    const files = e.target.files;\n    if (files.length > 0) {\n      this.context.loadMap(files[0]);\n    }\n  }\n\n  render() {\n    const cache = this.context;\n    cache.custom = cache.custom || {};\n    return (\n      <div className=\"HomePage\">\n        {this.state.message != null && (\n          <div bsStyle={this.state.messageType}>\n            {this.state.message}\n          </div>\n        )}\n        <h3>Warcraft III Data</h3>\n        <ul>\n          {Object.entries(cache.versions).sort((a, b) => parseInt(b[0], 10) - parseInt(a[0], 10)).map(([id, name]) => (\n            <li key={id}><Link to={`/${id}`}>Patch {name}</Link></li>\n          ))}\n        </ul>\n        <AppCache.MapsContext.Consumer>\n          {maps => (\n            <MapList name=\"Standard Maps\" items={maps} paths={cache.custom || {}} descs={cache.customDesc || {}} />\n          )}\n        </AppCache.MapsContext.Consumer>\n        <h3>Custom Maps</h3>\n        <AppCache.MapsContext.Consumer>\n          {maps => (\n            <ul>\n              {Object.entries(maps).filter(([id]) => !cache.custom[id] || !cache.custom[id].match(/^maps\\//))\n                .sort((a, b) => a[1].localeCompare(a[2])).map(([id, name]) => {\n                  let unload = null;\n                  if (cache.isLocal(id)) {\n                    unload = <span className=\"unload\" onClick={() => cache.unloadMap(id)}>(unload)</span>;\n                  }\n                  return <li key={id}><Link to={`/${id}`}>{name}</Link>{unload}</li>;\n                })}\n            </ul>\n          )}\n        </AppCache.MapsContext.Consumer>\n        <form>\n          <FormGroup controlId=\"loadFile\">\n            <FormFileLabel className=\"linkLike\">Load a custom Warcraft III map</FormFileLabel>\n            <FormControl style={{ display: \"none\" }} type=\"file\" onChange={this.parseFile} accept=\".w3x,.w3m,.mpq\" multiple={false} value=\"\" />\n            <div>\n              <p>Or simply drop the map file onto the page</p>\n              <p>The map will be parsed in your browser, and the data will be stored in browser cache. Nothing is sent to the server.</p>\n            </div>\n          </FormGroup>\n        </form>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { BrowserRouter as Router, Route, Link, Redirect } from 'react-router-dom';\nimport { Navbar, Modal, Button } from 'react-bootstrap';\nimport { LinkContainer } from 'react-router-bootstrap';\nimport { withAsync } from './utils';\nimport AppCache from './data/cache';\nimport Title from './data/title';\nimport Options from './data/options';\nimport { notifyMessage } from 'notify';\nimport './App.scss';\n\nimport DataMenu from './DataMenu';\nimport DataView from './DataView';\nimport HomePage from './HomePage';\n\nconst Spinner = () => <div className=\"Spinner\" />;\n\nconst WithData = withAsync({\n  data: ({ id }, cache) => cache.data(id)\n}, ({ data, children }) => (\n  <AppCache.DataContext.Provider value={data}>\n    {children}\n  </AppCache.DataContext.Provider>\n), undefined, () => <Redirect to=\"/\" />);\nWithData.contextType = AppCache.Context;\n\nfunction isDropFile(e) {\n  if (e.dataTransfer.items) {\n    for (let i = 0; i < e.dataTransfer.items.length; ++i) {\n      if (e.dataTransfer.items[i].kind === \"file\") {\n        return true;\n      }\n    }\n  } if (e.dataTransfer.files.length) {\n    return true;\n  }\n  return false;\n}\nfunction getDropFile(e) {\n  if (e.dataTransfer.items) {\n    for (let i = 0; i < e.dataTransfer.items.length; ++i) {\n      if (e.dataTransfer.items[i].kind === \"file\") {\n        return e.dataTransfer.items[i].getAsFile();\n      }\n    }\n  } if (e.dataTransfer.files.length) {\n    return e.dataTransfer.files[0];\n  }\n}\n\nclass App extends React.PureComponent {\n  static contextType = AppCache.Context;\n\n  get build() {\n    return this.props.match.params.build;\n  }\n\n  state = {\n    loading: 0,\n    dropping: 0,\n  }\n\n  onLoading = loading => {\n    this.setState({ loading });\n  }\n\n  componentDidMount() {\n    this.context.subscribe(this.onLoading);\n    document.addEventListener(\"drop\", this.onDrop, true);\n    document.addEventListener(\"dragover\", this.onDragOver, true);\n    document.addEventListener(\"dragenter\", this.onDragEnter, true);\n    document.addEventListener(\"dragleave\", this.onDragLeave, true);\n  }\n  componentWillUnmount() {\n    this.context.unsubscribe(this.onLoading);\n\n    document.removeEventListener(\"drop\", this.onDrop, true);\n    document.removeEventListener(\"dragover\", this.onDragOver, true);\n    document.removeEventListener(\"dragenter\", this.onDragEnter, true);\n    document.removeEventListener(\"dragleave\", this.onDragLeave, true);\n  }\n\n  setDropping(inc) {\n    this.setState(({ dropping }) => ({ dropping: Math.max(dropping + inc, 0) }));\n  }\n\n  onDrop = e => {\n    const file = getDropFile(e);\n    if (file) {\n      e.preventDefault();\n      this.context.loadMap(file);\n    }\n    this.setState({ dropping: 0 });\n  }\n  onDragEnter = e => {\n    e.preventDefault();\n    this.setDropping(1);\n  }\n  onDragOver = e => {\n    if (isDropFile(e)) {\n      e.preventDefault();\n    }\n  }\n  onDragLeave = e => {\n    this.setDropping(-1);\n  }\n\n  render() {\n    //const { versions, loading } = this.state;\n    const build = this.build;\n    if (build && !this.context.hasData(build)) {\n      notifyMessage(`No data for ${build}`, \"warning\");\n      return <Redirect to=\"/\" />;\n    }\n    return (\n      <React.Fragment>\n        {this.state.dropping > 0 && <div className=\"DropFrame\" />}\n        <Navbar className=\"app-navbar\" fluid=\"true\">\n          <Navbar.Brand>\n            <Link to=\"/\"><span className=\"AppIcon\" /> {\n              !build ? <span style={{ padding: \"5px 10px\" }}>WC3 Data</span> : <span></span>\n            }</Link>\n          </Navbar.Brand>\n          {!!build &&\n            <WithData id={build}>\n              <DataMenu />\n            </WithData>}\n        </Navbar>\n        {build ? (\n          <WithData id={build}>\n            <DataView />\n          </WithData>\n        ) : (\n          <HomePage />\n        )}\n        {this.state.loading > 0 && <Spinner />}\n      </React.Fragment>\n    );\n  }\n}\n\nconst AppLoader = withAsync({\n  ready: (props, cache) => cache.ready,\n}, App, undefined, undefined);\nAppLoader.contextType = AppCache.Context;\n\nclass MapDialog extends React.Component {\n  renderStep(index, name) {\n    const { progress, status } = this.props;\n    if (progress >= index || (status != null && status !== false)) {\n      return <li className=\"success\"><span glyph=\"success\" />{name}</li>;\n    } else if (status != null) {\n      return <li className=\"failure\"><span glyph=\"remove\" />{name}</li>;\n    } else if (progress === index - 1) {\n      return <li className=\"working\"><span glyph=\"success\" />{name}...</li>;\n    } else {\n      return <li className=\"pending\"><span glyph=\"success\" />{name}</li>;\n    }\n  }\n  render() {\n    const { name, status, error, onHide } = this.props;\n    return (\n      <Modal dialogClassName=\"MapDialog\" show={name != null} onHide={onHide}>\n        <Modal.Header closeButton>\n          <Modal.Title>Processing {name}</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <ul className=\"load-progress\">\n            {this.renderStep(0, \"Downloading meta data\")}\n            {this.renderStep(1, \"Loading objects\")}\n            {this.renderStep(2, \"Writing objects\")}\n            {this.renderStep(3, \"Identifying files\")}\n            {this.renderStep(4, \"Copying files\")}\n            {this.renderStep(5, \"Finishing\")}\n          </ul>\n          {error != null && (\n            <Link bsStyle=\"danger\">\n              {error}\n            </Link>\n          )}\n        </Modal.Body>\n        <Modal.Footer>\n          {status == null && <Button bsStyle=\"warning\" onClick={onHide}>Cancel</Button>}\n          {status != null && status !== false && (\n            <LinkContainer to={`/${status}`}>\n              <Button bsStyle=\"info\" onClick={onHide}>Open</Button>\n            </LinkContainer>\n          )}\n          {status != null && <Button bsStyle=\"info\" onClick={onHide}>Ok</Button>}\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n}\n\nclass Root extends React.Component {\n  cache = new AppCache(this);\n  state = {\n    mapLoadName: null,\n    mapLoadProgress: -1,\n    mapLoadStatus: null,\n    mapLoadError: null,\n  }\n\n  navigateTo(url) {\n    if (this.router) {\n      this.router.history.push(url);\n    }\n  }\n\n  beginMapLoad(name) {\n    this.setState({ mapLoadName: name, mapLoadProgress: -1, mapLoadStatus: null, mapLoadError: null });\n  }\n  onMapProgress(stage) {\n    this.setState({ mapLoadProgress: stage });\n  }\n  finishMapLoad(id) {\n    this.setState({ mapLoadStatus: id });\n    window.cache = this.cache;\n  }\n  failMapLoad(error) {\n    this.setState({ mapLoadStatus: false, mapLoadError: error });\n  }\n\n  onCloseMapDialog = () => {\n    this.cache.abortMap();\n    this.setState({\n      mapLoadName: null,\n      mapLoadProgress: -1,\n      mapLoadStatus: null,\n      mapLoadError: null,\n    });\n  }\n\n  render() {\n    const { mapLoadName, mapLoadProgress, mapLoadStatus, mapLoadError } = this.state;\n    return (\n      <Router basename=\"/\" ref={e => this.router = e}>\n        <Title title=\"WC3 Data\">\n          <Options>\n            <AppCache.Context.Provider value={this.cache}>\n              <AppCache.MapsContext.Provider value={this.cache.maps}>\n                <div className=\"App\">\n                  <MapDialog name={mapLoadName} status={mapLoadStatus} progress={mapLoadProgress} error={mapLoadError} onHide={this.onCloseMapDialog} />\n                  <Route path=\"/:build?\" component={AppLoader} />\n                </div>\n              </AppCache.MapsContext.Provider>\n            </AppCache.Context.Provider>\n          </Options>\n        </Title>\n      </Router>\n    )\n  }\n}\n\nexport default Root;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './reset.css';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}